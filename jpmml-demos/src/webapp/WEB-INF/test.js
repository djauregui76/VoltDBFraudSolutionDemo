Ext.ns("Explore");
Explore.versionDescription = "Autonomy Explore 3.5 SP2 U04";
Explore.version = "3.5.2304.4";
Ext.ns("Explore");
Ext.chart.Chart.CHART_URL = "../resources/ext/340/resources/charts.swf";
Explore.TAG_SEPARATOR = ", ";
Explore.popupWindow = function(d, c, e, a) {
    var b = String.format("width={0},height={1},toolbar=no,scrollbars=no,menubar=no,resizable=yes", e, a);
    var g = window.open(d, c, b);
    try {
        g.focus()
    } catch(f) {
    }
    return g
};
Explore.showSearchPanel = function() {
    var a = Ext.getCmp("mainTabPanel");
    a.setActiveTab(1);
    var b = Ext.getCmp("searchPanel");
    var c = b.getSearchPresenter();
    return c
};
Explore.getSearchPresenter = function() {
    var d = Ext.getCmp("mainTabPanel").layout.activeItem;
    var a = Ext.getCmp("mainTabPanel");
    a.setActiveTab(1);
    var b = Ext.getCmp("searchPanel");
    var c = b.getSearchPresenter();
    a.setActiveTab(d);
    return c
};
Explore.showAnalyticsPanel = function() {
    var a = Ext.getCmp("mainTabPanel");
    a.setActiveTab(2);
    var b = Ext.getCmp("analyticsPanel");
    return b.getPresenter()
};
Explore.showConfigMissingMessage = function(c) {
    if (Explore.Security.isAuthorized("ADMINISTER_APP")) {
        var a = Ext.getCmp("mainTabPanel");
        a.setActiveTab("app-administration");
        var b = Ext.getCmp("app-administration").get(0);
        b.setActiveTab("admin-config");
        Explore.view.StatusBox.showError(Explore.i18n("appTitle"), Explore.i18n(c) + "<br />" + Explore.i18n("checkSettings"))
    } else {
        Explore.view.StatusBox.showError(Explore.i18n("appTitle"), Explore.i18n(c) + "<br />" + Explore.i18n("contactAdmin"))
    }
};
Explore.getHash = function() {
    var a = top.location.href,b = a.indexOf("#");
    if (b >= 0) {
        return decodeURIComponent(a.substr(b + 1))
    }
    return null
};
Explore.setHash = function(a, c) {
    log.info("Explore.setHash: ", a, " ", c);
    var b = "";
    if (a) {
        if (c) {
            b = a + ":" + c
        } else {
            b = a
        }
    }
    top.location.hash = b
};
Explore.addHash = function(d, g) {
    log.info("Explore.setHash: ", d, " ", g);
    var f = "";
    if (d) {
        if (g) {
            f = d + ":" + g
        } else {
            f = d
        }
    }
    if (!f) {
        return
    }
    var c = Explore.getHash();
    var e;
    if (c) {
        var a = c.split("#");
        if (a) {
            for (var b = 0; b < a.length; ++b) {
                if (a[b].indexOf(d, 0) === 0) {
                    e = a[b];
                    break
                }
            }
        }
        if (e) {
            c = c.replace(e, f)
        } else {
            c = c + "#" + f
        }
    } else {
        c = f
    }
    top.location.hash = c
};
Explore.getHashValue = function(f) {
    var e;
    if (f) {
        var c = Explore.getHash();
        var d;
        if (c) {
            var a = c.split("#");
            if (a) {
                for (var b = 0; b < a.length; ++b) {
                    if (a[b].indexOf(f, 0) === 0) {
                        d = a[b];
                        if (d.indexOf(":", 0) >= 0) {
                            e = d.substring(d.indexOf(":", 0) + 1)
                        } else {
                            e = ""
                        }
                        break
                    }
                }
            }
        }
    }
    return e
};
Explore.checkHash = function() {
    var a = Explore.getHashValue("search");
    if (a) {
        var b = Explore.showSearchPanel();
        b.searchByText(a)
    }
};
Explore.areArraysSame = function(c, a) {
    var d = false;
    if ((!c || c.length === 0) && (!a || a.length === 0)) {
        d = true
    } else {
        if (c && a) {
            if (c.length === a.length) {
                for (var b = 0;
                     b < c.length; ++b) {
                    if (a.indexOf(c[b]) === -1) {
                        return d
                    }
                }
                d = true
            }
        }
    }
    return d
};
Explore.abortAllAjax = function() {
    try {
        for (var a = 0; a < 100;
             a++) {
            Ext.Ajax.abort(a)
        }
    } catch(b) {
    }
};
Explore.reload = function(a) {
    if (a !== true) {
        var b = Explore.presenter.ProjectsPresenter.getCurrentProjectId();
        if (b) {
            Explore.addHash("ProjectId", b)
        }
    }
    Explore.abortAllAjax();
    window.location.reload()
};
Explore.formatNumber = function(b) {
    if (b === null || b === undefined) {
        return""
    }
    var c = b;
    if (Ext.isNumber(b)) {
        c = Ext.util.Format.number(b, Explore.isInt(b) ? Explore.getIntegerFormat() : Explore.getNumberFormat())
    } else {
        var a = parseFloat(b);
        if (!Ext.isNumber(a)) {
            return b
        }
        c = Ext.util.Format.number(a, Explore.isInt(b) ? Explore.getIntegerFormat() : Explore.getNumberFormat())
    }
    return c
};
Explore.getNumberFormat = function() {
    return"0,000.00"
};
Explore.isInt = function is_int(a) {
    return Math.ceil(a) == Math.floor(a)
};
Explore.getIntegerFormat = function() {
    return"0,000"
};
(function() {
    Ext.ns("Explore");
    Explore.Globalization = {getString:function(d, c) {
        var a = null;
        if (d) {
            var b = d.replace("-", "_");
            if (typeof(ExploreWebStrings) !== "undefined") {
                a = ExploreWebStrings[b];
                if (!a) {
                    if (c !== undefined) {
                        a = c
                    } else {
                        a = d
                    }
                }
            } else {
                if (typeof(i18n) !== "undefined") {
                    return i18n("Explore.view.common.r." + b)
                }
            }
        }
        return a
    },globalizeArray:function(a, d, c) {
        if (a === null) {
            log.warn("globalizeArray valuesArray is null");
            return
        }
        if (d === undefined) {
            d = "name"
        }
        if (c === undefined) {
            c = ""
        }
        for (var b = 0; b < a.length; b++) {
            var e = a[b];
            e[d] = Explore.Globalization.getString(c + e[d])
        }
        return a
    },globalizeAndSortArray:function(a, c, b) {
        if (c === undefined) {
            c = "name"
        }
        a = this.globalizeArray(a, c, b);
        a.sort(function(f, d) {
            var g = f[c].toLowerCase(),e = d[c].toLowerCase();
            if (g < e) {
                return -1
            } else {
                if (g > e) {
                    return 1
                } else {
                    return 0
                }
            }
        });
        return a
    },getErrorMessage:function(a) {
        var b = "Error" + a.ID;
        return Explore.Globalization.getString(b, a.IDOLErrorMessage)
    }}
})();
Explore.i18n = function(a) {
    if (typeof(i18n) !== "undefined") {
        return i18n("Explore.view.common.r." + a)
    } else {
        return Explore.Globalization.getString(a)
    }
};
Explore.Playlist = [];
function GetPlayList() {
    return Explore.Playlist
}
function GetLangType() {
    var a = "englishUTF8";
    return a
}
function GetSearchTerm() {
    return null
}
Ext.ns("Explore");
Explore.SearchResults = {getBodyFieldsByType:function(a) {
    return["body"]
},getIcnSmallByType:function(a) {
    return"../resources/images/icons/icn_multichannel_" + a + "_16.png"
},getTitleForRecord:function(c, a) {
    a = a || 100;
    var b = Ext.util.Format;
    var d = c.fields.title;
    if (d) {
        d = b.ellipsis(b.stripTags(d), a)
    }
    return d
},getTruncateTextWithEllipsis:function(d, a) {
    a = a || 100;
    var b = Ext.util.Format;
    var c = "";
    if (d) {
        c = b.ellipsis(b.stripTags(d), a)
    }
    return c
},getRelativeTime:function(e) {
    function d(l, k, j) {
        var m = Math.floor(l);
        if (m == 1) {
            return String.format("{0} {1} " + Explore.i18n("_Ago"), m, k)
        } else {
            if (m > 1) {
                return String.format("{0} {1} " + Explore.i18n("_Ago"), m, j)
            }
        }
        return null
    }

    var a = Explore.parseSerializedDate(e.date);
    var h = a.getElapsed() / 1000;
    var g = h / 60;
    var c = g / 60;
    var b = c / 24;
    var f = b / 365;
    return d(f, Explore.i18n("year"), Explore.i18n("years")) || d(b, Explore.i18n("day"), Explore.i18n("days")) || d(c, Explore.i18n("hour"), Explore.i18n("hours")) || d(g, Explore.i18n("minutes"), Explore.i18n("minutes")) || d(h, Explore.i18n("second"), Explore.i18n("seconds"))
},getSummaryForRecord:function(d, a) {
    a = a || 100;
    var c = Ext.util.Format;
    var b = "";
    var b = d.fields.summary;
    if (b !== null && b !== undefined && b.length > 0) {
        b = c.ellipsis(c.stripTags(b), a)
    }
    return b
},createLinks:function(c) {
    var b = /(\b(https?):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gim;
    var a = c.replace(b, '<a href="$1" target="_blank">$1</a>');
    return a
},getObjectsFromRows:function(b) {
    var a = Ext.pluck(b, "json");
    return a
},openResultsById:function(c, a, b, d) {
    Explore.data.IDOLDataStore.getDocsFromSearchId(c, a, b, function(e) {
        if (e && e.rows && e.rows.length > 0) {
            log.info("retrieveSearchResults returned:", e);
            Explore.SearchResults.openSearchResults(e.rows, e.rows, d, null, null, true)
        } else {
            log.error("No search results were returned in call to retrieveSearchResults")
        }
    })
},openSearchResults:function(c, h, j, k, l, a, d) {
    log.info("openSearchResults selectedRows.length,", c.length, " rowIndex=", j, " pagingInfo=", k, " searchCriteria=", l);
    var e;
    var f = (c.length > 1);
    var m = f ? c : h;
    if (a) {
        e = m
    } else {
        e = this.getObjectsFromRows(m)
    }
    var b = {results:e,startIndex:f ? 0 : j,pagingInfo:f ? null : k,searchCriteria:l,getDocumentBodyFn:d};
    var g = new Explore.view.SearchResultDetailDialog(b);
    g.show()
},allowClassify:function(b) {
    for (var a = 0; a < b.length; a++) {
        if (b[a].data.type === "Recordings") {
            return true
        }
    }
    return false
},getPlayerUrl:function(c, b, e) {
    var d = Explore.PlayerUrl;
    if (d == null || d == "") {
        Explore.view.StatusBox.showError(Explore.i18n("error"), Explore.i18n("errorQfinitiUrlMissing"))
    } else {
        function a() {
            d = Ext.urlAppend(d, Ext.urlEncode({id:c,t:(b || ""),emotion:Explore.data.PreferenceDataStore.getShowEmotionMarkersPreference(),authtoken:Explore.SearchResults.qwaAuthToken}));
            e(d)
        }

        if (Explore.SearchResults.qwaAuthToken) {
            a()
        } else {
            Explore.data.QWADataStore.getAuthenticationToken(function(f) {
                if (f == null || f.ErrorCode === null || f.ErrorCode === 0) {
                    Explore.SearchResults.qwaAuthToken = f.Result;
                    a()
                } else {
                    log.warn("getPlayerUrl", f);
                    Explore.SearchResults.qwaAuthToken = null;
                    if (f.ErrorCode === 401) {
                        a()
                    } else {
                        if (f.ErrorCode === 590) {
                            Explore.view.StatusBox.showWarning("Qfiniti - Change Password", "You must change your password for Qfiniti to play the requested recording. Click to continue.");
                            a()
                        } else {
                            Explore.view.StatusBox.showError("Error logging into the Qfiniti Player.", "There was an error logging into the Qfiniti Player.<br />Check the event log on the QWA server for more information.");
                            e(null)
                        }
                    }
                }
            })
        }
    }
},getWorkflowItem:function(f, b) {
    if (f != null && f.length > 0) {
        for (var d = f.length - 1; d >= 0; d--) {
            var e = f[d];
            var g = e.Actions;
            if (g != null) {
                for (var c = 0; c < g.length; c++) {
                    if (b === g[c]) {
                        return e
                    }
                }
            }
        }
    }
    return null
}};
Ext.ns("Explore");
Explore.Security = {permissions:null,buildPermissions:function() {
    this.permissions = {};
    if (typeof currentUser !== "undefined") {
        var b = currentUser.Role.Permissions;
        if (b) {
            for (var a = 0; a < b.length; a++) {
                this.permissions[b[a].Name] = true
            }
        }
    }
},isAuthorized:function(a) {
    if (this.permissions === null) {
        this.buildPermissions()
    }
    return this.permissions[a] || false
}};
Ext.ns("Explore.base");
Explore.base.AdministrationDetailPanelBase = Ext.extend(Ext.Panel, {itemDescription:null,permissions:null,formItems:[],itemDescription:"",currentObject:null,_formItemsConfig:null,labelWidth:150,layout:"form",padding:"10",itemCls:"sourcefield",initComponent:function() {
    var a = {title:this.getTitleText(),defaults:{xtype:"displayfield",hideLabel:false,hidden:true,width:"100%"},items:this.getItemsConfig(),tbar:this.getButtonsConfig()};
    Ext.apply(this, Ext.apply(this.initialConfig, a));
    Explore.base.AdministrationDetailPanelBase.superclass.initComponent.apply(this, arguments)
},getMask:function() {
    return new Ext.LoadMask(this.body || Ext.getBody(), {msg:Explore.i18n("Loading_")})
},getTitleText:function() {
    return String.format(Explore.i18n("_Details"), this.itemDescription) + ": " + this.getObjectName()
},getObjectName:function() {
    var a = this.currentObject;
    if (a && a.Name) {
        return a.Name
    }
    return""
},getAuditText:function() {
    var a = "";
    var c = this.currentObject;
    if (c && c.CreatedBy && c.DateCreated) {
        var b = Explore.parseSerializedDate(c.DateCreated);
        a = c.CreatedBy + " " + Explore.i18n("on") + " " + Explore.formatDateByPref(b)
    }
    return a
},getButtonsConfig:function() {
    var a = this;
    var b = [
        {xtype:"button",itemId:"newButton",iconCls:"new-icon",text:Explore.i18n("New"),tooltip:String.format(Explore.i18n("CreateANew_"), this.itemDescription),hidden:!a.permissions.create,handler:function() {
            a.fireEvent("newItem")
        }},
        {xtype:"button",itemId:"editButton",iconCls:"edit-icon",text:Explore.i18n("Edit"),tooltip:String.format(Explore.i18n("Edit_"), this.itemDescription),disabled:true,hidden:!a.permissions.update,handler:function() {
            a.fireEvent("editItem", a.currentObject)
        }},
        {xtype:"button",itemId:"viewButton",iconCls:"edit-icon",text:Explore.i18n("View"),tooltip:String.format(Explore.i18n("View_"), this.itemDescription),disabled:true,hidden:!a.permissions.update,handler:function() {
            a.fireEvent("viewItem", a.currentObject)
        }},
        {xtype:"button",itemId:"deleteButton",iconCls:"delete-icon",text:Explore.i18n("Delete"),tooltip:String.format(Explore.i18n("Delete_"), this.itemDescription),disabled:true,hidden:!a.permissions["delete"],handler:function() {
            a.fireEvent("deleteItem", a.currentObject)
        }}
    ];
    return b
},getItemsConfig:function() {
    if (!this._formItemsConfig) {
        var b = [];
        b.push({itemId:"auditLabel",fieldLabel:Explore.i18n("Created")});
        for (var e = 0; e < this.formItems.length; e++) {
            var d = this.formItems[e];
            var c = d.name;
            var a = Ext.apply({itemId:c,fieldLabel:Explore.i18n(c)}, d);
            b.push(a)
        }
        this._formItemsConfig = b
    }
    return this._formItemsConfig
},updateButtonState:function() {
    var a = this.currentObject == null;
    if (this.topToolbar.getByItemId) {
        var b = this.topToolbar.getByItemId("editButton");
        if (b) {
            b.setDisabled(a)
        }
        var c = this.topToolbar.getByItemId("deleteButton");
        if (c) {
            c.setDisabled(a)
        }
    }
},displayObject:function(g) {
    this.currentObject = g;
    for (var c = 0; c < this._formItemsConfig.length; c++) {
        try {
            var b = this._formItemsConfig[c];
            var j = b.itemId;
            var d = this.getByItemId(j);
            d.setVisible(g != null);
            if (j === "auditLabel") {
                var a = this.getAuditText();
                if (a === null || a === "") {
                    d.setValue("");
                    d.hide()
                } else {
                    d.setValue(a);
                    d.show()
                }
            } else {
                if (g) {
                    var h;
                    if (b.tpl) {
                        h = new Ext.XTemplate(b.tpl).apply(g)
                    } else {
                        h = Explore.base.EditorUtil.getObjectProperty(g, b.name) || ""
                    }
                    if (b.xtype === "label") {
                        d.setText(h)
                    } else {
                        if (d.setValue) {
                            d.setValue(h)
                        }
                    }
                } else {
                    if (b.xtype === "label") {
                        d.setText("")
                    } else {
                        if (d.setValue) {
                            d.setValue(null)
                        }
                    }
                }
            }
        } catch(f) {
            log.error("AdministrationDetailPanelBase displayObject:", f)
        }
    }
    this.setTitle(this.getTitleText());
    this.updateButtonState()
}});
Ext.reg("explore.base.administrationdetailpanelbase", Explore.base.AdministrationDetailPanelBase);
Ext.ns("Explore.base");
Explore.base.getRefreshSourceValue = function(a) {
    if (a != null) {
        if ((Explore.formatDate(a.RefreshSourceNextTime, Explore.datePatterns.ShortDateTime).indexOf("1/1/0001") != -1) || (a.RefreshSourceInterval === 0)) {
            return Explore.i18n("Noscheduledinterval")
        } else {
            return String.format(Explore.i18n("Every") + " {0} " + Explore.i18n("hours") + " (" + Explore.i18n("nextrefresh") + ": {1})", a.RefreshSourceInterval, (Explore.formatDateByPref(a.RefreshSourceNextTime)))
        }
    }
};
Explore.base.getLastRefreshedValue = function(a) {
    if (a != null) {
        if (Explore.formatDate(a.LastRefreshed, Explore.datePatterns.ShortDateTime).indexOf("1/1/0001") != -1) {
            return Explore.i18n("Neverrun")
        } else {
            if (a.LastRefreshedDocuments > 0) {
                return String.format("{0} ( {1} " + Explore.i18n("_documents") + ", {2} " + Explore.i18n("minutes") + " {3} " + Explore.i18n("seconds") + ")", (Explore.formatDateByPref(a.LastRefreshed)), Explore.formatNumber(a.LastRefreshedDocuments), (a.LastRefreshedProcessingTime >= 60) ? Math.floor((a.LastRefreshedProcessingTime / 60)) : 0, a.LastRefreshedProcessingTime % 60)
            } else {
                if (a.ErrorMessage) {
                    return String.format('<div><img src="../resources/images/icons/icn_error.gif" height="10" width="10"/><font color="#ff0000"> {0}</font></div>', a.ErrorMessage)
                } else {
                    return String.format('<div><img src="" height="10" width="10"/><font color="#000000"> {0}</font></div>', Explore.i18n("NotRunYet"))
                }
            }
        }
    }
};
Explore.base.AdministrationPanelBase = Ext.extend(Ext.Panel, {itemDescription:"",_treeConfig:{},_detailConfig:{},permissions:null,initComponent:function() {
    var b = this;
    if (!this.permissions) {
        this.permissions = {view:false,create:false,update:false,"delete":false}
    }
    var c = {layout:"border",border:false,items:[Ext.apply({itemId:"tree",region:"west",split:true,width:250,minSize:150,maxSize:350,itemDescription:b.itemDescription,permissions:b.permissions,getMask:function() {
        return b.getMask()
    },listeners:{save:function(d) {
        b.displayObject(d)
    },"delete":function(d, e) {
        if (e) {
            Explore.reload()
        } else {
            b.displayObject(null)
        }
    }}}, b._treeConfig),Ext.apply({itemId:"detail",region:"center",itemDescription:b.itemDescription,permissions:b.permissions,getMask:function() {
        return b.getMask()
    },listeners:{newItem:function() {
        b.getTree().newCommand()
    },editItem:function(d) {
        b.getTree().editCommand(d)
    },viewItem:function(d) {
        b.getTree().viewCommand(d)
    },deleteItem:function(d) {
        b.getTree().deleteCommand(d.Id, d.Name)
    }}}, b._detailConfig)]};
    Ext.apply(this, Ext.apply(this.initialConfig, c));
    Explore.base.AdministrationPanelBase.superclass.initComponent.apply(this, arguments);
    var a = b.getByItemId("tree");
    if (a) {
        a.getSelectionModel().on("selectionchange", function(d) {
            var e = d.getSelectedNode();
            if (e) {
                b.onTreeSelectionChange(e)
            }
        })
    }
},getTree:function() {
    return this.getByItemId("tree")
},getDetail:function() {
    return this.getByItemId("detail")
},setTreeConfig:function(a) {
    this._treeConfig = a
},setDetailConfig:function(a) {
    this._detailConfig = a
},getMask:function() {
    return new Ext.LoadMask(this.body || Ext.getBody(), {msg:Explore.i18n("Loading_")})
},onTreeSelectionChange:function(e) {
    var b = this;
    var h = e.attributes.tag.id;
    var d = {};
    log.info("onTreeSelectionChange", h);
    var f = this.getTree().loadFn;
    var a = b.getMask();
    a.show();
    f(h, function(j) {
        a.hide();
        d = j;
        b.displayObject(j)
    });
    var g = new Array();
    g[0] = h;
    var c = this.getTree().docCountsFn
},displayObject:function(a) {
    this.getDetail().displayObject(a)
}});
Ext.reg("explore.base.administrationpanelbase", Explore.base.AdministrationPanelBase);
Ext.ns("Explore.base");
Explore.base.AdministrationTreePanel = Ext.extend(Ext.tree.TreePanel, {itemDescription:null,permissions:null,loadFn:null,saveFn:null,deleteFn:null,editDialogFn:null,viewDialogFn:null,contextMenu:null,contextMenuNode:null,dragNode:null,hideTools:false,showExpandCollapseAll:false,collapsible:false,useArrows:true,autoScroll:true,animate:true,enableDD:false,containerScroll:true,rootVisible:true,initComponent:function() {
    var b = this;
    if (!this.permissions) {
        this.permissions = {create:false,update:false,"delete":false}
    }
    if (!this.root && this.rootVisible) {
        this.root = {id:"root",text:"Root",expanded:true,tag:{id:-1,type:"root"}}
    }
    if (!this.keys) {
        this.keys = [
            {key:Ext.EventObject.DELETE,fn:function() {
                try {
                    var d = b.getSelectionModel().getSelectedNode();
                    if (d) {
                        var g = d.attributes.tag.id;
                        var c = d.text;
                        b.deleteCommand(g, c)
                    }
                } catch(f) {
                }
            },scope:b},
            {key:"r",fn:function() {
                b.refresh(null, function() {
                    var c = b.getRootNode();
                    if (c) {
                        c.select()
                    }
                })
            }}
        ]
    }
    if (!this.tools && !this.hideTools) {
        this.tools = [];
        if (true || this.showExpandCollapseAll) {
            this.tools.push({id:"plus",qtip:Explore.i18n("ExpandAll"),handler:function() {
                b.expandAll()
            }});
            this.tools.push({id:"minus",qtip:Explore.i18n("CollapseAll"),handler:function() {
                b.collapseAll()
            }})
        }
        this.tools.push({id:"refresh",qtip:Explore.i18n("refresh"),handler:function() {
            b.refresh(null, function() {
                var c = b.getRootNode();
                c.ensureVisible();
                c.select()
            })
        }})
    }
    Explore.base.AdministrationTreePanel.superclass.initComponent.apply(this, arguments);
    b.on("contextmenu", this.onContextMenu, this);
    b.on("beforenodedrop", this.treeNodeDrop, this);
    var a = b.getMask();
    b.on("afterLayout", function() {
        if (!b.intiallyLoaded) {
            a.hide();
            a = b.getMask();
            a.show()
        }
    }, this);
    b.getLoader().on("beforeload", function(c) {
        a.show()
    });
    b.getLoader().on("load", function(e) {
        if (!b.intiallyLoaded) {
            b.intiallyLoaded = true
        }
        var c = b.getRootNode();
        var d = b.getSelectionModel();
        var f = d.getSelectedNode();
        if (!f && c.ui.rendered) {
            c.select()
        }
        a.hide();
        b.enable();
        b.fireEvent("listen")
    });
    b.getLoader().on("loadexception", function(c, e, d) {
        a.hide()
    })
},getMask:function() {
    return new Ext.LoadMask(this.getEl() || Ext.getBody(), Explore.i18n("Loading..."))
},onContextMenu:function(b, c) {
    c.stopEvent();
    b.select();
    this.contextMenuNode = b;
    var a = this.getContextMenu(b);
    a.showAt(c.getXY());
    this.fireEvent("AfterContextMenuShow", a, b)
},treeNodeDrop:function(a) {
    this.dragNode = a;
    this.getDragDropNode(a)
},getDragDropNode:function(a) {
},getTreeNodeById:function(f) {
    var c = this.getNodeById(f);
    if (!c) {
        var e = [];
        try {
            var a = this.getRootNode();
            a.cascade(function(g) {
                if (!g.isExpanded()) {
                    e.push(g.id);
                    g.expand(false, false)
                }
            })
        } catch(d) {
            log.warn("AdministrationTreePanel.getTreNodeById error: ", d)
        }
        for (var b = e.length - 1; b >= 0; b--) {
            this.getNodeById(e[b]).collapse(false, false)
        }
        c = this.getNodeById(f)
    }
    if (c) {
        c.ensureVisible()
    }
    return c
},getContextMenu:function(b) {
    var a = this;
    if (!a.contextMenu) {
        a.contextMenu = new Ext.menu.Menu({get:function(c) {
            return this.getByItemId(c)
        },items:[
            {text:String.format(Explore.i18n("New_"), a.itemDescription),itemId:"New" + a.itemDescription,iconCls:"new-icon",disbled:!a.permissions.create,handler:function() {
                a.newCommand()
            }},
            {text:String.format(Explore.i18n("Edit_"), a.itemDescription),itemId:"Edit" + a.itemDescription,iconCls:"edit-icon",disbled:!a.permissions.update,handler:function() {
                a.contextMenuNode.select();
                if (a.contextMenuNode) {
                    var c = a.contextMenuNode.attributes.tag.id;
                    a.editCommand(c)
                }
            }},
            {text:String.format(Explore.i18n("View_"), a.itemDescription),itemId:"View" + a.itemDescription,iconCls:"edit-icon",hidden:true,handler:function() {
                a.contextMenuNode.select();
                if (a.contextMenuNode) {
                    var c = a.contextMenuNode.attributes.tag.id;
                    a.viewCommand(c)
                }
            }},
            {text:String.format(Explore.i18n("Delete_"), a.itemDescription),itemId:"Delete" + a.itemDescription,iconCls:"delete-icon",disbled:!a.permissions["delete"],handler:function() {
                if (a.contextMenuNode) {
                    var d = a.contextMenuNode.attributes.tag.id;
                    var c = a.contextMenuNode.text;
                    a.deleteCommand(d, c)
                }
            }}
        ]})
    }
    a.contextMenuNode.expand(false);
    return a.contextMenu
},refreshForId:function(e) {
    var a = this;
    var c = this.getTreeNodeById(e);
    var b = null;
    if (c) {
        b = c.parentNode
    } else {
        var d = a.getSelectionModel().getSelectedNode();
        if (d) {
            if (a.isLeafNode(d)) {
                b = d.parentNode
            } else {
                b = d
            }
        }
    }
    a.refresh(b, function() {
        try {
            c = a.getTreeNodeById(e);
            if (c) {
                c.ensureVisible(function() {
                    c.select()
                })
            } else {
                if (b) {
                    b.ensureVisible(function() {
                        b.select()
                    })
                }
            }
        } catch(g) {
            var f = a.getRootNode().firstChild;
            if (f) {
                f.ensureVisible(function() {
                    f.select()
                })
            }
        }
    })
},onSave:function(b) {
    var a = this;
    a.saveFn(b, function(c) {
        if (c.ErrorCode == 0) {
            a.fireEvent("save", c.Result)
        } else {
            a.showEditDialog(c.Result);
            Explore.view.StatusBox.showError(Explore.i18n("appTitle"), c.Message)
        }
    })
},createObject:function() {
    var a = {};
    return a
},newCommand:function() {
    var a = this;
    if (!a.permissions.create) {
        Explore.view.StatusBox.showWarning(Explore.i18n("PermissionDenied"), Explore.i18n("YourRoleDoesNotHavePermissionToPerformTheRequestedOperation"));
        return
    }
    var b = a.createObject();
    this.showEditDialog(b)
},editCommand:function(b) {
    log.info("editCommand", b);
    var a = this;
    if (typeof b == "number") {
        a.loadFn(b, function(c) {
            a.editCommand(c)
        })
    } else {
        this.showEditDialog(b)
    }
},viewCommand:function(b) {
    log.info("viewCommand", b);
    var a = this;
    if (typeof b == "number") {
        a.loadFn(b, function(c) {
            a.viewCommand(c)
        })
    } else {
        this.showViewDialog(b)
    }
},showViewDialog:function(c, b) {
    var a = this;
    var d = new a.editDialogFn({editObject:c,readOnly:true});
    d.on("save", function() {
        a.onSave(c)
    });
    d.show(a)
},showEditDialog:function(c, b) {
    var a = this;
    var d = new a.editDialogFn({editObject:c,readOnly:!a.permissions.update});
    d.on("save", function() {
        a.onSave(c)
    });
    d.show(a)
},deleteCommand:function(c, b) {
    var h = this;
    var f = this.itemDescription;
    var a = false;
    var j = Explore.data.PreferenceDataStore.getPreferences();
    if (j.SelectedProjectId == c && f == "Project") {
        a = true
    }
    log.info("deleteCommand", c, b);
    if (!c || c === 1) {
        var e = h.getSelectionModel().getSelectedNode();
        if (!e.attributes.leaf && c) {
            Explore.view.StatusBox.showWarning("Warning", "Can not delete root folder");
            return
        }
    }
    var g = function(k) {
        if (k) {
            if (k.ErrorCode == 0) {
                h.fireEvent("delete", k.Result, a)
            } else {
                Explore.view.StatusBox.showError(Explore.i18n("appTitle"), Explore.i18n(k.Message))
            }
        }
    };
    var d = String.format(Explore.i18n("AreYouSureYouWantToDeleteThe_"), this.itemDescription, b);
    if (a) {
        d = String.format(Explore.i18n("AreYouSureYouWantToDeleteThe_"), this.itemDescription, b) + Explore.i18n("RefreshApplication")
    }
    Explore.view.StatusBox.confirm(Explore.i18n("appTitle"), d, function() {
        var k = new Explore.view.DeleteConfirmationWindow({mytype:f,deleteFn:h.deleteFn,itemName:b,myId:c,callback:g});
        k.start()
    })
},isLeafNode:function(a) {
    if (a && a.attributes && a.attributes.tag && a.attributes.tag.type && a.attributes.tag.type !== "GROUP") {
        return true
    } else {
        return false
    }
},getSelectedIds:function() {
    var d = this.getChecked();
    var a = [];
    if (d) {
        for (var b = 0; b < d.length; b++) {
            var c = d[b];
            if (this.isLeafNode(c)) {
                a.push(c.attributes.tag.id)
            }
        }
    }
    return a
},clearAllChecks:function() {
    var c = this.getChecked();
    if (c) {
        for (var a = 0;
             a < c.length; a++) {
            var b = c[a];
            b.getUI().toggleCheck(false)
        }
    }
},checkObjectId:function(a, b) {
    var c = this.getNodeById(a);
    if (c) {
        c.getUI().toggleCheck(b)
    }
},checkObjectIds:function(b) {
    if (b) {
        for (var a = 0; a < b.length; a++) {
            this.checkObjectId(b[a], true)
        }
    }
}});
Ext.reg("explore.base.administrationtreepanel", Explore.base.AdministrationTreePanel);
Ext.ns("Explore.base");
Explore.base.EditorDialog = Ext.extend(Ext.Window, {editObject:null,readOnly:false,formItemId:"myForm",itemDescription:"",saveButtonText:Explore.i18n("Save"),modal:true,constrain:true,constrainHeader:true,cls:"white-bg-dialog",defaults:{padding:"10"},plain:true,layout:"fit",bodyBorder:false,labelWidth:130,height:500,width:600,_formItemsConfig:null,bypassDirtyCheck:false,initComponent:function() {
    var k = this;
    var f = Ext.getBody().getHeight();
    var h = Math.min(this.height, f);
    var g = Ext.getBody().getWidth();
    var a = Math.min(this.width, g);
    var c = {title:this.getTitle(),width:a,height:h,items:this.createWindowItems(),buttons:this.getButtonsConfig()};
    var b = this.getFooterText();
    if (b !== null && b !== "") {
        c.bbar = [b]
    }
    Ext.apply(this, Ext.apply(this.initialConfig, c));
    Explore.base.EditorDialog.superclass.initComponent.apply(this, arguments);
    this.displayObject();
    if (!this.readOnly) {
        var d = false;

        function j() {
            var l = k.isDirty() && k.isValid(true);
            if (l !== d) {
                d = l;
                var m = k.getByItemId("saveButton");
                m.setDisabled(!l)
            }
        }

        var e = window.setInterval(j, 1000);
        this.on("beforeclose", function() {
            if (k.bypassDirtyCheck || !k.isDirty()) {
                window.clearInterval(e)
            } else {
                log.info("EditorDialog beforeclose, preventing close", k.bypassDirtyCheck);
                var l = new Explore.view.SaveChangesDialog({msg:String.format(Explore.i18n("RecentChangesToThe_HaveNotBeenSavedbrbrWouldYouLikeToSaveTheseChanges"), k.itemDescription),fn:function(m) {
                    if (m === "save") {
                        k.onSaveClick()
                    } else {
                        if (m === "dontsave") {
                            k.bypassDirtyCheck = true;
                            k.close()
                        } else {
                            if (m === "cancel") {
                                this.close()
                            }
                        }
                    }
                },icon:Ext.MessageBox.QUESTION});
                l.show();
                return false
            }
        })
    }
},getTitle:function() {
    var b;
    if (!this.readOnly) {
        var a = (this.editObject.Id > 0) ? false : true;
        if (a) {
            b = String.format(Explore.i18n("New_"), this.itemDescription)
        } else {
            b = String.format(Explore.i18n("Edit_"), this.itemDescription) + ": " + this.getObjectName()
        }
    } else {
        b = String.format(Explore.i18n("View_"), this.itemDescription) + ": " + this.getObjectName()
    }
    return b
},getObjectName:function() {
    return this.editObject.Name
},getFooterText:function() {
    return Explore.base.EditorUtil.getAuditText(this.editObject)
},getButtonsConfig:function() {
    if (!this.readOnly) {
        return[
            {itemId:"saveButton",disabled:true,text:this.saveButtonText,handler:this.onSaveClick,scope:this},
            {text:Explore.i18n("textCancel"),handler:this.close,scope:this}
        ]
    } else {
        return[
            {text:Explore.i18n("Ok"),handler:this.close,scope:this}
        ]
    }
},getRequiredIndicator:function() {
    return" (" + Explore.i18n("required") + ")"
},getFormItems:function() {
    return this.formItems || []
},createWindowItems:function() {
    var a = [
        {xtype:"form",itemId:this.formItemId,border:false,labelWidth:this.labelWidth,autoScroll:true,items:this.getFormItemsConfig()}
    ];
    return a
},getFormItemsConfig:function() {
    var f = this.getRequiredIndicator();
    if (!this._formItemsConfig) {
        var j = this.getFormItems();
        var g = [];
        var c = 400 - (this.labelWidth - 130);
        for (var d = 0; d < j.length; d++) {
            var h = j[d];
            if (h) {
                if (typeof(h.doLayout) === "function") {
                    g.push(h)
                } else {
                    var a = h.name;
                    var b = h.label || Explore.i18n(a);
                    if (!this.readOnly && h.allowBlank === false) {
                        b = b + f
                    }
                    var e = Ext.apply({xtype:this.readOnly ? "displayfield" : "textfield",width:c,itemId:a || Ext.id(),fieldLabel:b,helpText:Explore.Globalization.getString(a + "HelpText", null)}, h);
                    if (e.helpText != null) {
                        if (e.plugins == undefined) {
                            e.plugins = []
                        }
                        e.plugins.push(Explore.view.common.TipIconPlugin)
                    }
                    g.push(Ext.create(e))
                }
            }
        }
        this._formItemsConfig = g
    }
    return this._formItemsConfig
},getForm:function() {
    return this.getByItemId(this.formItemId).getForm()
},isDirty:function() {
    if (!this.readOnly) {
        return this.getForm().isDirty()
    } else {
        return false
    }
},onSaveClick:function() {
    var a = this;
    if (!a.readOnly) {
        if (a.isValid(false)) {
            a.populateObject();
            a.saveAndClose()
        }
    }
},saveAndClose:function() {
    var a = this;
    a.fireEvent("save", a, a.editObject);
    a.bypassDirtyCheck = true;
    a.close()
},isValid:function(b) {
    var e = this.getForm();
    var d = true;
    var a = e.items.items;
    for (var c = 0; c < a.length;
         c++) {
        var g = a[c];
        if (Ext.isFunction(g.isValid)) {
            if (!g.isValid(b)) {
                d = false
            }
        }
    }
    return d
},populateObject:function() {
    var e = this.getForm();
    var a = e.items.items;
    for (var c = 0; c < a.length; c++) {
        var d = a[c];
        if (Ext.isFunction(d.getName)) {
            var b = d.getName();
            if (b && b.indexOf("ext-comp-") == -1) {
                var f = d.getValue();
                if (f != null && Ext.isFunction(f.isXType) && f.isXType("radio")) {
                    f = f.getGroupValue()
                }
                Explore.base.EditorUtil.setObjectProperty(this.editObject, b, f)
            }
        }
    }
},displayObject:function() {
    var e = this.getForm();
    var a = e.items.items;
    for (var c = 0; c < a.length; c++) {
        var d = a[c];
        if (Ext.isFunction(d.getName)) {
            var b = d.getName();
            if (b && b.indexOf("ext-comp-") == -1) {
                var f = Explore.base.EditorUtil.getObjectProperty(this.editObject, b);
                if (f !== undefined && f !== null && f !== "") {
                    d.setValue(f);
                    if (d.xtype == "radiogroup") {
                        d.isDirty = function() {
                            return d.getValue() !== f
                        }
                    }
                }
            }
        }
    }
},focus:function() {
    var b = this.getForm();
    var a = b.items.items;
    if (a.length > 0) {
        var c = a[0];
        if (c.focus) {
            c.focus()
        }
    }
}});
Ext.ns("Explore.base");
Explore.base.EditorUtil = {getAuditText:function(c) {
    var a = "";
    if (c && c.CreatedBy && c.DateCreated) {
        var b = Explore.parseSerializedDate(c.DateCreated);
        a = String.format(Explore.i18n("Created_On_"), c.CreatedBy, Explore.formatDateByPref(b))
    }
    return a
},getObjectProperty:function(c, e) {
    var d = null;
    if (e) {
        if (e.indexOf(".") > 0) {
            d = c;
            var b = e.split(".");
            for (var a = 0; a < b.length;
                 a++) {
                if (d == null) {
                    break
                }
                d = d[b[a]]
            }
        } else {
            d = c[e]
        }
    }
    return d
},setObjectProperty:function(c, g, e) {
    if (g) {
        if (g.indexOf(".") > 0) {
            var d = c;
            var b = g.split(".");
            var a;
            for (a = 0; a < b.length - 1; a++) {
                var f = d[b[a]];
                if (f === undefined || f === null) {
                    f = d[b[a]] = {}
                }
                d = f
            }
            d[b[a]] = e
        } else {
            c[g] = e
        }
    }
}};
Ext.ns("Explore.view");
Explore.view.TreeNodeUIContainer = Ext.extend(Ext.tree.TreeNodeUI, {renderElements:function(j, c, h, b) {
    this.indentMarkup = j.parentNode ? j.parentNode.ui.getChildIndent() : "";
    var e = ['<li class="x-tree-node"><div ext:tree-node-id="',j.id,'" class="x-unselectable ',c.cls,'" unselectable="on">','<img src="',this.emptyIcon,'" class="x-tree-ec-icon x-tree-elbow" style="display:none"/>','<div class="tree-node-container"></div>',"</li>"].join("");
    var g;
    if (b !== true && j.nextSibling && (g = j.nextSibling.ui.getEl())) {
        this.wrap = Ext.DomHelper.insertHtml("beforeBegin", g, e)
    } else {
        this.wrap = Ext.DomHelper.insertHtml("beforeEnd", h, e)
    }
    this.elNode = this.wrap.childNodes[0];
    this.ctNode = this.wrap.childNodes[1];
    var f = this.elNode.childNodes;
    this.indentNode = null;
    this.ecNode = f[0];
    this.checkbox = null;
    this.iconNode = null;
    this.anchor = null;
    this.textNode = null;
    this.componentDiv = f[1];
    var d = j.attributes.item;
    if (d) {
        d.ownerCt = j.getOwnerTree();
        d.render(this.componentDiv)
    }
}});
Ext.ns("Explore.base");
Explore.base.WidgetBase = Ext.extend(Ext.Panel, {getReportFailedMessage:function() {
    return Explore.i18n("ReportFailMessageNotSet")
},getNoReportDiv:function() {
    var a = this;
    if (!a.noReportDiv) {
        a.noReportDiv = new Ext.Component({minHeight:50,itemId:"no-report-div",autoEl:{tag:"div",cls:"no-report",html:a.getReportFailedMessage()},hidden:true,setSize:function(b) {
        }})
    }
    return a.noReportDiv
},reportSuccessful:function() {
    log.warn("widget.base child class needs to override reportSuccesful");
    return true
},getElementForStatus:function() {
    var a = this.getEl().parent(".x-window");
    if (a == null) {
        a = this.getEl()
    }
    return a
},_btnTemplate:'<div style="margin-top:5px; border:none"><table cellspacing="0" class="x-btn" style="margin:0px auto"><tbody><tr><td class="x-btn-tl"><i>&#160;</i></td><td class="x-btn-tc"></td><td class="x-btn-tr"><i>&#160;</i></td></tr><tr><td class="x-btn-ml"><i>&#160;</i></td><td class="x-btn-mc"><em unselectable="on"><button>{0}</button></em></td><td class="x-btn-mr"><i>&#160;</i></td></tr><tr><td class="x-btn-bl"><i>&#160;</i></td><td class="x-btn-bc"></td><td class="x-btn-br"><i>&#160;</i></td></tr></tbody></table></div>',showBusy:function(d, a) {
    var c = this.getElementForStatus();
    var f = '<div class="ext-mb-loading" style="padding-left: 50px; margin: 5px; border:none">' + (d || Explore.i18n("Loading...")) + "</div>";
    if (a) {
        f += String.format(this._btnTemplate, Explore.i18n("Cancel"))
    }
    c.mask(f);
    if (a) {
        var e = Ext.Element.data(c.dom, "maskMsg");
        if (e) {
            var b = e.select("button");
            b.on("click", function() {
                c.unmask();
                a();
                return false
            })
        }
    }
},showError:function(c) {
    var b = this.getElementForStatus();
    var e = c || "";
    e += String.format(this._btnTemplate, Explore.i18n("Ok"));
    var d = Ext.Element.data(b.dom, "maskMsg");
    if (d) {
        var a = d.select("button");
        a.on("click", function() {
            b.unmask();
            return false
        })
    }
    b.mask(c)
},hideStatus:function() {
    var a = this.getElementForStatus();
    a.unmask()
},getCurrentData:function() {
    return this.reportData
},exportData:function() {
    var d = this.getCurrentData();
    if (d && d.Fields && d.GraphData) {
        var b = new Ext.data.ArrayStore({fields:d.Fields,data:d.GraphData});
        var a = b.getRange();
        if (d.ExportFields == null || d.ExportFields.length === 0) {
            Explore.utils.Exporter.exportToCsv(a)
        } else {
            var e = {};
            var f = [];
            for (var c = 0; c < d.ExportFields.length; c++) {
                f.push(d.ExportFields[c].Key);
                e[d.ExportFields[c].Key] = d.ExportFields[c].Value
            }
            Explore.utils.Exporter.exportToCsv(a, e, f)
        }
    } else {
        Explore.view.StatusBox.showWarning(Explore.i18n("ExportNotSupported"), Explore.i18n("ExportNotSupported"))
    }
},getCategoryFriendlyName:function(b) {
    var a = Explore.utils.SearchCriteriaUtil.findFilter(Explore.data.IDOLDataStore.getParametricFilters(), b);
    if (a != null) {
        return a.Name
    }
    return b
}});
Ext.ns("Explore.data");
Explore.data.ClusterDataStore = (function() {
    return{submitClusterJobForSavedSearch:function(b, a) {
        IDOLClusterService.SubmitClusterForSmartView(b, a)
    },submitSpectrographJobForSavedSearch:function(b, a) {
        IDOLClusterService.SubmitSpectrographForSmartView(b, a)
    },getClusterInfo:function(b, a, c) {
        IDOLClusterService.GetClusterInfo(b, a, function(d, f) {
            if (c) {
                c(d)
            }
        })
    },getClusterResultInfo:function(c, b, a, d) {
        IDOLClusterService.GetClusterResultInfo(c, b, a, function(f, g) {
            if (d) {
                d(f)
            }
        })
    },getClusterErrorInfo:function(c, b, a, d) {
        IDOLClusterService.GetClusterErrorInfoByAgentId(c, b, a, function(f, g) {
            if (d) {
                d(f)
            }
        })
    },getBreakingClusterList:function(b, a, c) {
        IDOLClusterService.GetBreakingClusterList(b, a, function(d, f) {
            if (c) {
                c(d)
            }
        })
    },getBreakingClusterResults:function(d, b, a, c, e) {
        IDOLClusterService.GetBreakingClusterResults(d, b, a, c, function(f, g) {
            if (e) {
                e(f)
            }
        })
    },getHotClusterList:function(b, a, c) {
        IDOLClusterService.GetHotClusterList(b, a, function(d, f) {
            if (c) {
                c(d)
            }
        })
    },getHotClusterResults:function(c, b, a, d) {
        IDOLClusterService.GetHotClusterResults(c, b, a, function(f, g) {
            if (d) {
                d(f)
            }
        })
    }}
}());
Ext.ns("Explore.data");
Explore.data.DataImportStore = (function() {
    var b = function() {
        this.addEvents(["dataimportsaved","dataimportdeleted","dataimportchanged"]);
        b.superclass.constructor.call(this, {})
    };
    var a;
    Ext.extend(b, Ext.util.Observable, {getDataImportDefinition:function(d, c) {
        SourceService.GetDataImportDefinition(d, function(e) {
            if (c) {
                c(e)
            }
        })
    },listAllDataImports:function(c) {
        SourceService.ListAllDataImportDefinitions(function(d) {
            if (c) {
                c(d)
            }
        })
    },saveDataImport:function(d, e, c) {
        SourceService.SaveRadian6DataImportDefiniton(d, function(f) {
            if (e) {
                e(f)
            }
            if (!c) {
                a.fireEvent("dataimportsaved", f.Result.Id)
            }
        })
    },saveTwitterDataImport:function(d, e, c) {
        SourceService.SaveTwitterDataImportDefiniton(d, function(f) {
            if (e) {
                e(f)
            }
            if (!c && f && f.Result) {
                a.fireEvent("dataimportsaved", f.Result.Id)
            }
        })
    },saveFacebookDataImport:function(d, e, c) {
        SourceService.SaveFacebookDataImportDefiniton(d, function(f) {
            e(f);
            if (e) {
            }
            if (!c) {
                a.fireEvent("dataimportsaved", f.Result.Id)
            }
        })
    },createDataImport:function(d, e, c, g, f, h, j) {
        SourceService.CreateDataImportDefiniton(d, e, c, g, f, h, function(k) {
            if (j) {
                j(k)
            }
        });
        a.fireEvent("dataimportsaved", 1)
    },deleteDataImport:function(e, d, c) {
        SourceService.DeleteDataImportDefinition(e, function(f) {
            if (d) {
                d(f)
            }
            if (!c) {
                a.fireEvent("dataimportdeleted", 1)
            }
        })
    },editDataImport:function(c) {
        a.fireEvent("dataimportchanged", 1)
    }});
    a = new b();
    return a
}());
Ext.ns("Explore.data");
Explore.data.Configuration = (function() {
    function a() {
        var b = this;
        var d;
        var c = [];
        this.retrieveTeamSiteUrl = function(e) {
            ConfigurationService.GetTeamSiteUrl(function(f, g) {
                if (e) {
                    e(f)
                }
            })
        };
        this.loadTeamSiteUrl = function() {
            this.retrieveTeamSiteUrl(function(e) {
                b.teamSiteUrl = e
            })
        };
        this.getTeamSiteUrl = function() {
            return this.teamSiteUrl
        };
        this.getWorkflowItems = function() {
            return this.workflowItems
        };
        this.retrieveWorkflowItems = function(e) {
            ConfigurationService.GetWorkflowItems(function(f, g) {
                if (e) {
                    e(f)
                }
            })
        };
        this.loadWorkflowItems = function() {
            this.retrieveWorkflowItems(function(e) {
                b.workflowItems = e
            })
        }
    }

    return new a()
}());
Explore.data.DummyDataStore = {retrieveDummyActivities:function() {
    return{nodeType:"async",text:"Activities",id:"activitiesRootNode",expanded:true,children:[
        {id:1,text:"Snapshots (4)",iconCls:"buttonSearchSnapshot",leaf:true},
        {id:2,text:"Favorites (5)",iconCls:"buttonFavorite",leaf:true},
        {id:3,text:"Tagged (11)",iconCls:"iconTag",leaf:true},
        {id:4,text:"Hidden (4)",iconCls:"buttonSearchShowHide",leaf:true}
    ]}
}};
Ext.ns("Explore.data");
Explore.data.EngagementDataStore = (function() {
    var c = function() {
        this.addEvents(["engagementModified","engagementWorkflowModified","engagementResponseModified"]);
        c.superclass.constructor.call(this, {})
    };
    var a;
    var b = null;
    Ext.extend(c, Ext.util.Observable, {listAll:function(d) {
        if (b != null) {
            if (d) {
                d(b)
            }
        } else {
            EngagementService.ListAll(true, function(f, g) {
                b = f;
                if (d) {
                    d(f)
                }
            })
        }
    },getEngagementStatus:function(e, d) {
        EngagementService.GetEngagementStatus(e, function(f, g) {
            if (d) {
                d(f)
            }
        })
    },getEngagementStatusNodes:function(d) {
        EngagementService.GetEngagementStatusNodes(function(f, g) {
            if (d) {
                d(f)
            }
        })
    },saveEngagementStatus:function(d, e) {
        b = null;
        EngagementService.SaveEngagementStatus(d, function(f, g) {
            if (e) {
                e(f)
            }
            a.fireEvent("engagementStatusModified")
        })
    },deleteEngagementStatus:function(e, d) {
        b = null;
        EngagementService.DeleteEngagementStatus(e, function(f, g) {
            if (d) {
                d(f)
            }
            a.fireEvent("engagementStatusModified")
        })
    },assignToUsers:function(d, e, f) {
        EngagementService.AssignToUsers(d, e, function(g, h) {
            if (f) {
                f(g)
            }
            a.fireEvent("engagementWorkflowModified", d, g.Result)
        })
    },assignToProjects:function(d, e, f) {
        EngagementService.AssignToProjects(d, e, function(g, h) {
            if (f) {
                f(g)
            }
            a.fireEvent("engagementWorkflowModified", d, g.Result)
        })
    },assignPriority:function(d, e, f) {
        EngagementService.AssignPriority(d, e, function(g, h) {
            if (f) {
                f(g)
            }
            a.fireEvent("engagementWorkflowModified", d, g.Result)
        })
    },assignTags:function(e, g, d, f) {
        EngagementService.AssignTags(e, g, d, function(h, j) {
            if (f) {
                f(h)
            }
            a.fireEvent("engagementWorkflowModified", e, h.Result)
        })
    },assignSentiment:function(d, g, e, f) {
        EngagementService.AssignSentiment(d, g, e, function(h, j) {
            if (f) {
                f(h)
            }
            a.fireEvent("engagementWorkflowModified", d, h.Result)
        })
    },assignClassification:function(e, g, d, f) {
        EngagementService.AssignClassification(e, g, d, function(h, j) {
            if (f) {
                f(h)
            }
            a.fireEvent("engagementWorkflowModified", e, h.Result)
        })
    },addNotes:function(d, f, e) {
        EngagementService.AddNotes(d, f, function(g, h) {
            if (e) {
                e(g)
            }
            a.fireEvent("engagementWorkflowModified", d, g.Result)
        })
    },changeStatus:function(d, f, e, g) {
        EngagementService.ChangeStatus(d, f, e, function(h, j) {
            if (g) {
                g(h)
            }
            a.fireEvent("engagementWorkflowModified", d, h.Result)
        })
    },respondToTweet:function(f, g, j, e, d, h) {
        EngagementService.RespondToTweet(f, g, j, e, d, function(k, m) {
            if (h) {
                h(k)
            }
            if (k.Result) {
                var l = k.Result.RESPONSE;
                if (l != null) {
                    a.fireEvent("engagementResponseModified", f, l)
                }
                var n = k.Result.HISTORY;
                if (n != null) {
                    a.fireEvent("engagementWorkflowModified", f, n)
                }
            }
        })
    }});
    a = new c();
    return a
}());
Ext.ns("Explore.data");
Explore.data.FavoriteReportDataStore = (function() {
    var b = function() {
        this.addEvents(["favoriteAdded","favoriteChanged","favoriteReportDeleted"]);
        b.superclass.constructor.call(this, {})
    };
    var a;
    Ext.extend(b, Ext.util.Observable, {getFavoriteReportsForCurrentUser:function(c) {
        WidgetService.GetReportFavoritesForCurrentUser(function(d, f) {
            if (c) {
                c(d)
            }
        })
    },getFavoriteReportSettings:function(c, d) {
        WidgetService.GetFavoriteReportSettings(c, function(f, g) {
            if (d) {
                d(f)
            }
        })
    },getFavoriteReportSearchSettings:function(c, d) {
        WidgetService.GetFavoriteReportSearchSettings(c, function(f, g) {
            if (d) {
                d(f)
            }
        })
    },updateReportFavoriteSettings:function(c, d, e) {
        WidgetService.UpdateReportFavoriteSettings(c, d, function(f, g) {
            if (e) {
                e(f)
            }
        })
    },updateReportSearchSettings:function(c, d, e) {
        WidgetService.UpdateReportSearchSettings(c, d, function(f, g) {
            if (e) {
                e(f)
            }
            a.fireEvent("favoriteChanged", c)
        })
    },createReportFavorite:function(c, d, e) {
        WidgetService.CreateReportFavorite(c, d, function(f, g) {
            if (e) {
                e(f)
            }
            a.fireEvent("favoriteAdded")
        })
    },deleteFavoriteReport:function(d, e, c) {
        WidgetService.DeleteReportFavorite(d, function(f, g) {
            if (e) {
                e(f)
            }
            if (!c) {
                a.fireEvent("favoriteDeleted", d)
            }
        })
    }});
    a = new b();
    return a
}());
Ext.ns("Explore.data");
Explore.data.HiddenResultsDataStore = {hiddenResults:[],getIndex:function(b) {
    if (this.hiddenResults.length > 0) {
        for (var a = 0;
             a < this.hiddenResults.length; a++) {
            if (this.hiddenResults[a] == b) {
                return a
            }
        }
    }
    return -1
},isHidden:function(b) {
    var a = this.getIndex(b);
    return(a >= 0)
},addToHiddenList:function(a) {
    this.hiddenResults.push(a)
},removeFromHiddenList:function(b) {
    var a = this.getIndex(b);
    this.hiddenResults.splice(a, 1)
}};
Ext.ns("Explore.data");
Explore.data.IDOLDataStore = (function() {
    var k = function() {
        this.addEvents(["savedSearchChanged","savedSearchDeleted","searchHistoryAdded","searchHistoryDeleted"]);
        k.superclass.constructor.call(this, {})
    };
    var j;
    var l = null;
    var c = null;
    var e = null;
    var a = null;
    var b = true;
    var f = null;
    var h = false;
    var g = null;
    var d = [];
    Ext.extend(k, Ext.util.Observable, {preloadData:function(m) {
        Explore.data.MetaDataStore.preloadData();
        IDOLService.GetReportsToHideByType(Explore.model.ReportTypes.SearchResultReportType, function(n) {
            if (n && n.Result) {
                d = n.Result
            }
        });
        IDOLService.GetSupportedDocumentTypes(function(n, o) {
            l = n
        });
        IDOLService.GetDocumentTypeConfigs(function(n, o) {
            c = n
        });
        IDOLService.GetAllLanguages(function(n, o) {
            e = n
        });
        IDOLService.GetAdvancedSearchCriteria(function(n, o) {
            a = n
        });
        IDOLService.GetParametricFilters(function(n, o) {
            f = n
        });
        ConfigurationService.GetRecordingSummaryVisibility(function(n, o) {
            b = n;
            if (m) {
                m()
            }
        });
        ConfigurationService.GetConfigurationSettings(function(n, p) {
            try {
                h = n.HideRadianSixDataImport
            } catch(o) {
                h = false
            }
            try {
                g = n.ExportSearchResultsDetailFields;
                if (!(g)) {
                    g = "fields"
                }
            } catch(o) {
                g = "fields"
            }
            if (m) {
                m()
            }
        })
    },getActiveSearchResultReportTypeValues:function() {
        var q = [],m = Explore.model.SearchResultReportType.getValues(),p = function(r) {
            for (var s = 0;
                 s < d.length; s++) {
                if (d[s] === r) {
                    return true
                }
            }
            return false
        };
        for (var o = 0; o < m.length; o++) {
            var n = m[o];
            if (!p(n.value)) {
                q.push(n)
            }
        }
        return q
    },getAllLanguages:function() {
        return e
    },getSupportedDocTypes:function() {
        return l
    },getDocumentTypeConfigs:function() {
        return c
    },getAdvancedSearchCriteria:function() {
        return a
    },getParametricFiltersForResultDocs:function(m, n) {
        IDOLService.GetParametricFiltersForResultDocs(m, function(o, p) {
            if (n) {
                n(o)
            }
        })
    },getFilterByFilterTag:function(m) {
        var o = null;
        var n = function(u) {
            if (u) {
                for (var q = 0; q < u.length && !o; q++) {
                    n(u[q])
                }
                var t = u.Groups,p = u.Items;
                if (t && !o) {
                    n(t)
                }
                if (p && !o) {
                    for (var r = 0; r < p.length; r++) {
                        var s = p[r];
                        if (s.FilterTag === m) {
                            o = s;
                            break
                        }
                    }
                }
            }
        };
        n(f);
        return o
    },getParametricFilters:function(m) {
        return f
    },saveAdvancedSearchInfo:function(m, n) {
        IDOLService.SaveAdvancedSearchInfo(m, function(o, p) {
            if (o && o.ErrorCode === 0) {
                if (m.Type === Explore.model.ASType.SavedSearch) {
                    j.fireEvent("savedSearchChanged", j, o.Result)
                } else {
                    if (m.Type === Explore.model.ASType.RecentSearch) {
                        j.fireEvent("searchHistoryAdded", j, o.Result)
                    }
                }
            }
            if (n) {
                n(o)
            }
        })
    },getAdvancedSearchResults:function(o, n, m, p) {
        IDOLService.GetAdvancedSearchResults(o, n, m, function(q, r) {
            if (p) {
                p(q)
            }
            j.fireEvent("newSearchCompleted", o, n, m, q)
        })
    },getAdvancedSearchResultsForExport:function(o, n, m, p) {
        IDOLService.ExportAdvancedSearchResults(o, n, m, function(q, r) {
            if (p) {
                p(q)
            }
        })
    },getIDOLServerName:function(m) {
        IDOLService.GetIDOLServerName(function(n, o) {
            if (m) {
                m(n)
            }
        })
    },setDocumentVisibility:function(m, n) {
        IDOLService.SetDocumentVisibility(m, n, function(o, p) {
        })
    },getCloud:function(n, m, o) {
        IDOLService.GetCloud(n, m, function(p, q) {
            if (o) {
                o(p)
            }
        })
    },getCloudByPosition:function(m, n) {
        IDOLService.GetCloudByPosition(cloudId, function(o, p) {
            if (n) {
                n(o)
            }
        })
    },saveCloud:function(m, n) {
        IDOLService.SaveCloud(m, function(o, p) {
            if (n) {
                n(o)
            }
        })
    },getTopicTrendsForCloud:function(m, n) {
        IDOLService.GetTopicTrendsForCloud(m, function(o) {
            if (n) {
                n(o)
            }
        })
    },getCloudTopicResults:function(n, o, m, p) {
        IDOLService.GetCloudTopicResults(n, o, m, function(q, r) {
            if (p) {
                p(q)
            }
        })
    },getLastCloudTopicResultHarvestDate:function(n, m, o) {
        IDOLService.GetLastCloudTopicResultHarvestDate(n, m, function(p, q) {
            if (o) {
                o(p)
            }
        })
    },getTopicIdsForCloud:function(m, n) {
        IDOLService.GetTopicIdsForCloud(m, function(o, p) {
            if (n) {
                n(o)
            }
        })
    },saveTopicsToCloud:function(m, o, n) {
        IDOLService.SaveTopicsToCloud(m, o, function(p, q) {
            if (n) {
                n(p)
            }
        })
    },getSearchCriteriaBySearchId:function(m, n) {
        IDOLService.GetSearchCriteriaBySearchId(m, function(o, p) {
            if (n) {
                n(o)
            }
        })
    },deleteSearch:function(n, m, o) {
        IDOLService.DeleteSearch(n, function(p, q) {
            if (p && p.ErrorCode === 0) {
                if (m === Explore.model.ASType.SavedSearch) {
                    j.fireEvent("savedSearchDeleted", j, n)
                } else {
                    if (m === Explore.model.ASType.RecentSearch) {
                        j.fireEvent("searchHistoryDeleted", j, n)
                    }
                }
            }
            if (o) {
                o(p)
            }
        })
    },deleteSearchHistory:function(m) {
        IDOLService.DeleteSearchHistory(function(n, o) {
            if (n && n.ErrorCode === 0) {
                j.fireEvent("searchHistoryDeleted", j, "ALL")
            }
            if (m) {
                m(n)
            }
        })
    },retrieveRelatedConcepts:function(n, m, o) {
        IDOLService.GetRelatedConcepts(n, m, function(p, q) {
            if (o) {
                o(p)
            }
        })
    },getDocsFromSearchId:function(n, m, o, p) {
        IDOLService.GetDocsFromSearchId(n, m, o, Explore.getLocalTimeZoneOffset(), function(q, r) {
            if (p) {
                p(q)
            }
        })
    },getSearchTerms:function(m, n) {
        IDOLService.GetSearchTerms(m, function(o, p) {
            if (n) {
                n(o)
            }
        })
    },getBestTerms:function(m, n, o) {
        IDOLService.GetBestTerms(m, n, function(p, q) {
            if (o) {
                o(p)
            }
        })
    },getNumericStatsFilters:function(m) {
        IDOLService.GetNumericStatsFilters(function(n, o) {
            if (m) {
                m(n)
            }
        })
    },getParametricFilterValue:function(o, m, n, p) {
        IDOLService.GetParametricFilterValue(o, m, n, function(q, r) {
            if (p) {
                p(q)
            }
        })
    },getParametricFilterValues:function(n, m, o) {
        IDOLService.GetParametricFilterValues(n, m, function(p, q) {
            if (o) {
                o(p)
            }
        })
    },getDocumentCountByParametricFilter:function(o, m, n, p) {
        IDOLService.GetDocumentCountByParametricFilter(o, m, n, function(q, r) {
            if (p) {
                p(q)
            }
        })
    },getTrendAnalytics:function(n, m, o) {
        IDOLService.GetTrendAnalytics(n, m, Explore.getLocalTimeZoneOffset(), function(p, r) {
            for (var q = 0;
                 q < p.GraphData.length; q++) {
                p.GraphData[q][0] = Ext.util.Format.date(p.GraphData[q][0], Explore.getDateFormatByPref({ignoreTime:true}))
            }
            if (o) {
                o(p)
            }
        })
    },getHistogramData:function(n, m, o) {
        IDOLService.GetHistogramData(n, m, Explore.getLocalTimeZoneOffset(), function(p, q) {
            if (o) {
                o(p)
            }
        })
    },getReportOnCriteria:function(o, n, m, p) {
        IDOLService.GetReportOnCriteria(o, n, m, Explore.getLocalTimeZoneOffset(), function(q, r) {
            if (p) {
                p(q)
            }
        })
    },getRelatedDocuments:function(o, m, n, p) {
        IDOLService.GetRelatedDocuments(o, m, n, function(q, r) {
            if (p) {
                p(q)
            }
        })
    },getTickerString:function(m) {
        IDOLService.GetTickerString(function(n, o) {
            if (m) {
                m(n)
            }
        })
    },isIDOLRunning:function(m) {
        IDOLService.IsIDOLRunning(function(n, o) {
            if (m) {
                m(n)
            }
        })
    },validateParametricFilterConfiguration:function(m) {
        IDOLService.ValidateParametricFilterConfiguration(function(n, o) {
            if (m) {
                m(n)
            }
        })
    },checkDocumentDateIntegrity:function(m) {
        IDOLService.CheckDocumentDateIntegrity(function(n, o) {
            if (m) {
                m(n)
            }
        })
    },getRecordingSummaryVisibility:function() {
        return b
    },getRadianSixDataImportVisibility:function() {
        return h
    },getSearchResultsExportDetailFields:function() {
        return g
    }});
    j = new k();
    return j
}());
Ext.ns("Explore.data");
Explore.data.InfluencerDataStore = (function() {
    var b = function() {
        this.addEvents(["docConfigurationTypeChanged"]);
        b.superclass.constructor.call(this, {})
    };
    var a;
    Ext.extend(b, Ext.util.Observable, {saveDocConfiguration:function(c, d) {
        InfluenceService.SaveDocTypeInfluenceCriteria(c, function(f, g) {
            a.fireEvent("docConfigurationTypeChanged");
            if (d) {
                d(f)
            }
        })
    },getBlogInfluencers:function(c) {
        InfluencerService.GetBlogInfluencers(function(d, f) {
            if (c) {
                c(d)
            }
        })
    },getMicroMediaInfluencers:function(c) {
        InfluencerService.GetMicroMediaInfluencers(function(d, f) {
            if (c) {
                c(d)
            }
        })
    }});
    a = new b();
    return a
}());
Ext.ns("Explore.data");
Explore.data.LexiconDataStore = (function() {
    var b = function() {
        this.addEvents(["lexiconChanged","lexiconDeleted"]);
        b.superclass.constructor.call(this, {})
    };
    var a;
    Ext.extend(b, Ext.util.Observable, {exportLexicon:function(c, d) {
        LexiconService.ExportLexicon(c, function(e) {
            if (d) {
                d(e)
            }
        })
    },getLexicons:function(c) {
        LexiconService.GetLexicons(function(d, f) {
            if (c) {
                c(d)
            }
        })
    },getLexicon:function(c, d) {
        LexiconService.GetLexicon(c, function(f, g) {
            if (d) {
                d(f)
            }
        })
    },saveLexicon:function(d, e, c) {
        LexiconService.SaveLexicon(d, function(f, g) {
            if (e) {
                e(f)
            }
            if (!c) {
                a.fireEvent("lexiconChanged", f.Result.Id)
            }
        })
    },deleteLexicon:function(c, e, d) {
        LexiconService.DeleteLexicon(c, function(f, g) {
            if (e) {
                e(f)
            }
            if (!d) {
                a.fireEvent("lexiconDeleted")
            }
        })
    }});
    a = new b();
    return a
}());
Ext.ns("Explore.data");
Explore.data.MetaDataStore = (function() {
    var e = function() {
        this.addEvents(["assigntags","editsentiment"]);
        e.superclass.constructor.call(this, {})
    };
    var a;
    var c = null;
    var d = null;
    var b = [];
    Ext.extend(e, Ext.util.Observable, {preloadData:function(f) {
        MetaDataService.GetTags(function(g, h) {
            c = g
        });
        MetaDataService.GetRecordingClassifications(function(g, l) {
            d = g;
            if (d != null) {
                b = [];
                for (var k = 0; k < d.length; k++) {
                    var m = d[k];
                    if (m.ValueType === Explore.model.ClassificationValueType.Standard) {
                        b.push({Id:m.Id,Name:m.Name})
                    } else {
                        if (m.ValueType === Explore.model.ClassificationValueType.Predefined) {
                            for (var h = 0;
                                 h < m.Classifications.length; h++) {
                                b.push({Id:m.Classifications[h].Id,Name:m.Name + ": " + m.Classifications[h].Name})
                            }
                        } else {
                            if (m.ValueType === Explore.model.ClassificationValueType.UserDefined) {
                            }
                        }
                    }
                }
            }
            if (f) {
                f()
            }
        })
    },saveTags:function(f, g) {
        c = null;
        MetaDataService.SaveTags(f, function(h, j) {
            if (h.ErrorCode == 0) {
                c = h.Result
            }
            if (g) {
                g(h)
            }
        })
    },getTags:function(f) {
        if (c != null) {
            if (f) {
                f(c)
            }
        } else {
            MetaDataService.GetTags(function(g, h) {
                c = g;
                if (f) {
                    f(g)
                }
            })
        }
    },getTags2:function() {
        return c
    },getRecordingClassificationNames:function() {
        return b
    },getTransactionClassificationsByIds:function(f, g) {
        MetaDataService.GetTransactionClassificationsByIds(f, function(h, j) {
            if (g) {
                g(h)
            }
        })
    },saveTransactionClassifications:function(g, f, h) {
        MetaDataService.SaveTransactionClassifications(g, f, function(j, k) {
            if (h) {
                h(j)
            }
        })
    },assignTags:function(g, f, h) {
        MetaDataService.AssignTags(g, f, function(j, k) {
            a.fireEvent("assigntags", g, f, j);
            if (h) {
                h(j)
            }
        })
    },editSentiment:function(f, g, h) {
        MetaDataService.UpdateSentimentValue(f, g, function(j, k) {
            a.fireEvent("editsentiment", f, g, j);
            if (h) {
                h(j)
            }
        })
    }});
    a = new e();
    return a
}());
Ext.ns("Explore.data");
Explore.data.NotificationDataStore = (function() {
    var b = function() {
        b.superclass.constructor.call(this, {})
    };
    var a;
    Ext.extend(b, Ext.util.Observable, {sendTestEmail:function(c) {
        NotificationService.TestEmail(function(d, f) {
            if (c) {
                c(d)
            }
        })
    },isNotificationServerRunning:function(c) {
        NotificationService.IsNotificationServerRunning(function(d, f) {
            if (c) {
                c(d)
            }
        })
    }});
    a = new b();
    return a
}());
Ext.ns("Explore.data");
Explore.data.PreferenceDataStore = (function() {
    var c = function() {
        c.superclass.constructor.call(this, {})
    };
    var a;
    var b = null;
    Ext.extend(c, Ext.util.Observable, {getPreferences:function() {
        return b
    },load:function(d) {
        if (b === null) {
            PreferenceService.GetPreferenceForCurrentUser(function(f, g) {
                b = f;
                if (d) {
                    d(b)
                }
            })
        } else {
            if (d) {
                d(b)
            }
        }
    },save:function(d) {
        PreferenceService.SavePreference(b, function(f, g) {
            b = f.Result;
            if (d) {
                d(f)
            }
        })
    },saveExploreWidgets:function(d, e, f) {
        b.ExploreWidgets = d;
        b.IngestionTrendWidgetDuration = e;
        this.save(f)
    },saveIngestionWidgetDuration:function(d, f, g) {
        if (!b.IngestionTrendWidgetDuration) {
            var e = [5,5,5];
            b.IngestionTrendWidgetDuration = e
        }
        b.IngestionTrendWidgetDuration[d] = f;
        this.save(g)
    },setAutoRefreshIntervalPreference:function(d) {
        b.AutoRefreshInterval = d
    },getAutoRefreshIntervalPreference:function() {
        return b.AutoRefreshInterval
    },setSearchAutoRefreshIntervalPreference:function(d) {
        b.SearchAutoRefreshInterval = d
    },getSearchAutoRefreshIntervalPreference:function() {
        return b.SearchAutoRefreshInterval
    },setCloudCountPreference:function(d) {
        b.CloudCount = d
    },getCloudCountPreference:function() {
        return b.CloudCount
    },setShowVibePreference:function(d) {
        b.ShowVibe = d
    },getShowVibePreference:function() {
        return b.ShowVibe
    },setShowSentimentPreference:function(d) {
        b.ShowSentiment = d
    },getShowSentimentPreference:function() {
        return b.ShowSentiment
    },getShowEmotionMarkersPreference:function(d) {
        return b.ShowEmotionMarkers
    },setShowEmotionMarkersPreference:function(d) {
        b.ShowEmotionMarkers = d
    },getDocCountForRelatedTerms:function() {
        return b.DocCountForRelatedTerms
    },getDocCountForTerms:function() {
        return b.DocCountForTerms
    },setDocCountForRelatedTerms:function(d) {
        b.DocCountForRelatedTerms = d
    },setDocCountForTerms:function(d) {
        b.DocCountForTerms = d
    },setRelatedTermsAction:function(d) {
        b.RelatedTermsAction = d
    },getRelatedTermsAction:function() {
        return b.RelatedTermsAction
    },setGridType:function(d) {
        b.GridType = d
    },getGridType:function() {
        return b.GridType
    },getSelectedHighlightingOption:function() {
        return b.HighlightingOptions
    },getExploreWidgets:function() {
        return b.ExploreWidgets
    },getIngestionTrendWidgetDuration:function() {
        return b.IngestionTrendWidgetDuration
    },setSelectedHighlightingOption:function(d) {
        b.HighlightingOptions = d
    },setHideProjectSelectDialogAtLogin:function(d) {
        b.HideProjectSelectDialogAtLogin = d
    }});
    a = new c();
    return a
}());
Ext.ns("Explore.data");
Explore.data.ProjectDataStore = (function() {
    var b = function() {
        this.addEvents(["projectModified","projectDeleted"]);
        b.superclass.constructor.call(this, {})
    };
    var a;
    Ext.extend(b, Ext.util.Observable, {listAll:function(c) {
        ProjectService.ListAll(function(d, f) {
            if (c) {
                c(d)
            }
        })
    },listMyProjects:function(c) {
        ProjectService.ListMyProjects(function(d, f) {
            if (c) {
                c(d)
            }
        })
    },getProject:function(c, d) {
        ProjectService.Get(c, function(f, g) {
            if (d) {
                d(f)
            }
        })
    },save:function(c, d) {
        ProjectService.Save(c, function(f, j) {
            if (d) {
                d(f)
            }
            if (f && f.Result && f.Result.Id) {
                if (Explore.presenter.ProjectsPresenter.getCurrentProjectId() === f.Result.Id) {
                    var h = Explore.data.PreferenceDataStore.getPreferences();
                    var k = f.Result;
                    h.SelectedProjectId = k.Id;
                    Explore.addHash("ProjectId", k.Id);
                    Explore.abortAllAjax();
                    var g = new Ext.LoadMask(Ext.getBody(), {msg:Explore.i18n("ReloadingForProject") + ": " + k.Name});
                    g.show();
                    Explore.data.PreferenceDataStore.save(function(e) {
                        Explore.reload()
                    })
                } else {
                    a.fireEvent("projectModified", f.Result.Id)
                }
            }
        })
    },deleteProject:function(c, d) {
        ProjectService.Delete(c, function(f, g) {
            if (d) {
                d(f)
            }
            a.fireEvent("projectDeleted")
        })
    },getUserSourceCounts:function(c) {
        ProjectService.GetUserSourceCounts(function(d, f) {
            if (c) {
                c(d)
            }
        })
    },getProjectsForUser:function(c, d) {
        ProjectService.GetProjectsForUser(c, function(f, g) {
            if (d) {
                d(f)
            }
        })
    },getProjectsUsingDataSource:function(c, d) {
        ProjectService.GetProjectsUsingDataSource(c, function(f, g) {
            if (d) {
                d(f)
            }
        })
    },getProjectsUsingSnapshot:function(c, d) {
        ProjectService.GetProjectsUsingSnapshot(c, function(f, g) {
            if (d) {
                d(f)
            }
        })
    },getProjectsUsingTopic:function(c, d) {
        ProjectService.GetProjectsUsingTopic(c, function(f, g) {
            if (d) {
                d(f)
            }
        })
    },getProjectsUsingDataImport:function(c, d) {
        ProjectService.GetProjectsUsingDataImport(c, function(f, g) {
            if (d) {
                d(f)
            }
        })
    },getUserDefinedFilters:function(c) {
        ProjectService.GetUserDefinedFilters(function(d, f) {
            if (c) {
                c(d)
            }
        })
    },getProjectDocumentTypes:function(c) {
        ProjectService.GetProjectDocumentTypes(function(d) {
            if (c) {
                c(d)
            }
        })
    }});
    a = new b();
    return a
}());
Ext.ns("Explore.data");
Explore.data.QWADataStore = (function() {
    var b = function() {
        b.superclass.constructor.call(this, {})
    };
    var a;
    Ext.extend(b, Ext.util.Observable, {getAuthenticationToken:function(c) {
        QWAService.GetAuthenticationToken(function(d, f) {
            if (c) {
                c(d)
            }
        })
    }});
    a = new b();
    return a
}());
Ext.ns("Explore.data");
Explore.data.RuleDataStore = (function() {
    var b = function() {
        this.addEvents(["ruleModified"]);
        b.superclass.constructor.call(this, {})
    };
    var a;
    Ext.extend(b, Ext.util.Observable, {listAll:function(c) {
        RuleService.ListAll(function(d, g) {
            for (var f = 0;
                 f < d.length; f++) {
                d[f] = new Explore.data.model.AutomationRule(d[f])
            }
            if (c) {
                c(d)
            }
        })
    },getRulesByUser:function(c) {
        RuleService.GetRulesByUser(function(d, g) {
            for (var f = 0;
                 f < d.length; f++) {
                d[f] = new Explore.data.model.AutomationRule(d[f])
            }
            if (c) {
                c(d)
            }
        })
    },getRule:function(c, d) {
        RuleService.GetRule(c, function(f, g) {
            f = new Explore.data.model.AutomationRule(f);
            if (d) {
                d(f)
            }
        })
    },saveRule:function(c, d) {
        RuleService.SaveRule(c, function(f, g) {
            if (d) {
                d(f);
                a.fireEvent("ruleModified")
            }
        })
    },deleteRule:function(c, d) {
        RuleService.DeleteRule(c, function(f, g) {
            if (d) {
                d(f);
                a.fireEvent("ruleModified")
            }
        })
    },getAllTemplates:function(c) {
        RuleService.GetAllTemplates(function(d, f) {
            if (c) {
                c(d)
            }
        })
    }});
    a = new b();
    return a
}());
Ext.ns("Explore.data");
Explore.data.ScriptAdherenceDataStore = (function() {
    var b = function() {
        this.addEvents(["scriptModified"]);
        b.superclass.constructor.call(this, {})
    };
    var a;
    Ext.extend(b, Ext.util.Observable, {getAllScriptDefinitions:function(c) {
        ScriptAdherenceService.GetAllScriptDefinitions(function(d, f) {
            if (c) {
                c(d)
            }
        })
    },getScriptDefinitionById:function(d, c) {
        ScriptAdherenceService.GetScriptDefinitionById(d, function(f, g) {
            if (c) {
                c(f)
            }
        })
    },addScriptDefinition:function(c, e) {
        function d(f) {
            if (c[f] === "") {
                delete c[f]
            }
        }

        d("TagId");
        d("Duration");
        d("SilenceDuration");
        d("EmotionDuration");
        d("CrosstalkDuration");
        d("Hold");
        ScriptAdherenceService.AddScriptDefinition(c, function(f, g) {
            if (e) {
                e(f)
            }
            a.fireEvent("scriptModified", f.Result.Id)
        })
    },deleteScriptDefinition:function(d, c) {
        ScriptAdherenceService.DeleteScriptDefinition(d, function(f, g) {
            if (c) {
                c(f)
            }
            a.fireEvent("scriptModified", d)
        })
    },getScriptResults:function(d, c) {
        ScriptAdherenceService.GetScriptResults(d, function(f, g) {
            if (c) {
                c(f)
            }
        })
    }});
    a = new b();
    return a
}());
Ext.ns("Explore.data");
Explore.data.SnapshotDataStore = (function() {
    var b = function() {
        this.addEvents(["snapshotAdded","snapshotModified","snapshotDeleted"]);
        b.superclass.constructor.call(this, {})
    };
    var a;
    Ext.extend(b, Ext.util.Observable, {getSnapshotResultsForCurrentUser:function(d, e, c, f) {
        SnapshotService.GetSnapshotResultsForCurrentUser(d, e, c, function(g, h) {
            if (f) {
                f(g)
            }
        })
    },getSnapshotsList:function(c) {
        SnapshotService.GetSnapshotsList(function(d, f) {
            if (c) {
                c(d)
            }
        })
    },getAllSnapshots:function(c) {
        SnapshotService.GetAllSnapshots(function(d, f) {
            if (c) {
                c(d)
            }
        })
    },getSnapshot:function(c, d) {
        SnapshotService.GetSnapshot(c, function(f, g) {
            if (d) {
                d(f)
            }
        })
    },takeSnapshot:function(c, e, d, f) {
        SnapshotService.TakeSnapshot(c, e, d, function(g, h) {
            if (f) {
                f(g);
                a.fireEvent("snapshotAdded", g.Result.Id)
            }
        })
    },saveSnapshot:function(c, d) {
        SnapshotService.SaveSnapshot(c, function(f, g) {
            if (d) {
                d(f);
                a.fireEvent("snapshotModified", c.Id)
            }
        })
    },deleteSnapshot:function(c, d) {
        SnapshotService.DeleteSnapshot(c, function(f, g) {
            if (d) {
                d(f);
                a.fireEvent("snapshotDeleted", c)
            }
        })
    }});
    a = new b();
    return a
}());
Ext.ns("Explore.data");
Explore.data.SourceDataStore = (function() {
    var b = function() {
        this.addEvents(["sourceModified","sourceDeleted","groupModified","groupDeleted"]);
        b.superclass.constructor.call(this, {})
    };
    var a;
    Ext.extend(b, Ext.util.Observable, {getAutomationServerUrl:function(c) {
        SourceService.GetAutomationServerUrl(function(d, f) {
            if (c) {
                c(d)
            }
        })
    },getAutomationSettings:function(c) {
        SourceService.GetAutomationSettings(function(d, f) {
            if (c) {
                c(d)
            }
        })
    },getDataSourcesByGroup:function(c, d) {
        SourceService.GetDataSourcesByGroup(c, function(f, g) {
            if (d) {
                d(f)
            }
        })
    },getDataSourcesListByGroup:function(c, d) {
        SourceService.GetDataSourcesListByGroup(c, function(f, g) {
            if (d) {
                d(f)
            }
        })
    },getDataSource:function(d, c) {
        SourceService.GetDataSource(d, function(f, g) {
            if (c) {
                c(f)
            }
        })
    },getDataSourceByGroup:function(d, c) {
        SourceService.GetGroup(d, function(f, g) {
            if (c) {
                c(f)
            }
        })
    },saveDataSource:function(c, d) {
        SourceService.SaveDataSource(c, function(f, g) {
            if (d) {
                d(f)
            }
            a.fireEvent("sourceModified", f.Result.Id)
        })
    },deleteDataSource:function(e, d, c) {
        SourceService.DeleteDataSource(e, function(f, g) {
            if (d) {
                d(f)
            }
            if (!c) {
                a.fireEvent("sourceDeleted")
            }
        })
    },saveGroup:function(c, d) {
        SourceService.SaveGroup(c, function(f, g) {
            if (d) {
                d(f)
            }
            if (f.ErrorCode != 54003) {
                a.fireEvent("groupModified", f.Result.Id)
            }
        })
    },deleteGroup:function(e, d, c) {
        SourceService.DeleteGroup(e, function(f, g) {
            if (d) {
                d(f)
            }
            if (!c) {
                a.fireEvent("groupDeleted")
            }
        })
    },renameGroup:function(e, c, d) {
        SourceService.RenameGroup(e, c, function(f, g) {
            if (d) {
                d(f)
            }
            a.fireEvent("groupModified", f.Result.Id)
        })
    },getFeeds:function(d, f, c, e) {
        SourceService.GetSourceFeeds(d, f, c, function(g, h) {
            if (e) {
                e(g)
            }
        })
    },getTwitterUser:function(c, d, e) {
        SourceService.GetTwitterUserInfo(c + "", d + "", function(f) {
            if (e) {
                e(f)
            }
        })
    }});
    a = new b();
    return a
}());
Ext.ns("Explore.data");
Explore.data.SpectrographDataStore = (function() {
    return{getSpectrographResultInfo:function(b, a, c) {
        IDOLClusterService.GetSpectrographResultInfo(b, a, function(d, f) {
            if (c) {
                c(d)
            }
        })
    },getSpectrographErrorInfo:function(c, b, a, d) {
        IDOLClusterService.GetSpectrographErrorInfoByAgentId(c, b, a, function(f, g) {
            if (d) {
                d(f)
            }
        })
    }}
}());
Ext.ns("Explore.data");
Explore.data.SystemReportsDataStore = new function() {
    this.getDocumentCountReportInfo = function(b, a) {
        SystemReportsService.GetDocumentCountReportInfo(b, Explore.getLocalTimeZoneOffset(), function(c, d) {
            if (a) {
                a(c)
            }
        })
    };
    this.getAuditLog = function(a, b) {
        SystemReportsService.GetAuditLog(a, function(c, d) {
            if (b) {
                b(c)
            }
        })
    };
    this.getDataIngestionReport = function(a) {
        SystemReportsService.GetDataIngestionReport(function(b, c) {
            if (a) {
                a(b)
            }
        })
    };
    this.getTransactionReport = function(a) {
        SystemReportsService.GetTransactionReport(function(b, c) {
            if (a) {
                a(b)
            }
        })
    };
    this.getProductionReport = function(a) {
        SystemReportsService.GetProductionReport(function(b, c) {
            if (a) {
                a(b)
            }
        })
    }
}();
Ext.ns("Explore.data");
Explore.data.TopicDataStore = (function() {
    var b = function() {
        this.addEvents(["topicsChanged","topicSaved"]);
        b.superclass.constructor.call(this, {})
    };
    var a;
    Ext.extend(b, Ext.util.Observable, {getTopicsUsingLexicon:function(c, d) {
        TopicService.GetTopicsUsingLexicon(c, function(f, g) {
            if (d) {
                d(f)
            }
        })
    },getTopicsListBySectionId:function(c, d) {
        TopicService.GetTopicsListBySectionId(c, function(f, g) {
            if (d) {
                d(f)
            }
        })
    },getTopicHierarchyBySectionId:function(d, c, e, f) {
        TopicService.GetTopicHierarchyBySectionId(d, c, e, function(g, h) {
            if (f) {
                f(g)
            }
        })
    },getTopic:function(c, d) {
        TopicService.GetTopic(c, function(f, g) {
            if (d) {
                d(f)
            }
        })
    },saveTopic:function(d, c, e) {
        TopicService.SaveTopic(d, c, function(f, g) {
            if (f && f.Result && f.Result.Id) {
                a.fireEvent("topicSaved", f.Result.Id)
            }
            if (e) {
                e(f)
            }
        })
    },RenameTopic:function(d, c, e) {
        TopicService.RenameTopic(d, c, function(f, g) {
            if (e) {
                e(f)
            }
        })
    },renameTopicSection:function(d, c, e) {
        TopicService.RenameTopicSection(d, c, function(f, g) {
            if (e) {
                e(f)
            }
        })
    },moveTopic:function(c, d, e) {
        TopicService.MoveTopic(c, d, function(f, g) {
            if (e) {
                e(f)
            }
        })
    },moveTopicSection:function(c, d, e) {
        TopicService.MoveTopicSection(c, d, function(f, g) {
            if (e) {
                e(f)
            }
        })
    },copyTopic:function(c, d, e) {
        TopicService.CopyTopic(c, d, function(f, g) {
            if (e) {
                e(f)
            }
        })
    },copyTopicSection:function(c, d, e) {
        TopicService.CopyTopicSection(c, d, function(f, g) {
            if (e) {
                e(f)
            }
        })
    },addTopicSection:function(d, c, e, f) {
        TopicService.AddTopicSection(d, c, e, function(g, h) {
            if (f) {
                f(g)
            }
        })
    },deleteTopic:function(c, d) {
        TopicService.DeleteTopic(c, function(f, g) {
            if (d) {
                d(f)
            }
        })
    },deleteTopicSection:function(c, d) {
        TopicService.DeleteTopicSection(c, function(f, g) {
            if (d) {
                d(f)
            }
        })
    },exportTopic:function(c, d) {
        TopicService.ExportTopic(c, function(e) {
            if (d) {
                d(e)
            }
        })
    },exportTopicHierarchyBySectionId:function(c, d) {
        TopicService.ExportTopicHierarchyBySectionId(c, function(e) {
            if (d) {
                d(e)
            }
        })
    },exportTopicByTopicId:function(c, d) {
        TopicService.ExportTopicByTopicId(c, function(e) {
            if (d) {
                d(e)
            }
        })
    },getPhrases:function(c, d) {
        TopicService.getPhrases(c, function(e) {
            if (d) {
                d(e)
            }
        })
    }});
    a = new b();
    return a
}());
Ext.ns("Explore.data");
Explore.data.UserDataStore = (function() {
    var b = function() {
        this.addEvents(["userModified","userGroupModified","roleModified"]);
        b.superclass.constructor.call(this, {})
    };
    var a;
    Ext.extend(b, Ext.util.Observable, {getGroups:function(c) {
        UserService.GetGroups(function(d, f) {
            if (c) {
                c(d)
            }
        })
    },saveGroup:function(e, d, c) {
        UserService.SaveGroup(e, d, function(f, g) {
            if (c) {
                c(f)
            }
            a.fireEvent("userGroupModified", f.Result.Id)
        })
    },renameGroup:function(c, e, d) {
        UserService.RenameGroup(c, e, function(f, g) {
            if (d) {
                d(f)
            }
            a.fireEvent("userGroupModified", c)
        })
    },moveGroupToAnotherGroup:function(e, c, d) {
        UserService.MoveGroupToAnotherGroup(e, c, function(f, g) {
            if (d) {
                d(f)
            }
            a.fireEvent("userGroupModified", c)
        })
    },moveUserToAnotherGroup:function(d, c, e) {
        UserService.MoveUserToAnotherGroup(d, c, function(f, g) {
            if (e) {
                e(f)
            }
            a.fireEvent("userModified", d)
        })
    },getGroupChildren:function(d, c) {
        UserService.GetOrganizationNodes(d, function(e) {
            if (c) {
                c(e)
            }
        })
    },deleteGroup:function(c, d) {
        UserService.DeleteGroup(c, function(f, g) {
            if (d) {
                d(f)
            }
        })
    },getRoles:function(c) {
        UserService.GetRoles(function(d, f) {
            if (c) {
                c(d)
            }
        })
    },getRole:function(d, c) {
        UserService.GetRole(d, function(f, g) {
            if (c) {
                c(f)
            }
        })
    },saveRole:function(d, c) {
        UserService.SaveRole(d, function(f, g) {
            if (c) {
                c(f)
            }
            a.fireEvent("roleModified", f.Result.Id)
        })
    },deleteRole:function(d, c) {
        UserService.DeleteRole(d, function(f, g) {
            if (c) {
                c(f)
            }
            a.fireEvent("roleModified", d)
        })
    },getUsersInRole:function(c, d) {
        UserService.GetUsersInRole(c, function(f, g) {
            if (d) {
                d(f)
            }
        })
    },getUser:function(c, d) {
        UserService.GetUser(c, function(f, g) {
            if (d) {
                d(f)
            }
        })
    },saveUser:function(c, d) {
        c.Role = null;
        c.Group = null;
        UserService.SaveUser(c, function(f, g) {
            if (d) {
                d(f)
            }
            a.fireEvent("userModified", f.Result.Id);
            if (f && f.Result && f.Result.Id && f.Result.Id === currentUser.Id) {
                currentUser = f.Result
            }
        })
    },deleteUser:function(d, e, c) {
        UserService.DeleteUser(d, function(f, g) {
            if (e) {
                e(f)
            }
            if (!c) {
                a.fireEvent("userModified", d)
            }
        })
    },getUsers:function(c) {
        UserService.GetUsers(function(d, f) {
            if (c) {
                c(d)
            }
        })
    },getAllUserRoles:function(c) {
        UserService.GetRoles(function(d, f) {
            if (c) {
                c(d)
            }
        })
    },getUsersForGroup:function(d, c) {
        UserService.GetUsersForGroup(d, function(f, g) {
            if (c) {
                c(f)
            }
        })
    },changePassword:function(c, d, e) {
        UserService.ChangePassword(c, d, function(f, g) {
            if (e) {
                e(f)
            }
        })
    },getUsingWindowsImpersonation:function(c) {
        UserService.IsWebIdentityImpersonating(function(d, f) {
            if (c) {
                c(d)
            }
        })
    }});
    a = new b();
    return a
}());
Ext.ns("Explore.data");
Explore.data.WidgetDataStore = (function() {
    var b = function() {
        b.superclass.constructor.call(this, {})
    };
    var a;
    Ext.extend(b, Ext.util.Observable, {publishWidget:function(e, c, d, f) {
        WidgetService.PublishWidget(e, c, d, function(g, h) {
            if (f) {
                f(g)
            }
        })
    },publishHomeWidget:function(e, c, d, f) {
        WidgetService.PublishHomeWidget(e, c, d, function(g, h) {
            if (f) {
                f(g)
            }
        })
    }});
    a = new b();
    return a
}());
Ext.ns("Explore.data.model");
Explore.data.model.AutomationAction = Ext.extend(Object, {constructor:function(b) {
    b = b || {};
    var a = {Id:0,Action:null,EngagementItem:null,UNCPath:null,UsersEmailIds:null};
    Ext.applyIf(b, a);
    Ext.apply(this, b);
    Explore.data.model.AutomationAction.superclass.constructor.apply(this, arguments);
    this.procEngagementItem()
},procEngagementItem:function() {
    if (this.EngagementItem) {
        this.EngagementItem = new Explore.data.model.EngagementItem(this.EngagementItem)
    }
},getName:function() {
    return Explore.model.AutomationAction.getName(this.Action)
},isType:function(a) {
    return(Explore.model.AutomationAction[a] === this.Action)
}});
Ext.ns("Explore.data.model");
Explore.data.model.AutomationRule = Ext.extend(Object, {constructor:function(b) {
    b = b || {};
    var a = {Actions:[],CreatedBy:"",CreatedById:currentUser.Id,DateCreated:null,Description:"",EndDate:null,Frequency:null,Id:0,Interval:null,IsEnabled:true,IsPerpetual:null,LastModified:null,LastProcessed:null,LastRevBy:null,Name:"",Plan:{Frequency:1,Interval:3,IsPerpetual:true,PlanType:0,Threshold:0},PlanType:null,ProjectId:Explore.presenter.ProjectsPresenter.getCurrentProjectId(),SearchInfo:null,StartDate:null,Threshold:null,TimeStamp:null};
    Ext.applyIf(b, a);
    Ext.apply(this, b);
    Explore.data.model.AutomationRule.superclass.constructor.apply(this, arguments);
    this.processActions()
},getActionByType:function(a) {
    var e = this.Actions;
    var d = null;
    for (var b = 0; b < e.length; b++) {
        var c = e[b];
        if (c.isType(a)) {
            d = c;
            break
        }
    }
    return d
},getPriority:function() {
    var a = this.getActionByTypeId(Explore.model.AutomationAction.ChangePriority);
    return(a && a.EngagementItem && a.EngagementItem.Priority) ? a.EngagementItem.Priority : null
},getCurrentStatus:function() {
    var a = this.getActionByType("ChangeStatus");
    return(a && a.EngagementItem && (a.EngagementItem.CurrentStatus != null)) ? a.EngagementItem.CurrentStatus : null
},getAddTagsObj:function() {
    var a = this.getActionByType("AddTag");
    if (a && a.EngagementItem && a.EngagementItem.TagNames && a.EngagementItem.Tags) {
        return{ids:a.EngagementItem.Tags,names:a.EngagementItem.TagNames}
    }
    return null
},getRemoveTagObj:function() {
    var a = this.getActionByType("RemoveTag");
    if (a && a.EngagementItem && a.EngagementItem.TagNames && a.EngagementItem.Tags) {
        return{ids:a.EngagementItem.Tags,names:a.EngagementItem.TagNames}
    }
    return null
},getAddClassificationObj:function() {
    var a = this.getActionByType("AddClassification");
    if (a && a.EngagementItem && a.EngagementItem.Classifications && a.EngagementItem.ClassificationNames) {
        return{ids:a.EngagementItem.Classifications,names:a.EngagementItem.ClassificationNames}
    }
},getRemoveClassificationObj:function() {
    var a = this.getActionByType("RemoveClassification");
    if (a && a.EngagementItem && a.EngagementItem.Classifications && a.EngagementItem.ClassificationNames) {
        return{ids:a.EngagementItem.Classifications,names:a.EngagementItem.ClassificationNames}
    }
},getAssignedProjectsObj:function() {
    var a = this.getActionByType("AssignProjects");
    if (a && a.EngagementItem && a.EngagementItem.Projects) {
        return{ids:a.EngagementItem.Projects,names:a.EngagementItem.ProjectNames || []}
    }
},getUsersObj:function() {
    var a = this.getActionByType("AssignUsers");
    if (a && a.EngagementItem && a.EngagementItem.Users) {
        return{ids:a.EngagementItem.Users,names:a.EngagementItem.UserNames}
    }
},getSendEmailNotificationObj:function() {
    var a = this.getActionByType("SendNotification");
    if (a && a.UsersEmailIds) {
        return{ids:a.UsersEmailIds,names:[]}
    }
},getSaveToUNCObj:function() {
    var a = this.getActionByType("SaveToUNC");
    if (a && a.UNCPath) {
        return{path:a.UNCPath}
    }
},getSentiment:function() {
    var b = this.getActionByType("AddSentiment"),a = null;
    if (b && b.EngagementItem && b.EngagementItem.Sentiment) {
        a = b.EngagementItem.Sentiment
    }
    return a
},getActionByTypeId:function(a) {
    var e = this.Actions;
    var d = null;
    for (var b = 0; b < e.length; b++) {
        var c = e[b];
        if (c.Action === a) {
            d = c;
            break
        }
    }
    return d
},processActions:function() {
    var b = this.Actions;
    for (var a = 0; a < b.length; a++) {
        b[a] = new Explore.data.model.AutomationAction(b[a])
    }
}});
Ext.ns("Explore.data.model");
Explore.data.model.EngagementItem = Ext.extend(Object, {constructor:function(b) {
    b = b || {};
    var a = {ClassificationNames:null,Classifications:null,TagNames:null,Tags:null,Actions:[],Sentiment:null,Priority:null,Notes:null,Projects:null,ProjectNames:null,Users:null,UserNames:null,CurrentStatus:null,PreviousStatus:null,CurrentStatusName:null,PreviousStatusName:null};
    Ext.applyIf(b, a);
    Ext.apply(this, b);
    Explore.data.model.EngagementItem.superclass.constructor.apply(this, arguments)
}});
Ext.ns("Explore.data.model");
Explore.data.model.Optimization = Ext.extend(Object, {Phrases:[],constructor:function(b) {
    b = b || {};
    var a = {Id:b.Id || 0,Name:b.Name || "",Description:b.Description || "",Type:b.Type || 0};
    Ext.apply(b, a);
    Ext.apply(this, b);
    Explore.data.model.Optimization.superclass.constructor.apply(this, arguments)
}});
Ext.ns("Explore.data.model");
Explore.data.model.Project = Ext.extend(Object, {constructor:function(b) {
    b = b || {};
    var a = {Id:0,Name:"",Description:"",AllDocumentTypes:true,AllSources:false,AllTopics:true,AllUsers:false,AllFilters:true,defaultSettings:true,Type:0};
    Ext.applyIf(b, a);
    Ext.apply(this, b);
    Explore.data.model.Project.superclass.constructor.apply(this, arguments)
}});
Ext.ns("Explore.data.model");
Explore.data.model.ReportSettings = Ext.extend(Object, {constructor:function(b) {
    b = b || {};
    var a = {Category:"",LimitResults:50,description:"",filterByDateType:0,name:"",reportType:0,searchTerms:"",terms:"",StartDate:undefined,EndDate:undefined,topics:[]};
    Ext.applyIf(b, a);
    Ext.apply(this, b);
    Explore.data.model.ReportSettings.superclass.constructor.apply(this, arguments)
}});
Ext.ns("Explore.data.model");
Explore.data.model.SearchCriteria = Ext.extend(Object, {constructor:function(b) {
    b = b || {};
    var a = {CreatedBy:null,CreatedById:0,DateCreated:0,Id:0,LastModified:0,LastRevBy:null,LastRevId:0,Name:null,TimeStamp:null,Type:0,criteria:null,documentTypes:null,endDate:0,filterByDateType:0,language:null,printOption:2,projectId:Explore.presenter.ProjectsPresenter.getCurrentProjectId() || 1,searchTerms:"",searchTermsUI:"",stateDontMatchId:null,stateMatchId:null,targetDocuments:null,timezoneOffsetMilliseconds:0};
    Ext.applyIf(b, a);
    Ext.apply(this, b);
    Explore.data.model.SearchCriteria.superclass.constructor.apply(this, arguments)
}});
Ext.ns("Explore.model");
(function() {
    Explore.model.Enum = function(b) {
        Ext.apply(this, b);
        var a = (function(d) {
            var c = null;

            function e() {
                var g = {};
                for (var f in d) {
                    if (typeof f === "string") {
                        g[d[f]] = f
                    }
                }
                return g
            }

            return{getLookup:function() {
                if (!c) {
                    c = e()
                }
                return c
            }}
        }(b));
        this.getName = function(c) {
            var d = a.getLookup();
            return d[c] || ""
        };
        this.getNames = function() {
            var d = [];
            for (var c in b) {
                if (b.hasOwnProperty(c)) {
                    d.push(c)
                }
            }
            return d
        };
        this.getValues = function() {
            var c = [];
            for (var d in b) {
                if (b.hasOwnProperty(d)) {
                    c.push({name:d,value:b[d]})
                }
            }
            return c
        };
        this.parse = function(f, d) {
            var c = null;
            if (f) {
                if (d) {
                    f = f.toLowerCase()
                }
                for (var e in b) {
                    if (b.hasOwnProperty(e)) {
                        if (d) {
                            e = e.toLowerCase()
                        }
                        if (e === f) {
                            c = b[e];
                            break
                        }
                    }
                }
            }
            return c
        }
    }
}());
(function() {
    Ext.ns("Explore.model");
    Explore.model.SearchTypes = new Explore.model.Enum({SavedSearch:1,SharedSearch:2,RecentSearch:3,TopicSearch:4});
    Explore.model.Sentiment = new Explore.model.Enum({Neutral:0,Positive:1,Negative:2});
    Explore.model.SearchResultReportType = new Explore.model.Enum({DocumentCounts:0,Trend:1,CountsByTerms:2,SentimentsByDate:3,ShareOfVoice:4,Map:5,Terms:7,RelatedConcepts:8,HighLowComparison:9,RootCauseSummary:10,StatisticalSummary:11,RelativeDocCountsByType:12});
    Explore.model.Duration = new Explore.model.Enum({Minute:0,Hour:1,SixHours:2,Day:3,Week:4,Month:5,Year:6});
    Explore.model.GridType = new Explore.model.Enum({Concise:0,Compact:1});
    Explore.model.CloudViewType = new Explore.model.Enum({CloudView:0,ListView:1,PieChart:2,ClustersView:3,SentimentView:4,RootCauseView:5,BreakingClusters:6,HotClusters:7,SpectrographsView:8,TrendComparision:9,DocumentsFilter:10});
    Explore.model.AuditAction = new Explore.model.Enum({LoginSuccessful:0,LoginFailed:1,Notification:2});
    Explore.model.TimeWindow = new Explore.model.Enum({Past5Minutes:0,PastHour:1,Past24Hours:2,PastWeek:3,PastMonth:4,Past3Months:5,Past6Months:6,Past12Months:7,Past18Months:8,Past24Months:9,Between:10});
    Explore.model.FilterByDateType = new Explore.model.Enum({Any:0,After:1,Before:2,Between:3,PastDay:4,PastWeek:5,PastMonth:6,PastYear:7,LastLogin:8});
    Explore.model.Status = new Explore.model.Enum({Inactive:0,Active:1});
    Explore.model.SpeakerTypes = new Explore.model.Enum({Either:0,Agent:1,Caller:2});
    Explore.model.SortProperty = new Explore.model.Enum({None:0,Reference:1,AgentName:2,Ani:3,DateTime:4,Dnis:5,Duration:6,Group:7,MediaType:8,NumberOfHolds:9,RecordingSource:10,Silence:11,Weight:12,EmailSubject:13,DocumentCount:14});
    Explore.model.SortDirection = new Explore.model.Enum({Descending:-1,Ascending:1});
    Explore.model.PrintOptions = new Explore.model.Enum({PrintAll:0,NoResults:1,PrintFields:2});
    Explore.model.R6Language = new Explore.model.Enum({English:1,Other:2});
    Explore.model.ReportTypes = new Explore.model.Enum({ExploreWidgets:0,SearchResultReportType:1});
    Explore.model.DataSourceSearchType = new Explore.model.Enum({Public:0,Authorized:1});
    Explore.model.CriteriaCombine = new Explore.model.Enum({All:0,Any:1});
    Explore.model.ASType = new Explore.model.Enum({SavedSearch:1,RecentSearch:2,TopicSearch:3,RuleSearch:4,ReportFavoriteSearch:5});
    Explore.model.ASCombineType = new Explore.model.Enum({Single:0,And:1,Or:2});
    Explore.model.AutomationAction = new Explore.model.Enum({None:0,AddToSnapshot:1,RemoveFromSnapshot:2,AddTag:3,RemoveTag:4,StartOptimostExp:5,SendNotification:6,SaveToUNC:7,AddClassification:8,RemoveClassification:9,AddSentiment:10,ChangePriority:11,ChangeStatus:12,AddNotes:13,AssignProjects:14,AssignUsers:15,RespondTo:16});
    Explore.model.AutomationAttribute = new Explore.model.Enum({None:0,Snapshot:1,Tag:2,User:3,Template:4,UNCPath:5,OptimostExp:6,Classification:7,Sentiment:8,Priority:9,PreviousStatus:10,CurrentStatus:11,Note:12,AssignedProject:13,AssignedUser:14,Response:15});
    Explore.model.AutomationInterval = new Explore.model.Enum({None:0,Seconds:1,Minutes:2,Hours:3,Days:4,Week:5});
    Explore.model.AutomationPlanType = new Explore.model.Enum({Scheduled:0,Threshold:1});
    Explore.model.AutomationActionType = new Explore.model.Enum({SendNotification:0,ChangeEngagement:1});
    Explore.model.GridColumn = new Explore.model.Enum({Source:0,Date:1,Type:2});
    Explore.model.DateFormats = new Explore.model.Enum({MMDDYYYYSlash:0,DDMMYYYYSlash:1,YYYYMMDDHyph:2});
    Explore.model.PermissionType = new Explore.model.Enum({Folder:0,Normal:1,Future:2});
    Explore.model.LoginType = new Explore.model.Enum({Explore:0,WindowsIntegrated:1});
    Explore.model.ClassificationState = new Explore.model.Enum({Added:0,Deleted:1,Modified:2,Unchanged:3});
    Explore.model.ClassificationStatus = new Explore.model.Enum({Inactive:0,Active:1});
    Explore.model.ClassificationValueType = new Explore.model.Enum({Standard:0,UserDefined:1,Predefined:2});
    Explore.model.ValidationStatus = new Explore.model.Enum({Unknown:0,Valid:1,Invalid:2});
    Explore.model.ExploreWidgets = new Explore.model.Enum({IDOLDocumentCount:1,IDOLIndexingTrend:2,FavoriteGrid:3,SourceTree:4,ProjectTree:5});
    Explore.model.EngagementPriority = new Explore.model.Enum({None:0,Low:1,Medium:2,High:3});
    Explore.model.EngagementWorkFlowActions = new Explore.model.Enum({AddNotes:0,ChangePriority:1,ChangeStatus:2,AssignedUsers:3,AssignedProjects:4,AssignedSentiment:5,AssignedTags:6,AssignedClassification:7,Responded:8});
    Explore.model.SocialMediaType = new Explore.model.Enum({Twitter:0,Facebook:1,Linkedin:2});
    Explore.model.TwitterAction = new Explore.model.Enum({UpdateReplyStatus:0,Retweet:1,DirectMsg:2});
    Explore.model.DocumentType = new Explore.model.Enum({MicroMedia:0});
    Explore.model.SearchResultsExportFormat = new Explore.model.Enum({XMLSummary:0,XMLDetailed:1,HTML:2,CSV:3});
    Explore.model.SearchResultsExportMethod = new Explore.model.Enum({DirectDownload:0,EMail:1});
    Explore.model.SearchResultsExportCount = new Explore.model.Enum({CurrentPage:0,Ten:1,Hundred:2,FiveHundred:3,Thousand:4,AllItems:5});
    Explore.model.SearchResultsExportEngagement = new Explore.model.Enum({No:0,Yes:1});
    Explore.model.MASComparators = new Explore.model.Enum({Equals:0,Contains:1,StartsWith:2,EndsWith:3})
}());
Ext.ns("Explore.presenter");
Explore.presenter.AnalyticsPresenter = function(a) {
    var b = this;
    this.onSearchChanged = function(h, d, f) {
        log.info("Analytics search click: " + h);
        var c = a.getActivePanel();
        if (c.doSearch) {
            var g = {searchId:h,searchType:f,canceled:false};
            Explore.view.StatusBox.showBusy(Explore.i18n("RunningAnalytics") + ": " + d, function e() {
                log.info("Analytics was cancelled");
                g.canceled = true
            });
            c.currentSearchId = h;
            c.currentSearchType = f;
            c.doSearch(g)
        }
    };
    this.onTabChange = function(c, d) {
    };
    this.analyzeCriteria = function(j, c) {
        a.setActiveTab(c);
        var f = {};
        Explore.view.StatusBox.showBusy(Explore.i18n("RunningAnalytics") + ": " + j.searchTerms, function d() {
            log.info("Analytics was cancelled");
            f.canceled = true
        });
        var g = a.getActivePanel();
        g.currentSearchId = null;
        g.currentSearchType = null;
        g.analyzeCriteria(j, f);
        var h = a.getTabswithRecentSearch();
        for (var e = 0; e < h.length; e++) {
            h[e].setRecentSearch(j, f)
        }
    };
    Explore.presenter.AnalyticsPresenter.superclass.constructor.call(this, {});
    return this
};
Ext.extend(Explore.presenter.AnalyticsPresenter, Ext.util.Observable, {});
Ext.ns("Explore.presenter");
Explore.presenter.ProjectsPresenter = (function() {
    var b = function() {
    };
    var a;
    Ext.extend(b, Ext.util.Observable, {getCurrentProjectId:function() {
        var c = Explore.data.PreferenceDataStore.getPreferences();
        return c.SelectedProjectId
    },setCurrentProjectId:function(d) {
        var c = Explore.data.PreferenceDataStore.getPreferences();
        c.SelectedProjectId = d
    }});
    a = new b();
    return a
}());
Ext.ns("Explore.presenter");
Explore.presenter.SearchPresenter = function(c) {
    var l = this;
    var g = [];
    var k = null;
    this.searchCriteria = null;
    this.pageSize = 50;
    var h = 100;
    this.currentResultsJsonData = null;
    var a = Explore.data.IDOLDataStore.getAdvancedSearchCriteria();
    var b = {PageNumber:1,PageSize:this.pageSize,SortDirection:Explore.model.SortDirection.Descending,SortProperty:Explore.model.SortProperty.Weight};
    var f = {};

    function j(n) {
        var m = n;
        if (m) {
            m = m.replace(/^"|"$/g, "")
        }
        return m
    }

    function e(o) {
        for (var m = 0; m < o.length; m++) {
            var n = o[m];
            n.text = j(n.text)
        }
    }

    function d(o, n) {
        var m = [];
        if (o) {
            for (var r = 0; r < o.length; r++) {
                var s = o[r];
                var q = j(s.text);
                var p = s.tag;
                var t = (!n && p !== null && p !== undefined) ? String.format("{0} ({1} {2})", q, p, Explore.i18n("results")) : q;
                m.push({data:s,term:q,weight:p,tooltip:t})
            }
        }
        return m
    }

    Ext.apply(this, {getSearchSourceId:function() {
        return k
    },resetPagingCriteria:function() {
        f = Ext.apply(f, b);
        if (this.pageSize === 0) {
            f.PageSize = h
        }
    },findFiltersByType:function(o) {
        var n;
        for (var m = 0; m < g.length; ++m) {
            if (g[m].type === o) {
                n = g[m];
                return n
            }
        }
        return n
    },findCriteriaFiltersByType:function(o) {
        var n;
        var p = this.getCurrentSearchCriteria().criteria.Criteria;
        for (var m = 0;
             m < p.length; ++m) {
            if (p[m].FilterTag === o) {
                n = p[m];
                return n
            }
        }
        return n
    },removeFiltersMatching:function(o) {
        var m = 0;
        while (m < g.length) {
            var n = g[m];
            if (o(n)) {
                g.remove(n)
            } else {
                m++
            }
        }
    },removeNonPinnedFilters:function() {
        this.removeFiltersMatching(function(m) {
            return !m.pin
        })
    },removeFilterByColumn:function(m) {
        this.removeFiltersMatching(function(n) {
            return n.type === m
        })
    },getFilteredSearchCriteria:function(r) {
        if (r === undefined || r === null) {
            r = this.getCurrentSearchCriteria();
            if (r === undefined || r === null) {
                return null
            }
        }
        var o = {};
        Ext.apply(o, r);
        var s = l.findFiltersByType("Date");
        if (s) {
            o.filterByDateType = s.values.filterByDateType;
            o.startDate = s.values.fromDate;
            o.endDate = s.values.toDate
        } else {
            o.filterByDateType = Explore.model.FilterByDateType.Any;
            o.startDate = undefined;
            o.endDate = undefined
        }
        var q = l.findFiltersByType("Type");
        if (q) {
            o.documentTypes = q.values.join("+")
        } else {
            o.documentTypes = null
        }
        var m = l.findFiltersByType("Language");
        if (m) {
            o.language = m.values[0]
        } else {
            o.language = null
        }
        o.criteria = null;
        for (var p = 0; p < g.length; ++p) {
            var n = g[p].type;
            if (n != "Date" && n != "Type" && n != "Language") {
                if (n === "__ADVANCED__") {
                    Explore.utils.SearchCriteriaUtil.addSearchFilter(o, g[p].values)
                } else {
                    Explore.utils.SearchCriteriaUtil.addSearchFilter(o, {Combine:Explore.model.ASCombineType.Single,FilterTag:g[p].type,Comparator:g[p].comparator || null,Values:g[p].values})
                }
            }
        }
        return o
    },displaySearchCriteriaFilters:function() {
        var o = l.getCurrentSearchCriteria();
        if (o.filterByDateType === undefined || o.filterByDateType === null || o.filterByDateType === Explore.model.FilterByDateType.Any) {
            l.removeFilterByColumn("Date")
        } else {
            l.addResultsDateFilter(o.startDate, o.endDate, true, true, o.filterByDateType)
        }
        if (o.documentTypes) {
            l.onSearchFilterChange({type:"Type",values:o.documentTypes.split("+"),friendlyValue:o.documentTypes.replace(/\+/g, ",").toUpperCase()}, true)
        } else {
            l.removeFilterByColumn("Type")
        }
        if (o.language) {
            l.onSearchFilterChange({type:"Language",values:[o.language],friendlyValue:Explore.utils.SearchCriteriaUtil.getLanguageFriendlyName(o.language)}, true)
        } else {
            l.removeFilterByColumn("Language")
        }
        function p(u, v) {
            if (u.Combine === Explore.model.ASCombineType.And || u.Combine === Explore.model.ASCombineType.Or) {
                var t = u.Criteria;
                for (var r = 0; r < t.length; r++) {
                    var s = Explore.utils.SearchCriteriaUtil.findFilter(a, t[r].FilterTag);
                    l.onSearchFilterChange({type:s.FilterTag,values:t[r].Values,comparator:s.Comparator,friendlyType:s.Name,friendlyValues:Explore.utils.SearchCriteriaUtil.getFriendlyValues(s, t[r].Values)}, true)
                }
            } else {
                var s = Explore.utils.SearchCriteriaUtil.findFilter(a, u.FilterTag);
                if (s != null) {
                    l.onSearchFilterChange({type:u.FilterTag,values:u.Values,comparator:u.Comparator,friendlyType:s.Name,friendlyValues:Explore.utils.SearchCriteriaUtil.getFriendlyValues(s, u.Values)}, true)
                }
            }
        }

        if (g != null && g.length > 0) {
            var n = 0;
            while (n < g.length) {
                if (g[n].type === "__ADVANCED__") {
                    g.splice(n, 1)
                } else {
                    n++
                }
            }
        }
        if (o.criteria != null && o.criteria.Criteria.length > 0) {
            if (o.criteria.Combine === Explore.model.ASCombineType.And) {
                var q = o.criteria.Criteria;
                for (var m = 0; m < q.length; m++) {
                    p(q[m])
                }
            } else {
                p(o.criteria)
            }
        }
        c.setSearchFilters(g)
    },refreshResults:function() {
        var n = l.getCurrentSearchCriteria();
        var m = {filterMode:true,showSearchTerms:false};
        l.searchByCriteria(n, m)
    },refreshSearchFilters:function(m) {
        c.setSearchFilters(g);
        var n = l.getCurrentSearchCriteria();
        if (n !== null && n.searchTerms !== null) {
            m = Ext.apply({filterMode:true,showSearchTerms:false}, m);
            l.searchByCriteria(n, m)
        }
    },getFilterHeaderText:function() {
        var q = this.getFilteredSearchCriteria();
        var n = "";
        if (q && q.documentTypes) {
            n = q.documentTypes.split("+").remove("").join(",")
        } else {
            n = Explore.i18n("allSources")
        }
        if (q && q.filterByDateType == Explore.model.FilterByDateType.Between) {
            var m = {ignoreTime:true};
            var o = Explore.formatDateByPref(q.startDate, m);
            var p = Explore.formatDateByPref(q.endDate, m);
            n += " " + String.format(Explore.i18n("between_And_"), o, p)
        } else {
            if (q && q.filterByDateType >= Explore.model.FilterByDateType.PastDay) {
                n += Explore.i18n(Explore.model.FilterByDateType.getName(q.filterByDateType))
            } else {
                n += ", " + Explore.i18n("anyDate")
            }
        }
        if (q && (q.language !== null && q.language !== undefined && q.language != "")) {
            n += " " + Explore.i18n("inLanguage") + " " + Explore.utils.SearchCriteriaUtil.getLanguageFriendlyName(q.language)
        } else {
            n += ", " + Explore.i18n("AnyLanguage").toLowerCase()
        }
        n = n.trim();
        return n
    },showSearchResults:function(n, m) {
        m = m || {};
        c.showResultsTools(true);
        if (m.showSearchTerms) {
            c.setSearchTerms(l.searchCriteria.searchTermsUI || l.searchCriteria.searchTerms)
        }
        l.removeNonPinnedFilters();
        l.displaySearchCriteriaFilters();
        c.setHeaderAddButtonEnabled(true);
        c.setCountsByTypes(n);
        c.setTopToolbarVisible(true);
        c.loadData(n);
        l.currentResultsJsonData = n;
        Explore.view.StatusBox.close()
    },refreshGrid:function() {
        c.loadData(l.currentResultsJsonData)
    },onSearchFilterRemove:function(m) {
        g.remove(m);
        this.refreshSearchFilters()
    },onSearchFilterAdded:function(m, n) {
        m.pinned = m.pinned ? true : false;
        g.push(m);
        if (!n) {
            this.refreshSearchFilters()
        }
    },onSearchFilterPinToggle:function(m) {
        m.pin = !m.pin;
        c.setSearchFilters(g)
    },onSearchFilterChange:function(n, o) {
        var m = this.findFiltersByType(n.type, n.values);
        if (m) {
            m.values = n.values;
            m.comparator = n.comparator;
            m.friendlyValues = n.friendlyValues;
            m.friendlyValue = n.friendlyValue;
            m.friendlyType = n.friendlyType;
            if (!o) {
                this.refreshSearchFilters()
            }
        } else {
            this.onSearchFilterAdded(n, o)
        }
    },onRowSelected:function(n) {
        var m = Explore.SearchResults.allowClassify(n);
        c.setToolbarRowButtonsEnabled(n.length > 0, m)
    },onAdvancedSearchClick:function() {
        var m = this.getFilteredSearchCriteria() || {};
        c.showAdvancedSearchDialog(m, function n() {
            l.searchCriteria = m;
            l.removeNonPinnedFilters();
            l.displaySearchCriteriaFilters();
            l.refreshSearchFilters({filterMode:true,showSearchTerms:true})
        })
    },addResultsDateFilter:function(q, o, p, t, r) {
        var n = "";
        q = Explore.parseSerializedDate(q);
        o = Explore.parseSerializedDate(o);
        if (r === null || r === undefined) {
            r = Explore.model.FilterByDateType.Between
        }
        if (r === Explore.model.FilterByDateType.PastDay) {
            n = Explore.i18n("FilterByDateType_PastDay")
        } else {
            if (r === Explore.model.FilterByDateType.PastWeek) {
                n = Explore.i18n("FilterByDateType_PastWeek")
            } else {
                if (r === Explore.model.FilterByDateType.PastMonth) {
                    n = Explore.i18n("FilterByDateType_PastMonth")
                } else {
                    if (r === Explore.model.FilterByDateType.PastYear) {
                        n = Explore.i18n("FilterByDateType_PastYear")
                    } else {
                        n = q.format("M d, Y g:ia") + " - " + o.format("M d, Y g:ia")
                    }
                }
            }
        }
        p = !(p === false);
        var m = this.findFiltersByType("Date");
        if (m) {
            m.values = {fromDate:q,toDate:o,filterByDateType:r,allowDrill:p};
            m.friendlyValue = n;
            if (!t) {
                this.refreshSearchFilters()
            }
        } else {
            var s = {type:"Date",values:{fromDate:q,toDate:o,filterByDateType:r,allowDrill:p},friendlyValue:n};
            this.onSearchFilterAdded(s, t)
        }
    },onClearSearch:function() {
        log.info("SearchPresenter - onClearSearch");
        this.removeNonPinnedFilters();
        this.searchCriteria = null;
        k = null;
        c.clearSearch();
        c.setSearchTerms("");
        c.setRefineResults("");
        c.setHeaderClearButtonEnabled(false);
        c.setHeaderAddButtonEnabled(false);
        c.setToolbarRowButtonsEnabled(false, false);
        c.setCountsByTypes(null);
        c.setTopToolbarVisible(false);
        c.showResultsTools(false);
        c.clearRelatedConcepts();
        l.fireEvent("searchCleared")
    },onGridOpenRows:function() {
        var n = c.getSelectedRows();
        if (n.length > 0) {
            var m = c.getAllRows();
            var o = c.getIndexOfRow(n[0]);
            l.openSearchResults(n, m, o)
        }
    },onEditSentiment:function(m, q) {
        log.info("onEditSentiment: selectedRows.length=" + m.length + " sentimentValue=" + q);
        var n = [];
        for (var o = 0; o < m.length; o++) {
            var p = m[o];
            n.push({id:p.id,type:p.type});
            p.fields.sentiment = q
        }
        Explore.data.MetaDataStore.editSentiment(n, q, function(r) {
            if (r) {
            } else {
                log.warn("Error updating sentiment")
            }
        });
        l.refreshGrid()
    },onGridRowDoubleClick:function(p, o) {
        var n = [o];
        var m = c.getAllRows();
        l.openSearchResults(n, m, p)
    },openSearchResults:function(p, o, q) {
        var n = Ext.apply({}, f);
        n.PageNumber = 1;
        n.TotalCount = l.currentResultsJsonData.results > 0 ? l.currentResultsJsonData.results : 1;
        var m = l.getFilteredSearchCriteria();
        Explore.SearchResults.openSearchResults(p, o, q, n, m, false, function(s, r) {
            l.searchResultById(s, r)
        })
    },getSelectedRows:function() {
        var m = c.getSelectedRows();
        return m
    },getSelectedRowObjects:function() {
        return c.getSelectedRowObjects()
    },getSelectedRowIds:function() {
        var m = [];
        var o = c.getSelectedRows();
        if (o) {
            for (var n = 0; n < o.length; ++n) {
                m.push(o[n].id)
            }
        }
        return m
    },showBusy:function(n, m) {
        var o = (!m.filtering) ? Explore.i18n("RunningSearch") : Explore.i18n("FilteringSearch");
        Explore.view.StatusBox.showBusy(o + ": " + n, function() {
            log.info("SearchPresnter action canceled");
            m.isCanceled = true
        })
    },gridStoreBeforeLoad:function(u, x) {
        var p = x.params;
        var m = p.start;
        var q = p.limit;
        if (m !== undefined && q !== undefined) {
            var n = (m / q) + 1;
            f.PageNumber = n
        }
        var o = p.dir;
        var r = p.sort;
        var w = null;
        if (r !== undefined && o !== undefined) {
            w = {direction:o,field:r};
            if (o === "ASC") {
                f.SortDirection = Explore.model.SortDirection.Ascending
            } else {
                f.SortDirection = Explore.model.SortDirection.Descending
            }
            if (r === "type") {
                f.SortProperty = Explore.model.SortProperty.MediaType
            } else {
                if (r === "source") {
                    f.SortProperty = Explore.model.SortProperty.MediaType
                } else {
                    if (r === "date") {
                        f.SortProperty = Explore.model.SortProperty.DateTime
                    } else {
                        f.SortProperty = Explore.model.SortProperty.Weight;
                        f.SortDirection = Explore.model.SortDirection.Descending;
                        w.direction = "DESC"
                    }
                }
            }
        }
        var v = l.getFilteredSearchCriteria();
        v.projectId = Explore.presenter.ProjectsPresenter.getCurrentProjectId();
        v.timezoneOffsetMilliseconds = Explore.getLocalTimeZoneOffset();
        log.debug("gridStoreBeforeLoad params= ", p, " _pagingCriteria=", f);
        var t = {BypassDocCounts:true};
        var s = false;
        Explore.view.StatusBox.showBusy(Explore.i18n("LoadingResults"), function() {
            s = true
        });
        Explore.data.IDOLDataStore.getAdvancedSearchResults(v, f, t, function(y) {
            if (s) {
                return
            }
            if (w) {
                u.sortInfo = w
            }
            y.results = u.reader.jsonData.results;
            var z = u.reader.readRecords(y);
            u.loadRecords(z, x, true);
            l.fireEvent("searchBatchCompleted", v);
            Explore.view.StatusBox.close()
        })
    },quickSearch:function(o) {
        var n = this.getCurrentSearchCriteria();
        if (n) {
            n.searchTerms = "(" + n.searchTerms + ")+AND+*" + o + "*";
            if (n.searchTermsUI) {
                n.searchTermsUI = "(" + n.searchTermsUI + ")+AND+*" + o + "*"
            }
            var m = {bypassRelatedConcepts:true,showSearchTerms:true,filterMode:true};
            l.searchByCriteria(n, m)
        }
    },onBroadCastAnalysis:function(m) {
        if (m) {
            Explore.data.IDOLDataStore.getSearchTerms(m, function(n) {
                log.info("BroadCast returned");
                if (n) {
                    var o = "http://cmbg-newsocial-demo.autonomy.com/explore-broadcast/broadcast.php?databases=all&query=" + n;
                    var p = new Explore.view.URLDDialog({title:"BroadCast Analysis: " + n,URL:o});
                    p.show()
                }
            })
        }
    },searchByIds:function(m) {
        l.onClearSearch();
        var n = l.getFilteredSearchCriteria({searchTerms:"*",targetDocuments:m});
        l.searchByCriteria(n)
    },searchResultById:function(q, p) {
        var m = [q];
        var o = Ext.apply({}, l.getCurrentSearchCriteria());
        o.projectId = Explore.presenter.ProjectsPresenter.getCurrentProjectId();
        o.timezoneOffsetMilliseconds = Explore.getLocalTimeZoneOffset();
        o.targetDocuments = m;
        var n = {BypassDocCounts:true};
        o.printOptions = Explore.model.PrintOptions.PrintAll;
        f.PageNumber = 1;
        Explore.data.IDOLDataStore.getAdvancedSearchResults(o, f, n, function(r) {
            if (r) {
                log.info("retrieveSearchResults returned:" + r.results);
                if (p) {
                    p(r)
                }
            } else {
                log.error("No search results were returned in call to retrieveSearchResults");
                if (p) {
                    p(r)
                }
            }
        })
    },searchByCriteria:function(o, m) {
        log.info("searchByCriteria called: ", o, m);
        m = Ext.apply({bypassRelatedConcepts:false,bypassBusyMessage:false,bypassHistory:false,showSearchTerms:true,filterMode:false,replaceCurrentFilters:false,isCanceled:false}, m);
        l.fireEvent("newSearchStarted", o, m);
        this.resetPagingCriteria();
        c.setRefineResults("");
        if (m.replaceCurrentFilters) {
            l.searchCriteria = o;
            l.displaySearchCriteriaFilters()
        } else {
            if (!m.filterMode) {
                l.removeNonPinnedFilters();
                c.setSearchFilters(g)
            }
            o = l.getFilteredSearchCriteria(o)
        }
        o.projectId = Explore.presenter.ProjectsPresenter.getCurrentProjectId();
        o.timezoneOffsetMilliseconds = Explore.getLocalTimeZoneOffset();
        c.setHeaderClearButtonEnabled(true);
        if (!o.description) {
            o.description = Ext.util.Format.ellipsis(o.searchTermsUI || o.searchTerms, 200)
        }
        if (!m.bypassBusyMessage) {
            l.showBusy(o.description, m)
        }
        if (!m.bypassHistory) {
            if (o.searchTerms.length < 200) {
                Explore.setHash("search", o.searchTermsUI || o.searchTerms)
            }
        }
        log.info("Running search: ", o);
        function p(q) {
            if (!m.isCanceled) {
                if (q) {
                    if (q.searchInfo != null) {
                        l.searchCriteria = q.searchInfo;
                        l.searchCriteria.searchTermsUI = o.searchTermsUI || q.searchInfo.searchTerms
                    }
                    log.info("retrieveSearchResults returned:" + q.results);
                    l.showSearchResults(q, m);
                    l.fireEvent("newSearchCompleted", o, m, g);
                    if (!m.bypassHistory) {
                        l.saveCriteriaToHistory(o)
                    }
                    Explore.view.StatusBox.close()
                } else {
                    log.error("No search results were returned in call to retrieveSearchResults");
                    l.fireEvent("searchErrored", o);
                    Explore.view.StatusBox.close()
                }
            }
        }

        var n = {BypassDocCounts:false};
        Explore.data.IDOLDataStore.getAdvancedSearchResults(o, f, n, p)
    },loadRelatedConceptsByCriteria:function(p, n) {
        var o = n || {};
        var q = c.getByItemId("relatedConceptsViews");
        if (q && q.getEl()) {
            var m = new Ext.LoadMask(q.getEl(), {msg:Explore.i18n("Loading Related Concepts")});
            m.show()
        }
        Explore.data.IDOLDataStore.retrieveRelatedConcepts(p, o, function(s) {
            if (m) {
                m.hide()
            }
            if (o.isCanceled) {
                return
            }
            log.info("retrieveRelatedConcepts returned.");
            c.clearRelatedConcepts();
            if (s) {
                var u = [];
                var r = 6;
                if (s) {
                    for (var t = 0; t < s.length && t < r; t++) {
                        u.push(s[t])
                    }
                }
                c.showRelatedConcepts(u, p);
                var v = d(s.splice(0, Math.min(r, s.length)), true);
                c.showCloudData(v)
            }
        })
    },loadHistogramByCriteria:function(o, m) {
        var p = false;
        var q = l.findFiltersByType("date");
        if (q) {
            p = !q.values.allowDrill
        }
        if (!p) {
            var n = {};
            Explore.data.IDOLDataStore.getHistogramData(o, n, function(r) {
                log.info("getHistogramData returned.");
                if (r) {
                    m(r)
                }
            })
        }
    },getParametricFilterValue:function(n, p) {
        var o = l.getFilteredSearchCriteria();
        var m = {};
        Explore.data.IDOLDataStore.getParametricFilterValue(o, m, n, function(q) {
            if (p) {
                p(q)
            }
        })
    },getParametricFilterValues:function(o) {
        var n = l.getFilteredSearchCriteria();
        var m = {};
        Explore.data.IDOLDataStore.getParametricFilterValues(n, m, function(p) {
            if (o) {
                o(p)
            }
        })
    },getDocumentCountByParametricFilter:function(n, p) {
        var o = l.getFilteredSearchCriteria();
        var m = {};
        Explore.data.IDOLDataStore.getDocumentCountByParametricFilter(o, m, n, function(q) {
            if (p) {
                p(q)
            }
        })
    },saveCriteriaToHistory:function(m) {
        if (m.Type !== Explore.model.ASType.RecentSearch) {
            m.Id = 0;
            m.Type = Explore.model.ASType.RecentSearch;
            m.Name = Ext.util.Format.ellipsis(m.searchTermsUI || m.searchTerms, 55, true);
            Explore.data.IDOLDataStore.saveAdvancedSearchInfo(m, function(n) {
            })
        }
    },searchById:function(r, m, o) {
        k = r;
        var n = {};
        var q;
        if (o === Explore.model.ASType.SavedSearch) {
            q = "SAVEDSEARCH::(" + m + ")";
            var p = {searchTerms:q,searchTermsUI:q,description:q,searchType:1};
            l.searchByCriteria(p, n)
        } else {
            n = {isSavedSearch:true,bypassBusyMessage:true};
            q = m;
            l.showBusy(m, n);
            if (o === Explore.model.ASType.RecentSearch) {
                Explore.data.IDOLDataStore.getSearchCriteriaBySearchId(r, function(s) {
                    if (!n.isCanceled) {
                        s.projectId = Explore.presenter.ProjectsPresenter.getCurrentProjectId();
                        s.timezoneOffsetMilliseconds = Explore.getLocalTimeZoneOffset();
                        s.searchType = o;
                        s.description = m;
                        l.searchByCriteria(s, n)
                    }
                })
            } else {
                log.warn("SearchPresenter: searchType is not supported: " + o)
            }
        }
    },searchByText:function(o) {
        var n = {searchTerms:o,searchTermsUI:o,projectId:Explore.presenter.ProjectsPresenter.getCurrentProjectId(),timezoneOffsetMilliseconds:Explore.getLocalTimeZoneOffset()};
        var m = {};
        this.searchByCriteria(n, m)
    },searchByTopic:function(o, n) {
        log.info("Execute search for topic: " + n);
        var q = "TOPIC::(" + n + ")";
        var p = {searchTerms:q,searchTermsUI:q,description:q};
        var m = {replaceCurrentFilters:false};
        l.searchByCriteria(p, m)
    },searchByCloudTopic:function(p, o, m, s) {
        log.info("Execute search for topic: " + o);
        var r = "TOPIC::(" + o + ")";
        var q = {searchTerms:r,searchTermsUI:r,description:r,projectId:Explore.presenter.ProjectsPresenter.getCurrentProjectId(),timezoneOffsetMilliseconds:Explore.getLocalTimeZoneOffset(),filterByDateType:Explore.model.FilterByDateType.Between,startDate:m,endDate:s};
        var n = {replaceCurrentFilters:true};
        l.searchByCriteria(q, n)
    },getCurrentSearchCriteria:function() {
        return this.searchCriteria
    },getCurrentSearchPanel:function() {
        return c
    },onRelatedConcept:function(t) {
        log.info("SearchPresenter - onRelatedConcept");
        var r = this.getCurrentSearchCriteria();
        var m = {};
        Ext.apply(m, r);
        var p = Explore.data.PreferenceDataStore.getRelatedTermsAction();
        var n = "+" + p + "+";
        if (p !== "NEW") {
            var q = t.join(n);
            if (m.searchTerms && m.searchTerms.length > 0) {
                m.searchTerms = "(" + m.searchTerms + ")" + n + q;
                m.searchTermsUI = "(" + m.searchTermsUI + ")" + n + q;
                log.debug("combined search terms are: " + m.searchTerms)
            } else {
                m.searchTerms = q;
                m.searchTermsUI = q;
                log.debug("search terms are: " + m.searchTerms)
            }
        } else {
            m.searchTerms = t[0];
            m.searchTermsUI = t[0]
        }
        var o = {bypassRelatedConcepts:true,filterMode:true};
        this.searchByCriteria(m, o)
    },analyze:function(n) {
        log.info("SearchPresenter.onAddFavorite", n);
        var o = l.getCurrentSearchCriteria();
        var m = Explore.showAnalyticsPanel();
        m.analyzeCriteria(o, n)
    },onAddFavorite:function() {
        log.info("SearchPresenter.onAddFavorite");
        Ext.MessageBox.prompt(Explore.i18n("SaveToFavorites"), Explore.i18n("Name"), function m(p, n) {
            var o = Ext.getCmp("userControlPanel");
            var r = l.getSearchSourceId();
            var q = l.getSelectedRowIds();
            o.addFavorites(n, r, q)
        })
    },onAddTag:function() {
        log.info("SearchPresenter.onAddTag");
        var n = l.getSelectedRowObjects();
        var m = new Explore.view.TagsDialog({rowObjects:n,listeners:{close:function() {
        }}});
        m.show()
    },onClassify:function() {
        log.info("SearchPresenter.onClassify");
        var n = l.getSelectedRowObjects();
        var m = new Explore.view.ClassifyDialog({rowObjects:n,listeners:{close:function() {
        }}});
        m.show()
    },saveSearch:function(o, n, m) {
        o = o || l.getFilteredSearchCriteria();
        if (n) {
            n += "<br />"
        } else {
            n = ""
        }
        Explore.view.StatusBox.prompt(Explore.i18n("SaveSearch"), n + Explore.i18n("Name"), m, function(p) {
            o.Name = p;
            o.Type = Explore.model.ASType.SavedSearch;
            Explore.data.IDOLDataStore.saveAdvancedSearchInfo(o, function(q) {
                if (q.ErrorCode == 0) {
                    log.info("Saved Search")
                } else {
                    log.warn("Saved Search Error", q);
                    l.saveSearch(o, q.Message, p)
                }
            })
        }, "usersyntaxName")
    },onExportResults:function(m, o, q) {
        if (o === Explore.model.SearchResultsExportFormat.XMLDetailed) {
            this.searchCriteria.printOptions = Explore.model.PrintOptions.PrintAll
        } else {
            this.searchCriteria.printOptions = Explore.model.PrintOptions.PrintFields
        }
        var p = Ext.apply({}, f);
        if (m) {
            p.PageNumber = 1;
            p.PageSize = m
        } else {
            p.PageSize = 50
        }
        var n = {BypassDocCounts:true};
        Explore.data.IDOLDataStore.getAdvancedSearchResultsForExport(this.searchCriteria, p, n, function(r) {
            Explore.utils.Exporter.exportTextToXml("text/xml", "Results.xml", r.XmlPayloadToString);
            q()
        })
    },onTakeSnapshot:function(p, m, o) {
        Explore.view.StatusBox.showBusy(Explore.i18n("TakingSnapshot") + ": " + m + "...");
        var n = l.getFilteredSearchCriteria();
        Explore.data.SnapshotDataStore.takeSnapshot(m, o, n, function(q) {
            Explore.view.StatusBox.close();
            if (q.ErrorCode > 0) {
                Explore.view.StatusBox.showWarning(Explore.i18n("appTitle"), q.Message)
            } else {
                p.close()
            }
        })
    },onCreateAutomationRule:function() {
        log.info("SearchPresenter.onCreateAutomationRule");
        var m = new Explore.data.model.AutomationRule({SearchInfo:this.getFilteredSearchCriteria(),Enabled:true,ProjectId:Explore.presenter.ProjectsPresenter.getCurrentProjectId()});
        Explore.view.RulesPanel.showRuleDialog(m)
    },onReport:function(o, p) {
        log.info("SearchPresenter.onReport");
        var n = new Date();
        o = Ext.apply({}, o || l.getFilteredSearchCriteria());
        var m = Ext.apply({name:(o.description || o.searchTermsUI || Explore.i18n("DefaultReportName")),description:"",reportType:Explore.model.SearchResultReportType.DocumentCounts,tag:null,filterByDateType:null,LimitResults:10,searchTerms:(o.description || o.searchTermsUI || Explore.i18n("DefaultReportName"))}, p);
        if (m.filterByDateType === null) {
            m.filterByDateType = o.filterByDateType || Explore.model.FilterByDateType.Any;
            if (o.filterByDateType != Explore.model.FilterByDateType.Any) {
                m.startDate = o.startDate;
                m.endDate = o.endDate
            }
        }
        var q = new Explore.view.widgets.WidgetSettingsDialog({reportSettings:m,listeners:{runReport:function(r) {
            l.runReport(o, r)
        }}});
        q.show()
    },runReport:function(s, m, t) {
        log.info("SearchPresenter.runReport searchCriteria: ", s, " reportSettings:", m);
        var u = this;
        var p = false;
        var q = null;
        Explore.view.StatusBox.showBusy(Explore.i18n("RunningReport") + ": " + m.name, function() {
            p = true
        });
        var v = {};
        var o = -1;
        var r = "";
        var n = "";
        Explore.data.IDOLDataStore.getReportOnCriteria(s, v, m, function(w) {
            if (!p) {
                if (w) {
                    if (w.ErrorInfo != null) {
                        Explore.view.StatusBox.close();
                        var x = Explore.i18n(w.ErrorInfo.ID);
                        if (x === w.ErrorInfo.ID || !x) {
                            if (w.ErrorInfo.Message) {
                                x = w.ErrorInfo.Message
                            }
                        }
                        if (w.GraphData.length != 0) {
                            Explore.view.StatusBox.showWarning(Explore.i18n("WarningLabel"), x, function() {
                                u.generateReport(s, m, t, w)
                            })
                        } else {
                            Explore.view.StatusBox.showError(Explore.i18n("error"), Explore.i18n("errorReportFailed") + "<br />" + x)
                        }
                    } else {
                        u.generateReport(s, m, t, w)
                    }
                } else {
                    Explore.view.StatusBox.close();
                    Explore.view.StatusBox.showError(Explore.i18n("error"), Explore.i18n("errorReportFailed"))
                }
            }
        })
    },generateReport:function(q, m, s, u) {
        var t = this;
        var o = -1;
        var r = "";
        var n = "";
        o = Explore.determineTimeInterval(u.StartDate, u.EndDate, t.getTimeInterval());
        r = Explore.i18n(Explore.model.Duration.getName(o).toLowerCase());
        if (r === "hour" || r === "sixhours") {
            n = "M-d-Y g:i a"
        } else {
            n = "M-d-Y"
        }
        if (m.reportType === Explore.model.SearchResultReportType.Trend) {
            u.GraphData = Explore.convertGraphDataEpochsData(u.GraphData)
        }
        if (m.reportType === Explore.model.SearchResultReportType.SentimentsByDate) {
            u.GraphData = Explore.convertGraphDataEpochsData(u.GraphData)
        }
        var p = new Explore.view.widgets.WidgetDialog({searchCriteria:q,reportSettings:m,reportData:u,durationName:r,dateFormat:n,reportFavorite:s,listeners:{backButton:function() {
            try {
                m = p.reportSettings;
                p.close()
            } catch(v) {
                log.info("Exception during close of chart - IE issue with tip renderers", v)
            }
            t.onReport(q, m)
        },onDrillDownReport:function(v, w) {
            if ((w.reportType === Explore.model.SearchResultReportType.ShareOfVoice) || (w.reportType === Explore.model.SearchResultReportType.HighLowComparison)) {
                t.onReport(v, w)
            } else {
                t.runReport(v, w)
            }
        }}});
        p.show();
        Explore.view.StatusBox.close()
    },getTimeInterval:function() {
        var m = {byHour:3,bySixHours:8,byDay:46,byWeek:367,byYear:1085};
        return m
    }});
    Explore.presenter.SearchPresenter.superclass.constructor.call(this, {});
    return this
};
Ext.extend(Explore.presenter.SearchPresenter, Ext.util.Observable, {});
Ext.ns("Explore");
Explore.datePatterns = {ISO8601Long:"Y-m-d H:i:s",ISO8601Short:"Y-m-d",ShortDateTime:"n/j/Y g:i A",ShortDate:"n/j/Y",LongDate:"l, F d, Y",FullDateTime:"l, F d, Y g:i:s A",MonthDay:"F d",ShortTime:"g:i A",LongTime:"g:i:s A",SortableDateTime:"Y-m-d\\TH:i:s",UniversalSortableDateTime:"Y-m-d H:i:sO",YearMonth:"F, Y"};
Explore.getTimeAxis = function(a, e) {
    var b = (e - a) / 1000 / 60 / 60 / 24;
    var d = "day";
    var c = NaN;
    if (b > 365 * 2) {
        d = "year";
        if (b >= 365 * 40) {
            c = 10
        } else {
            if (b >= 365 * 20) {
                c = 5
            } else {
                if (b >= 365 * 10) {
                    c = 2
                } else {
                    c = 1
                }
            }
        }
    } else {
        if (b > 60) {
            d = "month"
        } else {
            if (b <= 2) {
                d = "hours";
                c = 15
            }
        }
    }
    return new Ext.chart.TimeAxis({displayName:"Date",minimum:Explore.formatDateByPref(a),maximum:Explore.formatDateByPref(e),majorTimeUnit:d,majorUnit:c,labelRenderer:function(f) {
        var g;
        log.debug("labelRenderer for date: " + f);
        if (b <= 1) {
            g = Explore.formatDateByPref(f)
        } else {
            if (b <= 16) {
                g = Ext.util.Format.date(f, Explore.getDateFormatByPref({ignoreTime:true})) + "\n" + Ext.util.Format.date(f, Explore.getDateFormatByPref({ignoreDate:true}))
            } else {
                g = Explore.formatDateByPref(f, {ignoreTime:true})
            }
        }
        return g
    }})
};
Explore.getLocalTimeZoneOffset = function() {
    var a = new Date();
    var b = a.getTimezoneOffset();
    return b
};
Explore.getEpochFromDate = function(b) {
    var a = 0;
    if (b) {
        a = Date.parse(b.toUTCString());
        return a / 1000
    }
    return
};
Explore.getDateFromEpoch = function(c, b) {
    if (c) {
        if (!b) {
            c = c * 1000
        }
        var a = new Date(c);
        return a
    }
    return
};
Explore.parseSerializedDate = function(b) {
    var a = b;
    if (typeof(b) === "string") {
        if (b.indexOf("/Date") === 0) {
            var c = /Date\(([-+]?\d+[-+]?\d+)\)/.exec(b);
            if (c) {
                a = new Date(parseInt(c[1]))
            }
        } else {
            a = Date.parse(b)
        }
    } else {
        if (typeof(b) === "number") {
            a = new Date(b)
        }
    }
    return a
};
Explore.serializeDate = function(a) {
    if (a) {
        return a.toString()
    } else {
        a = new Date();
        a.setTime(0);
        return a.toString()
    }
};
Explore.getTimeFormatByPref = function() {
    var a = Explore.data.PreferenceDataStore.getPreferences();
    return"H:i:s"
};
Explore.formatTimeByPref = function(b, a) {
    if (a) {
    }
    var c = " ";
    var e = 1;
    var f = Explore.formatDateByPref(b, {ignoreTime:false});
    return f.split(c)[e]
};
Explore.getDateFormatByPref = function(d) {
    var a = Explore.data.PreferenceDataStore.getPreferences();
    var c = Explore.model.DateFormats.MMDDYYYYSlash;
    if (a && a.DateTimeFormat) {
        c = a.DateTimeFormat
    }
    var b = null;
    if (d && d.ignoreDate === true) {
        return"g:i a"
    } else {
        if (c === Explore.model.DateFormats.MMDDYYYYSlash) {
            if (d.ignoreTime === true) {
                b = "m/d/Y"
            } else {
                b = "m/d/Y H:i:s"
            }
        } else {
            if (c === Explore.model.DateFormats.DDMMYYYYSlash) {
                if (d && d.ignoreTime === true) {
                    b = "d/m/Y"
                } else {
                    b = "d/m/Y H:i:s"
                }
            } else {
                if (c === Explore.model.DateFormats.YYYYMMDDHyph) {
                    if (d && d.ignoreTime === true) {
                        b = "Y-m-d"
                    } else {
                        b = "Y-m-d H:i:s"
                    }
                } else {
                    if (d && d.ignoreTime === true) {
                        b = "Y-m-d"
                    } else {
                        b = "Y-m-d H:i:s"
                    }
                }
            }
        }
        return b
    }
};
Explore.formatDateByPref = function(a, c) {
    var b = "";
    a = Explore.parseSerializedDate(a);
    if (a) {
        if (c && c.ignoreTime === true) {
            return Ext.util.Format.date(a, Explore.getDateFormatByPref(c))
        } else {
            return Ext.util.Format.date(a, Explore.getDateFormatByPref({ignoreTime:false}))
        }
    }
    return b
};
Explore.formatDate = function(b, c) {
    var d = "";
    var a = Explore.parseSerializedDate(b);
    if (a) {
        d = Ext.util.Format.date(a, c)
    }
    return d
};
Explore.showLoadedImage = function(a) {
    if (a) {
        a.style.display = ""
    }
};
Explore.findMatching = function(f, a, e, c) {
    for (var b = 0; b < f.length; b++) {
        var d = f[b];
        if (d[a] === e) {
            return d
        }
    }
    return null
};
Explore.selectBestFitDuration = function(a, d, b) {
    var c = (d - a) / (1000 * 60 * 60 * 24);
    if (c <= 4) {
        return Explore.model.Duration.Hour
    } else {
        if (c <= 7) {
            return Explore.model.Duration.Day
        } else {
            if (c <= 100) {
                return Explore.model.Duration.Week
            } else {
                if (c <= 365 * 2) {
                    return Explore.model.Duration.Month
                } else {
                    return Explore.model.Duration.Year
                }
            }
        }
    }
};
Explore.determineTimeInterval = function(a, d, b) {
    var c = (d - a) / (1000 * 60 * 60 * 24);
    if (c <= b.byHour) {
        return Explore.model.Duration.Hour
    } else {
        if (c <= b.bySixHours) {
            return Explore.model.Duration.SixHours
        } else {
            if (c <= b.byDay) {
                return Explore.model.Duration.Day
            } else {
                if (c <= b.byWeek) {
                    return Explore.model.Duration.Week
                } else {
                    if (c <= b.byMonth) {
                        return Explore.model.Duration.Month
                    } else {
                        return Explore.model.Duration.Year
                    }
                }
            }
        }
    }
};
Explore.advanceDateByDuration = function(b, f, d) {
    var c = new Date();
    c.setTime(b.getTime());
    c.setMilliseconds(0);
    switch (f) {case Explore.model.Duration.Hour:c.setMilliseconds(0);
        c.setMinutes(0);if (d) {
            var e = c.getHours();
            c.setHours(c.getHours() + 1);
            if (e === c.getHours()) {
                c.setHours(c.getHours() + 2)
            }
        }break;
        case Explore.model.Duration.Day:c.setMilliseconds(0);c.setMinutes(0);c.setHours(0);if (d) {
            c.setDate(c.getDate() + 1)
        }break;case Explore.model.Duration.Week:var h = c.getUTCDay();
        var a = 1000 * 60 * 60 * 24;if (h > 1) {
            var g = (h - 1) * a;
            c.setTime(c.getTime() - g)
        } else {
            if (h < 1) {
                c.setTime(c.getTime() + a)
            }
        }c.setMilliseconds(0);
        c.setMinutes(0);c.setHours(0);if (d) {
            c.setDate(c.getDate() + 7)
        }break;case Explore.model.Duration.Month:c.setMilliseconds(0);
        c.setMinutes(0);c.setHours(0);c.setDate(1);if (d) {
            c.setMonth(c.getMonth() + 1)
        }break;case Explore.model.Duration.Year:default:c.setMilliseconds(0);
        c.setMinutes(0);c.setHours(0);c.setDate(1);c.setMonth(0);if (d) {
            c.setFullYear(c.getFullYear() + 1)
        }break
    }
    return c
};
Explore.convertGraphDataEpochsData = function(d) {
    var c = d;
    for (var a = 0; a < c.length; a++) {
        var b = c[a];
        b[0] = new Date(b[0]);
        b[1] = new Date(b[1]);
        b[2] = new Date(b[2])
    }
    return c
};
Explore.getDurationString = function(b) {
    var a = "Hour";
    if (b === 5) {
        a = "Year"
    } else {
        if (b === 4) {
            a = "Month"
        } else {
            if (b === 3) {
                a = "Week"
            } else {
                if (b === 2) {
                    a = "Day"
                }
            }
        }
    }
    return a
};
Explore.getStartDateFromTimeWindow = function(d, c, b) {
    c = c || new Date();
    var a = new Date(c.getTime());
    switch (d) {case Explore.model.TimeWindow.Past5Minutes:a.setMinutes(c.getMinutes() - 5);break;case Explore.model.TimeWindow.PastHour:a.setHours(c.getHours() - 1);
        break;case Explore.model.TimeWindow.Past24Hours:a.setDate(c.getDate() - 1);break;case Explore.model.TimeWindow.PastWeek:a.setDate(c.getDate() - 7);
        break;case Explore.model.TimeWindow.PastMonth:a.setMonth(c.getMonth() - 1);break;case Explore.model.TimeWindow.Past3Months:a.setMonth(c.getMonth() - 3);
        break;case Explore.model.TimeWindow.Past6Months:a.setMonth(c.getMonth() - 6);break;case Explore.model.TimeWindow.Past12Months:a.setMonth(c.getMonth() - 12);
        break;case Explore.model.TimeWindow.Past18Months:a.setMonth(c.getMonth() - 18);break;case Explore.model.TimeWindow.Past24Months:a.setMonth(c.getMonth() - 24);
        break;case Explore.model.TimeWindow.Between:a = b;break
    }
    return a
};
Explore.ensureExtDirect = function(a) {
    if (typeof IDOLService === "undefined") {
        if (!a.match(/\/$/)) {
            a += "/"
        }
        ExploreDirect.url = a + "Direct/ServiceHandler.ashx";
        Ext.Direct.addProvider(ExploreDirect)
    }
};
Explore.setButtonState = function(c, a, d) {
    for (var b = 0;
         b < c.length; b++) {
        c[b].setVisible(a);
        c[b].setDisabled(d)
    }
};
Explore.getInfoIconMessage = function(b) {
    var c = '<div class = "project-description-message">{0} <span>&nbsp;{1}</span> </div>';
    var a = '<img  class="x-toolUR x-toolUR-about" width="16" height="16" style="padding: 0; float:left;" src="data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==">';
    return String.format(c, a, b)
};
Explore.getDefaultSocialAccByType = function(b) {
    var c;
    if (currentUser) {
        if (currentUser.SocialMediaAccounts != null && currentUser.SocialMediaAccounts.length > 0) {
            for (var a = 0;
                 a < currentUser.SocialMediaAccounts.length; a++) {
                if (currentUser.SocialMediaAccounts[a].AccountType == b && currentUser.SocialMediaAccounts[a].DefaultAccount) {
                    c = currentUser.SocialMediaAccounts[a];
                    break
                }
            }
        }
    }
    return c
};
Explore.getSocialAccountsByType = function(b) {
    var c = new Array();
    if (currentUser) {
        if (currentUser.SocialMediaAccounts != null && currentUser.SocialMediaAccounts.length > 0) {
            for (var a = 0;
                 a < currentUser.SocialMediaAccounts.length; a++) {
                if (currentUser.SocialMediaAccounts[a].AccountType == b) {
                    c.push(currentUser.SocialMediaAccounts[a])
                }
            }
        }
    }
    return c
};
Explore.getNumberSocialMediaAccounts = function() {
    var a = 0;
    if (currentUser) {
        if (currentUser.SocialMediaAccounts != null) {
            a = currentUser.SocialMediaAccounts.length
        }
    }
    return a
};
Explore.getNumberAccountsByType = function(b) {
    var c = 0;
    if (currentUser) {
        if (currentUser.SocialMediaAccounts != null && currentUser.SocialMediaAccounts.length > 0) {
            for (var a = 0;
                 a < currentUser.SocialMediaAccounts.length; a++) {
                if (currentUser.SocialMediaAccounts[a].AccountType == b) {
                    c++
                }
            }
        }
    }
    return c
};
Ext.ns("Explore.utils");
Explore.utils.Exporter = (function() {
    var d = new RegExp("\\/Date\\(([-+])?(\\d+)(?:[+-]\\d{4})?\\)\\/");

    function c() {
        var o = null;
        var p = document.getElementsByTagName("body");
        if (p) {
            var n = p[0];
            var l = document.createElement("iframe");
            l.setAttribute("style", "display:none");
            l.style.display = "none";
            n.appendChild(l);
            var m = (l.contentWindow) ? l.contentWindow : (l.contentDocument.document) ? l.contentDocument.document : l.contentDocument;
            if (m && m.document) {
                o = (function(q) {
                    return{write:function(r) {
                        q.write(r)
                    },getElementById:function(r) {
                        return q.getElementById(r)
                    },submit:function() {
                        q.forms[0].submit()
                    }}
                }(m.document))
            }
        }
        return o
    }

    function g(o, l, m) {
        var n = c();
        if (n) {
            n.write('<html><head><body><form action="../Handlers/Exporter.ashx" method="post"><input type="hidden" id="contentType" name="contentType" /><input type="hidden" id="filename" name="filename" /><input type="hidden" id="buf" name="buf" /></form></body></head></html>');
            n.getElementById("contentType").value = o;
            n.getElementById("filename").value = l;
            n.getElementById("buf").value = m;
            n.submit()
        }
    }

    function f(n) {
        var m = typeof(n);
        if (m === "undefined" || n === null) {
            return""
        } else {
            if (m === "object") {
                n = n.toString() + ""
            } else {
                if (m === "string" && d.test(n)) {
                    n = Explore.formatDateByPref(n)
                } else {
                    n = n + ""
                }
            }
            n = n.replace(/"/g, '""');
            n = n.replace(/\n/g, " ");
            var l = (n.indexOf(",") >= 0);
            return(l) ? ('"' + n + '"') : n
        }
    }

    function b(m, q) {
        var o = "";
        for (var n = 0; n < m.length; n++) {
            var p = m[n];
            if (n > 0) {
                o += ","
            }
            var l = null;
            if (q) {
                l = q[p]
            }
            if (l === null || l === undefined) {
                l = Explore.i18n(p)
            }
            o += f(l)
        }
        o += "\n";
        return o
    }

    function a(l) {
        var p = [];
        if (l) {
            for (var n = 0; n < l.length; n++) {
                var o = l[n];
                var m = o.name;
                if (m && (m.indexOf("hidden") < 0) && (m.indexOf("token") < 0)) {
                    p.push(m)
                }
            }
        }
        return p
    }

    function j(m) {
        var l = m;
        if (l && (typeof(l) === "string")) {
            l = l.replace(/&/gi, "&amp;");
            l = l.replace(/"/gi, "&quot;");
            l = l.replace(/</gi, "&lt;");
            l = l.replace(/>/gi, "&gt;");
            l = l.replace(/'/gi, "&apos;")
        }
        return l
    }

    function k(m) {
        var l = m;
        if (m === null || m === undefined || m === "") {
            l = "_"
        } else {
            if (!isNaN(m)) {
                l = ("_" + m)
            } else {
                l = m.replace(/ /g, "_");
                if ("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_".indexOf(l.charAt(0)) < 0) {
                    l = "_" + l
                }
            }
        }
        return l
    }

    function h(p) {
        var n = "";
        var r = typeof(p);
        if (p === null && p === undefined || r === "function") {
            n = ""
        } else {
            if (typeof(p) === "string" && d.test(p)) {
                n += Explore.formatDateByPref(p)
            } else {
                if (Ext.isArray(p)) {
                    for (var o = 0; o < p.length; o++) {
                        n += "<item>";
                        n += h(p[o]);
                        n += "</item>"
                    }
                } else {
                    if (r === "object") {
                        for (var m in p) {
                            if (p.hasOwnProperty(m)) {
                                var q = p[m];
                                if (typeof(q) !== "function") {
                                    var l = k(m);
                                    n += "<" + l + (Ext.isArray(q) ? ' type="list"' : "") + ">";
                                    n += h(q);
                                    n += "</" + l + ">"
                                }
                            }
                        }
                    } else {
                        n += j(p)
                    }
                }
            }
        }
        return n
    }

    function e(l, o) {
        var m = "";
        if (l && o) {
            var n = l.get(o);
            if (o === "date") {
                n = Explore.formatDateByPref(n)
            }
            m += "<" + o + ">";
            m += h(n);
            m += "</" + o + ">\n"
        }
        return m
    }

    return{exportToCsv:function(o, l, t) {
        var m = "";
        var n = "";
        if (o) {
            for (var q = 0; q < o.length; q++) {
                var r = o[q];
                if (q === 0) {
                    if (r.fields && !t) {
                        t = a(r.fields.items)
                    }
                    if (!t) {
                        break
                    }
                    m += b(t, l)
                }
                for (var p = 0; p < t.length; p++) {
                    var s = t[p];
                    if (p > 0) {
                        m += ","
                    }
                    if (r.get) {
                        n = r.get(s)
                    } else {
                        n = r[s]
                    }
                    m += f(n)
                }
                m += "\n"
            }
        }
        g("text/csv", "results.csv", m)
    },exportGridToCsv:function(p) {
        var m = p.getStore().getRange();
        var l = p.getColumnModel();
        var q = {};
        var r = [];
        for (var o = 0; o < l.config.length; o++) {
            var n = l.config[o];
            if (!n.hidden) {
                r.push(n.dataIndex);
                q[n.dataIndex] = n.header
            }
        }
        this.exportToCsv(m, q)
    },exportToXml:function(n) {
        var o = "<records>\n";
        var r;
        if (n) {
            for (var p = 0; p < n.length;
                 p++) {
                var l = n[p];
                if (l && l.fields.items) {
                    if (p === 0) {
                        r = a(l.fields.items);
                        if (!r) {
                            break
                        }
                    }
                    o += "   <record>\n";
                    for (var m = 0; m < r.length;
                         m++) {
                        var q = r[m];
                        o += e(l, q)
                    }
                    o += "   </record>\n"
                }
            }
        }
        o += "</records>";
        g("application/octet-stream|+xml", "results.xml", o)
    },exportObject:function(n, l) {
        l = l || "records";
        var m = "<" + l + ">\n";
        m += h(n);
        m += "</" + l + ">\n";
        var o = "results.xml";
        if (Ext.isString(l)) {
            o = l + ".xml"
        }
        g("application/octet-stream|+xml", o, m)
    },exportTextToXml:function(n, m, l) {
        g(n, m, l)
    },exportTextToCsV:function(n, m, l) {
        g(n, m, l)
    },exportClusterImage:function(l, m) {
        var o = l.split("?");
        var n = o[0];
        var s = Ext.urlDecode(o[1]);
        s.filename = m || "cluster.jpg";
        var p = c();
        if (p) {
            var q = '<html><head><body><form action="' + n + '" method="get">';
            for (var t in s) {
                if (s.hasOwnProperty(t)) {
                    var r = s[t];
                    q += '<input type="hidden" name="' + t + '" value="' + r + '" />'
                }
            }
            q += "</form></body></head></html>";
            p.write(q);
            p.submit()
        }
    },exportHotBreakingClusters:function(n) {
        var o = [];
        for (var m = 0; m < n.length; m++) {
            var r = n[m];
            for (var l = 0;
                 l < r.children.length; l++) {
                var q = r.children[l];
                o.push({ClusterTitle:r.text,Document:q.text,Reference:q.tag})
            }
        }
        var p = {ClusterTitle:Explore.i18n("ClusterTitle"),Document:Explore.i18n("DocumentTitle"),Reference:Explore.i18n("Reference")};
        this.exportToCsv(o, p)
    }}
}());
Ext.ns("Explore.utils");
Explore.utils.SearchCriteriaUtil = {clone:function(d) {
    if (d === null || d === undefined) {
        return d
    } else {
        if (typeof d === "object") {
            var a;
            if (d instanceof Array) {
                a = [];
                for (var c = 0; c < d.length; c++) {
                    a.push(Explore.utils.SearchCriteriaUtil.clone(d[c]))
                }
            } else {
                a = {};
                for (var b in d) {
                    if (d.hasOwnProperty(b)) {
                        a[b] = Explore.utils.SearchCriteriaUtil.clone(d[b])
                    }
                }
            }
            return a
        } else {
            return d
        }
    }
},addSearchFilter:function(c, b) {
    if (c.criteria == null) {
        c.criteria = {Combine:Explore.model.ASCombineType.And,Criteria:[]}
    } else {
        if (c.criteria.Combine !== Explore.model.ASCombineType.And) {
            var a = c.criteria;
            c.criteria = {Combine:Explore.model.ASCombineType.And,Criteria:[a]}
        }
    }
    c.criteria.Criteria.push(b)
},getFriendlyValues:function(a, h) {
    var m = [];
    var c,j,e;
    var k = a.FilterTag;
    var g = a.Type;
    if (k === "CLASSIFICATION") {
        var l = Explore.data.MetaDataStore.getTags2();
        for (e = 0; e < h.length;
             e++) {
            c = h[e];
            if (typeof(c) == "string") {
                c = parseInt(c, 10)
            }
            j = Explore.findMatching(l, "Id", c);
            if (j != null) {
                m.push(j.TagName)
            }
        }
        return m
    } else {
        if (k === "OBSERVECLASSIFICATION") {
            var f = Explore.data.MetaDataStore.getRecordingClassificationNames();
            for (e = 0; e < h.length;
                 e++) {
                c = h[e];
                if (typeof(c) == "string") {
                    c = parseInt(c, 10)
                }
                j = Explore.findMatching(f, "Id", c);
                if (j != null) {
                    m.push(j.Name)
                }
            }
            return m
        } else {
            if (g === "Date") {
                for (e = 0; e < h.length; e++) {
                    var b = Explore.getDateFromEpoch(h[e]);
                    b = b.format(Explore.getDateFormatByPref({ignoreTime:true}));
                    m.push(b)
                }
                return m
            } else {
                if (a.UserValues !== null && a.UserValues.length > 0) {
                    for (e = 0; e < h.length; e++) {
                        c = h[e];
                        var d = Explore.findMatching(a.UserValues, "Key", c);
                        if (d != null) {
                            m.push(d.Value)
                        }
                    }
                    return m
                } else {
                    return h
                }
            }
        }
    }
},getNodeCombineText:function(a) {
    if (a.Combine === Explore.model.ASCombineType.And) {
        return Explore.i18n("withAllOf")
    } else {
        if (a.Combine === Explore.model.ASCombineType.Or) {
            return Explore.i18n("withAnyOf")
        } else {
            return null
        }
    }
},findFilter:function(a, b) {
    var e;
    for (var c = 0,d = a.Items.length; c < d; c++) {
        e = a.Items[c];
        if (e.FilterTag === b) {
            return e
        }
    }
    for (c = 0,d = a.Groups.length; c < d; c++) {
        var f = a.Groups[c];
        e = Explore.utils.SearchCriteriaUtil.findFilter(f, b);
        if (e) {
            return e
        }
    }
    return null
},getNodeFriendlyText:function(e, j, d) {
    if (e.Combine === Explore.model.ASCombineType.Single) {
        var a = Explore.data.IDOLDataStore.getAdvancedSearchCriteria();
        var c = Explore.utils.SearchCriteriaUtil.findFilter(a, e.FilterTag);
        if (c != null) {
            var b = Explore.findMatching(c.ComparatorGroup.Comparators, "IDOLSpecifier", e.Comparator);
            var f = Explore.i18n("is_");
            if (b != null) {
                f = b.FriendlyName
            }
            return c.Name + " " + f + " " + this.getFriendlyValues(c, e.Values).join(",")
        } else {
            return Explore.i18n("filter not found")
        }
    } else {
        if ((j < 0 || j > 0) && e.Criteria && e.Criteria.length > 0) {
            var h = this.getNodeCombineText(e) + " ";
            for (var g = 0; g < e.Criteria.length; g++) {
                if (g > 0) {
                    h = h + (d || ", ")
                }
                h = h + this.getNodeFriendlyText(e.Criteria[g], j - 1, d)
            }
            return h
        } else {
            return Explore.i18n("additionalCriteria_")
        }
    }
},getLanguageFriendlyName:function(c) {
    var b = Explore.data.IDOLDataStore.getAllLanguages();
    for (var a = 0; a < b.length; a++) {
        if (b[a].Key === c) {
            return b[a].Value
        }
    }
    return c
},getSearchCriteriaDescription:function(b) {
    var e = b;
    var d = null;
    if (e != null) {
        d = "";
        if (e.searchTerms !== undefined && e.searchTerms !== null && e.searchTerms !== "") {
            d += '"' + e.searchTerms + '"'
        }
        if (e.documentTypes && e.documentTypes !== "any") {
            d += " " + Explore.i18n("ofType") + " " + e.documentTypes.split("+").toString()
        }
        if (e.filterByDateType == Explore.model.FilterByDateType.Between) {
            var a = Explore.formatDateByPref(e.startDate);
            var c = Explore.formatDateByPref(e.endDate);
            d += " " + String.format(Explore.i18n("between_And_"), a, c)
        } else {
            if (e.filterByDateType >= Explore.model.FilterByDateType.PastDay) {
                d += Explore.i18n(Explore.model.FilterByDateType.getName(e.filterByDateType))
            }
        }
        if (e && (e.language !== null && e.language !== undefined && e.language != "")) {
            d += " " + Explore.i18n("inLanguage") + " " + this.getLanguageFriendlyName(e.language)
        }
        if (e.criteria && e.criteria.Criteria && e.criteria.Criteria.length > 0) {
            d += " " + this.getNodeFriendlyText(e.criteria, -1)
        }
        if (d) {
            d = d.trim()
        }
    }
    return d
}};
Ext.ns("Explore.utils");
Explore.utils.SearchTermParser = (function() {
    var e = {AND:true,OR:true,EOR:true,XOR:true,BEFORE:true,AFTER:true,NOT:true,NEAR:true,DNEAR:true,WNEAR:true,XNEAR:true};

    function f(g) {
        return e[g]
    }

    function c(j) {
        for (var h = 0; h < j.length; h++) {
            var g = j[h];
            if (g.isGroup) {
                return true
            } else {
                if (g.isReserved && g.value != "OR" && g.value != "AND" && g.value != "NOT") {
                    return true
                }
            }
        }
        return false
    }

    function d(j) {
        var l = 0;

        function h() {
            var m = [];
            var p;
            var o = false;
            var q = false;
            var s = 0;
            var t = false;
            for (; l < j.length && !o;
                   l++) {
                p = j.charAt(l);
                switch (p) {case"(":m.push(p);if (!q) {
                    s++;
                    t = true
                }break;case")":m.push(p);if (!q) {
                    s--;
                    o = (s === 0)
                }break;case'"':if ((!q) && (s === 0) && (m.length > 0)) {
                    l--;
                    o = true
                } else {
                    m.push(p);
                    q = !q;
                    o = ((s === 0) && (!q))
                }break;case" ":if (q || s > 0) {
                    m.push(p)
                }o = ((s === 0) && (!q) && (m.length > 0));break;default:m.push(p);
                    break
                }
            }
            var n = null;
            if (m.length > 0 && !q && s === 0) {
                var r = m.join("");
                n = {value:r,isGroup:t,isReserved:f(r)}
            }
            return n
        }

        var g;
        var k = [];
        while ((g = h()) !== null) {
            k.push(g)
        }
        return k
    }

    function a(k, m) {
        var l = d(k);
        var g = [];
        for (var j = 0; j < l.length; j++) {
            var h = l[j];
            if (h.isReserved && m) {
                g.push('"' + h.value + '"')
            } else {
                g.push(h.value)
            }
        }
        return g
    }

    function b(g) {
        return(g.length > 2 && g.charAt(0) == '"' && g.charAt(g.length - 1) === '"')
    }

    return{explodeSearchTerms:function(l) {
        var q = d(l);
        var r = "";
        var n = "";
        var o = "";
        var j = "";
        var m = 0;
        var s = 0;
        if (c(q)) {
            o = l
        } else {
            var p = function(u) {
                var v = "";
                if (m + 2 < q.length && q[m + 1].value === u) {
                    v = q[m].value;
                    do{
                        var t = q[m + 2].value;
                        v += " " + t;
                        m += 2
                    } while (m + 2 < q.length && q[m + 1].value === u)
                }
                return v
            };
            var g = null;
            for (m = 0; m < q.length; m++) {
                var k = q[m];
                var h = (m + 1 < q.length) ? q[m + 1] : null;
                if (k.isReserved) {
                    g = k;
                    if (k.value === "AND") {
                        o += k.value + " "
                    }
                } else {
                    if (h && h.value === "AND" && s === 0) {
                        s++;
                        r += p("AND") + " "
                    } else {
                        if (h && h.value === "OR") {
                            o += p("OR") + " "
                        } else {
                            if (g && g.value === "NOT") {
                                j += k.value + " "
                            } else {
                                if (n === "" && b(k.value)) {
                                    n += k.value.substring(1, k.value.length - 1)
                                } else {
                                    o += k.value + " "
                                }
                            }
                            g = k
                        }
                    }
                }
            }
        }
        return{all:r.trim(),exact:n.trim(),any:o.trim(),not:j.trim()}
    },reduceSearchTerms:function(q) {
        var n,k;
        var p = (q.all || "").trim();
        var l = (q.exact || "").replace(/"/gi, "").trim();
        var r = (q.any || "").trim();
        var j = (q.not || "").trim();
        var g = [];
        if (p !== "") {
            var o = a(p, true);
            var h = false;
            for (n = 0; n < o.length; n++) {
                k = o[n];
                if (k) {
                    g.push((h) ? " AND " : " ");
                    g.push(k);
                    h = true
                }
            }
        }
        if (l !== "") {
            g.push(' "' + l + '"')
        }
        if (r !== "") {
            g.push(" ");
            g.push(r)
        }
        if (j !== "") {
            var m = a(j, true);
            for (n = 0; n < m.length; n++) {
                k = m[n];
                if (k) {
                    g.push(" NOT ");
                    g.push(k)
                }
            }
        }
        return g.join("").trim()
    }}
}());
Ext.ns("Explore.view");
Explore.view.Activities = Ext.extend(Ext.tree.TreePanel, {title:Explore.i18n("Activity"),collapsible:false,useArrows:true,autoScroll:true,animate:false,enableDD:false,containerScroll:true,initComponent:function() {
    var a = this;
    var b = {rootVisible:false,root:Explore.data.DummyDataStore.retrieveDummyActivities()};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.Activities.superclass.initComponent.apply(this, arguments)
}});
Ext.reg("explore.view.activities", Explore.view.Activities);
Explore.view.AdministrationConfigurationDialog = Ext.extend(Explore.base.EditorDialog, {itemDescription:Explore.i18n("Configuration"),labelWidth:300,initComponent:function() {
    var n = this;
    var b = {name:"IDOLAciUrl",fieldLabel:Explore.i18n("IDOLAciUrl"),vtype:"url",allowBlank:false};
    var c = {name:"NotificationServerUrl",fieldLabel:Explore.i18n("NotificationServerUrl"),vtype:"url"};
    var u = {name:"AutomationServerUrl",fieldLabel:Explore.i18n("AutomationServerUrl"),vtype:"url"};
    var m = {name:"CustomerName",itemId:"CustomerName",fieldLabel:Explore.i18n("CustomerName")};
    var p = {name:"QfinitiUrl",fieldLabel:Explore.i18n("QfinitiUrl"),vtype:"url"};
    var q = {name:"MASImportAgentIP",fieldLabel:Explore.i18n("MAS Import Agent IP"),allowBlank:true,itemId:"MASImportAgentIP"};
    var k = {name:"SocialMediaConnectorUrl",fieldLabel:Explore.i18n("SocialMediaConnectorUrl"),allowBlank:true,itemId:"SocialMediaConnetorUrl"};
    var v = {name:"WorkspacesUrl",fieldLabel:Explore.i18n("WorkspacesUrl"),vtype:"url",hidden:!Explore.demoMode};
    var t = {xtype:"selectboxfield",name:"DateTimeFormatDefault",fieldLabel:Explore.i18n("Date & Time Format"),width:230,mode:"local",store:new Ext.data.ArrayStore({id:0,fields:["id","timezone"],data:[
        [0,Explore.i18n(Explore.model.DateFormats.getName(0))],
        [1,Explore.i18n(Explore.model.DateFormats.getName(1))],
        [2,Explore.i18n(Explore.model.DateFormats.getName(2))]
    ]}),valueField:"id",displayField:"timezone",value:Explore.i18n(Explore.model.DateFormats.getName(2))};
    var l = {name:"UseExternalUrlsforMAS",fieldLabel:Explore.i18n("UseExternalUrlsforMAS"),xtype:"checkbox",hidden:true,listeners:{check:function(x, w) {
        n.getByItemId("IDOLACIUrlExternal").allowBlank = !w;
        n.getByItemId("IDOLIndexUrlExternal").allowBlank = !w;
        n.getByItemId("ExploreURLExternal").allowBlank = !w;
        if (w) {
            n.getByItemId("IDOLACIUrlExternal").show();
            n.getByItemId("IDOLIndexUrlExternal").show();
            n.getByItemId("NotificationUrlExternal").show();
            n.getByItemId("ExploreURLExternal").show()
        } else {
            n.getByItemId("IDOLACIUrlExternal").hide();
            n.getByItemId("IDOLIndexUrlExternal").hide();
            n.getByItemId("NotificationUrlExternal").hide();
            n.getByItemId("ExploreURLExternal").hide()
        }
    }}};
    var r = {name:"IDOLACIUrlExternal",fieldLabel:Explore.i18n("IDOLACIUrlExternal"),vtype:"url",allowBlank:!this.editObject.UseExternalUrlsforMAS,itemId:"IDOLACIUrlExternal",hidden:!this.editObject.UseExternalUrlsforMAS};
    var f = {name:"IDOLIndexUrlExternal",vtype:"url",fieldLabel:Explore.i18n("IDOLIndexUrlExternal"),allowBlank:!this.editObject.UseExternalUrlsforMAS,itemId:"IDOLIndexUrlExternal",hidden:!this.editObject.UseExternalUrlsforMAS};
    var h = {name:"NotificationUrlExternal",fieldLabel:Explore.i18n("NotificationUrlExternal"),vtype:"url",itemId:"NotificationUrlExternal",hidden:!this.editObject.UseExternalUrlsforMAS};
    var d = {name:"ExploreURLExternal",fieldLabel:Explore.i18n("ExploreURLExternal"),vtype:"url",allowBlank:!this.editObject.UseExternalUrlsforMAS,itemId:"ExploreURLExternal",hidden:!this.editObject.UseExternalUrlsforMAS};
    var j = {name:"CustomerMASGuid",itemId:"CustomerMASGuid",fieldLabel:Explore.i18n("MAS Account Key")};
    var s = {name:"MASCallbackUrl",itemId:"MASCallbackUrl",fieldLabel:Explore.i18n("AutomationServerCallback")};
    var o = {name:"MASImportAgentACIURL",itemId:"MASImportAgentACIURL",fieldLabel:Explore.i18n("MAS Import Agent URL")};
    var g = {xtype:"fieldset",title:Explore.i18n("General"),defaults:{anchor:"-5",xtype:"textfield"},width:"100%",items:[m,t]};
    var a = {xtype:"fieldset",title:Explore.i18n("Components"),defaults:{anchor:"-5",xtype:"textfield"},width:"100%",items:[b,r,f,k,c,h,d,p]};
    var e = {xtype:"fieldset",title:Explore.i18n("Media Aggregation Service(MAS)"),defaults:{anchor:"-5",xtype:"textfield"},width:"100%",items:[u,q,o,v,l,j,s]};
    n.formItems = [g,a,e];
    Explore.view.AdministrationConfigurationDialog.superclass.initComponent.apply(this, arguments)
},getTitle:function() {
    return Explore.i18n("EditConfiguration")
}});
Ext.reg("explore.view.administrationconfigurationdialog", Explore.view.AdministrationConfigurationDialog);
Ext.ns("Explore.view");
Explore.view.AdministrationConfigurationPanel = Ext.extend(Explore.base.AdministrationDetailPanelBase, {itemDescription:Explore.i18n("Configuration"),labelWidth:300,initComponent:function() {
    var l = this;
    l.readOnly = !Explore.Security.isAuthorized("CONFIGURATION_UPDATE");
    l.permissions = {view:Explore.Security.isAuthorized("CONFIGURATION_VIEW"),update:Explore.Security.isAuthorized("CONFIGURATI ON_UPDATE")};
    var a = {name:"IDOLAciUrl"};
    var b = {name:"NotificationServerUrl"};
    var t = {name:"AutomationServerUrl"};
    var k = {name:"CustomerName"};
    var o = {name:"QfinitiUrl"};
    var s = {name:"SocialMediaConnectorUrl"};
    var p = {name:"MASImportAgentIP"};
    var q = {name:"DateTimeFormatDefault",fieldLabel:Explore.i18n("DateTimeFormat"),tpl:'{[ Explore.i18n(Explore.model.DateFormats.getName(!isNaN(values.DateTimeFormatDefault) ? values.DateTimeFormatDefault : "")) ]}'};
    var d = {name:"WorkspacesUrl",hidden:!Explore.demoMode};
    var e = {name:"IDOLACIUrlExternal",itemId:"IDOLACIUrlExternal",fieldLabel:"test",hidden:true};
    var f = {name:"IDOLIndexUrlExternal",itemId:"IDOLIndexUrlExternal",hidden:true};
    var g = {name:"NotificationUrlExternal",itemId:"NotificationUrlExternal",hidden:true};
    var c = {name:"ExploreURLExternal",itemId:"ExploreURLExternal",hidden:true};
    var m = {name:"CustomerMASGuid",fieldLabel:Explore.i18n("MAS Account Key")};
    var h = {name:"MASCallbackUrl",fieldLabel:Explore.i18n("AutomationServerCallback")};
    var n = {name:"MASImportAgentACIURL",itemId:"MASImportAgentACIURL",fieldLabel:Explore.i18n("MAS Import Agent URL")};
    var r = {itemId:"spaceBox",xtype:"box",height:20};
    var j = {width:100,itemId:"testConfigButton",xtype:"button",text:Explore.i18n("TestConfiguration"),handler:function() {
        var u = new Explore.view.ConfigurationTests();
        u.show()
    }};
    l.formItems = [k,q,a,e,f,s,b,g,c,o,t,p,n,d,m,h,r,j];
    Explore.view.AdministrationConfigurationPanel.superclass.initComponent.apply(this, arguments);
    ConfigurationService.GetConfigurationSettings(function(u, v) {
        l.displayObject(u)
    })
},showHideFields:function(b) {
    var a = this;
    a.getByItemId("WorkspacesUrl").setVisible(Explore.demoMode);
    a.getByItemId("testConfigButton").show();
    if (b.UseExternalUrlsforMAS) {
        a.getByItemId("IDOLACIUrlExternal").show();
        a.getByItemId("IDOLIndexUrlExternal").show();
        a.getByItemId("NotificationUrlExternal").show();
        a.getByItemId("ExploreURLExternal").show()
    } else {
        a.getByItemId("IDOLACIUrlExternal").hide();
        a.getByItemId("IDOLIndexUrlExternal").hide();
        a.getByItemId("NotificationUrlExternal").hide();
        a.getByItemId("ExploreURLExternal").hide()
    }
},displayObject:function(c) {
    var a = this;
    Explore.view.AdministrationConfigurationPanel.superclass.displayObject.call(this, c);
    if (this.topToolbar.getByItemId) {
        var b = this.topToolbar.getByItemId("editButton");
        if (Explore.Security.isAuthorized("CONFIGURATION_UPDATE")) {
            b.setDisabled(false)
        } else {
            b.setDisabled(true)
        }
    }
    a.showHideFields(c)
},getTitleText:function() {
    return String.format(Explore.i18n("_Details"), this.itemDescription) + ": " + this.getObjectName()
},getButtonsConfig:function() {
    var a = this;
    var b = [
        {xtype:"button",itemId:"editButton",iconCls:"edit-icon",text:Explore.i18n("Edit"),tooltip:Explore.i18n("EditSettings"),hidden:false,handler:function() {
            log.info("edit settings");
            a.showEditDialog(a.currentObject)
        }}
    ];
    return b
},showEditDialog:function(c, b) {
    var a = this;
    var d = new Explore.view.AdministrationConfigurationDialog({editObject:c,readOnly:false});
    d.on("save", function() {
        a.onSave(c)
    });
    d.show(a)
},onSave:function(b) {
    var a = this;
    if (!b.UseExternalUrlsforMAS) {
    }
    ConfigurationService.SaveConfiguration(b, function(c) {
        if (c.ErrorCode == 0) {
            a.displayObject(c.Result);
            Ext.MessageBox.show({title:Explore.i18n("appTitle"),msg:Explore.i18n("TheChangesHaveBeenSavedPleaseRestartAllClientsAndTheAutonomyJobScheduler"),buttons:Ext.MessageBox.OK,fn:function() {
                Explore.reload()
            },icon:Ext.MessageBox.INFO})
        } else {
            a.showEditDialog(c.Result)
        }
    })
}});
Ext.reg("explore.view.administrationconfigurationpanel", Explore.view.AdministrationConfigurationPanel);
Ext.ns("Explore.view");
Explore.view.AdministrationDataImportPanel = Ext.extend(Ext.Panel, {initComponent:function() {
    var b = this;
    var a = new Ext.FormPanel({fileUpload:true,region:"center",border:false,frame:false,padding:20,items:[
        {xtype:"fileuploadfield",buttonOnly:true,name:"idxFile",buttonText:"Import IDOL Data",listeners:{fileselected:function(e, d) {
            if (a.getForm().isValid()) {
                a.getForm().submit({fileUpload:true,url:"../Handlers/ImportIdx.ashx",waitMsg:"Importing..",success:function(f, g) {
                    Explore.view.StatusBox.showInfo("Success", g.result.msg)
                },failure:function(f, g) {
                    Explore.view.StatusBox.showWarning("Failed", g.result.msg)
                }})
            }
        }}}
    ]});
    var c = {layout:"border",border:false,items:a};
    Ext.apply(this, Ext.apply(this.initialConfig, c));
    Explore.view.AdministrationDataImportPanel.superclass.initComponent.apply(this, arguments)
}});
Ext.reg("explore.view.administrationdataimportpanel", Explore.view.AdministrationDataImportPanel);
Ext.ns("Explore.view");
Explore.view.AdministrationEngagementPanel = Ext.extend(Explore.base.AdministrationPanelBase, {initComponent:function() {
    var a = this;
    a.itemDescription = Explore.i18n("Engagement");
    a.refresh = function() {
        a.getByItemId("tree").refresh()
    };
    a.permissions = {view:Explore.Security.isAuthorized("ENGAGEMENT_STATUS_VIEW"),create:Explore.Security.isAuthorized("ENGAGEMENT_STATUS_CREATE"),update:Explore.Security.isAuthorized("ENGAGEMENT_STATUS_UPDATE"),"delete":Explore.Security.isAuthorized("ENGAGEMENT_STATUS_DELETE")};
    a.setTreeConfig({title:Explore.i18n("Engagements"),xtype:"explore.view.engagementpicker",showExpandCollapseAll:true,listeners:{engagementStatusSaved:function(b) {
        var c = a.getByItemId("detail");
        c.displayObject(b)
    },engagementStatusDeleted:function(c) {
        var b = a.getByItemId("detail");
        b.displayObject()
    }}});
    a.setDetailConfig({xtype:"explore.view.engagementsdetail",listeners:{newItem:function() {
        a.getTree().newCommand()
    },editItem:function(b) {
        var c = a.getTree().getSelectionModel().getSelectedNode();
        a.getTree().editCommand(c)
    },deleteItem:function(b) {
        var c = a.getTree().getSelectionModel().getSelectedNode();
        a.getTree().deleteCommand(c)
    }}});
    Explore.view.AdministrationEngagementPanel.superclass.initComponent.apply(this, arguments)
}});
Ext.reg("explore.view.administrationengagementpanel", Explore.view.AdministrationEngagementPanel);
Ext.ns("Explore.view");
Explore.view.AdministrationInfluencerPanel = Ext.extend(Explore.base.AdministrationPanelBase, {initComponent:function() {
    var a = this;
    a.permissions = {view:true,create:true,update:true,"delete":true};
    a.itemDescription = Explore.i18n("Project");
    a.setTreeConfig({title:Explore.i18n("Social Media Types"),xtype:"explore.view.influencer.influencetree",permissions:a.permissions});
    a.setDetailConfig({xtype:"explore.view.influencer.influencerdetailpanel",permissions:a.permissions});
    Explore.view.AdministrationInfluencerPanel.superclass.initComponent.apply(this, arguments)
}});
Ext.reg("explore.view.administrationinfluencerpanel", Explore.view.AdministrationInfluencerPanel);
Ext.ns("Explore.view");
Explore.view.AdministrationLexiconPanel = Ext.extend(Explore.base.AdministrationPanelBase, {initComponent:function() {
    var a = this;
    a.itemDescription = Explore.i18n("Lexicon");
    a.permissions = {view:Explore.Security.isAuthorized("LEXICONS_VIEW"),create:Explore.Security.isAuthorized("LEXICONS_CREATE"),update:Explore.Security.isAuthorized("LEXICONS_UPDATE"),"delete":Explore.Security.isAuthorized("LEXICONS_DELETE"),importExport:Explore.Security.isAuthorized("LEXICONS_IMPORT_EXPORT")};
    a.setTreeConfig({title:Explore.i18n("Lexicons"),xtype:"explore.view.lexicontree",rootVisible:true,root:{text:Explore.i18n("AllLexicons"),id:"root",singleClickExpand:true,expanded:true,tag:{type:"SECTION",id:1}}});
    a.setDetailConfig({xtype:"explore.view.lexicondetail"});
    Explore.view.AdministrationLexiconPanel.superclass.initComponent.apply(this, arguments)
}});
Ext.reg("explore.view.administrationlexiconpanel", Explore.view.AdministrationLexiconPanel);
Explore.view.LexiconTree = Ext.extend(Explore.base.AdministrationTreePanel, {itemDescription:Explore.i18n("Lexicon"),initComponent:function() {
    var a = this;
    a.loadFn = Explore.data.LexiconDataStore.getLexicon;
    a.saveFn = Explore.data.LexiconDataStore.saveLexicon;
    a.deleteFn = Explore.data.LexiconDataStore.deleteLexicon;
    a.editDialogFn = Explore.view.LexiconDialog;
    var b = {loader:new Ext.tree.TreeLoader({directFn:LexiconService.GetLexiconNodes})};
    if (!this.hideTools) {
        if (!this.tools) {
            this.tools = []
        }
        if (Explore.Security.isAuthorized("LEXICONS_IMPORT_EXPORT")) {
            this.tools.push({id:"plus",hidden:true,qtip:Explore.i18n("ExapandAll"),handler:function() {
                a.expandAll()
            }});
            this.tools.push({id:"minus",hidden:true,qtip:Explore.i18n("CollapseAll"),handler:function() {
                a.collapseAll()
            }})
        }
        this.tools.push({id:"refresh",qtip:Explore.i18n("refresh"),handler:function() {
            a.refreshForId()
        }})
    }
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.LexiconTree.superclass.initComponent.apply(this, arguments);
    Explore.data.LexiconDataStore.on("lexiconChanged", function(c) {
        a.refreshAndSelectNode(null, c)
    });
    Explore.data.LexiconDataStore.on("lexiconDeleted", function() {
        a.refresh()
    })
},importLexicons:function() {
    var a = this;
    var b = new Explore.view.ImportLexiconWindow();
    b.on("close", function() {
        a.refresh()
    });
    b.start()
},getContextMenu:function(c) {
    var j = this;
    if (!j.contextMenu) {
        var g = {text:String.format(Explore.i18n("New_"), j.itemDescription),itemId:"new",id:"New" + j.itemDescription,iconCls:"new-icon",disabled:!j.permissions.create,handler:function() {
            j.newCommand()
        }};
        var d = {text:Explore.i18n("Create Topics"),itemId:"createToopic",iconCls:"new-icon",disabled:!Explore.Security.isAuthorized("TOPICS_CREATE"),handler:function() {
            j.createTopicFromLexicon(j.contextMenuNode)
        }};
        var e = {text:String.format(Explore.i18n("Edit_"), j.itemDescription),itemId:"edit",id:"Edit" + j.itemDescription,iconCls:"edit-icon",disabled:!j.permissions.update,handler:function() {
            j.contextMenuNode.select();
            if (j.contextMenuNode) {
                var k = j.contextMenuNode.attributes.tag.id;
                j.editCommand(k)
            }
        }};
        var b = {text:String.format(Explore.i18n("Delete_"), j.itemDescription),itemId:"delete",id:"Delete" + j.itemDescription,iconCls:"delete-icon",disabled:!j.permissions["delete"],handler:function() {
            if (j.contextMenuNode) {
                var l = j.contextMenuNode.attributes.tag.id;
                var k = j.contextMenuNode.text;
                j.deleteCommand(l, k)
            }
        }};
        var f = {text:Explore.i18n("Import"),itemId:"lImport",iconCls:"import-icon",disabled:!j.permissions.importExport,handler:j.importLexicons,scope:j};
        var a = {text:Explore.i18n("Export"),itemId:"lRootExport",iconCls:"export-icon",disabled:!j.permissions.importExport,handler:j.exportAll,scope:j};
        var h = {text:Explore.i18n("Export"),itemId:"lExport",iconCls:"export-icon",disabled:!j.permissions.importExport,handler:function() {
            j.exportLexicon(j.contextMenuNode)
        }};
        j.contextMenu = new Ext.menu.Menu({items:[g,d,e,b,"-",f,a,h]})
    }
    if (c.attributes.id === "root") {
        j.contextMenu.getByItemId("createToopic").setVisible(false);
        j.contextMenu.getByItemId("edit").setVisible(false);
        j.contextMenu.getByItemId("delete").setVisible(false);
        j.contextMenu.getByItemId("lImport").setVisible(true);
        j.contextMenu.getByItemId("lExport").setVisible(false);
        j.contextMenu.getByItemId("lRootExport").setVisible(true)
    } else {
        j.contextMenu.getByItemId("createToopic").setVisible(true);
        j.contextMenu.getByItemId("edit").setVisible(true);
        j.contextMenu.getByItemId("delete").setVisible(true);
        j.contextMenu.getByItemId("lImport").setVisible(false);
        j.contextMenu.getByItemId("lExport").setVisible(true);
        j.contextMenu.getByItemId("lRootExport").setVisible(false)
    }
    return j.contextMenu
},createTopicFromLexicon:function(a) {
    var b = a.attributes.tag.id;
    var c = new Explore.view.TopicSectionSelectorDialog({listeners:{topicsectionselected:function(e, d) {
        TopicService.CreateTopicsFromLexicon(b, e, d, function(f) {
            Explore.view.TopicPicker.lastRefresh = new Date();
            if (!f || f.ErrorCode) {
                Explore.view.StatusBox.showError("Error", (!f || !f.Message) ? Explore.i18n("Unexpected Error") : f.Message)
            } else {
                var j = f.Result,g = j.length,h = String.format("{0} Topics were sucessfully created", g);
                Explore.view.StatusBox.showInfo("Topics Created", h)
            }
        })
    }}});
    c.show()
},exportLexicon:function(c) {
    var b = this;
    var c = c || b.getSelectionModel().getSelectedNode();
    if (!c) {
        Explore.view.StatusBox.showWarning(Explore.i18n("SelectATopic"), Explore.i18n("FirstSelectALexiconToExport"))
    } else {
        var a = c.attributes.tag.id;
        Explore.data.LexiconDataStore.exportLexicon(a, function(d) {
            Explore.utils.Exporter.exportTextToXml("text/xml", "lexicons.xml", d.XmlPayloadToString)
        })
    }
},exportAll:function() {
    LexiconService.ExportAllLexicons(function(a) {
        Explore.utils.Exporter.exportTextToXml("text/xml", "AllLexicons.xml", a.XmlPayloadToString)
    })
}});
Ext.reg("explore.view.lexicontree", Explore.view.LexiconTree);
Explore.view.LexiconDetail = Ext.extend(Explore.base.AdministrationDetailPanelBase, {initComponent:function() {
    var a = this;
    a.formItems = [
        {name:"Name",itemId:"Name"},
        {name:"Description",itemId:"Description"},
        {xtype:"explore.view.phraseweights",name:"Phrases",itemId:"Phrases",hideLabel:true,margins:"0 10 10 10",readOnly:true,allowLexicons:false,anchor:"100% -90"},
        {itemId:"allroles",xtype:"explore.view.alllexiconlist",anchor:"100% 97%",getMask:function() {
            return a.getMask()
        },hidden:true}
    ];
    Explore.view.LexiconDetail.superclass.initComponent.apply(this, arguments)
},displayAllLexicons:function(c) {
    var f = this.getByItemId("auditLabel");
    var d = this.getByItemId("Name");
    var e = this.getByItemId("Description");
    var b = this.getByItemId("Phrases");
    var a = this.getByItemId("allroles");
    f.setVisible(!c);
    d.setVisible(!c);
    e.setVisible(!c);
    b.setVisible(!c);
    a.setVisible(c);
    if (c) {
        a.refreshGrid()
    }
},displayObject:function(d) {
    var a = (!d || d.Id === 1);
    Explore.view.LexiconDetail.superclass.displayObject.call(this, d);
    this.displayAllLexicons(a);
    var e = this.topToolbar.getByItemId("newButton");
    var c = this.topToolbar.getByItemId("editButton");
    var f = this.topToolbar.getByItemId("deleteButton");
    var b = this.topToolbar.getByItemId("viewButton");
    b.hide();
    e.setVisible(true);
    c.setVisible(!a);
    f.setVisible(!a);
    e.setDisabled(!this.permissions.create);
    c.setDisabled(!this.permissions.update);
    f.setDisabled(!this.permissions["delete"]);
    this.doLayout()
}});
Ext.reg("explore.view.lexicondetail", Explore.view.LexiconDetail);
Ext.ns("Explore.view");
Explore.view.AdministrationPanel = Ext.extend(Ext.TabPanel, {initComponent:function() {
    var a = this;
    var b = {stateful:true,stateId:"adminTabPanel",deferredRender:true,activeTab:0,margins:"10 0 0 0",border:false,bodyBorder:false,plain:true,cls:"tab-plainheader",defaults:{closable:false,autoScroll:true,border:false,layout:{type:"fit"}},items:a.getTabItems()};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.AdministrationPanel.superclass.initComponent.apply(this, arguments);
    a.on("tabchange", a.onTabChange, a)
},getTabItems:function() {
    var a = [];
    if (Explore.Security.isAuthorized("PROJECTS")) {
        a.push({id:"admin-projects",title:Explore.i18n("Projects"),tabTip:Explore.i18n("linkTooltipAdminProjects"),lazyload:{xtype:"explore.view.administrationprojectspanel"}})
    }
    if (Explore.Security.isAuthorized("SOURCES")) {
        a.push({id:"admin-sources",title:Explore.i18n("Sources"),tabTip:Explore.i18n("linkTooltipSources"),lazyload:{xtype:"explore.view.administrationsourcespanel"}})
    }
    if (Explore.Security.isAuthorized("USERS")) {
        a.push({id:"admin-users",title:Explore.i18n("Users"),tabTip:Explore.i18n("linkTooltipAdminUsers"),lazyload:{xtype:"explore.view.administrationuserspanel"}})
    }
    if (Explore.Security.isAuthorized("ROLES")) {
        a.push({id:"admin-roles",title:Explore.i18n("Roles"),tabTip:Explore.i18n("linkTooltipAdminRoles"),lazyload:{xtype:"explore.view.administrationrolespanel"}})
    }
    if (Explore.Security.isAuthorized("TOPICS")) {
        a.push({id:"admin-topics",title:Explore.i18n("Topics"),tabTip:Explore.i18n("linkTooltipAdminTopics"),listeners:{activate:function(b) {
            var c = b.get(0);
            if (c) {
                c.refresh()
            }
        }},lazyload:{xtype:"explore.view.administrationtopicspanel"}})
    }
    if (Explore.Security.isAuthorized("LEXICONS")) {
        a.push({id:"admin-lexicons",title:Explore.i18n("Lexicons"),tabTip:Explore.i18n("linkTooltipAdminLexicons"),lazyload:{xtype:"explore.view.administrationlexiconpanel"}})
    }
    if (Explore.Security.isAuthorized("ENGAGEMENTS")) {
        a.push({id:"admin-engagements",title:Explore.i18n("Engagements"),tabTip:Explore.i18n("linkTooltipAdminEngagements"),lazyload:{xtype:"explore.view.administrationengagementpanel"}})
    }
    if (true) {
        a.push({id:"admin-influencer",title:Explore.i18n("Influencer"),tabTip:Explore.i18n("Influencer -manage Influencer and definitions"),lazyload:{xtype:"explore.view.administrationinfluencerpanel"}})
    }
    if (Explore.Security.isAuthorized("CONFIGURATION")) {
        a.push({id:"admin-config",title:Explore.i18n("Configuration"),tabTip:Explore.i18n("linkTooltipAdminConfig"),lazyload:{xtype:"explore.view.administrationconfigurationpanel"}})
    }
    if (Explore.demoMode) {
        a.push({id:"admin-data-import",title:Explore.i18n("DataImport"),tabTip:Explore.i18n("ImportData"),cls:"demoMode",lazyload:{xtype:"explore.view.administrationdataimportpanel"}})
    }
    return a
},onTabChange:function(b, a) {
    if (a) {
        if ((a.items === null) || (a.items.length === 0)) {
            if (a.lazyload) {
                a.add(a.lazyload);
                a.doLayout()
            }
        }
    }
}});
Ext.reg("explore.view.administrationpanel", Explore.view.AdministrationPanel);
Ext.ns("Explore.view");
Explore.view.AdministrationProjectsPanel = Ext.extend(Explore.base.AdministrationPanelBase, {initComponent:function() {
    var a = this;
    a.permissions = {view:Explore.Security.isAuthorized("PROJECTS_VIEW"),create:Explore.Security.isAuthorized("PROJECTS_CREATE"),update:Explore.Security.isAuthorized("PROJECTS_UPDATE"),"delete":Explore.Security.isAuthorized("PROJECTS_DELETE")};
    a.itemDescription = Explore.i18n("Project");
    a.setTreeConfig({title:Explore.i18n("Projects"),xtype:"explore.view.projectstree",permissions:a.permissions});
    a.setDetailConfig({xtype:"explore.view.projectsdetail",permissions:a.permissions});
    Explore.view.AdministrationProjectsPanel.superclass.initComponent.apply(this, arguments)
}});
Ext.reg("explore.view.administrationprojectspanel", Explore.view.AdministrationProjectsPanel);
Ext.ns("Explore.view");
Explore.view.AdministrationRolesPanel = Ext.extend(Explore.base.AdministrationPanelBase, {itemDescription:Explore.i18n("Role"),initComponent:function() {
    var a = this;
    a.permissions = {view:Explore.Security.isAuthorized("ROLES_VIEW"),create:Explore.Security.isAuthorized("ROLES_CREATE"),update:Explore.Security.isAuthorized("ROLES_UPDATE"),"delete":Explore.Security.isAuthorized("ROLES_DELETE")};
    a.setTreeConfig({title:Explore.i18n("Roles"),xtype:"explore.view.roletree",showExpandCollapseAll:true});
    a.setDetailConfig({xtype:"explore.view.rolesdetail"});
    Explore.view.AdministrationRolesPanel.superclass.initComponent.apply(this, arguments)
}});
Ext.reg("explore.view.administrationrolespanel", Explore.view.AdministrationRolesPanel);
Explore.view.RoleTree = Ext.extend(Explore.base.AdministrationTreePanel, {itemDescription:Explore.i18n("Role"),initComponent:function() {
    var a = this;
    a.root = new Ext.tree.TreeNode({nodeType:"node",text:Explore.i18n("All Roles"),id:"root-node",expanded:true,tag:{type:-1,id:0,isCustom:false}});
    a.loadFn = Explore.data.UserDataStore.getRole;
    a.saveFn = Explore.data.UserDataStore.saveRole;
    a.deleteFn = Explore.data.UserDataStore.deleteRole;
    a.editDialogFn = Explore.view.RoleDialog;
    Explore.data.UserDataStore.on("roleModified", function(b) {
        a.refreshAndSelectNode(null, b)
    });
    this.loader = new Ext.tree.TreeLoader({directFn:UserService.GetRoleNodes});
    if (!this.tools) {
        this.tools = []
    }
    this.tools.push({id:"refresh",qtip:Explore.i18n("refresh"),handler:function() {
        a.refresh()
    }});
    Explore.view.RoleTree.superclass.initComponent.apply(this, arguments);
    a.refresh();
    this.on("click", function(b) {
        if (b && b.toggle) {
            b.toggle()
        }
    })
},getContextMenu:function() {
    var a = Explore.view.RoleTree.superclass.getContextMenu.call(this);
    if (this.contextMenuNode != null) {
        a.get("ViewRole").hide();
        if (this.contextMenuNode.attributes.tag.id === 0) {
            a.get("DeleteRole").disable();
            a.get("EditRole").disable();
            a.get("NewRole").disable();
            a.doLayout()
        } else {
            if (Explore.Security.isAuthorized("ROLES_DELETE") && this.contextMenuNode.attributes.tag.id != 1) {
                a.get("DeleteRole").enable()
            } else {
                a.get("DeleteRole").disable();
                a.get("EditRole").hide();
                a.get("ViewRole").show()
            }
            if (Explore.Security.isAuthorized("ROLES_UPDATE")) {
                a.get("EditRole").enable()
            } else {
                a.get("EditRole").disable()
            }
            if (Explore.Security.isAuthorized("ROLES_CREATE")) {
                a.get("NewRole").enable()
            } else {
                a.get("NewRole").disable()
            }
            a.doLayout()
        }
    }
    return a
}});
Ext.reg("explore.view.roletree", Explore.view.RoleTree);
Explore.view.RolesDetail = Ext.extend(Explore.base.AdministrationDetailPanelBase, {initComponent:function() {
    var a = this;
    a.formItems = [
        {itemId:"allroles",xtype:"explore.view.allroles",anchor:"100% 100%",getMask:function() {
            return a.getMask()
        },hidden:true},
        {name:"Name"},
        {name:"Description"},
        {xtype:"explore.view.permissionselector",itemId:"permissionselector",hideLabel:true,margins:"0 10 10 10",anchor:"100% -90",readOnly:true,getMask:function() {
            return a.getMask()
        },displayOnlyMode:true}
    ];
    Explore.view.RolesDetail.superclass.initComponent.apply(this, arguments)
},displayObject:function(d) {
    Explore.view.RolesDetail.superclass.displayObject.call(this, d);
    this.getByItemId("allroles").setVisible(!d);
    this.getByItemId("allroles").refreshGrid();
    var e = this.topToolbar.getByItemId("newButton");
    var c = this.topToolbar.getByItemId("editButton");
    var f = this.topToolbar.getByItemId("deleteButton");
    var b = this.topToolbar.getByItemId("viewButton");
    if (d != null) {
        var a = this.getByItemId("permissionselector");
        a.setRoleId(d.Id);
        if (d && d.Id === 1) {
            b.enable();
            b.show();
            c.hide()
        } else {
            b.hide();
            c.show()
        }
    } else {
        c.show();
        b.hide()
    }
},updateButtonState:function() {
    var a = this.currentObject == null;
    if (this.topToolbar.getByItemId) {
        var b = this.topToolbar.getByItemId("editButton");
        if (b) {
            b.setDisabled(a || !Explore.Security.isAuthorized("ROLES_UPDATE"));
            b.setVisible(true)
        }
        var c = this.topToolbar.getByItemId("deleteButton");
        if (c) {
            c.setDisabled(a || (this.currentObject.Id === 1) || !Explore.Security.isAuthorized("ROLES_DELETE"));
            c.setVisible(true)
        }
    }
}});
Ext.reg("explore.view.rolesdetail", Explore.view.RolesDetail);
Ext.ns("Explore.view");
Explore.view.AdministrationSourcesPanel = Ext.extend(Explore.base.AdministrationPanelBase, {itemDescription:Explore.i18n("Source"),initComponent:function() {
    var a = this;
    var b = {disabled:false,iconCls:"new-icon",itemId:"miNewMediaAggregationService",text:Explore.i18n("MediaAggregationService"),hidden:!Explore.Security.isAuthorized("SOURCES_CREATE"),handler:function() {
        var e = a.getTree();
        var f = e.getSelectionModel();
        f.select(e.getTreeNodeById("GROUP:1"));
        e.newCommand()
    }};
    var d = {disabled:false,iconCls:"new-icon",itemId:"miNewSnapshot",text:Explore.i18n("Snapshot"),hidden:!Explore.Security.isAuthorized("SNAPSHOTS_CREATE"),handler:function() {
        var e = a.getTree();
        var f = e.getSelectionModel();
        var g = e.getTreeNodeById("ALL-SNAPSHOTS");
        f.select(g);
        e.newCommand()
    }};
    var c = {disabled:false,iconCls:"new-icon",itemId:"miNewDataImport",text:Explore.i18n("DataImport"),hidden:!Explore.Security.isAuthorized("DATA_IMPORTS_CREATE"),handler:function() {
        var e = a.getTree();
        if (e) {
            e.newDataImport()
        }
    }};
    a.setTreeConfig({title:Explore.i18n("Sources"),tbar:new Ext.Toolbar({height:28,hidden:!(Explore.Security.isAuthorized("SOURCES_CREATE") || Explore.Security.isAuthorized("SNAPSHOTS_CREATE") || Explore.Security.isAuthorized("DATA_IMPORTS_CREATE")),items:[
        {xtype:"button",iconCls:"new-icon",text:Explore.i18n("New"),tooltip:String.format(Explore.i18n("CreateANew_"), Explore.i18n("Source")),handler:function(e) {
            a.onTreeMenuClick(e)
        },menu:new Ext.menu.Menu({items:[c,b,d]})}
    ]}),xtype:"explore.view.datasourcepicker",showExpandCollapseAll:true,includeSnapshots:true});
    a.setDetailConfig({xtype:"explore.view.administrationsourcedetail",getMask:function() {
        return a.getMask()
    },listeners:{newItem:function() {
        var e = a.getTree();
        var f = e.getSelectionModel();
        e.newCommand()
    },editItem:function(h) {
        var e = a.getTree();
        var f = e.getSelectionModel();
        var g = f.getSelectedNode();
        if (g) {
            if (g.leaf) {
                e.editCommand(h)
            } else {
                e.renameGroupCommand(g)
            }
        } else {
            Explore.view.StatusBox.showError(Explore.i18n("Error"), Explore.i18n("Please select a node first"))
        }
    },deleteItem:function(g) {
        if (g.DataSources) {
            var e = a.getTree();
            var f = e.getNodeById("GROUP:" + g.Parent);
            e.confirmDeleteGroup(f, g.Name, g.Id)
        } else {
            a.getTree().deleteCommand(g.Id, g.Name)
        }
    },newSnapshot:function() {
        var e = a.getTree();
        var f = e.getSelectionModel();
        snapShotRoot = (e.getTreeNodeById("ALL-SNAPSHOTS"));
        snapShotRoot.ensureVisible(function() {
            f.select(snapShotRoot);
            e.newCommand()
        });
        e.newCommand()
    },editSnapshot:function(e) {
        a.getTree().editSnapshot(e, null)
    },deleteSnapshot:function(e) {
        a.getTree().confirmDeleteSnapshot(e.Id, e.Name, null)
    },newDataImport:function() {
        var e = a.getTree();
        if (e) {
            e.newDataImport()
        }
    },editDataImport:function(g) {
        var h = g.id;
        var f = g.Name || g.text;
        var e = a.getTree();
        if (e) {
            e.editDataImport(g.attributes.tag.dataimport, f)
        }
    },deleteDataImport:function(g) {
        var f = g.Name || g.text;
        var e = a.getTree();
        if (e) {
            e.deleteDataImport(g.attributes.tag.id, f)
        }
    }}});
    Explore.view.AdministrationSourcesPanel.superclass.initComponent.apply(this, arguments)
},onTreeMenuClick:function(a) {
},onTreeSelectionChange:function(d) {
    var b = this;
    if (d.id === "all-snapshots") {
        b.displaySnapshotGroup(b, b.formatTitleFromSelection(d));
        b.doLayout()
    } else {
        var e = d.attributes.tag.id;
        var c = d.attributes.tag.type;
        log.info("onTreeSelectionChange", e, c);
        if (c === "SOURCE") {
            var a = new Ext.LoadMask(b.body, {msg:Explore.i18n("LoadingSourceInformation")});
            a.show();
            Explore.data.SourceDataStore.getDataSource(e, function(f) {
                b.displaySource(f, b.formatTitleFromSelection(d));
                a.hide()
            })
        } else {
            if (c === "SNAPSHOT") {
                var a = new Ext.LoadMask(b.body, {msg:Explore.i18n("LoadingSourceInformation")});
                a.show();
                Explore.data.SnapshotDataStore.getSnapshot(e, function(f) {
                    b.displaySnapshot(f, b.formatTitleFromSelection(d));
                    a.hide()
                })
            } else {
                if (c === "GROUP") {
                    var a = new Ext.LoadMask(b.body, {msg:Explore.i18n("LoadingSourceInformation")});
                    a.show();
                    Explore.data.SourceDataStore.getDataSourceByGroup(e, function(f) {
                        a.hide();
                        b.displayGroup(f, e, b.formatTitleFromSelection(d));
                        b.doLayout()
                    })
                } else {
                    if (c === "ALL-DATAIMPORTS") {
                        b.displayDataImportGroup(b, b.formatTitleFromSelection(d))
                    } else {
                        if (c === "DATAIMPORT") {
                            b.displayDataImport(d, b.formatTitleFromSelection(d))
                        } else {
                            if (c === "ALL-SNAPSHOTS") {
                                b.displaySnapshotGroup(d, b.formatTitleFromSelection(d))
                            } else {
                                if (c === -1) {
                                    b.displayAllSources(d, b.formatTitleFromSelection(d))
                                }
                            }
                        }
                    }
                }
            }
        }
    }
},displayAllSources:function(b, c) {
    var a = this;
    this.getDetail().displayAllSources(b, c)
},displayDataImportGroup:function(d, e) {
    var c = this;
    var b = this.getDetail().getByItemId("alldataimportlist");
    var a = new Ext.LoadMask(c.body, {msg:Explore.i18n("LoadingDataImportInformation")});
    a.show();
    b.on("dataimportloaded", function() {
        a.hide()
    });
    this.getDetail().displayDataImportGroup(d, e)
},displayDataImport:function(d, e) {
    var c = this;
    var b = this.getDetail().getByItemId("viewdataimport");
    var a = new Ext.LoadMask(c.body, {msg:Explore.i18n("LoadingDataImportInformation")});
    a.show();
    b.on("dataimportloaded", function() {
        a.hide()
    });
    this.getDetail().displayDataImport(d, e)
},displaySource:function(a, b) {
    this.getDetail().displaySource(a, b)
},formatTitleFromSelection:function(a) {
    title = Explore.i18n("SourceDetails_");
    return(a != null) ? String.format("{0} {1}", title, a.getPath("text").replace("/root-node/", "")) : title
},displaySnapshot:function(a, b) {
    this.getDetail().displaySnapshot(a, b)
},displaySnapshotGroup:function(a, b) {
    this.getDetail().displaySnapshotGroup(a, b)
},displayGroup:function(a, c, b) {
    this.getDetail().displayGroup(a, c, b)
}});
Ext.reg("explore.view.administrationsourcespanel", Explore.view.AdministrationSourcesPanel);
Explore.view.AdministrationSourceDetail = Ext.extend(Explore.base.AdministrationDetailPanelBase, {labelWidth:180,initComponent:function() {
    var j = this;
    var a = {itemId:"allsources",anchor:"100% 97%",getMask:function() {
        return j.getMask()
    },xtype:"explore.view.allsources"};
    var t = {name:"Name"};
    var o = {name:"Description"};
    var g = {itemId:"Projects",itemCls:"admin-sources-detail-list",fieldLabel:Explore.i18n("UsedbyProjects"),name:"Projects",xtype:"listview",emptyText:Explore.i18n("NotBeingUsedByAnyProject"),hideHeaders:true,padding:"5",width:250,columns:[
        {dataIndex:"Value"}
    ],store:new Ext.data.JsonStore({fields:[
        {name:"Value"}
    ],data:[]})};
    var n = {xtype:"explore.view.common.doccountcomponent",itemId:"TotalDocumentsIndexed",fieldLabel:Explore.i18n("totalDocumentsIndexed")};
    var f = {itemId:"viewSnapshotResults",xtype:"button",text:Explore.i18n("ViewSnapshotDocuments"),width:100,hidden:true,handler:j.onSearch,scope:j};
    var p = {xtype:"explore.view.sourcelist",itemId:"sourcelist",margins:"0 0 0 0",hidden:true,getMask:function() {
        return j.getMask()
    },anchor:"100% 100%",flex:1};
    var l = {xtype:"explore.view.allsnapshotlist",itemId:"allsnapshotlist",margins:"0 0 0 0",flex:1,hidden:true,getMask:function() {
        return j.getMask()
    },padding:"0",anchor:"100% 100%"};
    var k = {xtype:"explore.view.alldataimportlist",itemId:"alldataimportlist",margins:"0 0 0 0",flex:1,hidden:true,getMask:function() {
        return j.getMask()
    },padding:"0",anchor:"100% 100%"};
    var c = {xtype:"explore.view.dataimportlist",itemId:"viewdataimport",margins:"0 0 0 0",flex:1,hidden:true,padding:"0",anchor:"100% 100%"};
    var r = {name:"LastRefreshed",fieldLabel:Explore.i18n("LastRefreshed")};
    var e = {name:"RefreshSource",fieldLabel:Explore.i18n("RefreshSource")};
    var m = {name:"QueryText",fieldLabel:Explore.i18n("queryText")};
    var d = {name:"AdditionalCriteria",fieldLabel:Explore.i18n("additionalCriteria")};
    var b = {name:"TargetedDatabases",fieldLabel:Explore.i18n("targetedDatabases")};
    var s = {name:"recurring",fieldLabel:Explore.i18n("Recurring")};
    var h = {name:"startTime",fieldLabel:Explore.i18n("Start Time")};
    var q = {name:"Notifications"};
    j.formItems = [a,t,o,m,d,b,n,g,f,p,l,k,c,q,s,h,r];
    Explore.view.AdministrationSourceDetail.superclass.initComponent.apply(this, arguments)
},onSearch:function() {
    var a = this.currentObject;
    var b = new Explore.view.SnapshotResultsDialog({gridType:Explore.model.GridType.Concise,snapshot:a});
    b.show()
},displayObject:function(a) {
    Explore.view.AdministrationSourceDetail.superclass.displayObject.call(this, a)
},getTitleText:function() {
    return String.format(Explore.i18n("_Details"), this.itemDescription) + ": " + this.getObjectName()
},getObjectName:function() {
    var a = this.currentObject;
    if (a && a.Name) {
        return a.Name
    }
    return""
},getButtonsConfig:function() {
    var b = Explore.view.AdministrationSourceDetail.superclass.getButtonsConfig.call(this);
    var a = this;
    b.push({xtype:"button",itemId:"newSnapshotButton",iconCls:"new-icon",text:Explore.i18n("New"),tooltip:String.format(Explore.i18n("CreateANew_"), Explore.i18n("Snapshot")),hidden:true,handler:function() {
        a.fireEvent("newItem")
    }}, {xtype:"button",itemId:"editSnapshotButton",iconCls:"edit-icon",text:Explore.i18n("Edit"),tooltip:String.format(Explore.i18n("Edit_"), Explore.i18n("Snapshot")),hidden:true,handler:function() {
        a.fireEvent("editSnapshot", a.currentObject)
    }}, {xtype:"button",itemId:"deleteSnapshotButton",iconCls:"delete-icon",text:Explore.i18n("Delete"),tooltip:String.format(Explore.i18n("Delete_"), Explore.i18n("Snapshot")),hidden:true,handler:function() {
        a.fireEvent("deleteSnapshot", a.currentObject)
    }}, {xtype:"button",itemId:"newDataImportButton",iconCls:"new-icon",text:Explore.i18n("New"),tooltip:String.format(Explore.i18n("CreateANew_"), Explore.i18n("DataImport")),hidden:true,handler:function() {
        a.fireEvent("newDataImport")
    }}, {xtype:"button",itemId:"editDataImportButton",iconCls:"edit-icon",text:Explore.i18n("Edit"),tooltip:String.format(Explore.i18n("Edit_"), Explore.i18n("DataImport")),hidden:true,handler:function() {
        a.fireEvent("editDataImport", a.currentObject)
    }}, {xtype:"button",itemId:"deleteDataImportButton",iconCls:"delete-icon",text:Explore.i18n("Delete"),tooltip:String.format(Explore.i18n("Delete_"), Explore.i18n("DataImport")),hidden:true,handler:function() {
        a.fireEvent("deleteDataImport", a.currentObject)
    }}, a.getAllAddBtn());
    return b
},getAllAddBtn:function() {
    var a = this;
    var c = {text:String.format(Explore.i18n("New_"), a.itemDescription),iconCls:"new-icon",disabled:!Explore.Security.isAuthorized("SOURCES_CREATE"),handler:function() {
        a.fireEvent("newItem")
    }};
    var d = {itemId:"newDataImportButton2",iconCls:"new-icon",text:Explore.i18n("New") + " " + Explore.i18n("DataImport"),disabled:!Explore.Security.isAuthorized("DATA_IMPORTS_CREATE"),tooltip:String.format(Explore.i18n("CreateANew_"), Explore.i18n("DataImport")),hidden:false,handler:function() {
        a.fireEvent("newDataImport")
    }};
    var b = {itemId:"newSnapshotButton2",iconCls:"new-icon",disabled:!Explore.Security.isAuthorized("SNAPSHOTS_CREATE"),text:Explore.i18n("New") + " " + Explore.i18n("Snapshot"),tooltip:String.format(Explore.i18n("CreateANew_"), Explore.i18n("Snapshot")),hidden:false,handler:function() {
        a.fireEvent("newSnapShot")
    }};
    return{xtype:"button",height:28,width:50,itemId:"alladdmenu",iconCls:"new-icon",text:Explore.i18n("New"),tooltip:String.format(Explore.i18n("CreateANew_"), Explore.i18n("Source")),menu:{xtype:"menu",items:[d,c,b]}}
},hideAllToolBarButtons:function() {
    var c = this.topToolbar.items.items;
    var a = this;
    for (var b = 0; b < c.length; b++) {
        c[b].setDisabled(false);
        c[b].setVisible(false)
    }
},displayAllSources:function(a, b) {
    this.setDetailVisibility(false, "allsources");
    this.hideAllToolBarButtons();
    this.topToolbar.getByItemId("alladdmenu").setVisible(true)
},displaySnapshot:function(a, b) {
    this.displayObject(a);
    this.hideAllToolBarButtons();
    this.topToolbar.getByItemId("newSnapshotButton").setVisible(true);
    this.topToolbar.getByItemId("editSnapshotButton").setVisible(true);
    this.topToolbar.getByItemId("deleteSnapshotButton").setVisible(true);
    this.topToolbar.getByItemId("newSnapshotButton").setDisabled(!Explore.Security.isAuthorized("SNAPSHOTS_CREATE"));
    this.topToolbar.getByItemId("editSnapshotButton").setDisabled(a === null || !Explore.Security.isAuthorized("SNAPSHOTS_UPDATE"));
    this.topToolbar.getByItemId("deleteSnapshotButton").setDisabled(a === null || !Explore.Security.isAuthorized("SNAPSHOTS_DELETE"));
    this.getByItemId("Projects").getStore().removeAll(false);
    this.loadProjectsDataStore(a);
    this.setDetailVisibility(true, "snapshot");
    this.setTitle(b)
},loadProjectsDataStore:function(a) {
    this.getByItemId("Projects").getStore().removeAll(false);
    if ((a != null) && (a.Projects != null)) {
        this.getByItemId("Projects").getStore().loadData(a.Projects)
    }
},displaySource:function(c, j) {
    if (c != null) {
        if (c.LastRefreshed > 0) {
            c.LastRefreshed = Explore.base.getLastRefreshedValue(c)
        } else {
            c.LastRefreshed = Explore.i18n("NotRunYet")
        }
    }
    this.displayObject(c);
    this.hideAllToolBarButtons();
    this.topToolbar.getByItemId("newButton").setVisible(true);
    this.topToolbar.getByItemId("deleteButton").setVisible(true);
    this.topToolbar.getByItemId("editButton").setVisible(true);
    this.topToolbar.getByItemId("newButton").setDisabled(!Explore.Security.isAuthorized("SOURCES_CREATE"));
    this.topToolbar.getByItemId("editButton").setDisabled(!Explore.Security.isAuthorized("SOURCES_UPDATE"));
    this.topToolbar.getByItemId("deleteButton").setDisabled(!Explore.Security.isAuthorized("SOURCES_DELETE"));
    this.getByItemId("Projects").getStore().removeAll(false);
    this.loadProjectsDataStore(c);
    this.setDetailVisibility(true, "source");
    this.setTitle(j);
    var n = c.MasRequest || {},b = c.recurring,e = n["idol.query.completeText"],m = n["idol.query.addionalCriteria"],g = n["idol.query.databasematch"],f = n["schedule.starttime"],h = n["schedule.interval"],a = n["notifications.sendCompleteNotification"],d = n["notifications.sendErrorNotification"],l = n["notifications.sendStartNotification"],k = [];
    a ? k.push(Explore.i18n("On Job Complete")) : "";
    d ? k.push(Explore.i18n("On Job Error")) : "";
    l ? k.push(Explore.i18n("On Job Start")) : "";
    this.getByItemId("startTime").setVisible(!!f && b);
    this.getByItemId("recurring").setValue(b ? String.format(Explore.i18n("Repeats every {0} hours"), h) : Explore.i18n("Does not repeat"));
    if (!!f) {
        this.getByItemId("startTime").setValue(Explore.formatDateByPref(f))
    }
    this.getByItemId("Notifications").setValue(k.join(", "));
    this.getByItemId("TargetedDatabases").setValue(g);
    this.getByItemId("AdditionalCriteria").setValue(m);
    this.getByItemId("QueryText").setValue(e);
    this.getByItemId("TotalDocumentsIndexed").loadCounts("DATA_SOURCE", c.Id)
},displayGroup:function(c, f, e) {
    this.displayObject(c);
    this.hideAllToolBarButtons();
    this.topToolbar.getByItemId("newButton").setVisible(true);
    this.topToolbar.getByItemId("editButton").setVisible(true);
    this.topToolbar.getByItemId("deleteButton").setVisible(true);
    this.topToolbar.getByItemId("newButton").setDisabled(!Explore.Security.isAuthorized("SOURCES_CREATE"));
    this.topToolbar.getByItemId("editButton").setDisabled((f && f == 1) ? true : false || !Explore.Security.isAuthorized("SOURCES_DELETE"));
    this.topToolbar.getByItemId("deleteButton").setDisabled((f && f == 1) ? true : false || !Explore.Security.isAuthorized("SOURCES_DELETE"));
    this.setDetailVisibility(false, "source");
    this.setTitle(e);
    var a = this.getByItemId("allsnapshotlist");
    a.setVisible(false);
    var b = this.getByItemId("sourcelist");
    var d = this.getByItemId("viewSnapshotResults");
    d.setVisible(false);
    if (c == null) {
        b.clearData();
        b.setVisible(false)
    } else {
        b.loadData(f);
        b.setVisible(true)
    }
},setDetailVisibility:function(a, b) {
    if (a != null) {
        this.getByItemId("auditLabel").setVisible(false);
        this.getByItemId("Name").setVisible(a && (b === "source" || (b === "snapshot")));
        this.getByItemId("Description").setVisible(a && (b === "source" || (b === "snapshot")));
        this.getByItemId("startTime").setVisible(false);
        this.getByItemId("recurring").setVisible(a && (b === "source"));
        this.getByItemId("Notifications").setVisible(a && (b === "source"));
        this.getByItemId("LastRefreshed").setVisible(a && (b === "source"));
        this.getByItemId("QueryText").setVisible(a && (b === "source"));
        this.getByItemId("AdditionalCriteria").setVisible(a && (b === "source"));
        this.getByItemId("TargetedDatabases").setVisible(a && (b === "source"));
        this.getByItemId("TotalDocumentsIndexed").setVisible(a && ((b === "source") || (b === "dataimport")));
        this.getByItemId("Projects").setVisible(a);
        this.getByItemId("viewSnapshotResults").setVisible(a && (b === "snapshot"));
        this.getByItemId("allsnapshotlist").setVisible(!a && (b === "snapshot"));
        this.getByItemId("sourcelist").setVisible(!a && (b === "source"));
        this.getByItemId("alldataimportlist").setVisible(!a && (b === "dataimportlist"));
        this.getByItemId("viewdataimport").setVisible(!a && (b === "dataimport"));
        this.getByItemId("allsources").setVisible(b == "allsources")
    }
},displayDataImportGroup:function(b, c) {
    var a = this;
    a.hideAllToolBarButtons();
    a.topToolbar.getByItemId("newDataImportButton").setVisible(true);
    a.topToolbar.getByItemId("editDataImportButton").setVisible(true);
    a.topToolbar.getByItemId("deleteDataImportButton").setVisible(true);
    a.topToolbar.getByItemId("newDataImportButton").setDisabled(!Explore.Security.isAuthorized("DATA_IMPORTS_CREATE"));
    a.topToolbar.getByItemId("editDataImportButton").setDisabled(true || !Explore.Security.isAuthorized("DATA_IMPORTS_UPDATE"));
    a.topToolbar.getByItemId("deleteDataImportButton").setDisabled(true || !Explore.Security.isAuthorized("DATA_IMPORTS_DELETE"));
    a.setTitle(c);
    a.setDetailVisibility(false, "dataimportlist");
    a.getByItemId("alldataimportlist").refreshGrid()
},displayDataImport:function(c, d) {
    var b = this;
    this.displayObject(c);
    b.hideAllToolBarButtons();
    b.topToolbar.getByItemId("newDataImportButton").setVisible(true);
    b.topToolbar.getByItemId("editDataImportButton").setVisible(true);
    b.topToolbar.getByItemId("deleteDataImportButton").setVisible(true);
    b.topToolbar.getByItemId("newDataImportButton").setDisabled(!Explore.Security.isAuthorized("DATA_IMPORTS_CREATE"));
    b.topToolbar.getByItemId("editDataImportButton").setDisabled(!Explore.Security.isAuthorized("DATA_IMPORTS_UPDATE"));
    b.topToolbar.getByItemId("deleteDataImportButton").setDisabled(!Explore.Security.isAuthorized("DATA_IMPORTS_DELETE"));
    b.setTitle(d);
    b.setDetailVisibility(false, "dataimport");
    var a = this.getByItemId("viewdataimport");
    a.setDataImportId(c.attributes.tag.id)
},displaySnapshotGroup:function(c, e) {
    this.displayObject(c);
    this.hideAllToolBarButtons();
    this.topToolbar.getByItemId("newSnapshotButton").setVisible(true);
    this.topToolbar.getByItemId("newSnapshotButton").setDisabled(!Explore.Security.isAuthorized("SNAPSHOTS_CREATE"));
    this.setDetailVisibility(false, "snapshot");
    this.setTitle(e);
    var b = this.getByItemId("sourcelist");
    b.setVisible(false);
    var a = this.getByItemId("allsnapshotlist");
    var d = this.getByItemId("viewSnapshotResults");
    d.setVisible(false);
    if (c == null) {
        a.clearData();
        a.setVisible(false)
    } else {
        a.loadData();
        a.setVisible(true)
    }
},getMask:function() {
    return new Ext.LoadMask(this.body || Ext.getBody(), {msg:Explore.i18n("Loading_")})
}});
Ext.reg("explore.view.administrationsourcedetail", Explore.view.AdministrationSourceDetail);
Ext.ns("Explore.view");
Explore.view.AdministrationTopicsPanel = Ext.extend(Explore.base.AdministrationPanelBase, {initComponent:function() {
    var c = this;
    c.itemDescription = Explore.i18n("Topic");
    c.refresh = function() {
        c.getByItemId("tree").refresh()
    };
    c.permissions = {view:Explore.Security.isAuthorized("TOPICS_VIEW"),create:Explore.Security.isAuthorized("TOPICS_CREATE"),update:Explore.Security.isAuthorized("TOPICS_UPDATE"),"delete":Explore.Security.isAuthorized("TOPICS_DELETE")};
    c.setTreeConfig({title:Explore.i18n("Topics"),getMask:function() {
        return c.getMask()
    },tbar:new Ext.Toolbar({height:28,disabled:!c.permissions.create,items:[
        {xtype:"button",id:"mainMenuTopic",iconCls:"new-icon",text:Explore.i18n("New"),tooltip:String.format(Explore.i18n("CreateANew_"), Explore.i18n("Topic")),disabled:!c.permissions.create,handler:function(d) {
            c.onTreeMenuClick(d)
        },menu:new Ext.menu.Menu({items:[
            {disabled:true,iconCls:"new-icon",itemId:"miNewTopic",text:Explore.i18n("Topic"),handler:function() {
                c.getTree().createTopicInSection()
            }},
            {disabled:true,iconCls:"new-icon",itemId:"miNewTopicGroup",text:Explore.i18n("TopicGroup"),handler:function() {
                c.getTree().createTopicSection()
            }}
        ]})}
    ]}),xtype:"explore.view.topicpicker",checkable:false,showTools:false,showExpandCollapseAll:true,showImportExport:true,listeners:{topicSaved:function(f, d) {
        var e = c.getByItemId("detail");
        e.displayObject(d)
    },topicDeleted:function(e) {
        var d = c.getByItemId("detail");
        d.displayObject()
    }}});
    c.setDetailConfig({xtype:"explore.view.topicsdetail",getMask:function() {
        return c.getMask()
    },listeners:{newItem:function() {
        c.getByItemId("tree").createTopicInSection()
    },editItem:function(d) {
        nodeType = c.getTree().getSelectionModel().getSelectedNode().attributes.tag.type;
        if (nodeType === "SECTION") {
            c.getByItemId("tree").renameTopicSection()
        } else {
            c.getByItemId("tree").editTopic()
        }
    },deleteItem:function(d) {
        nodeType = c.getTree().getSelectionModel().getSelectedNode().attributes.tag.type;
        if (nodeType === "SECTION") {
            c.getByItemId("tree").deleteSection(c.getTree().getSelectionModel().getSelectedNode())
        } else {
            c.getByItemId("tree").deleteTopic()
        }
    }}});
    Explore.view.AdministrationTopicsPanel.superclass.initComponent.apply(this, arguments);
    var b = c.getByItemId("tree"),a = b.getLoader();
    a.on("load", function() {
        var d = b.getRootNode().firstChild;
        d.select();
        b.expandTopNodes()
    })
},onTreeMenuClick:function(b) {
    var a = this.getTree().getSelectionModel().getSelectedNode();
    if (a != null) {
        b.menu.getComponent("miNewTopic").setDisabled(false);
        b.menu.getComponent("miNewTopicGroup").setDisabled((a.attributes.tag.type === "SECTION") ? false : true)
    }
},onTreeSelectionChange:function(d) {
    var b = this;
    var g = d.attributes.tag.id;
    var c = d.attributes.tag.type;
    log.info("onTreeSelectionChange", g, c);
    var a = b.getMask();
    if (c === "TOPIC") {
        a.show();
        Explore.data.TopicDataStore.getTopic(g, function(j) {
            a.hide();
            var h = b.getByItemId("tree");
            b.getDetail().displayObject(j, b.formatTitleFromSelection(h.getSelectionModel().getSelectedNode()))
        })
    } else {
        if (c === "SECTION") {
            a.show();
            var e = this.getByItemId("alltopiclist");
            e.on("topicgrouploaded", function() {
                a.hide()
            });
            var f = d.attributes.tag.readOnly;
            this.getDetail().displaySection(b, g, b.formatTitleFromSelection(d), d.text, f);
            b.doLayout()
        } else {
            b.displayObject(null)
        }
    }
},formatTitleFromSelection:function(a) {
    if (a && a.text) {
        return a.text
    }
    return""
}});
Ext.reg("explore.view.administrationtopicspanel", Explore.view.AdministrationTopicsPanel);
Explore.view.TopicsDetail = Ext.extend(Explore.base.AdministrationDetailPanelBase, {labelWidth:200,initComponent:function() {
    var a = this;
    a.formItems = [
        {name:"Name"},
        {name:"Description"},
        {name:"Target",tpl:"{Target} " + Explore.i18n("perDay")},
        {name:"EnableRootCauseAnalysis",tpl:"{[values.EnableRootCauseAnalysis ? Explore.i18n('Yes') : Explore.i18n('No')]}"},
        {xtype:"explore.view.phraseweights",name:"Phrases",hideLabel:true,margins:"0 10 10 10",allowLexicons:true,readOnly:true,anchor:"100% -180",hidden:true},
        {itemId:"searchcriteriasummarylink",xtype:"explore.view.searchcriteriasummarylink",readOnly:true,fieldLabel:Explore.i18n("SearchCriteria"),hidden:true},
        {itemId:"alltopiclist",xtype:"explore.view.alltopiclist",anchor:"100% 97%",flex:1,hidden:true}
    ];
    Explore.view.TopicsDetail.superclass.initComponent.apply(this, arguments)
},displayObject:function(c, e) {
    Explore.view.TopicsDetail.superclass.displayObject.call(this, c);
    var g = null;
    if (c != null) {
        g = c.SearchInfo
    }
    this.getByItemId("searchcriteriasummarylink").setValue(g);
    this.setDetailVisibility(true);
    this.setTitle(e);
    var d = this.topToolbar.getByItemId("newButton");
    var b = this.topToolbar.getByItemId("editButton");
    var f = this.topToolbar.getByItemId("deleteButton");
    var a = this.topToolbar.getByItemId("viewButton");
    a.hide();
    d.setDisabled(!this.permissions.create);
    b.setDisabled(!this.permissions.update);
    f.setDisabled(!this.permissions["delete"])
},displaySection:function(e, a, j, c, k) {
    Explore.view.TopicsDetail.superclass.displayObject.call(this, e);
    this.setTitle(j);
    this.setDetailVisibility(false);
    var b = this.topToolbar.getByItemId("newButton");
    var d = this.topToolbar.getByItemId("editButton");
    var h = this.topToolbar.getByItemId("deleteButton");
    var g = this.topToolbar.getByItemId("viewButton");
    g.hide();
    b.setDisabled(!this.permissions.create);
    d.setDisabled(k || !this.permissions.update);
    h.setDisabled(k || !this.permissions["delete"]);
    this.topToolbar.getByItemId("newButton").setVisible(true);
    this.topToolbar.getByItemId("editButton").setVisible(true);
    this.topToolbar.getByItemId("deleteButton").setVisible(true);
    this.topToolbar.getByItemId("newButton").setDisabled(!this.permissions.create);
    this.topToolbar.getByItemId("editButton").setDisabled(k || !this.permissions.update);
    this.topToolbar.getByItemId("deleteButton").setDisabled(k || !this.permissions["delete"]);
    var f = this.getByItemId("alltopiclist");
    f.setVisible(false);
    if (e == null) {
        f.clearData();
        sourceList.setVisible(false)
    } else {
        f.loadData(a);
        f.setVisible(true)
    }
    this.getByItemId("Name").setValue(c)
},setDetailVisibility:function(a) {
    if (a != null) {
        this.getByItemId("Name").setVisible(true);
        this.getByItemId("Description").setVisible(a);
        this.getByItemId("Target").setVisible(a);
        this.getByItemId("EnableRootCauseAnalysis").setVisible(a);
        this.getByItemId("Phrases").setVisible(a);
        this.getByItemId("searchcriteriasummarylink").setVisible(a);
        this.getByItemId("auditLabel").setVisible(a);
        this.getByItemId("alltopiclist").setVisible(!a)
    }
}});
Ext.reg("explore.view.topicsdetail", Explore.view.TopicsDetail);
Ext.ns("Explore.view");
Explore.view.AdministrationUsersPanel = Ext.extend(Explore.base.AdministrationPanelBase, {initComponent:function() {
    var a = this;
    a.itemDescription = Explore.i18n("User");
    a.permissions = {view:Explore.Security.isAuthorized("USERS_VIEW"),create:Explore.Security.isAuthorized("USERS_CREATE"),update:Explore.Security.isAuthorized("USERS_UPDATE"),"delete":Explore.Security.isAuthorized("USERS_DELETE")};
    a.setTreeConfig({title:Explore.i18n("Users"),getMask:function() {
        return a.getMask()
    },xtype:"explore.view.userpicker",showExpandCollapseAll:true,rootVisible:true,root:{text:Explore.i18n("AllUsers"),id:"root",expanded:true,tag:{type:"SECTION",id:1}}});
    a.setDetailConfig({xtype:"explore.view.usersdetail",getMask:function() {
        return a.getMask()
    },listeners:{newItem:function() {
        var b = a.getTree().getSelectionModel().getSelectedNode();
        a.getTree().newCommand()
    },editItem:function(b) {
        var c = a.getTree().getSelectionModel().getSelectedNode();
        var d = new Explore.view.UserDialog({editObject:b,readOnly:false});
        d.on("save", function() {
            a.getTree().onSave(b)
        });
        d.show(a.getTree())
    },deleteItem:function(b) {
        var d = a.getTree().getSelectionModel().getSelectedNode();
        if (d) {
            var e = d.attributes.tag.id;
            var c = d.text;
            if (e) {
                a.getTree().deleteCommand(e, c)
            } else {
                e = d.attributes.tag.groupId;
                a.getTree().checkForUsers(d.childNodes, d.parentNode, c, e)
            }
        }
    },editgroup:function() {
        var b = a.getTree().getSelectionModel().getSelectedNode();
        var c = b.attributes.tag.groupId;
        if (!c || c == 1) {
            return
        }
        Explore.view.StatusBox.prompt(Explore.i18n("appTitle"), Explore.i18n("EnterGroupName"), b.attributes.text, function(d) {
            if (d) {
                Explore.data.UserDataStore.renameGroup(c, d, function(e) {
                    if (e.ErrorCode == 0) {
                    } else {
                        Explore.view.StatusBox.showError(Explore.i18n("appTitle"), e.Message)
                    }
                })
            }
        })
    },deletegroup:function() {
        var c = a.getTree().getSelectionModel().getSelectedNode();
        var b = c.attributes.text;
        if (a.getTree().getRootNode().attributes.text == b) {
            Explore.view.StatusBox.showWarning(Explore.i18n("appTitle"), String.format(Explore.i18n("_GroupCanNotBeDeleted"), b))
        } else {
            var d = c.attributes.tag.groupId;
            a.getTree().confirmDelete(c.parentNode, b, d)
        }
    }}});
    Explore.view.AdministrationUsersPanel.superclass.initComponent.apply(this, arguments)
},getMask:function() {
    return new Ext.LoadMask(this.getEl() || Ext.getBody(), {msg:Explore.i18n("LoadingSourceInformation")})
},onTreeSelectionChange:function(d) {
    var b = this;
    var f = d.attributes.tag.id;
    var c = d.attributes.tag.type;
    log.info("onTreeSelectionChange", c, f);
    if (c === "USER") {
        var e = this.getTree().loadFn;
        var a = b.getMask();
        a.show();
        e(f, function(g) {
            a.hide();
            b.displayObject(g)
        })
    } else {
        f = d.attributes.tag.groupId;
        b.getDetail().displayUserGroup(f)
    }
}});
Ext.reg("explore.view.administrationuserspanel", Explore.view.AdministrationUsersPanel);
Explore.view.UsersDetail = Ext.extend(Explore.base.AdministrationDetailPanelBase, {initComponent:function() {
    var a = this;
    a.formItems = [
        {xtype:"explore.view.alluserlist",getMask:function() {
            return a.getMask()
        },itemId:"alluserlist"},
        {fieldLabel:Explore.i18n("Name"),name:"FullNameFML"},
        {name:"Login"},
        {fieldLabel:Explore.i18n("Group"),name:"Group.Name"},
        {fieldLabel:Explore.i18n("Role"),name:"Role.Name"},
        {name:"Email"},
        {name:"EmployeeId"},
        {name:"Address",tpl:"{Address} {City} {State} {Zip}"},
        {name:"Phone"},
        {fieldLabel:Explore.i18n("Notifications"),tpl:"{[values.EnableNotifications ? Explore.i18n('Enabled') : Explore.i18n('Disabled')]}"}
    ];
    Explore.view.UsersDetail.superclass.initComponent.apply(this, arguments)
},displayObject:function(a) {
    Explore.view.UsersDetail.superclass.displayObject.call(this, a);
    var b = this.getByItemId("alluserlist");
    b.setVisible(!a)
},displayUserGroup:function(d) {
    this.displayObject(null);
    var c = this.getByItemId("alluserlist");
    c.refreshGrid(d);
    if (d === 1) {
        var b = this.topToolbar.getByItemId("deleteUserGroupButton");
        var a = this.topToolbar.getByItemId("editUserGroup");
        b.disable();
        a.disable()
    }
},getButtonsConfig:function() {
    var b = Explore.view.UsersDetail.superclass.getButtonsConfig.call(this);
    var a = this;
    b.push({xtype:"button",itemId:"editUserGroup",iconCls:"edit-icon",text:Explore.i18n("Edit"),tooltip:String.format(Explore.i18n("Edit_"), Explore.i18n("UserGroup")),hidden:true,handler:function() {
        a.fireEvent("editgroup")
    }});
    b.push({xtype:"button",itemId:"deleteUserGroupButton",iconCls:"delete-icon",text:Explore.i18n("Delete"),tooltip:String.format(Explore.i18n("Delete_"), Explore.i18n("UserGroup")),hidden:true,handler:function() {
        a.fireEvent("deletegroup")
    }});
    return b
},hideAllToolBarButtons:function() {
    var c = this.topToolbar.items.items;
    var a = this;
    for (var b = 0; b < c.length; b++) {
        c[b].setDisabled(false);
        c[b].setVisible(false)
    }
},updateButtonState:function() {
    var c = this.currentObject == null;
    if (this.topToolbar.getByItemId) {
        this.hideAllToolBarButtons();
        if (!c) {
            var b = this.topToolbar.getByItemId("newButton");
            if (b) {
                b.show();
                b.setDisabled(!this.permissions.create)
            }
            var d = this.topToolbar.getByItemId("editButton");
            if (d) {
                d.show();
                d.setDisabled(!this.permissions.update)
            }
            var f = this.topToolbar.getByItemId("deleteButton");
            if (f) {
                f.show();
                f.setDisabled(!this.permissions["delete"] || (currentUser.Id === this.currentObject.Id) || (this.currentObject.Id === 1))
            }
        } else {
            var b = this.topToolbar.getByItemId("newButton");
            if (b) {
                b.show();
                b.setDisabled(!this.permissions.create)
            }
            var a = this.topToolbar.getByItemId("editUserGroup");
            if (a) {
                a.show();
                a.setDisabled(!this.permissions.update)
            }
            var e = this.topToolbar.getByItemId("deleteUserGroupButton");
            if (e) {
                e.show();
                e.setDisabled(!this.permissions["delete"])
            }
        }
    }
}});
Ext.reg("explore.view.usersdetail", Explore.view.UsersDetail);
Ext.ns("Explore.view");
Explore.view.AdvancedSearchCriteriaDialog = Ext.extend(Explore.base.EditorDialog, {itemDescription:Explore.i18n("Search"),EMPTY_ITEM_ID:"-",readOnly:false,showName:true,showSearchTerms:true,saveButtonText:Explore.i18n("Save"),height:500,width:650,layout:"vbox",layoutConfig:{align:"stretch"},stateful:true,stateId:"AdvancedSearchCriteriaDialog",initComponent:function() {
    var a = this;
    a.formItems = [];
    if (this.showName) {
        a.formItems.push({name:"Name",xtype:a.readOnly ? "displayfield" : "textfield"})
    }
    if (this.showSearchTerms) {
        a.formItems.push({xtype:"trigger",itemId:"searchTerms",itemCls:"search-wizard-trigger",allowBlank:false,fieldLabel:Explore.i18n("Search Expression"),onTriggerClick:function() {
            var b = a.getByItemId("searchTerms").getValue();
            var c = new Explore.view.SearchExpressionDialog({editObject:b,listeners:{save:function(e, d) {
                a.getByItemId("searchTerms").setValue(d)
            }}});
            c.show()
        }})
    }
    a.formItems.push({itemId:"typesField",xtype:"multiselectdropdown",fieldLabel:Explore.i18n("Types"),store:new Ext.data.JsonStore({fields:["Id","Name"],data:[]}),valueField:"Id",displayField:"Name",allowBlank:false,editable:false,valueSeparator:"+",disabled:true,showAllCheckbox:true,allItemsText:Explore.i18n("All Types"),allItemsValue:"--ALL--",listeners:{afterrender:function(e) {
        var c = Explore.data.IDOLDataStore.getSupportedDocTypes();
        var b = [];
        for (var d = 0; d < c.length; d++) {
            b.push({Id:c[d],Name:c[d]})
        }
        e.getStore().loadData(b);
        e.initValue();
        e.setDisabled(false)
    }}});
    a.formItems.push({xtype:"explore.view.common.daterangepicker",itemId:"dateRangePicker",fieldLabel:Explore.i18n("Date"),horizontalLayout:true,defaultValues:{showStartDate:(this.editObject.TimeWindow === Explore.model.FilterByDateType.Between),showEndDate:(this.editObject.TimeWindow === Explore.model.FilterByDateType.Between),startDate:this.editObject.FromDate ? new Date(this.editObject.FromDate) : new Date(new Date().setYear(1900 + new Date().getYear() - 1)),endDate:this.editObject.ToDate ? new Date(this.editObject.ToDate) : new Date(),dateType:(this.editObject && this.editObject.TimeWindow !== null && this.editObject.TimeWindow !== undefined) ? this.editObject.TimeWindow : Explore.model.FilterByDateType.Any}});
    Explore.view.AdvancedSearchCriteriaDialog.superclass.initComponent.apply(this, arguments)
},createWindowItems:function() {
    var a = Explore.view.AdvancedSearchCriteriaDialog.superclass.createWindowItems.apply(this, arguments);
    a.push({hideLabel:true,itemId:"searchcriteriabuilder",xtype:"explore.view.searchbuilder.searchcriteriagroup",readOnly:false,flex:1,isTop:true});
    return a
},getTitle:function() {
    if (this.editObject.name) {
        return Explore.i18n("EditSavedSearch") + this.editObject.name
    } else {
        return Explore.i18n("SearchOptions")
    }
},isDirty:function() {
    var a = Explore.view.AdvancedSearchCriteriaDialog.superclass.isDirty.call(this);
    if (!a) {
        a = this.getByItemId("searchcriteriabuilder").isDirty()
    }
    return a
},isValid:function() {
    var a = true;
    if (this.showSearchTerms) {
        if (!this.getByItemId("searchTerms").isValid()) {
            a = false
        }
    }
    if (!this.getByItemId("typesField").isValid()) {
        a = false
    }
    if (!this.getByItemId("searchcriteriabuilder").isValid()) {
        a = false
    }
    return a
},displayObject:function() {
    Explore.view.AdvancedSearchCriteriaDialog.superclass.displayObject.call(this);
    var a = this;
    var c = this.editObject;
    log.debug("Displaying search criteria", c);
    if (this.showSearchTerms) {
        a.getByItemId("searchTerms").setValue(c.searchTerms)
    }
    var b = c.documentTypes;
    if (b === undefined || b === null || b === "") {
        b = "--ALL--"
    }
    a.getByItemId("typesField").setValue(b);
    a.getByItemId("dateRangePicker").populateUI(c);
    a.getByItemId("searchcriteriabuilder").setCriteria(c.criteria)
},populateObject:function() {
    Explore.view.AdvancedSearchCriteriaDialog.superclass.populateObject.call(this);
    var b = this;
    var a = this.editObject;
    if (this.showSearchTerms) {
        a.searchTerms = b.getByItemId("searchTerms").getValue()
    } else {
        a.searchTerms = ""
    }
    var c = b.getByItemId("typesField").getValue();
    if (c === "--ALL--") {
        c = ""
    }
    a.documentTypes = c;
    b.getByItemId("dateRangePicker").populateObject(a);
    a.criteria = b.getByItemId("searchcriteriabuilder").getCriteria();
    log.debug("Saving search criteria", a)
}});
AJAXSessionInterceptor = (function() {
    return{onBeforeRequest:function(b, a) {
    },requestcomplete:function(c, a, b) {
        try {
            var d = Ext.decode(a.responseText);
            if (d.redirect && d.redirectUrl) {
                AJAXSessionInterceptor.redirect(d.redirectUrl)
            }
        } catch(f) {
        }
    },exception:function(c, a, b) {
        try {
            var d = Ext.decode(a.responseText);
            if (d.redirect && d.redirectUrl) {
                AJAXSessionInterceptor.redirect(d.redirectUrl)
            }
        } catch(f) {
        }
    },redirect:function(a) {
        Ext.MessageBox.show({title:Explore.i18n("SessionTimedOutTitle"),msg:Explore.i18n("SessionTimedOutMsg"),buttons:Ext.MessageBox.OK,fn:function() {
            window.location = a
        },icon:Ext.MessageBox.WARNING})
    }}
})();
Ext.Ajax.timeout = 120 * 1000;
Ext.Ajax.on("beforerequest", AJAXSessionInterceptor.onBeforeRequest);
Ext.Ajax.on("requestcomplete", AJAXSessionInterceptor.requestcomplete);
Ext.Ajax.on("requestexception", AJAXSessionInterceptor.exception);
Ext.ns("Explore.view");
Explore.view.AllDataImportList = Ext.extend(Ext.Panel, {initComponent:function() {
    var a = this;
    var c = this.initialConfig || {};
    var b = {frame:false,layout:"fit",pageSize:50,items:[a.getGrid()]};
    Ext.apply(this, Ext.apply(b, this.initialConfig));
    Explore.view.AllDataImportList.superclass.initComponent.apply(this, arguments)
},calculateProjects:function(b, a) {
    var d = "";
    if (a.Projects.length > 0) {
        for (var c = 0; c < a.Projects.length - 1; c++) {
            d += a.Projects[c].Value + ", "
        }
        d += a.Projects[a.Projects.length - 1].Value
    }
    return d
},calculateLastImported:function(b, f) {
    var e = f.Executions;
    if (e && e.length > 0) {
        var a = 0;
        var c = 0;
        for (var d = 0; d < e.length; d++) {
            if (a < e[d].ImportDate) {
                a = e[d].ImportDate;
                c = d
            }
        }
        a = Explore.formatDateByPref(e[c].ImportDate);
        return a
    } else {
        return"N/A"
    }
},getGrid:function() {
    var b = this;
    if (!this.grid) {
        var a = new Explore.view.DocCountColumn({header:Explore.i18n("totalDocumentsIndexed"),id:"totalDocumentsIndexed",width:300,defaultType:"DATA_IMPORT"});
        var c = new Ext.grid.ColumnModel({defaults:{width:300,sortable:false},columns:[
            {header:Explore.i18n("DataImportName"),sortable:false,dataIndex:"Name",id:"name"},
            {header:Explore.i18n("Description"),dataIndex:"Description",id:"description"},
            {header:Explore.i18n("Projects"),dataIndex:"Projects",id:"projects"},
            {header:Explore.i18n("LastImported"),dataIndex:"LastImported",id:"lastimport"},
            {header:Explore.i18n("RepeatImport"),dataIndex:"RepeatImport",id:"repeatimport",renderer:function(d) {
                return(d) ? Explore.i18n("Yes") : Explore.i18n("No")
            }},
            a
        ]});
        this.grid = new Ext.grid.GridPanel({itemId:"grid",region:"center",border:false,disableSelection:true,store:b.getStore(),colModel:c,viewConfig:{autoFill:true,forceFit:true},plugins:[a],bbar:new Ext.PagingToolbar({pageSize:b.pageSize,store:b.getStore(),hidden:true,buttonAlign:"right"})})
    }
    return this.grid
},getStore:function() {
    var b = this;
    if (!this.store) {
        var a = new Ext.data.JsonReader({root:"",fields:[
            {name:"Id",mapping:"Id"},
            {name:"Name",mapping:"Name"},
            {name:"Description",mapping:"Description"},
            {name:"Projects",convert:b.calculateProjects},
            {name:"LastImported",convert:b.calculateLastImported},
            {name:"RepeatImport",mapping:"Repeat"},
            {name:"TotalDocumentsIndexed",mapping:"TotalDocumentsIndexed"}
        ]});
        this.store = new Ext.data.Store({reader:a})
    }
    return this.store
},refreshGrid:function() {
    var b = this;
    var a = b.getStore();
    a.loadData([]);
    Explore.data.DataImportStore.listAllDataImports(function(c) {
        b.fireEvent("dataimportloaded");
        a.loadData(c)
    })
}});
Ext.reg("explore.view.alldataimportlist", Explore.view.AllDataImportList);
Ext.ns("Explore.view");
Explore.view.AllEngagements = Ext.extend(Ext.Panel, {initComponent:function() {
    var a = this;
    var c = this.initialConfig || {};
    var b = {frame:false,layout:"fit",items:[a.getGrid()]};
    Ext.apply(this, Ext.apply(b, this.initialConfig));
    Explore.view.AllEngagements.superclass.initComponent.apply(this, arguments)
},getGrid:function() {
    var a = this;
    if (!this.grid) {
        var b = new Ext.grid.ColumnModel({defaults:{width:300,sortable:false},columns:[
            {header:Explore.i18n("EngagementName"),sortable:false,id:"name"},
            {header:Explore.i18n("Engagement Description"),sortable:false,id:"description"},
            {header:Explore.i18n("Last Modified"),id:"LastModified"}
        ]});
        this.grid = new Ext.grid.GridPanel({itemId:"grid",region:"center",border:false,disableSelection:true,store:a.getStore(),colModel:b})
    }
    return this.grid
},getStore:function() {
    var b = this;
    if (!this.store) {
        var a = new Ext.data.JsonReader({root:"",fields:[
            {name:"Engagment Name",mapping:"Name"},
            {description:"Description",mapping:"Description"},
            {name:"Last Modified",convert:function(d, c) {
                var e = c.LastModified;
                return Explore.formatDateByPref(e)
            }}
        ]});
        this.store = new Ext.data.Store({reader:a})
    }
    return this.store
},refreshGrid:function() {
    var c = this;
    var b = c.getStore();
    b.loadData([]);
    var a = new Ext.LoadMask(c.body, {msg:Explore.i18n("Loading Engagment Status List")});
    a.show();
    Explore.data.EngagementDataStore.listAll(function(d) {
        a.hide();
        b.loadData(d)
    })
}});
Ext.reg("explore.view.allengagements", Explore.view.AllEngagements);
Ext.ns("Explore.view");
Explore.view.AllLexiconList = Ext.extend(Ext.Panel, {initComponent:function() {
    var a = this;
    var c = this.initialConfig || {};
    var b = {frame:false,layout:"fit",items:[a.getGrid()]};
    Ext.apply(this, Ext.apply(b, this.initialConfig));
    Explore.view.AllLexiconList.superclass.initComponent.apply(this, arguments)
},getGrid:function() {
    var a = this;
    if (!this.grid) {
        var b = new Ext.grid.ColumnModel({defaults:{width:300,sortable:false},columns:[
            {header:Explore.i18n("Lexicon Name"),sortable:false,id:"name"},
            {header:Explore.i18n("Lexicon Description"),id:"description"},
            {header:Explore.i18n("Last Modified"),id:"LastModified"}
        ]});
        this.grid = new Ext.grid.GridPanel({itemId:"grid",region:"center",border:false,disableSelection:true,store:a.getStore(),colModel:b})
    }
    return this.grid
},getStore:function() {
    var b = this;
    if (!this.store) {
        var a = new Ext.data.JsonReader({root:"",fields:[
            {name:"Role Name",mapping:"Name"},
            {name:"Description",mapping:"Description"},
            {name:"Last Modified",convert:function(d, c) {
                var e = c.LastModified;
                return Explore.formatDateByPref(e)
            }}
        ]});
        this.store = new Ext.data.Store({reader:a})
    }
    return this.store
},refreshGrid:function() {
    var c = this;
    var b = c.getStore();
    b.loadData([]);
    var a = c.getMask();
    a.show();
    Explore.data.LexiconDataStore.getLexicons(function(d) {
        a.hide();
        b.loadData(d)
    })
},getMask:function() {
    return new Ext.LoadMask(this.body || Ext.getBody(), {msg:Explore.i18n("Loading Lexicon List")})
}});
Ext.reg("explore.view.alllexiconlist", Explore.view.AllLexiconList);
Ext.ns("Explore.view");
Explore.view.AllProjects = Ext.extend(Ext.Panel, {initComponent:function() {
    var a = this;
    var c = this.initialConfig || {};
    var b = {frame:false,layout:"fit",anchor:"100% 97%",items:[a.getGrid()]};
    Ext.apply(this, Ext.apply(b, this.initialConfig));
    Explore.view.AllProjects.superclass.initComponent.apply(this, arguments)
},getGrid:function() {
    var b = this;
    if (!this.grid) {
        var a = new Explore.view.DocCountColumn({header:Explore.i18n("Documents"),id:"Documents",dataIndex:"Documents",defaultType:"PROJECT"});
        var c = new Ext.grid.ColumnModel({defaults:{width:300,sortable:false},columns:[
            {header:Explore.i18n("Project Name"),sortable:false,dataIndex:"Name",id:"name"},
            {header:Explore.i18n("Project Description"),dataIndex:"Description",id:"description"},
            {header:Explore.i18n("Last Modified"),dataIndex:"LastModified",id:"LastModified"},
            a
        ]});
        this.grid = new Ext.grid.GridPanel({itemId:"grid",region:"center",border:false,disableSelection:true,viewConfig:{forceFit:true},plugins:[a],autoExpandColumn:"LastModified",region:"center",store:b.getStore(),colModel:c})
    }
    return this.grid
},getStore:function() {
    var b = this;
    if (!this.store) {
        var a = new Ext.data.JsonReader({root:"",fields:[
            {name:"Id",mapping:"Id"},
            {name:"Name",mapping:"Name"},
            {name:"Description",mapping:"Description"},
            {name:"LastModified",convert:function(d, c) {
                var e = c.LastModified;
                return Explore.formatDateByPref(e)
            }}
        ]});
        this.store = new Ext.data.Store({reader:a})
    }
    return this.store
},refreshGrid:function() {
    var c = this;
    var b = c.getStore();
    b.loadData([]);
    var a = c.getMask();
    a.show();
    Explore.data.ProjectDataStore.listAll(function(d) {
        a.hide();
        b.loadData(d)
    })
},getMask:function() {
    return new Ext.LoadMask(this.body || Ext.getBody(), {msg:Explore.i18n("Loading Data Import List")})
}});
Ext.reg("explore.view.allprojects", Explore.view.AllProjects);
Ext.ns("Explore.view");
Explore.view.AllRoles = Ext.extend(Ext.Panel, {initComponent:function() {
    var a = this;
    var c = this.initialConfig || {};
    var b = {frame:false,layout:"fit",items:[a.getGrid()]};
    Ext.apply(this, Ext.apply(b, this.initialConfig));
    Explore.view.AllRoles.superclass.initComponent.apply(this, arguments)
},getGrid:function() {
    var a = this;
    if (!this.grid) {
        var b = new Ext.grid.ColumnModel({defaults:{width:300,sortable:false},columns:[
            {header:Explore.i18n("Role Name"),sortable:false,id:"name"},
            {header:Explore.i18n("Role Description"),id:"description"},
            {header:Explore.i18n("Last Modified"),id:"LastModified"}
        ]});
        this.grid = new Ext.grid.GridPanel({itemId:"grid",region:"center",border:false,disableSelection:true,store:a.getStore(),colModel:b})
    }
    return this.grid
},getStore:function() {
    var b = this;
    if (!this.store) {
        var a = new Ext.data.JsonReader({root:"",fields:[
            {name:"Role Name",mapping:"Name"},
            {name:"Description",mapping:"Description"},
            {name:"Last Modified",convert:function(d, c) {
                var e = c.LastModified;
                return Explore.formatDateByPref(e)
            }}
        ]});
        this.store = new Ext.data.Store({reader:a})
    }
    return this.store
},refreshGrid:function() {
    var c = this;
    var b = c.getStore();
    b.loadData([]);
    var a = c.getMask();
    a.show();
    Explore.data.UserDataStore.getAllUserRoles(function(d) {
        a.hide();
        b.loadData(d)
    })
},getMask:function() {
    return new Ext.LoadMask(this.body || Ext.getBody(), {msg:Explore.i18n("Loading All Roles List")})
}});
Ext.reg("explore.view.allroles", Explore.view.AllRoles);
Ext.ns("Explore.view");
Explore.view.AllSnapshotList = Ext.extend(Ext.Panel, {pageSize:50,initComponent:function() {
    var c = this;
    var a = new Ext.data.JsonReader({root:"",fields:[
        {name:"Id",mapping:"Id"},
        {name:"Name",mapping:"Name"},
        {name:"Description",mapping:"Description"},
        {name:"Projects",convert:c.projectsConverter},
        {name:"Created",convert:c.createDate}
    ]});
    var b = new Explore.view.DocCountColumn({header:Explore.i18n("Documents"),id:"documents",width:200,defaultType:"SNAPSHOT"});
    c.store = new Ext.data.Store({reader:a,sortInfo:{field:"Name",direction:"DESC"},listeners:{beforeload:function(f, g) {
        var e = c.getMask();
        e.show();
        Explore.data.SnapshotDataStore.getSnapshotsList(function(h) {
            if (h) {
                var j = f.reader.readRecords(h.Result.Value);
                j.totalRecords = h.Result.Key;
                f.loadRecords(j, g, true)
            }
            e.hide();
            c.doLayout()
        });
        return false
    }}});
    var d = {frame:false,layout:"fit",items:{xtype:"grid",itemId:"grid",region:"center",border:false,disableSelection:true,store:c.store,autoExpandColumn:"snapshotlist-grid-name",columns:[
        {header:Explore.i18n("Name"),dataIndex:"Name",width:100,sortable:false,id:"snapshotlist-grid-name"},
        {header:Explore.i18n("Description"),dataIndex:"Description",width:200,sortable:false,id:"snapshotlist-grid-description"},
        {header:Explore.i18n("Projects"),dataIndex:"Projects",width:400,sortable:false,align:"center"},
        {header:Explore.i18n("Created"),dataIndex:"Created",width:175,sortable:false},
        b
    ],plugins:[b],viewConfig:{forceFit:true}}};
    Ext.apply(this, Ext.apply(this.initialConfig, d));
    Explore.view.AllSnapshotList.superclass.initComponent.apply(this, arguments)
},getMask:function() {
    return new Ext.LoadMask(this.body || Ext.getBody(), {msg:Explore.i18n("Loading Snapshots List")})
},projectsConverter:function(b, a) {
    var d = "";
    if (a.Projects.length > 0) {
        for (var c = 0; c < a.Projects.length - 1; c++) {
            d += a.Projects[c].Value + ", "
        }
        d += a.Projects[a.Projects.length - 1].Value
    }
    return d
},createDate:function(b, a) {
    return Explore.formatDateByPref(a.DateCreated)
},loadData:function() {
    var b = this;
    var a = false;
    Explore.view.StatusBox.showBusy(Explore.i18n("Loading..."), function() {
        a = true;
        b.close()
    });
    if (!a) {
        b.store.load({params:{start:0,limit:b.pageSize}});
        Explore.view.StatusBox.close()
    }
},clearData:function() {
    this.store.loadData({totalFeeds:0,feeds:[]})
}});
Ext.reg("explore.view.allsnapshotlist", Explore.view.AllSnapshotList);
Ext.ns("Explore.view");
Explore.view.AllSources = Ext.extend(Ext.Panel, {initComponent:function() {
    var a = this;
    var d = this.initialConfig || {};
    var e = Explore.i18n("Please select a group for more information");
    var c = "<span>{0}</span>";
    var b = {frame:false,border:false,layout:"fit",html:String.format(c, e),items:[]};
    Ext.apply(this, Ext.apply(b, this.initialConfig));
    Explore.view.AllSources.superclass.initComponent.apply(this, arguments)
}});
Ext.reg("explore.view.allsources", Explore.view.AllSources);
Ext.ns("Explore.view");
Explore.view.AllTopicList = Ext.extend(Ext.Panel, {initComponent:function() {
    var b = this;
    b.pageSize = 50;
    b.sectionId = -1;
    var a = new Ext.data.JsonReader({root:"",fields:[
        {name:"Topic Name",mapping:"Name"},
        {name:"Description",mapping:"Description"},
        {name:"Created",convert:b.createDate}
    ]});
    b.store = new Ext.data.Store({reader:a,sortInfo:{field:"Topic Name",direction:"ASC"},listeners:{beforeload:function(d, e) {
        Explore.data.TopicDataStore.getTopicsListBySectionId(b.sectionId, function(f) {
            b.fireEvent("topicgrouploaded");
            if (f) {
                var g = d.reader.readRecords(f.Result.Value);
                g.totalRecords = f.Result.Key;
                d.loadRecords(g, e, true)
            }
        });
        return false
    }}});
    var c = {frame:false,layout:"fit",items:{xtype:"grid",itemId:"grid",region:"center",border:false,disableSelection:true,store:b.store,autoExpandColumn:"topiclist-grid-name",columns:[
        {header:Explore.i18n("Name"),width:100,sortable:false,id:"topiclist-grid-name"},
        {header:Explore.i18n("Description"),width:600,sortable:false,id:"topiclist-grid-description"},
        {header:Explore.i18n("Created"),width:175,sortable:false}
    ],viewConfig:{forceFit:true}}};
    Ext.apply(this, Ext.apply(this.initialConfig, c));
    Explore.view.AllTopicList.superclass.initComponent.apply(this, arguments)
},createDate:function(b, a) {
    return Explore.formatDateByPref(a.DateCreated)
},loadData:function(c) {
    var b = this;
    b.sectionId = c;
    var a = false;
    b.store.load(null)
},clearData:function() {
    this.store.loadData({totalFeeds:0,feeds:[]})
}});
Ext.reg("explore.view.alltopiclist", Explore.view.AllTopicList);
Ext.ns("Explore.view");
Explore.view.AllUserList = Ext.extend(Ext.Panel, {initComponent:function() {
    var a = this;
    var c = this.initialConfig || {};
    var b = {frame:false,layout:"fit",anchor:"100% 100%",items:[a.getGrid()]};
    Ext.apply(this, Ext.apply(b, this.initialConfig));
    Explore.view.AllUserList.superclass.initComponent.apply(this, arguments)
},getGrid:function() {
    var a = this;
    if (!this.grid) {
        var b = new Ext.grid.ColumnModel({defaults:{width:300,sortable:false},columns:[
            {header:Explore.i18n("User Name"),sortable:false,id:"name"},
            {header:Explore.i18n("User Login"),id:"description"},
            {header:Explore.i18n("Last Modified"),id:"LastModified"}
        ]});
        this.grid = new Ext.grid.GridPanel({itemId:"grid",region:"center",border:false,disableSelection:true,viewConfig:{forceFit:true},autoExpandColumn:"LastModified",region:"center",store:a.getStore(),colModel:b})
    }
    return this.grid
},getStore:function() {
    var b = this;
    if (!this.store) {
        var a = new Ext.data.JsonReader({root:"",fields:[
            {name:"User Name",mapping:"FullNameLFM"},
            {name:"User Role",mapping:"Login"},
            {name:"Last Modified",convert:function(d, c) {
                var e = c.LastModified;
                return Explore.formatDateByPref(e)
            }}
        ]});
        this.store = new Ext.data.Store({reader:a})
    }
    return this.store
},refreshGrid:function(d) {
    var c = this;
    var b = c.getStore();
    b.loadData([]);
    var a = c.getMask();
    a.show();
    UserService.GetUsersForGroup(d, function(e) {
        a.hide();
        b.loadData(e)
    })
},getMask:function() {
    return new Ext.LoadMask(this.body || Ext.getBody(), {msg:Explore.i18n("Loading All Users List")})
}});
Ext.reg("explore.view.alluserlist", Explore.view.AllUserList);
Ext.ns("Explore.view");
Explore.view.AnalyticsClustersPanel = Ext.extend(Ext.Panel, {currentSearchId:null,currentSearchType:null,initComponent:function() {
    var a = {layout:"card",hidden:!Explore.Security.isAuthorized("SEARCH_WIDGET_VIEW"),activeItem:0,border:false,defaults:{border:false},items:[
        {html:"(" + Explore.i18n("noAnalysisPerformed") + ")"},
        {itemId:"cluster",xtype:"explore.view.common.cluster",margins:"10",stretch:false}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, a));
    Explore.view.AnalyticsClustersPanel.superclass.initComponent.apply(this, arguments)
},doSearch:function(a) {
    this.getLayout().setActiveItem(1);
    this.doLayout();
    this.getByItemId("cluster").doSearch(a)
}});
Ext.reg("explore.view.analyticsclusterspanel", Explore.view.AnalyticsClustersPanel);
Ext.ns("Explore.view");
Explore.view.AnalyticsInfluencersPanel = Ext.extend(Ext.Panel, {currentSearch:null,layout:"card",initComponent:function() {
    var a = this;
    var b = {title:Explore.i18n("No Selection"),activeItem:0,items:[
        {itemId:"no-selection",html:'<div class="no-report">No Saved Search Selected</div>'},
        {xtype:"explore.view.influencer.viewtabpanel",getMask:function(c) {
            return a.getMask(c)
        },itemId:"tabpanel"}
    ]};
    Ext.apply(this, Ext.applyIf(this.initialConfig, b));
    Explore.view.AnalyticsInfluencersPanel.superclass.initComponent.apply(this, arguments)
},getMask:function(b) {
    var a = new Ext.LoadMask(this.getEl() || Ext.getBody(), {msg:b || Explore.i18n("Loading...")});
    return a
},analyzeCriteria:function(c, b) {
    var a = this;
    Explore.view.StatusBox.close();
    tabPanel = a.getByItemId("tabpanel");
    a.getLayout().setActiveItem(1);
    tabPanel.displaySavedSearch(c);
    a.setTitle(c.Name || c.searchTermsUI);
    tabPanel.doLayout();
    a.doLayout()
},doSearch:function(b) {
    var a = this,c = a.getByItemId("tabpanel");
    Explore.data.IDOLDataStore.getSearchCriteriaBySearchId(b.searchId, function(d) {
        a.getLayout().setActiveItem(1);
        a.currentSearch = d;
        a.setTitle(d.Name);
        c.displaySavedSearch(d);
        Explore.view.StatusBox.close();
        c.doLayout();
        a.doLayout()
    })
}});
Ext.reg("explore.view.analyticsinfluencerspanel", Explore.view.AnalyticsInfluencersPanel);
Ext.ns("Explore.view");
Explore.view.AnalyticsPanel = Ext.extend(Ext.TabPanel, {initComponent:function() {
    var a = this;
    a.analyticsPresenter = new Explore.presenter.AnalyticsPresenter(a);
    var b = {stateful:true,stateId:"analyzeTabPanel",border:false,bodyBorder:false,plain:true,itemId:"analyzeTabs",cls:"tab-plainheader",activeTab:0,defaults:{closable:false,autoScroll:true,border:false},items:this.getTabItems(),listeners:{tabchange:function() {
        a.analyticsPresenter.onTabChange(this.getActiveTab(), a.getByItemId("searchCollections"))
    }}};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.AnalyticsPanel.superclass.initComponent.apply(this, arguments)
},getPresenter:function() {
    return this.analyticsPresenter
},getMask:function(b) {
    var a = new Ext.LoadMask(this.getEl() || Ext.getBody(), {msg:b || Explore.i18n("Loading")});
    return a
},createAnalyticsPanel:function(f, d, c) {
    var b = this;
    var e = d.id + "-searchCollections";
    var a = Ext.apply({xtype:"container",layout:"border",border:false,items:[Ext.apply({region:"west",itemId:"searchCollections",xtype:"explore.view.searchcollections",stateful:true,stateId:e,saveDimensionState:true,hideTopics:true,setRecentSearch:function(l, k) {
        var h = this.getByItemId("recentSearches");
        var j = this.getByItemId("savedSearches");
        this.clearSelectedSearches();
        var g = this;
        if (this.getLayoutTarget()) {
            this.getLayout().setActiveItem("recentSearches")
        }
        this.on("beforeload", function() {
            j.getSelectionModel().clearSelections(true);
            h.getSelectionModel().clearSelections(true)
        });
        h.on("load", function(m) {
            g.getLayout().setActiveItem("recentSearches");
            var n = h.getSelectionModel();
            m.renderChildren()
        }, {single:true}, this)
    },listeners:{searchClick:function(j, g, h) {
        b.analyticsPresenter.onSearchChanged(j, g, h)
    },contextMenuChange:function(h) {
        var g = b.getActiveTab().getItemId();
        h.items.items[2].show();
        if (g === "analytics-clusters") {
            h.getByItemId("saved-view-spectrograph").setVisible(false);
            h.getByItemId("saved-view-cluster").setVisible(true)
        } else {
            if (g === "analytics-spectrographs") {
                h.getByItemId("saved-view-cluster").setVisible(false);
                h.getByItemId("saved-view-spectrograph").setVisible(true)
            } else {
                h.items.items[2].setVisible(false);
                h.getByItemId("saved-view-cluster").setVisible(false);
                h.getByItemId("saved-view-spectrograph").setVisible(false)
            }
        }
    }}}, c),{region:"center",itemId:"analyzePanel",getMask:function(g) {
        return b.getMask(g)
    },xtype:f}]}, d);
    return a
},getTabItems:function() {
    var a = [];
    if (Explore.Security.isAuthorized("SEARCH_WIDGET_VIEW")) {
        a.push(this.createAnalyticsPanel("explore.view.analyticsclusterspanel", {id:"analytics-clusters",itemId:"analytics-clusters",title:Explore.i18n("Clusters")}, {hideRecentSearch:true}))
    }
    if (Explore.Security.isAuthorized("SEARCH_WIDGET_VIEW")) {
        a.push(this.createAnalyticsPanel("explore.view.analyticsspectrographspanel", {id:"analytics-spectrographs",itemId:"analytics-spectrographs",title:Explore.i18n("Spectrographs")}, {hideRecentSearch:true}))
    }
    if (Explore.Security.isAuthorized("SEARCH_WIDGET_VIEW")) {
        a.push(this.createAnalyticsPanel("explore.view.analyticstermspanel", {id:"analytics-terms",title:Explore.i18n("Terms")}))
    }
    if (Explore.Security.isAuthorized("SEARCH_WIDGET_VIEW")) {
        a.push(this.createAnalyticsPanel("explore.view.analyticssentimentpanel", {id:"analytics-sentiment",title:Explore.i18n("Sentiment")}))
    }
    if (Explore.demoMode && Explore.Security.isAuthorized("SEARCH_WIDGET_VIEW")) {
        a.push(this.createAnalyticsPanel("explore.view.analyticstrendspanel", {id:"analytics-trends",title:Explore.i18n("Trends")}))
    }
    if (true || Explore.demoMode && Explore.Security.isAuthorized("SEARCH_WIDGET_VIEW")) {
        a.push(this.createAnalyticsPanel("explore.view.analyticsinfluencerspanel", {id:"analytics-influencer",getMask:function(b) {
            return self.getMask(b)
        },title:Explore.i18n("Influence"),cls:"demoMode"}))
    }
    if (Explore.demoMode && Explore.Security.isAuthorized("ANALYZE_SCRIPT_ADHERENCE_VIEW")) {
        a.push({id:"analytics-scriptadherence",title:Explore.i18n("ScriptAdherence"),tabTip:Explore.i18n("linkTooltipScriptAdherence"),xtype:"explore.view.scriptadherencepanel",cls:"demoMode"})
    }
    return a
},getTabswithRecentSearch:function() {
    var b = this;
    var a = [];
    var c = function(f) {
        var e = b.getItem(f);
        if (e) {
            var d = e.getByItemId("searchCollections");
            if (d) {
                a.push(d)
            }
        }
    };
    c("analytics-terms");
    c("analytics-sentiment");
    c("analytics-trends");
    c("analytics-influencer");
    return a
},getActivePanel:function() {
    var a = this.getActiveTab();
    var b = a.getByItemId("analyzePanel");
    if (b == null) {
        b = a
    }
    return b
}});
Ext.reg("explore.view.analyticspanel", Explore.view.AnalyticsPanel);
Ext.ns("Explore.view");
Explore.view.AnalyticsSentimentPanel = Ext.extend(Ext.Panel, {currentSearchId:null,currentSearchType:null,currentData:null,useLineChart:true,chartStore_4:null,chart_4:null,sentimentClusterInitialized:false,initComponent:function() {
    this.chartStore_4 = new Ext4.data.JsonStore({fields:["FriendlyName","Count","Description"],data:[]});
    var a = {layout:"card",activeItem:0,border:false,hidden:!Explore.Security.isAuthorized("SEARCH_WIDGET_VIEW"),items:[
        {html:"(" + Explore.i18n("noAnalysisPerformed") + ")"},
        {itemId:"sentiment",xtype:"panel",border:false,layout:"fit",tbar:[
            {text:Explore.i18n("viewSentimentCluster"),scope:this,handler:function() {
                this.setupSentimentCluster();
                this.getLayout().setActiveItem(2)
            },hidden:!Explore.demoMode,cls:"demoMode"}
        ],items:[
            {xtype:"box",itemId:"chartContainer",listeners:{resize:{fn:this.setupChart,buffer:250,scope:this}}}
        ]},
        {xtype:"panel",itemId:"clusterPanel",layout:"fit",bodyStyle:"padding-top: 8px;",tbar:[
            {text:Explore.i18n("viewSentimentChart"),scope:this,handler:function() {
                this.getLayout().setActiveItem(1)
            }}
        ],html:""},
        {itemId:"error",html:""}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, a));
    return Explore.view.AnalyticsSentimentPanel.superclass.initComponent.apply(this, arguments)
},setupSentimentCluster:function() {
    if (!this.sentimentClusterInitialized) {
        this.sentimentClusterInitialized = true;
        var a = this.getByItemId("clusterPanel");
        Explore.data.IDOLDataStore.getIDOLServerName(function(c) {
            var b = "http://" + c + ":8080/BofA/widgets/userTags/slider/slider.jsp";
            a.load({url:b,scripts:true,text:Explore.i18n("loadingClusterMap")})
        })
    }
},setupChart:function(c) {
    var d = this,f = c.getEl(),e = f.getComputedWidth(),b = f.getComputedHeight();
    dom = f.dom;
    var a = {trackMouse:true,width:180,height:35,renderer:function(h, g) {
        var j = h.get("Description");
        this.setTitle(j)
    }};
    if (!this.chart_4) {
        this.chart_4 = Ext4.create("widget.chart", {store:this.chartStore_4,shadow:false,renderTo:dom,width:e,height:b,insetPadding:20,theme:"Base",series:[
            {type:"pie",field:"Count",donut:false,tips:a,highlight:{segment:{margin:20}},label:{field:"Description",display:"over",contrast:false,font:"16px Arial bold"}}
        ]})
    } else {
        this.chart_4.setSize(e, b)
    }
},renderChart:function() {
    if (this.chart_4) {
        this.chart_4.destroy();
        this.chart_4 = null
    }
    this.setupChart(this.getByItemId("chartContainer"));
    if (this.currentData) {
        this.chartStore_4.loadData(this.currentData)
    }
},doSearch:function(b) {
    var a = this;
    this.getLayout().setActiveItem(1);
    Explore.data.IDOLDataStore.getSearchCriteriaBySearchId(b.searchId, function(c) {
        if (!b.canceled) {
            if (c != null) {
                c.projectId = Explore.presenter.ProjectsPresenter.getCurrentProjectId();
                c.timezoneOffsetMilliseconds = Explore.getLocalTimeZoneOffset();
                a.analyzeCriteria(c, b)
            }
        }
    })
},analyzeCriteria:function(d, c) {
    var a = this;
    var b = {ProjectId:Explore.presenter.ProjectsPresenter.getCurrentProjectId()};
    Explore.data.IDOLDataStore.getDocumentCountByParametricFilter(d, b, "SENTIMENT", function(f) {
        if (!c.canceled) {
            if (f.length == 0) {
                var e = a.items.indexOfKey("error");
                a.getLayout().setActiveItem(e);
                var g = a.getLayout().activeItem.getEl();
                g.update(Explore.i18n("AnalyzeNoResult"))
            } else {
                for (var j = 0;
                     j < f.length; j++) {
                    var h = f[j];
                    h.Description = h.FriendlyName + " (" + h.Count + ")"
                }
                a.chartStore_4.loadData(f);
                var e = a.items.indexOfKey("sentiment");
                a.getLayout().setActiveItem(e);
                a.doLayout()
            }
            Explore.view.StatusBox.close()
        }
    })
}});
Ext.reg("explore.view.analyticssentimentpanel", Explore.view.AnalyticsSentimentPanel);
Ext.ns("Explore.view");
Explore.view.AnalyticsSpectrographsPanel = Ext.extend(Ext.Panel, {currentSearchId:null,currentSearchType:null,currentData:null,spectrographResults:null,initComponent:function() {
    var a = {layout:"card",hidden:!Explore.Security.isAuthorized("SEARCH_WIDGET_VIEW"),activeItem:0,border:false,defaults:{border:false},items:[
        {html:"(" + Explore.i18n("noAnalysisPerformed") + ")"},
        {itemId:"spectrograph",xtype:"explore.view.common.spectrograph",margins:"10",stretch:false}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, a));
    Explore.view.AnalyticsSpectrographsPanel.superclass.initComponent.apply(this, arguments)
},doSearch:function(a) {
    this.getLayout().setActiveItem(1);
    this.doLayout();
    this.getByItemId("spectrograph").doSearch(a)
}});
Ext.reg("explore.view.analyticsspectrographspanel", Explore.view.AnalyticsSpectrographsPanel);
Ext.ns("Explore.view");
Explore.view.AnalyticsTermsPanel = Ext.extend(Ext.Panel, {currentSearchId:null,currentSearchType:null,currentData:null,termCount:25,currentCriteria:null,grid:null,initComponent:function() {
    var a = this;
    this.grid = new Ext.grid.GridPanel({layout:"fit",border:false,itemId:"terms-grid",tbar:new Ext.Toolbar({items:["->",{itemId:"terms-count",xtype:"selectboxfield",options:[
        [5,"5"],
        [10,"10"],
        [25,"25"],
        [50,"50"],
        [100,"100"]
    ],listWidth:40,value:a.termCount,listeners:{select:function(c) {
        a.changeTermCount(c.getValue())
    }}}]}),store:new Ext.data.JsonStore({fields:[
        {name:"Weight",type:"float"},
        {name:"DocOccurrences"},
        {name:"TotalOccurrences"},
        {name:"Term"}
    ]}),autoExpandColumn:"term",listeners:{rowclick:function(f, h, g) {
        var c = f.getStore().getAt(h);
        var d = c.json
    }},columns:[
        {header:Explore.i18n("Term"),id:"term",width:200,sortable:true,dataIndex:"Term"},
        {header:Explore.i18n("Weight"),width:80,sortable:true,renderer:Explore.formatNumber,dataIndex:"Weight"},
        {header:Explore.i18n("Matches"),width:170,sortable:true,renderer:Explore.formatNumber,dataIndex:"DocOccurrences"},
        {header:Explore.i18n("Occurrences"),width:170,sortable:true,renderer:Explore.formatNumber,dataIndex:"TotalOccurrences"}
    ]});
    var b = {layout:"card",activeItem:0,border:false,hidden:!Explore.Security.isAuthorized("SEARCH_WIDGET_VIEW"),items:[
        {html:"(" + Explore.i18n("noAnalysisPerformed") + ")"},
        this.grid,
        {itemId:"error",html:""}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.AnalyticsTermsPanel.superclass.initComponent.apply(this, arguments);
    this.grid.on("rowcontextmenu", this.onContextMenu, this)
},onContextMenu:function(d, c, f) {
    var b = this;
    var a = d.getSelectionModel();
    a.selectRow(c, true);
    if (!this.menu) {
        this.menu = new Ext.menu.Menu({items:[
            {text:Explore.i18n("AddToSearch"),handler:function(l, j, k, h, g) {
                b.addToSearch(b.getSelectedTerms())
            }},
            {xtype:"menuseparator"},
            {text:Explore.i18n("AddToCreateTopic"),handler:function() {
                b.editTopic(b.getSelectedTerms())
            }},
            {text:Explore.i18n("AddToLexicon"),handler:function() {
                b.editLexicon(b.getSelectedTerms())
            }},
            {text:Explore.i18n("AddToOptimazationCampaign"),hidden:!Explore.demoMode,handler:function() {
                b.addToOptimization(b.getSelectedTerms())
            }}
        ]})
    }
    f.stopEvent();
    this.menu.showAt(f.getXY())
},getSelectedTerms:function() {
    var b = [];
    var d = this.grid;
    var a = d.getSelectionModel();
    var e = a.getSelections();
    if (e !== null && e !== undefined && e.length > 0) {
        for (var c = 0; c < e.length; ++c) {
            b[c] = e[c].data.Term
        }
    }
    return b
},addToSearch:function(f) {
    if (f) {
        var e;
        if (this.currentSearchType === 1) {
            e = "SAVEDSEARCH::(" + this.currentCriteria.Name + ")"
        } else {
            if (this.currentCriteria && this.currentCriteria.searchTerms) {
                e = "(" + this.currentCriteria.searchTerms + ")"
            }
        }
        var a;
        if (f !== null && f !== undefined && f.length > 0) {
            a = f[0];
            for (var c = 1; c < f.length; ++c) {
                a += "+OR+" + f[c]
            }
        }
        if (a !== null && a !== undefined) {
            var b = Explore.showSearchPanel();
            var d = this.currentCriteria;
            if (d === null || d === undefined) {
                d = {searchType:0}
            }
            if (e) {
                d.searchTerms = e + "+AND+(" + a + ")"
            } else {
                d.searchTerms = a
            }
            d.description = d.searchTerms;
            d.searchTermsUI = d.searchTerms;
            b.searchByCriteria(d, {bypassBusyMessage:false})
        }
    }
},addToOptimization:function(a) {
    var b = new Explore.view.OptimizationManagerDialog({terms:a});
    b.show()
},editLexicon:function(a) {
    var b = new Explore.view.LexiconManagerDialog({terms:a});
    b.show()
},editTopic:function(a) {
    var b = new Explore.view.TopicManagerDialog({terms:a});
    b.show()
},changeTermCount:function(b) {
    if (this.termCount != b) {
        log.info("AnalyticsTermsPanel: Term count changed: " + b);
        this.termCount = b;
        var a = {};
        this.analyzeCriteria(this.currentCriteria, a)
    }
},doSearch:function(b) {
    var a = this;
    Explore.data.IDOLDataStore.getSearchCriteriaBySearchId(b.searchId, function(c) {
        if (!b.canceled) {
            if (c != null) {
                c.projectId = Explore.presenter.ProjectsPresenter.getCurrentProjectId();
                c.timezoneOffsetMilliseconds = Explore.getLocalTimeZoneOffset();
                a.analyzeCriteria(c, b)
            }
        }
    })
},analyzeCriteria:function(c, b) {
    var a = this;
    a.currentCriteria = c;
    if (!Ext.MessageBox.isVisible()) {
        Explore.view.StatusBox.showBusy(Explore.i18n("RunningAnalyticsForSearchTerms"), function() {
            b.canceled = true
        })
    }
    c.projectId = Explore.presenter.ProjectsPresenter.getCurrentProjectId();
    Explore.data.IDOLDataStore.getBestTerms(c, a.termCount, function(e) {
        if (b.canceled) {
            log.debug("Search was canceled. Ignoring results.")
        } else {
            if (e == null || e.length == 0) {
                var d = a.items.indexOfKey("error");
                a.getLayout().setActiveItem(d);
                var f = a.getLayout().activeItem.getEl();
                f.update(Explore.i18n("AnalyzeNoResult"))
            } else {
                a.grid.getStore().loadData(e);
                var d = a.items.indexOfKey("terms-grid");
                a.getLayout().setActiveItem(d)
            }
        }
        Explore.view.StatusBox.close()
    })
}});
Ext.reg("explore.view.analyticstermspanel", Explore.view.AnalyticsTermsPanel);
Ext.ns("Explore.view");
Explore.view.AnalyticsTrendsPanel = Ext.extend(Ext.Panel, {currentSearchId:null,currentSearchType:null,currentData:null,useLineChart:true,chartStore_4:null,chart_4:null,initComponent:function() {
    this.chartStore_4 = new Ext4.data.ArrayStore({fields:["Date","Documents"],data:[]});
    var a = {layout:"card",activeItem:0,border:false,items:[
        {html:"(" + Explore.i18n("noAnalysisPerformed") + ")"},
        {itemId:"chart",xtype:"panel",layout:"fit",itemId:"chartPanel",tbar:[
            {xtype:"button",itemId:"chartTypeButton",text:Explore.i18n("ViewBarChart"),scope:this,handler:function(b) {
                this.useLineChart = !this.useLineChart;
                if (this.useLineChart) {
                    b.setText(Explore.i18n("ViewBarChart"))
                } else {
                    b.setText(Explore.i18n("ViewLineChart"))
                }
                this.renderChart()
            }}
        ],items:[
            {xtype:"box",itemId:"chartContainer",listeners:{resize:{fn:this.setupChart,buffer:250,scope:this}}}
        ]},
        {itemId:"error",html:""}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, a));
    Explore.view.AnalyticsTrendsPanel.superclass.initComponent.apply(this, arguments)
},setupChart:function(c) {
    var d = this,f = c.getEl(),e = f.getComputedWidth(),b = f.getComputedHeight();
    dom = f.dom;
    var a = {trackMouse:true,width:180,height:35,renderer:function(h, g) {
        var j = h.get("Documents") + " " + Explore.i18n("_documents");
        this.setTitle(j)
    }};
    if (!this.chart_4) {
        this.chart_4 = Ext4.create("widget.chart", {store:this.chartStore_4,shadow:false,renderTo:dom,width:e,height:b,theme:"Blue:gradients",axes:[
            {type:"Numeric",minimum:0,position:"left",fields:["Documents"],title:Explore.i18n("Documents"),grid:true,labelTitle:{font:"14px sans-serif"},label:{font:"12px sans-serif"}},
            {type:"Category",position:"bottom",title:Explore.i18n("Date"),fields:["Date"],labelTitle:{font:"14px sans-serif"}}
        ],series:[
            {type:this.useLineChart ? "line" : "column",xField:"Date",yField:"Documents",tips:a}
        ]})
    } else {
        this.chart_4.setSize(e, b)
    }
},renderChart:function() {
    if (this.chart_4) {
        this.chart_4.destroy();
        this.chart_4 = null
    }
    this.setupChart(this.getByItemId("chartContainer"));
    if (this.currentData) {
        this.chartStore_4.loadData(this.currentData)
    }
},doSearch:function(b) {
    this.getLayout().setActiveItem(1);
    var a = this;
    Explore.data.IDOLDataStore.getSearchCriteriaBySearchId(b.searchId, function(c) {
        if (c != null) {
            c.projectId = Explore.presenter.ProjectsPresenter.getCurrentProjectId();
            c.timezoneOffsetMilliseconds = Explore.getLocalTimeZoneOffset();
            a.analyzeCriteria(c, b)
        }
    })
},analyzeCriteria:function(c, b) {
    var a = this;
    var b = {ProjectId:Explore.presenter.ProjectsPresenter.getCurrentProjectId()};
    Explore.data.IDOLDataStore.getTrendAnalytics(c, b, function(e) {
        if (!b.canceled) {
            if (e.length == 0) {
                var d = a.items.indexOfKey("error");
                a.getLayout().setActiveItem(d);
                var f = a.getLayout().activeItem.getEl();
                f.update(Explore.i18n("AnalyzeNoResult"))
            } else {
                a.currentData = e.GraphData;
                a.chartStore_4.loadData(e.GraphData);
                var d = a.items.indexOfKey("chart");
                a.getLayout().setActiveItem(d)
            }
            Explore.view.StatusBox.close()
        }
    })
}});
Ext.reg("explore.view.analyticstrendspanel", Explore.view.AnalyticsTrendsPanel);
Ext.ns("Explore.view");
Explore.view.App = new function() {
    var l = null;
    var b = null;
    var n = {byHour:2,byDay:7,byWeek:100,byMonth:366,byYear:720};

    function k(o) {
        var p = {xtype:"container",cls:"header-panel",border:false,height:45,items:[
            {xtype:"component",border:false,id:"header-panel",html:'<div id="header"><div id="header1"><h1><span>' + Explore.i18n("appTitle") + "</span></h1></div></div>"},
            {xtype:"container",id:"header-toolbars",items:[
                {xtype:"explore.view.usercontrolpanel",id:"userControlPanel"},
                {xtype:"explore.view.projectstoolbar",hidden:false,id:"projectsToolbar"}
            ]}
        ]};
        return Ext.apply(o || {}, p)
    }

    function e(o) {
        if (o && o.items && o.items.length > 0) {
            return o.items.itemAt(0)
        }
        return null
    }

    function c(r, q) {
        log.info("onTabChange: " + q.id);
        var p;
        var o = (b === null);
        p = e(b);
        if (p && p.panelHide) {
            p.panelHide()
        }
        j(q);
        f(q);
        d(q);
        b = q;
        p = e(q);
        if (p && p.panelShow) {
            p.panelShow()
        }
        if (!o) {
            log.info("update location / hash  / preferences");
            Explore.setHash(q.id.replace("app-", ""), "");
            Explore.data.PreferenceDataStore.save()
        }
        r.doLayout()
    }

    function f(o) {
        var p = Explore.i18n("appTitle");
        if (o) {
            p += " :: " + o.title
        }
        document.title = p;
        log.info("updatePageTitle =" + p)
    }

    function d(p) {
        var r = Ext.getCmp("app-bottom-toolbar");
        if (r) {
            r.removeAll();
            if (p && p.items.length > 0) {
                var o = p.items.items[0];
                if (o) {
                    var q = Ext.getCmp(o.id);
                    if (q.getQuickActions) {
                        var s = q.getQuickActions();
                        if (s) {
                            r.add(s)
                        }
                    }
                }
            }
            r.add(["->",Explore.i18n("version") + " " + Explore.version]);
            r.doLayout()
        }
    }

    function j(p) {
        if ((p.items === null) || (p.items.length === 0)) {
            var q = null;
            switch (p.id) {case"app-home":q = {id:"appHomePanel",xtype:"explore.view.homepanel"};
                break;case"app-search":q = {id:"searchPanel",xtype:"explore.view.searchpanel"};break;case"app-analytics":q = {id:"analyticsPanel",xtype:"explore.view.analyticspanel"};
                break;case"app-rules":q = {xtype:"explore.view.rulespanel"};break;case"app-administration":q = {id:"adminTabPanel",xtype:"explore.view.administrationpanel"};
                break
            }
            if (q) {
                Explore.view.StatusBox.showBusy(Explore.i18n("Loading..."));
                q.border = false;
                q.bodyCssClass = "main-body-panel";
                p.add(q);
                p.doLayout();
                Explore.view.StatusBox.close()
            }
        } else {
            var r = p.findByType("explore.view.topicpicker");
            for (var o = 0; o < r.length; o++) {
                r[o].refreshDirty()
            }
        }
    }

    function h(p) {
        var o = [];
        if (Explore.Security.isAuthorized("HOME_VIEW")) {
            o.push({id:"app-home",title:Explore.i18n("Home")})
        }
        if (Explore.Security.isAuthorized("SEARCH_VIEW")) {
            o.push({id:"app-search",title:Explore.i18n("Search")})
        }
        if (Explore.Security.isAuthorized("SEARCH_WIDGET_VIEW")) {
            o.push({id:"app-analytics",title:Explore.i18n("Analyze")})
        }
        if (Explore.Security.isAuthorized("AUTOMATE")) {
            o.push({id:"app-rules",title:Explore.i18n("Automate"),tabTip:Explore.i18n("linkTooltipAutomate")})
        }
        if (Explore.Security.isAuthorized("ADMINISTER_APP")) {
            o.push({id:"app-administration",title:Explore.i18n("Administer")})
        }
        var q = {xtype:"tabpanel",id:"mainTabPanel",stateful:true,stateId:"mainTabPanel",deferredRender:true,activeTab:0,border:false,bodyBorder:false,listeners:{tabchange:c},defaults:{closable:false,autoScroll:true,layout:{type:"fit"}},items:o};
        return Ext.apply(p || {}, q)
    }

    function a(o) {
        var p = {xtype:"container",border:false,items:new Ext.Toolbar({id:"app-bottom-toolbar",items:[]})};
        return Ext.apply(o || {}, p)
    }

    function m() {
        if (l === null) {
            var o = {id:"explore-app",layout:"border",items:[k({region:"north"}),h({region:"center"}),a({region:"south",height:23})]};
            l = new Ext.Viewport(o);
            if (Explore.demoMode) {
                l.getEl().on("keypress", function(p, q) {
                    if (p.ctrlKey && p.button == 96) {
                        NotificationService.SendThresholdNotificationDemo()
                    }
                })
            }
        }
    }

    function g() {
        Ext.Ajax.on("requestexception", function(q, o, p, r) {
            log.error("AJAX requestexception", o.status, r);
            if (o.status == 401) {
            }
        })
    }

    this.run = function() {
        Ext.state.Manager.setProvider(new Explore.view.StateProvider());
        if (Ext.isIE7) {
            Ext.getBody().addClass("ie7")
        }
        if (Ext.isIE) {
            document.onpropertychange = function() {
                var p = document.title;
                if (p != null && typeof p != "undefined") {
                    var o = p.indexOf("#");
                    if (o >= 0) {
                        document.title = p.substring(0, o)
                    }
                }
            }
        }
        g();
        Explore.data.PreferenceDataStore.load(function() {
            Explore.data.Configuration.loadWorkflowItems();
            Explore.data.IDOLDataStore.preloadData(function() {
                m();
                if (Explore.idolRunning) {
                    Explore.checkHash()
                } else {
                    Explore.showConfigMissingMessage("errorMessageNoIdol")
                }
            })
        })
    }
};
Ext.ns("Explore.view");
Explore.view.AssignDialog = Ext.extend(Ext.Window, {width:600,height:300,closeAction:"destroy",modal:true,title:Explore.i18n("Assign"),cls:"asssign-dialog",assignConfig:null,assignTitle:function(a) {
    if (this.assignConfig.types[0].key == "CLASSIFICATIONS") {
        return Explore.i18n("AssignClassifications")
    } else {
        if (this.assignConfig.types[0].key == "TAGS") {
            return Explore.i18n("AssignTags")
        } else {
            if (a.selectedType == "PROJECTS") {
                return Explore.i18n("AssignProjects")
            } else {
                if (a.selectedType == "USERS") {
                    return Explore.i18n("AssignUsers")
                }
            }
        }
    }
},initComponent:function() {
    var a = this;
    this.setTitle(a.assignTitle(this.assignConfig));
    var b = {layout:"fit",items:[
        {xtype:"panel",itemId:"mainPanel",border:false,padding:"10",layout:"anchor",items:[
            {xtype:"toolbar",itemId:"toolbar",items:[
                {xtype:"selectboxfield",itemId:"selectBox",emptyText:null,value:this.assignConfig.selectedType,hidden:this.assignConfig.types.length <= 1,options:this.assignConfig.types,disabled:(!!this.assignConfig.changeDisabled),valueField:"key",displayField:"text",listeners:{select:this.onDropDownSelect,scope:this}},
                "->",
                {xtype:"textfield",itemId:"searchText",emptyText:Explore.i18n("Search"),enableKeyEvents:true,listeners:{keyup:this.onSearch,scope:this}},
                {xtype:"button",text:Explore.i18n("Search"),handler:this.onSearch,scope:this}
            ]},
            {layout:"card",itemId:"cardPanel",border:false,anchor:"100% -40",items:this.getGrids()}
        ]}
    ],buttons:[
        {text:Explore.i18n("Save"),handler:this.onSaveClick,scope:this}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.AssignDialog.superclass.initComponent.apply(this, arguments);
    this.onDropDownSelect()
},getGrids:function() {
    var c = [];
    for (var b = 0; b < this.assignConfig.types.length; b++) {
        var a = this.assignConfig.types[b];
        var d = this.getGridConfig(a);
        c.push(d)
    }
    return c
},getGridConfig:function(a) {
    var e = Ext.apply({xtype:"grid",itemId:"grid-" + a.key,loadMask:true,viewConfig:{forceFit:true}}, a.gridConfig);
    var g = new Ext.grid.CheckboxSelectionModel({checkOnly:true,listeners:{rowselect:function(h, j, c) {
        c.data.selected = true
    },rowdeselect:function(h, j, c) {
        c.data.selected = false
    }}});
    var b = a.selections;
    e.selModel = g;
    var d = [g];
    for (var f = 0; f < a.gridConfig.columns.length; f++) {
        d.push(a.gridConfig.columns[f])
    }
    e.columns = d;
    e.store.listeners = {load:function(j, c, h) {
        window.setTimeout(function() {
            if (b && b.length > 0) {
                for (var l = 0; l < b.length;
                     l++) {
                    var k = j.findExact("Id", b[l]);
                    if (k >= 0) {
                        g.selectRow(k, true)
                    }
                }
            }
        }, 10)
    }};
    return e
},onDropDownSelect:function() {
    var b = this.getByItemId("cardPanel");
    var c = b.getLayout();
    var a = 0;
    if (this.assignConfig.types.length > 1) {
        var e = this.getByItemId("selectBox");
        var d = e.getValue();
        if (d !== null) {
            a = e.getStore().findExact("key", d)
        }
    }
    this.activeGrid = this.getByItemId("cardPanel").getComponent(a);
    if (c === "card") {
        b.activeItem = a
    } else {
        c.setActiveItem(this.activeGrid)
    }
    this.doLayout()
},onSearch:function() {
    var b = this.activeGrid;
    if (b) {
        var a = b.getStore();
        var e = this.getByItemId("searchText");
        var d = e.getValue();
        if (d != null && d.length >= 2) {
            var c = new RegExp(d, "i");
            a.filterBy(function(f) {
                var j = f.data;
                for (var g in j) {
                    if (j.hasOwnProperty(g)) {
                        var h = j[g];
                        if (typeof h === "string") {
                            if (c.test(h)) {
                                return true
                            }
                        }
                    }
                }
                return false
            })
        } else {
            a.clearFilter()
        }
        this.syncSelectionsFromStore(b)
    }
},syncSelectionsFromStore:function(d) {
    var b = d.store;
    var a = b.getRange();
    var f = d.getSelectionModel();
    f.clearSelections(true);
    for (var c = 0; c < a.length; c++) {
        var e = a[c];
        if (e.data.selected) {
            f.selectRow(c, true)
        }
    }
},onSaveClick:function() {
    var k = {};
    var d = {};
    for (var e = 0; e < this.assignConfig.types.length; e++) {
        var c = this.assignConfig.types[e];
        var h = c.key;
        var g = [];
        var j = [];
        var b = this.getByItemId("grid-" + h);
        var f = b.getSelectionModel().getSelections();
        for (var a = 0; a < f.length;
             a++) {
            g.push(f[a].get(c.idProperty));
            j.push(f[a].data)
        }
        if (!this.listAreSame(c.selections, g)) {
            k[h] = g;
            d[h] = j
        }
    }
    this.fireEvent("save", this, k, d);
    this.close()
},listAreSame:function(a, e) {
    var c = a ? a.length : 0;
    var b = e ? e.length : 0;
    if (c === b) {
        for (var d = 0; d < c; d++) {
            if (a[d] !== e[d]) {
                return false
            }
        }
        return true
    } else {
        return false
    }
}});
Ext.reg("explore.view.AssignDialog", Explore.view.AssignDialog);
Ext.ns("Explore.view");
Explore.view.BlogInfluencerGrid = Ext.extend(Ext.Panel, {grid:null,contextMenu:null,initComponent:function() {
    var a = {layout:"card",activeItem:0,border:false,items:[this.createGrid()]};
    Ext.apply(this, Ext.apply(this.initialConfig, a));
    Explore.view.BlogInfluencerGrid.superclass.initComponent.apply(this, arguments)
},loadDataSource:function() {
    var a = this;
    Explore.data.InfluencerDataStore.getBlogInfluencers(function(b) {
        if (b) {
            var c = a.grid.getStore();
            c.loadData(b)
        }
    })
},changeInfluencerCount:function(a) {
},createGrid:function() {
    var a = this;
    a.grid = new Ext.grid.EditorGridPanel({itemId:"blogsInfluencer",flex:1,clicksToEdit:"auto",enableColumnHide:false,enableColumnMove:false,selModel:new Ext.grid.RowSelectionModel({singleSelect:true}),margins:"10 0 0 0",tbar:[
        {text:Explore.i18n("Add"),handler:function() {
            var e = a.grid.getStore();
            var d = e.recordType;
            var c = new d({Id:0,Rating:"High",Score:0,Source:"Source",TotalCommentators:0,TotalComments:0,TotalCommentators:0,TotalInboundLinks:0,TotalVotes:0});
            a.grid.stopEditing();
            e.insert(0, c);
            a.grid.startEditing(0, 0)
        }}
    ],columns:[
        {header:"Id",sortable:true,dataIndex:"Id",editor:new Ext.form.TextField({allowBlank:false})},
        {header:"Rating",sortable:true,dataIndex:"Rating",editor:new Ext.form.TextField({allowBlank:false})},
        {header:"Score",sortable:true,dataIndex:"Score",editor:new Ext.form.TextField({allowBlank:false})},
        {header:"Source",sortable:true,dataIndex:"Source",width:200,editor:new Ext.form.TextField({allowBlank:false})},
        {header:"TotalCommentators",sortable:true,dataIndex:"TotalCommentators",editor:new Ext.form.TextField({allowBlank:false})},
        {header:"TotalComments",sortable:true,dataIndex:"TotalCommentators",editor:new Ext.form.TextField({allowBlank:false})},
        {header:"TotalInboundLinks",sortable:true,dataIndex:"TotalInboundLinks",editor:new Ext.form.TextField({allowBlank:false})},
        {header:"TotalVotes",sortable:true,dataIndex:"TotalVotes",editor:new Ext.form.TextField({allowBlank:false})}
    ],store:new Ext.data.JsonStore({storeId:"blogInfluencerGridStore",fields:["Id","Rating","Score","Source","TotalCommentators","TotalComments","TotalCommentators","TotalInboundLinks","TotalVotes"],data:[]}),buttonAlign:"left",listeners:{rowcontextmenu:this.onContextMenu,scope:this}});
    return a.grid
},onContextMenu:function(c, f, d) {
    var b = this;
    if (!this.contextMenu) {
        this.contextMenu = new Ext.menu.Menu({items:[
            {text:Explore.i18n("AddToSearch"),handler:function() {
                b.fireEvent("addToSearch")
            }},
            {xtype:"menuseparator"},
            {text:Explore.i18n("AddToTopic"),handler:function() {
                b.fireEvent("addToTopic")
            }}
        ]})
    }
    var a = this.grid.getSelectionModel();
    if (!a.isSelected(f)) {
        a.selectRow(f)
    }
    d.stopEvent();
    this.contextMenu.showAt(d.getXY())
}});
Ext.reg("explore.view.blogInfluencerGrid", Explore.view.BlogInfluencerGrid);
Ext.namespace("Explore.view");
Explore.view.ChangeLoginPasswordWindow = Ext.extend(Ext.Window, {bypassDirtyCheck:false,closable:false,initComponent:function() {
    var a = this;
    var b = {title:Explore.i18n("Change Password Window"),height:220,width:500,layout:"fit",cls:"autn-login-window",resizable:false,modal:true,constrain:true,items:[a.getForm()]};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.ChangeLoginPasswordWindow.superclass.initComponent.apply(this, arguments)
},getForm:function() {
    var a = this;
    if (!this.form) {
        var d = [];
        var f = {allowBlank:false,readOnly:true,disabled:true,fieldLabel:Explore.i18n("User Name"),id:"user",value:currentUser.Login};
        var g = {allowBlank:false,fieldLabel:Explore.i18n("Old Password"),inputType:"password",validator:function(l, k) {
            if (l !== "") {
                var j = a.form.form.getFieldValues();
                if (l === j.newpassword) {
                    return Explore.i18n("Old password is the same as new password")
                } else {
                    return true
                }
            }
            return Explore.i18n("This field is required")
        },id:"oldpassword"};
        var h = {allowBlank:false,fieldLabel:Explore.i18n("New Password"),inputType:"password",validator:function(l, k) {
            if (l !== "") {
                var j = a.form.form.getFieldValues();
                if (l !== j.confirmpassword) {
                    return Explore.i18n("Passwords do not match")
                } else {
                    return true
                }
            }
            return Explore.i18n("This field is required")
        },id:"newpassword"};
        var b = {allowBlank:false,inputType:"password",fieldLabel:Explore.i18n("Cofirm New Password"),validator:function(l, k) {
            if (l !== "") {
                var j = a.form.form.getFieldValues();
                if (l !== j.newpassword) {
                    return Explore.i18n("Passwords do not match")
                } else {
                    return true
                }
            }
            return Explore.i18n("This field is required")
        },id:"confirmpassword"};
        var c = {text:Explore.i18n("Change Password"),handler:a._changePassword,itemId:"changepwd",scope:a};
        var e = {text:Explore.i18n("Cancel"),handler:this.cancelBtn,itemId:"cancelbtn",scope:this};
        this.form = new Ext.form.FormPanel({itemId:"changepasswordform",border:false,labelWidth:100,monitorPoll:1000,method:"POST",padding:10,monitorValid:true,buttons:[c,e],defaults:{anchor:Ext.isIE ? "100%" : "95%",xtype:"textfield"},items:[f,g,h,b],keys:d,layoutConfig:{align:"stretch"},plugins:[Autonomy.ux.form.FirstInvalidField]});
        this.form.on("clientvalidation", function(k, j) {
            k.fbar.getByItemId("changepwd").setDisabled(!j)
        })
    }
    return this.form
},cancelBtn:function() {
    this.close()
},_changePassword:function() {
    var d = this;
    var f = this.getByItemId("changepasswordform");
    var c = f.form.getFieldValues();
    var e = c.confirmpassword;
    var b = c.oldpassword;
    var g = c.newpassword;
    var a = new Ext.LoadMask(d.body, {msg:Explore.i18n("Changing Password...")});
    a.show();
    Explore.data.UserDataStore.changePassword(b, g, function(h) {
        a.hide();
        var j = Explore.i18n("Change Password");
        if (h && h.IsSuccessFlag) {
            d.displayMessage(j, Explore.i18n("Password Change Successful"), false);
            d.close()
        } else {
            if (!h) {
                d.displayMessage(j, Explore.i18n("Unexpected Error"), true)
            } else {
                d.displayMessage(j, Explore.i18n(h.Message), true)
            }
        }
    })
},displayMessage:function(c, b, a) {
    if (a) {
        Explore.view.StatusBox.showError(c, b)
    } else {
        Explore.view.StatusBox.showInfo(c, b)
    }
},validPassword:function(b) {
    var c = b.confirmpassword;
    var a = b.oldpassword;
    var d = b.newpassword;
    return(d !== a && (d === a))
}});
Ext.reg("explore.view.changeloginpasswordwindow", Explore.view.ChangeLoginPasswordWindow);
Ext.ns("Explore.view");
Explore.view.ClassifyDialog = Ext.extend(Ext.Window, {rowObjects:null,width:400,height:400,closeAction:"close",modal:true,stateful:true,stateId:"classifyDialog",initComponent:function() {
    var a = this;
    a.transIds = [];
    a.transIdToRefIdMap = {};
    for (var c = 0; c < a.rowObjects.length; c++) {
        var d = a.rowObjects[c];
        if (d.type === "Recordings") {
            var e = parseInt(d.fields.transId, 10);
            a.transIds.push(e);
            a.transIdToRefIdMap[e] = d.id
        }
    }
    a.rootNode = new Ext.tree.TreeNode({nodeType:"node",text:"",id:"root",singleClickExpand:true});
    var f = new Ext.tree.TreeLoader({preloadChildren:true,clearOnLoad:true,directFn:MetaDataService.GetRecordingClassificationNodes,baseAttrs:{uiProvider:Ext.tree.TriStateNodeUI,singleClickExpand:true,expanded:true},createNode:function(g) {
        if (g.leaf) {
            g.checked = false;
            g.tag.origState = false
        }
        return Ext.tree.TreeLoader.prototype.createNode.call(this, g)
    }});
    f.load(a.rootNode, function() {
        if (a.transIds != null && a.transIds.length > 0) {
            Explore.data.MetaDataStore.getTransactionClassificationsByIds(a.transIds, function(k) {
                log.debug("getTransactionClassificationsById", k);
                if (k === null) {
                    Explore.view.StatusBox.showError(Explore.i18n("AppTitle"), Explore.i18n("There was an error loading classifications for the selected recordings. Check the event log for details."))
                } else {
                    var h = a.getByItemId("tree");
                    for (var l = 0; c < k.length; c++) {
                        var g = k[l];
                        var n = h.getNodeById(g.ClassificationId);
                        if (n != null) {
                            if (n.attributes.tag.tc == null) {
                                n.attributes.tag.tc = []
                            }
                            n.attributes.tag.tc.push(g);
                            var m = null;
                            if (a.transIds.length == n.attributes.tag.tc.length) {
                                m = true
                            }
                            n.getUI().toggleCheck(m);
                            n.attributes.tag.origState = m
                        }
                    }
                }
            })
        }
    });
    var b = {itemId:"tags-dialog",cls:"tags-dialog",title:Explore.i18n("AddAndRemoveClassificationsToSelectedResult"),layout:"fit",items:{xtype:"panel",itemId:"mainPanel",autoScroll:true,border:false,padding:"10",layout:"anchor",items:[
        {xtype:"label",cls:"header-directions",text:Explore.i18n("CheckTheClassificationsToApplyToTheSelectedResult"),margins:"0 0 7 0"},
        {itemId:"tree",xtype:"treepanel",border:false,cls:"hierarchy-tree",anchor:"100% -30",useArrows:true,autoScroll:true,rootVisible:false,root:a.rootNode,loader:f}
    ]},buttons:[
        {text:Explore.i18n("Ok"),handler:function() {
            a.saveClassifications()
        }},
        {text:Explore.i18n("textCancel"),handler:function() {
            a.close()
        }}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.ClassifyDialog.superclass.initComponent.apply(this, arguments)
},getTransactionClassificationsForSave:function() {
    var a = this;
    var b = [];
    a.rootNode.cascade(function(g) {
        if (g.id !== "root" && g.attributes.tag.id > 0) {
            var e,c,f = g.getUI().isChecked(),d = g.attributes.tag.tc;
            if (f === true) {
                for (e = 0; e < a.transIds.length; e++) {
                    if (d != null) {
                        c = Explore.findMatching(d, "TransactionId", a.transIds[e])
                    } else {
                        c = null
                    }
                    if (!c) {
                        c = {ClassificationId:g.attributes.tag.id,TransactionId:a.transIds[e],RowState:Explore.model.ClassificationState.Added}
                    }
                    b.push(c)
                }
            } else {
                if (f === false) {
                    if (d != null) {
                        for (e = 0; e < d.length; e++) {
                            c = d[e];
                            c.RowState = Explore.model.ClassificationState.Deleted;
                            b.push(c)
                        }
                    }
                } else {
                    if (d != null) {
                        for (e = 0; e < d.length; e++) {
                            b.push(d[e])
                        }
                    }
                }
            }
        }
    });
    return b
},saveClassifications:function() {
    var a = this;
    var b = this.getTransactionClassificationsForSave();
    Explore.data.MetaDataStore.saveTransactionClassifications(b, a.transIdToRefIdMap, function(c) {
        if (c) {
            a.close()
        } else {
            log.warn("Error saving tags")
        }
    })
}});
Ext.ns("Explore.view");
Explore.view.CloudSettingsDialog = Ext.extend(Explore.base.EditorDialog, {itemDescription:Explore.i18n("settings"),isSearchIdRequired:false,minWidth:620,width:620,initComponent:function() {
    var a = this;
    a.topicPicker = new Explore.view.TopicPicker({border:true,anchor:"100% -200",hideLabel:true,checkable:true,rootCause:a.editObject.ViewType === Explore.model.CloudViewType.RootCauseView,listeners:{click:function(k, l) {
        var f = (k.attributes.id === "SECTION:1");
        var j = (k.attributes.tag.type === "TOPIC");
        var g = a.getByItemId("createTopicButton");
        var m = a.getByItemId("editViewTopicButton");
        var h = a.getByItemId("deleteTopicButton");
        if (f) {
            g.setDisabled(true);
            m.setDisabled(true);
            h.setDisabled(true)
        } else {
            if (j) {
                if (k.attributes.tag.isCustom) {
                    m.setText(Explore.i18n("Edit"));
                    m.setDisabled(false);
                    h.setDisabled(false)
                } else {
                    m.setText(Explore.i18n("View"));
                    m.setDisabled(false);
                    h.setDisabled(true)
                }
            } else {
                m.setText(Explore.i18n("View"));
                m.setDisabled(true);
                h.setDisabled(true)
            }
        }
    }}});
    a.setControlsByView = function(e) {
        var h = (e === Explore.model.CloudViewType.ClustersView) || (e === Explore.model.CloudViewType.HotClusters) || (e === Explore.model.CloudViewType.BreakingClusters) || (e === Explore.model.CloudViewType.SentimentView) || (e === Explore.model.CloudViewType.SpectrographsView) || (e === Explore.model.CloudViewType.DocumentsFilter);
        var j = (!h && !(e === Explore.model.CloudViewType.TrendComparision));
        var l = (!h || (e === Explore.model.CloudViewType.SentimentView) || (e === Explore.model.CloudViewType.DocumentsFilter));
        a.isSearchIdRequired = h;
        var k = (e === Explore.model.CloudViewType.DocumentsFilter);
        var g = a.getByItemId("Category");
        var f = a.getByItemId("savedSearch");
        g.setVisible(k);
        f.setVisible(h);
        a.getByItemId("topicCountContainer").setVisible(j);
        a.getByItemId("basedOnContainer").setVisible(!h && !(e === Explore.model.CloudViewType.TrendComparision));
        a.getByItemId("cloud-settings-time-period").setVisible(l);
        a.topicPicker.setVisible(!h);
        a.getByItemId("topicLimitMessage").setVisible(e === Explore.model.CloudViewType.TrendComparision);
        a.getByItemId("topicsButtons").setVisible(!h);
        a.doLayout()
    };
    var c = [
        [Explore.model.CloudViewType.CloudView,Explore.i18n("CloudView")],
        [Explore.model.CloudViewType.ListView,Explore.i18n("ListView")],
        [Explore.model.CloudViewType.PieChart,Explore.i18n("ChartView")],
        [Explore.model.CloudViewType.RootCauseView,Explore.i18n("RootCauseView")],
        [Explore.model.CloudViewType.ClustersView,Explore.i18n("ClustersView")],
        [Explore.model.CloudViewType.HotClusters,Explore.i18n("HotClustersView")],
        [Explore.model.CloudViewType.BreakingClusters,Explore.i18n("BreakingClustersView")],
        [Explore.model.CloudViewType.SentimentView,Explore.i18n("SentimentView")],
        [Explore.model.CloudViewType.SpectrographsView,Explore.i18n("SpectrographsView")],
        [Explore.model.CloudViewType.TrendComparision,Explore.i18n("TrendComparision")],
        [Explore.model.CloudViewType.DocumentsFilter,Explore.i18n("Document Counts by Filter")]
    ];
    c.sort(function(f, e) {
        return(f[1] === e[1]) ? 0 : (f[1] > e[1]) ? 1 : -1
    });
    var b = {xtype:"explore.view.common.daterangepicker",itemId:"cloud-settings-time-period",name:"TimeWindow",showAny:false,label:Explore.i18n("Within"),horizontalLayout:true,width:"90%",defaultValues:{showStartDate:(this.editObject.TimeWindow === Explore.model.TimeWindow.Between),showEndDate:(this.editObject.TimeWindow === Explore.model.TimeWindow.Between),startDate:this.editObject.FromDate ? new Date(this.editObject.FromDate) : new Date(new Date().setYear(1900 + new Date().getYear() - 1)),endDate:this.editObject.ToDate ? new Date(this.editObject.ToDate) : new Date(),dateType:(this.editObject && this.editObject.TimeWindow !== null && this.editObject.TimeWindow !== undefined) ? this.editObject.TimeWindow : Explore.model.TimeWindow.PastMonth},customOptions:[
        {id:Explore.model.TimeWindow.Between,text:Explore.i18n("FilterByDateType_Between"),showStartDate:true,showEndDate:true},
        {id:Explore.model.TimeWindow.Past5Minutes,text:Explore.i18n("cloudSettingsTimePeriod0"),showStartDate:false,showEndDate:false},
        {id:Explore.model.TimeWindow.PastHour,text:Explore.i18n("cloudSettingsTimePeriod1"),showStartDate:false,showEndDate:false},
        {id:Explore.model.TimeWindow.Past24Hours,text:Explore.i18n("cloudSettingsTimePeriod2"),showStartDate:false,showEndDate:false},
        {id:Explore.model.TimeWindow.PastWeek,text:Explore.i18n("cloudSettingsTimePeriod3"),showStartDate:false,showEndDate:false},
        {id:Explore.model.TimeWindow.PastMonth,text:Explore.i18n("cloudSettingsTimePeriod4"),showStartDate:false,showEndDate:false},
        {id:Explore.model.TimeWindow.Past3Months,text:Explore.i18n("cloudSettingsTimePeriod5"),showStartDate:false,showEndDate:false},
        {id:Explore.model.TimeWindow.Past6Months,text:Explore.i18n("cloudSettingsTimePeriod6"),showStartDate:false,showEndDate:false},
        {id:Explore.model.TimeWindow.Past12Months,text:Explore.i18n("cloudSettingsTimePeriod12"),showStartDate:false,showEndDate:false},
        {id:Explore.model.TimeWindow.Past18Months,text:Explore.i18n("cloudSettingsTimePeriod18"),showStartDate:false,showEndDate:false},
        {id:Explore.model.TimeWindow.Past24Months,text:Explore.i18n("cloudSettingsTimePeriod24"),showStartDate:false,showEndDate:false}
    ]};
    var d = {xtype:"selectboxfilter",name:"Category",itemId:"Category",fieldLabel:Explore.i18n("Category"),allowBlank:false,checkValidOnHide:false,width:150,forceSelection:true,filterConfig:Explore.data.IDOLDataStore.getParametricFilters()};
    a.formItems = [
        {xtype:"textfield",itemId:"cloud-settings-area-name",label:Explore.i18n("AreaName"),name:"Name",allowBlank:false,width:300},
        {xtype:"selectboxfield",itemId:"cloud-settings-view-type",name:"ViewType",label:Explore.i18n("View"),width:180,options:c,listeners:{select:function(g, e, f) {
            a.setControlsByView(e.id);
            a.topicPicker.setRootCause(e.id === Explore.model.CloudViewType.RootCauseView)
        }}},
        {xtype:"selectboxfield",itemId:"savedSearch",name:"AdvancedSearchId",label:Explore.i18n("SavedSearch"),width:200,store:new Ext.data.JsonStore({id:"id",fields:["id","text"],data:[]}),valueField:"id",displayField:"text",listeners:{afterrender:function(e) {
            IDOLService.GetSavedSearches(null, function(f, g) {
                log.debug("IDOLService.GetSavedSearches");
                if (f != null) {
                    e.getStore().loadData(f);
                    e.setValue(e.getValue())
                }
            })
        }}},
        d,
        {xtype:"container",itemId:"topicCountContainer",border:false,layout:{type:"hbox",align:"middle"},height:25,label:Explore.i18n("DisplayUpTo"),items:[
            {xtype:"spinnerfield",itemId:"cloud-settings-topic-display-count",name:"DisplayCount",width:60,minValue:1,maxValue:20,value:15},
            {xtype:"label",text:Explore.i18n("topics_v2")}
        ]},
        {xtype:"container",itemId:"basedOnContainer",border:false,height:60,label:Explore.i18n("BasedOn"),items:[
            {xtype:"selectboxfield",itemId:"cloud-settings-based-on",name:"Basis",minListWidth:300,width:200,options:[
                [0,Explore.i18n("cloudSettingsBasedOn0")],
                [1,Explore.i18n("cloudSettingsBasedOn1")],
                [2,Explore.i18n("cloudSettingsBasedOn2")]
            ],value:0,listeners:{select:function(j, e, g) {
                var f = [Explore.i18n("cloudSettingsBasedOn0Descr"),Explore.i18n("cloudSettingsBasedOn1Descr"),Explore.i18n("cloudSettingsBasedOn2Descr")];
                var h = j.ownerCt.get("basedOnDescription");
                document.getElementById(h.id).innerHTML = f[g]
            }}},
            {xtype:"panel",itemId:"basedOnDescription",html:Explore.i18n("cloudSettingsBasedOn0Descr"),border:false,width:400}
        ]},
        b,
        {xtype:"panel",itemId:"topicLimitMessage",html:Explore.i18n("topicLimitMessage"),margins:"0 5 5 5",hidden:true,border:false},
        a.topicPicker,
        {xtype:"container",itemId:"topicsButtons",border:false,layout:"hbox",height:30,defaults:{margins:"5 5 0 0"},items:[
            {xtype:"button",itemId:"editViewTopicButton",text:Explore.i18n("View"),disabled:true,width:75,handler:function() {
                a.topicPicker.editTopic()
            }},
            {xtype:"button",itemId:"createTopicButton",text:Explore.i18n("Create"),width:75,disabled:!Explore.Security.isAuthorized("TOPICS_CREATE"),handler:function() {
                a.topicPicker.createCustomTopic()
            }},
            {xtype:"button",itemId:"deleteTopicButton",text:Explore.i18n("Delete"),disabled:true,width:75,handler:function() {
                a.topicPicker.deleteTopic()
            }}
        ]}
    ];
    Explore.view.CloudSettingsDialog.superclass.initComponent.apply(this, arguments)
},getTitle:function() {
    return Explore.i18n("Settings_v2") + ": " + this.editObject.Name
},getObjectName:function() {
    return this.editObject.Name
},isDirty:function() {
    var f = this.getByItemId("cloud-settings-view-type");
    var b = this;
    var e = Explore.view.CloudSettingsDialog.superclass.isDirty.call(this);
    e = e || this.topicPicker.isDirty();
    if (f.getValue() === Explore.model.CloudViewType.TrendComparision) {
        var a = function() {
            if (b && b.topicPicker && b.topicPicker.getEl()) {
                b.topicPicker.addClass("red");
                if (!b.topicPicker.tooltip) {
                    b.topicPicker.tooltip = new Ext.ToolTip({autoShow:true,html:Explore.i18n("topicLimitMessage"),target:b.topicPicker.el})
                }
            }
        };
        var c = function() {
            if (b && b.topicPicker && b.topicPicker.getEl()) {
                b.topicPicker.removeClass("red");
                if (b.topicPicker.tooltip) {
                    b.topicPicker.tooltip.destroy();
                    b.topicPicker.tooltip = null
                }
            }
        };
        var d = this.topicPicker.getSelectedTopicNames();
        if (d && d.length > 3) {
            a();
            e = false
        } else {
            c()
        }
    }
    return e
},isValid:function(a) {
    var c = Explore.view.CloudSettingsDialog.superclass.isValid.call(this, a);
    if (this.isSearchIdRequired && c) {
        var b = this.getByItemId("savedSearch");
        var d = b.getValue();
        if (d === null || d === "") {
            b.markInvalid();
            c = false
        } else {
            b.clearInvalid()
        }
    }
    return c
},populateObject:function() {
    Explore.view.CloudSettingsDialog.superclass.populateObject.call(this);
    var b = this.editObject;
    var a = this.getByItemId("cloud-settings-time-period");
    var c = {};
    a.populateObject(c);
    b.TimeWindow = c.filterByDateType;
    b.FromDate = c.startDate;
    b.ToDate = c.endDate
},saveAndClose:function() {
    var a = this;
    Explore.data.IDOLDataStore.saveCloud(a.editObject, function(b) {
        if (b && b.ErrorCode === 0) {
            a.editObject = b.Result;
            var d = a.topicPicker.getSelectedTopicIds();
            var c = d.splice(0, Math.min(a.editObject.DisplayCount, d.length));
            Explore.data.IDOLDataStore.saveTopicsToCloud(a.editObject.Id, c, function(e) {
                a.fireEvent("save", a.editObject);
                a.bypassDirtyCheck = true;
                a.close()
            })
        } else {
            if (b.ErrorCode === 54003) {
                Explore.view.StatusBox.showError("Setting", "Unable to save your settings. Please refresh the application and try again.")
            }
            log.error("Error in saveCloud", b)
        }
    })
},displayObject:function() {
    Explore.view.CloudSettingsDialog.superclass.displayObject.call(this);
    var a = this;
    var b = a.editObject;
    a.topicPicker.clearAll();
    a.topicPicker.refreshDirty(null, function() {
        Explore.data.IDOLDataStore.getTopicIdsForCloud(b.Id, function(c) {
            if (c) {
                a.topicPicker.checkNodesByIds(c)
            }
            a.topicPicker.setDirty(false)
        })
    });
    if (b.Category) {
        a.getByItemId("Category").setValue(b.Category)
    }
    window.setTimeout(function() {
        a.setControlsByView(b.ViewType)
    }, 100)
}});
Ext.ns("Explore.view");
Explore.view.ConciseSearchGrid = Ext.extend(Ext.Panel, {hideFooter:false,pageSize:50,gridType:Explore.model.GridType.Concise,usePaging:true,disableRefineResults:false,noSearchText:"(" + Explore.i18n("nosearchhasbeenperformed") + ")",showGridMask:false,_currentData:null,_contextMenu:null,hideRecordingSummary:Explore.data.IDOLDataStore.getRecordingSummaryVisibility(),_grid:null,_pagingToolbar:null,initComponent:function() {
    var a = this;
    var d = ["rowSelected","gridContextOpen","rowDoubleClick","storeBeforeLoad","gridContextFavorite","gridContextTag","gridContextEditSentiment","gridContextHideResults","gridContextWorkflow"];
    a.addEvents(d);
    a.enableBubble(d);
    a.store = new Ext.data.GroupingStore({reader:new Ext.data.JsonReader({totalProperty:"results",root:"rows",idProperty:"id",fields:["id","weight","type","fields","date","source","matchTerms","tag","token","hidden"]}),remoteSort:a.usePaging,sortInfo:{field:"weight",direction:"DESC"}});
    var c = new Ext.Panel({padding:5,layout:"fit",border:false,cls:"no-search-results",html:a.noSearchText});
    a.setupTemplates();
    a.createGrid();
    var b = {layout:"card",activeItem:0,border:false,items:[c,a._grid]};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.ConciseSearchGrid.superclass.initComponent.apply(this, arguments);
    a.store.on("beforeload", function(e, f) {
        log.info("ConciseSearchGrid Store BeforeLoad");
        a.fireEvent("storeBeforeLoad", e, f);
        if (a.showGridMask) {
            if (!a.gridMask) {
                a.gridMask = new Ext.LoadMask(a._grid.getEl(), "loading")
            }
            a.gridMask.show()
        }
        return false
    });
    a.store.on("load", function() {
        if (a.showGridMask && a.gridMask) {
            a.gridMask.hide()
        }
    })
},setupTemplates:function() {
    var a = this;
    a.templateOptions = {formatDate:a.formatDate,matchTerms:function(b) {
        var c = Explore.data.PreferenceDataStore.getSelectedHighlightingOption();
        if (c === "MatchTermsOnly" || c === "HilighTermAndMatchTerms") {
            if (b.matchTerms) {
                return Explore.i18n("MatchTerms") + ": " + b.matchTerms + "<br />"
            }
        }
        return""
    },vibe:function(b) {
        var c = Explore.data.PreferenceDataStore.getShowVibePreference();
        if (c) {
            if (b.fields.positiveVibes) {
                if (b.fields.negativeVibes) {
                    return Explore.i18n("PositiveVibes") + ": " + b.fields.positiveVibes + "<br />" + Explore.i18n("NegativeVibes") + ": " + b.fields.negativeVibes + "<br />"
                } else {
                    return Explore.i18n("PositiveVibes") + ": " + b.fields.positiveVibes + "<br />"
                }
            } else {
                if (b.fields.negativeVibes) {
                    return Explore.i18n("NegativeVibes") + ": " + b.fields.negativeVibes + "<br />"
                }
            }
        }
        return""
    },sentiment:function(c) {
        var b = Explore.data.PreferenceDataStore.getShowSentimentPreference();
        if (b) {
            if (c.fields.sentiment) {
                return Explore.i18n("Sentiment") + ":" + c.fields.sentiment + "<br />"
            }
        }
        return""
    },tags:function(b) {
        if (b.tag) {
            return Explore.i18n("Tags") + ":" + b.tag + "<br />"
        }
        return""
    }};
    a.sourceTemplates = {Recordings:a.createSourceTemplate("Recordings", "{values.fields.title}<br />", Explore.i18n("Holdssilence") + ": {values.fields.holdCount}&nbsp;/&nbsp;{values.fields.silence}<br />" + Explore.i18n("Duration") + ": {values.fields.duration}<br />"),"Micro Media":a.createSourceTemplate("Micro Media", Explore.i18n("Following") + ": {values.fields.following}&nbsp;&nbsp;" + Explore.i18n("Followers") + ": {values.fields.followers}&nbsp;&nbsp;" + Explore.i18n("Updates") + ": {values.fields.updates}<br />")};
    a.dateTemplates = {Recordings:a.createDateTemplate("Recordings", Explore.i18n("TeamMember") + ": {values.fields.teamMember}<br />")}
},createGrid:function() {
    var p = this;

    function n(w, r, q, x, u, s) {
        var v = q.data.type.toLowerCase();
        var t = "";
        if (q.data.hidden === true) {
            t += '<img src="../resources/images/icons/showhide.gif" alt="Hidden" />'
        }
        t += '<img src="' + Explore.SearchResults.getIcnSmallByType(v) + '" alt="' + v + '" />';
        return t
    }

    function o(w, s, r, x, u, t) {
        var v;
        if (r.data.type === "Micro Media") {
            if (r.data.fields.following && r.data.fields.followers && r.data.fields.updates) {
                v = p.sourceTemplates[r.data.type]
            }
        } else {
            v = p.sourceTemplates[r.data.type]
        }
        if (v === undefined) {
            v = p.createSourceTemplate(r.data.type);
            p.sourceTemplates[r.data.type] = v
        }
        var q = v.apply(r.data);
        q = p.formatCellText(q, r.data);
        return q
    }

    function h(w, s, r, x, u, t) {
        var v = p.dateTemplates[r.data.type];
        if (v === undefined) {
            v = p.createDateTemplate(r.data.type);
            p.dateTemplates[r.data.type] = v
        }
        var q = v.apply(r.data);
        q = p.formatCellText(q, r.data);
        return q
    }

    function j(v, r, q, w, t, s) {
        var u = Explore.formatDateByPref(q.data.date);
        return u
    }

    function a(v, s, r, w, u, t) {
        var q = Explore.SearchResults.getSummaryForRecord(r.data);
        if (p.hideRecordingSummary && r.data.type === "Recordings") {
            q = ""
        }
        return p.formatCellText(q, r.data)
    }

    function c(s, q, u, x, t, w) {
        return s
    }

    refineResults = [];
    if (!p.disableRefineResults) {
        refineResults = [
            {xtype:"label",text:Explore.i18n("RefineResults"),margins:"5 5 0 5"},
            {id:"refineResultsText",xtype:"textfield",width:200,margins:"0 5 0 0",enableKeyEvents:true,listeners:{keypress:function(q, r) {
                if (r.getKey() == r.RETURN || r.getKey() == r.ENTER) {
                    r.stopEvent()
                }
            },keyup:function(q, r) {
                if (r.getKey() == r.RETURN || r.getKey() == r.ENTER) {
                    p.refineSearch()
                }
            }}},
            {id:"refineResultsButton",xtype:"button",iconCls:"buttonRefineResults",handler:function() {
                p.refineSearch()
            }}
        ]
    }
    refineResults.push({xtype:"label",text:Explore.i18n("LastRefreshed") + ":  ",margins:"5 5 0 5"});
    refineResults.push({xtype:"label",text:"N/A",margins:"5 5 0 5",itemId:"lastRefreshed"});
    var k = [
        {header:Explore.i18n("Weight"),width:60,sortable:true,align:"center",dataIndex:"weight",menuDisabled:true},
        {header:Explore.i18n("Type"),width:60,sortable:true,dataIndex:"type",renderer:n,align:"center",groupRenderer:c},
        {id:"sourceColumn",header:Explore.i18n("Source"),width:200,sortable:false,renderer:o,dataIndex:"source",groupRenderer:c,menuDisabled:true},
        {id:"dateColumn",width:200,header:Explore.i18n("Date"),sortable:true,dataIndex:"date",renderer:h,groupRenderer:c}
    ];
    var l = [
        {header:Explore.i18n("Weight"),width:60,sortable:true,align:"center",dataIndex:"weight",menuDisabled:true},
        {header:Explore.i18n("Type"),width:60,sortable:true,dataIndex:"type",align:"center",renderer:n,groupRenderer:c},
        {header:Explore.i18n("Content"),id:"contentCol",sortable:false,groupable:false,renderer:a},
        {header:Explore.i18n("Date"),width:150,sortable:true,dataIndex:"date",renderer:j}
    ];
    var d = {store:p.store,columns:k,view:new Explore.view.ConciseGridView({hideRecordingSummary:Explore.data.IDOLDataStore.getRecordingSummaryVisibility(),groupTextTpl:'{text} ({[values.rs.length]} {[values.rs.length > 1 ? "' + Explore.i18n("Items") + '" : "' + Explore.i18n("Item") + '"]})',enableRowBody:true,getRowClass:p.applyRowClass,previewOffsetColumns:2}),sm:new Ext.grid.RowSelectionModel({singleSelect:false}),keys:{key:Ext.EventObject.ENTER,fn:function() {
        try {
            var r = p._grid.getSelectionModel();
            var q = r.getSelections();
            for (var s = 0; s < q.length; s++) {
                var v = p.store.indexOf(q[s]);
                var u = p.store.getAt(v);
                p.fireEvent("rowDoubleClick", v, u)
            }
        } catch(t) {
        }
    },scope:p},autoExpandColumn:"sourceColumn",border:false,layout:"fit"};
    var m = {store:p.store,columns:l,view:new Ext.grid.GroupingView({groupTextTpl:'{text} ({[values.rs.length]} {[values.rs.length > 1 ? "' + Explore.i18n("Items") + '" : "' + Explore.i18n("Item") + '"]})',enableRowBody:false}),sm:new Ext.grid.RowSelectionModel({singleSelect:false}),keys:{key:Ext.EventObject.ENTER,fn:function(r, q, x) {
        var t = p._grid.getSelectionModel();
        var s = t.getSelections();
        for (var u = 0; u < s.length; u++) {
            var w = p.store.indexOf(s[u]);
            var v = p.store.getAt(w);
            p.fireEvent("rowDoubleClick", w, v)
        }
    },scope:p},autoExpandColumn:"contentCol",border:false,layout:"fit"};
    var e = (p.gridType === Explore.model.GridType.Concise) ? d : m;
    if (!p.hideFooter) {
        if (p.usePaging) {
            if (p._pagingToolbar === null) {
                refineResults.push("->")
            }
            p._pagingToolbar = new Ext.PagingToolbar({store:p.store,displayInfo:true,pageSize:p.pageSize,prependButtons:true,displayMsg:"Displaying {0}-{1} of {2}",items:refineResults});
            e.bbar = p._pagingToolbar
        } else {
            e.bbar = refineResults
        }
    }
    var g = new Ext.grid.GridPanel(e);
    if (p._grid !== null) {
        var b = p._grid.ownerCt;
        b.remove(p._grid);
        p._grid.destroy();
        p._grid = g;
        b.add(g);
        var f = p.getLayout();
        f.setActiveItem(1)
    } else {
        p._grid = g
    }
    p._grid.on("rowcontextmenu", p.onContextMenu, p);
    p._grid.getSelectionModel().on("selectionchange", function() {
        var q = p.getSelectedRows();
        p.fireEvent("rowSelected", q)
    }, this);
    p._grid.on("rowdblclick", function(q, t, r) {
        var s = p.store.getAt(t);
        p.fireEvent("rowDoubleClick", t, s)
    });
    p._grid.on("sortchange", function(q, r) {
        q.store.setDefaultSort("Weight", "DESC");
        if (r) {
            q.store.setDefaultSort(r.field, r.direction)
        }
    })
},getStore:function() {
    return this.store
},formatDate:function(a) {
    return Explore.formatDateByPref(a)
},updateDate:function() {
    var a = this;
    var b = a._pagingToolbar.getByItemId("lastRefreshed");
    b.setText(Explore.formatDateByPref(new Date()))
},getCustomFieldsTpl:function(g, e) {
    var b = "";
    var c = Explore.data.IDOLDataStore.getDocumentTypeConfigs();
    var f = c[g];
    if (f != undefined || f != null) {
        var a = f.GridFields[e];
        if (a !== undefined && a !== null) {
            for (var d = 0; d < a.length; d++) {
                if (a[d].Type && a[d].Type === "url") {
                    b += a[d].Name + ': <a target="_blank" href ="{values.fields.' + a[d].Tag + '}">{values.fields.' + a[d].Tag + "}<a><br />"
                } else {
                    b += a[d].Name + ": {values.fields." + a[d].Tag + "}<br />"
                }
            }
        }
    }
    return b
},createSourceTemplate:function(e, b, a) {
    var c = this;
    var d = "{source}<br />";
    if (b !== undefined && b !== null) {
        d += b
    }
    d += "{[this.sentiment(values)]}";
    if (a !== undefined && a !== null) {
        d += a
    }
    d += c.getCustomFieldsTpl(e, "Source");
    d += "{[this.vibe(values)]}";
    return new Ext.XTemplate(d, c.templateOptions)
},createDateTemplate:function(d, a) {
    var b = this;
    var c = "{[Explore.formatDateByPref(values.date)]}<br />{[this.matchTerms(values)]}{[this.tags(values)]}";
    if (a !== undefined && a !== null) {
        c += a
    }
    c += b.getCustomFieldsTpl(d, "Date");
    return new Ext.XTemplate(c, b.templateOptions)
},formatCellText:function(a, c) {
    var b = a;
    if (c.hidden === true) {
        b = "<i>" + a + "</i>"
    }
    return b
},applyRowClass:function(a, f, e, d) {
    var b = this;
    var c = Explore.SearchResults.getSummaryForRecord(a.data);
    if (b.hideRecordingSummary && a.data.type === "Recordings") {
        c = ""
    }
    if (c != "") {
        e.body = '<p class="grid-result-summary">' + c + "</p>"
    } else {
        e.body = ""
    }
    return""
},refineSearch:function() {
    var a = Ext.getCmp("searchPanel");
    var b = a.getSearchPresenter();
    var c = Ext.get("refineResultsText").getValue();
    if (c) {
        b.quickSearch(c)
    }
},onContextMenu:function(c, h, f) {
    var b = this;
    if (!b._contextMenu) {
        b._contextMenu = new Ext.menu.Menu({items:[
            {text:Explore.i18n("Open"),iconCls:"buttonOpen",handler:function() {
                b.fireEvent("gridContextOpen")
            }},
            {xtype:"menuseparator"},
            {text:Explore.i18n("AddToFavorites"),iconCls:"buttonFavorite",handler:function() {
                b.fireEvent("gridContextFavorite")
            },cls:"demoMode",hidden:!Explore.demoMode || !Explore.Security.isAuthorized("SEARCH_SAVE_FAVORITE")},
            {itemId:"tag",text:Explore.i18n("Tag_dots"),iconCls:"iconTag",disabled:!Explore.Security.isAuthorized("SEARCH_TAG"),handler:function() {
                b.fireEvent("gridContextTag")
            }},
            {itemId:"classify",text:Explore.i18n("Classify_dots"),iconCls:"iconClassify",disabled:!Explore.Security.isAuthorized("SEARCH_CLASSIFY"),handler:function() {
                b.fireEvent("gridContextClassify")
            }},
            {itemId:"sentiment",text:Explore.i18n("EditSentiment"),disabled:!Explore.Security.isAuthorized("SEARCH_EDIT_SENTIMENT"),handler:function() {
                b.fireEvent("gridContextEditSentiment")
            }},
            {xtype:"menuseparator",hidden:!Explore.enableHide},
            {text:Explore.i18n("HideFromAllSearchResults"),iconCls:"buttonSearchShowHide",handler:function() {
                b.fireEvent("gridContextHideResults")
            },hidden:!Explore.enableHide}
        ]})
    }
    var g = b._grid.getSelectionModel();
    if (!g.isSelected(h)) {
        g.selectRow(h)
    }
    f.stopEvent();
    var a = !(Explore.data.PreferenceDataStore.getShowSentimentPreference() && Explore.Security.isAuthorized("SEARCH_EDIT_SENTIMENT"));
    b._contextMenu.getByItemId("sentiment").setVisible(Explore.data.PreferenceDataStore.getShowSentimentPreference());
    b._contextMenu.getByItemId("sentiment").setDisabled(a);
    var d = Explore.SearchResults.allowClassify(g.getSelections()) && Explore.Security.isAuthorized("SEARCH_CLASSIFY");
    b._contextMenu.getByItemId("classify").setDisabled(!d);
    b._contextMenu.showAt(f.getXY())
},setGridType:function(a) {
    this.gridType = a;
    this.createGrid()
},getGridType:function() {
    return this.gridType
},showData:function(b) {
    var a = this;
    if (b === null) {
        a.clearSearch()
    } else {
        a._currentData = b;
        var c = this.getLayout();
        c.setActiveItem(1);
        a._grid.getSelectionModel().clearSelections();
        a.store.loadData(b);
        a.store.sortInfo = {field:"weight",direction:"DESC"};
        a.store.filterBy(function(d, f) {
            if (d.json && d.json.fields) {
                var e = Explore.data.HiddenResultsDataStore.isHidden(f);
                return !e
            }
            return false
        });
        if (!a.hideFooter) {
            a.updateDate()
        }
    }
},clearSearch:function() {
    var a = this;
    a._currentData = null;
    var b = this.getLayout();
    b.setActiveItem(0)
},getSelectedRows:function() {
    var a = this._grid.getSelectionModel().getSelections();
    return a
},getAllRows:function() {
    return this.store.getRange()
},getIndexOfRow:function(a) {
    return this.store.indexOf(a)
}});
Ext.reg("explore.view.conciseSearchGrid", Explore.view.ConciseSearchGrid);
Explore.view.ConciseGridView = Ext.extend(Ext.grid.GridView, {previewOffsetColumns:0,constructor:function(a) {
    if (!a.templates) {
        a.templates = {}
    }
    if (!a.templates.row) {
        a.templates.row = new Ext.Template('<div class="x-grid3-row {alt}" style="{tstyle}">', '<table class="x-grid3-row-table" border="0" cellspacing="0" cellpadding="0" style="{tstyle}">', "<tbody>", '<tr class="x-grid3-row-body-tr" style="{bodyStyle}">{offsetColumnCells}<td class="x-grid3-body-cell" tabIndex="0" hidefocus="on"><div class="x-grid3-row-body">{body}</div></td></tr>', "</tbody>", "</table>", '<table class="x-grid3-row-table" border="0" cellspacing="0" cellpadding="0" style="{tstyle}">', "<tbody>", "<tr>{cells}</tr>", "</tbody>", "</table>", "</div>")
    }
    Explore.view.ConciseGridView.superclass.constructor.call(this, a)
},updateColumnWidth:function(d, c) {
    var l = this.getColumnWidth(d);
    var g = this.getTotalWidth();
    var k = this.cm.getColumnCount();
    this.innerHd.firstChild.style.width = this.getOffsetWidth();
    this.innerHd.firstChild.firstChild.style.width = g;
    this.mainBody.dom.style.width = g;
    var f = this.getHeaderCell(d);
    f.style.width = l;
    var a = this.getRows(),n;
    var j = [];
    j = a;
    for (var e = 0,h = j.length;
         e < h; e++) {
        n = j[e];
        n.style.width = g;
        for (var b = 0; b < n.childNodes.length; b++) {
            var m = n.childNodes[b];
            m.style.width = g;
            if (m.firstChild) {
                m.firstChild.style.width = g;
                if (m.firstChild.rows[0].childNodes.length == k) {
                    m.firstChild.rows[0].childNodes[d].style.width = l
                } else {
                    if (d < this.previewOffsetColumns) {
                        m.firstChild.rows[0].childNodes[d].style.width = l
                    }
                }
            }
        }
    }
    this.onColumnWidthUpdated(d, l, g)
},updateAllColumnWidths:function() {
    var f = this.getTotalWidth(),m = this.cm.getColumnCount(),h = [],g,d;
    for (d = 0; d < m; d++) {
        h[d] = this.getColumnWidth(d)
    }
    this.innerHd.firstChild.style.width = this.getOffsetWidth();
    this.innerHd.firstChild.firstChild.style.width = f;
    this.mainBody.dom.style.width = f;
    for (d = 0; d < m; d++) {
        var e = this.getHeaderCell(d);
        e.style.width = h[d]
    }
    var a = this.getRows(),o,l;
    var k = [];
    k = a;
    for (d = 0,g = k.length; d < g; d++) {
        o = k[d];
        o.style.width = f;
        for (var b = 0; b < o.childNodes.length; b++) {
            var n = o.childNodes[b];
            n.style.width = f;
            if (n.firstChild) {
                n.firstChild.style.width = f;
                l = n.firstChild.rows[0];
                if (l.childNodes.length == m) {
                    for (var c = 0;
                         c < m; c++) {
                        l.childNodes[c].style.width = h[c]
                    }
                } else {
                    for (var c = 0; c < l.childNodes[c].length; c++) {
                        if (c < this.previewOffsetColumns) {
                            l.childNodes[c].style.width = h[c]
                        }
                    }
                }
            }
        }
    }
    this.onAllColumnWidthsUpdated(h, f)
},updateColumnHidden:function(c, g) {
    var f = this.getTotalWidth();
    var l = this.cm.getColumnCount();
    this.innerHd.firstChild.style.width = this.getOffsetWidth();
    this.innerHd.firstChild.firstChild.style.width = f;
    this.mainBody.dom.style.width = f;
    var j = g ? "none" : "";
    var e = this.getHeaderCell(c);
    e.style.display = j;
    var a = this.getRows(),n;
    var k = [];
    k = a;
    for (var d = 0,h = k.length;
         d < h; d++) {
        n = k[d];
        n.style.width = f;
        for (var b = 0; b < n.childNodes.length; b++) {
            var m = n.childNodes[b];
            if (m.firstChild) {
                m.firstChild.style.width = f;
                if (m.firstChild.rows[0].childNodes.length == l) {
                    m.firstChild.rows[0].childNodes[c].style.display = j
                } else {
                    if (c < this.previewOffsetColumns) {
                        m.firstChild.rows[0].childNodes[c].style.display = j
                    }
                }
            }
        }
    }
    this.onColumnHiddenUpdated(c, g, f);
    delete this.lastViewWidth;
    this.layout()
},doRender:function(h, m, u, a, t, y) {
    var b = this.templates,g = b.cell,l = b.row,n = t - 1;
    var d = "width:" + this.getTotalWidth() + ";";
    var B = [],v,C,w = {},o = {tstyle:d},s;
    for (var x = 0,A = m.length; x < A; x++) {
        s = m[x];
        v = [];
        var q = (x + a);
        for (var z = 0; z < t; z++) {
            C = h[z];
            w.id = C.id;
            w.css = z === 0 ? "x-grid3-cell-first " : (z == n ? "x-grid3-cell-last " : "");
            w.attr = w.cellAttr = "";
            w.value = C.renderer(s.data[C.name], w, s, q, z, u);
            w.style = C.style;
            if (Ext.isEmpty(w.value)) {
                w.value = "&#160;"
            }
            if (this.markDirty && s.dirty && typeof s.modified[C.name] !== "undefined") {
                w.css += " x-grid3-dirty-cell"
            }
            v[v.length] = g.apply(w)
        }
        var E = [];
        if (y && ((q + 1) % 2 === 0)) {
            E[0] = "x-grid3-row-alt"
        }
        if (s.dirty) {
            E[1] = " x-grid3-dirty-row"
        }
        o.cols = t;
        if (this.getRowClass) {
            E[2] = this.getRowClass(s, q, o, u)
        }
        o.alt = E.join(" ");
        if (this.previewOffsetColumns > 0) {
            var e = g.apply({value:"&#160;",css:"x-grid3-cell-first ",style:h[0].style});
            var f = this.previewOffsetColumns;
            var k = [];
            k[k.length] = v[0];
            v[0] = e;
            f -= 1;
            var D = 1;
            while (f > 0) {
                k[k.length] = v[D];
                v[D] = g.apply({value:"&#160;",css:"",style:h[D].style});
                D += 1;
                f -= 1
            }
            o.offsetColumnCells = k.join("")
        }
        o.cells = v.join("");
        B[B.length] = l.apply(o)
    }
    return B.join("")
},getRows:function() {
    return Ext.grid.GroupingView.superclass.getRows.call(this)
}});
Ext.ns("Explore.view");
Explore.view.ConfigurationTests = Ext.extend(Ext.Window, {initComponent:function() {
    var a = this;
    var b = {title:Explore.i18n("TestConfiguration"),width:600,height:400,resizable:false,modal:true,layout:"fit",cls:"autn-login-window",items:[this.getForm()]};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.ConfigurationTests.superclass.initComponent.apply(this, arguments)
},getForm:function() {
    var l = this;
    if (!this.form) {
        var o = {text:Explore.i18n("Cancel"),handler:this.cancelBtn,itemId:"cancelbtn",scope:this};
        var s = this._testNotifBtn = new Ext.Button({text:Explore.i18n("TestNotificationBtn"),columnWidth:0.4,width:100,handler:function() {
            l.testNotification()
        }});
        var m = {xtype:"label",html:Explore.getInfoIconMessage(Explore.i18n("TestNotificationLabel")),columnWidth:0.6};
        var j = this._checkIDOLRunningBtn = new Ext.Button({text:Explore.i18n("CheckIDOLRunningBtn"),columnWidth:0.4,width:100,handler:function() {
            l.isIDOLServerRunning()
        }});
        var n = {xtype:"label",html:Explore.getInfoIconMessage(Explore.i18n("CheckIDOLRunningLabel")),columnWidth:0.6};
        var d = this._checkImportAgentRunningBtn = new Ext.Button({text:Explore.i18n("CheckImportAgentRunningBtn"),columnWidth:0.4,width:100,handler:function() {
            l.isAgentImportServerRunning()
        }});
        var e = {xtype:"label",html:Explore.getInfoIconMessage(Explore.i18n("CheckImportAgentRunningLabel")),columnWidth:0.6};
        var c = this._checkSocialMediaConnectorRunningBtn = new Ext.Button({text:Explore.i18n("CheckSocialMediaConnectorRunningBtn"),columnWidth:0.4,width:100,handler:function() {
            l.isSocialMediaServerRunning()
        }});
        var h = {xtype:"label",html:Explore.getInfoIconMessage(Explore.i18n("CheckSocialMediaConnectorRunningLabel")),columnWidth:0.6};
        var a = this._checkNotificationServerRunningBtn = new Ext.Button({text:Explore.i18n("CheckNotificationServerRunningBtn"),columnWidth:0.4,width:100,handler:function() {
            l.isNotificationServerRunning()
        }});
        var r = {xtype:"label",html:Explore.getInfoIconMessage(Explore.i18n("CheckNotificationServerRunningLabel")),columnWidth:0.6};
        var u = this._checkIDOLDocumentDateValidityBtn = new Ext.Button({text:Explore.i18n("CheckIDOLDocumentDateValidityBtn"),columnWidth:0.4,width:100,handler:function() {
            l.checkDocumentDateIntegrity()
        }});
        var g = {xtype:"label",html:Explore.getInfoIconMessage(Explore.i18n("CheckIDOLDocumentDateValidityLabel")),columnWidth:0.6};
        var v = this._checkParametricFieldValidityBtn = new Ext.Button({text:Explore.i18n("CheckParametricFieldValidityBtn"),columnWidth:0.4,width:100,handler:function() {
            l.validateParametricFilterConfiguration()
        }});
        var b = {xtype:"label",html:Explore.getInfoIconMessage(Explore.i18n("checkParametricFieldValidityLabel")),columnWidth:0.6};
        var t = {xtype:"container",border:false,anchor:"100%",layout:"column",items:[s,m],defaults:{style:{padding:"10px"}}};
        var f = {xtype:"container",border:false,anchor:"100%",layout:"column",items:[a,r],defaults:{style:{padding:"10px"}}};
        var w = {xtype:"container",border:false,anchor:"100%",layout:"column",items:[j,n],defaults:{style:{padding:"10px"}}};
        var q = {xtype:"container",border:false,anchor:"100%",layout:"column",items:[d,e],defaults:{style:{padding:"10px"}}};
        var x = {xtype:"container",border:false,anchor:"100%",layout:"column",items:[c,h],defaults:{style:{padding:"10px"}}};
        var p = {xtype:"container",border:false,anchor:"100%",layout:"column",items:[u,g],defaults:{style:{padding:"10px"}}};
        var k = {xtype:"container",border:false,anchor:"100%",layout:"column",items:[v,b],defaults:{style:{padding:"10px"}}};
        this.form = new Ext.form.FormPanel({itemId:"testConfigurationPanel",border:false,padding:10,buttons:[o],defaults:{anchor:Ext.isIE ? "100%" : "95%",xtype:"textfield"},items:[w,f,x,q,t,p,k]})
    }
    return this.form
},cancelBtn:function() {
    this.close()
},testNotification:function() {
    var c = this;
    var d = currentUser.Email;
    var a = currentUser.EnableNotifications;
    var b = new Ext.LoadMask(c.body, {msg:Explore.i18n("Sending notification")});
    b.show();
    ConfigurationService.GetConfigurationSettings(function(f, m) {
        b.hide();
        var k = f.NotificationServerUrl;
        if (d && a && k) {
            Explore.data.NotificationDataStore.sendTestEmail(function(e) {
                if (e === null) {
                    Explore.view.StatusBox.showInfo(Explore.i18n("Notification"), Explore.i18n("Notification Successfully sent"))
                } else {
                    Explore.view.StatusBox.showError(Explore.i18n("Notification"), e.Message)
                }
            })
        } else {
            var j = "{0}{1}{2}";
            var g = d ? "" : Explore.i18n("No email address is set for the current user");
            var h = a ? "" : Explore.i18n("Notifications are not enabled for the current user");
            if (g !== "" && h !== "") {
                g += "<br>"
            }
            var l = k ? "" : Explore.i18n("Notification server url is not configured");
            if (l !== "" && (h !== "" || g !== "")) {
                l = "<br>" + l
            }
            var n = String.format(j, g, h, l);
            Explore.view.StatusBox.showError(Explore.i18n("Nofication Failed"), n)
        }
    })
},isIDOLServerRunning:function() {
    var a = new Ext.LoadMask(this.getEl(), Explore.i18n("MaskTextChecking"));
    a.show();
    Explore.data.IDOLDataStore.isIDOLRunning(function(b) {
        a.hide();
        if (b === null) {
            Explore.view.StatusBox.showInfo(Explore.i18n("ConfigurationTestResultDialigTitle"), Explore.i18n("IDOLServerRunning"))
        } else {
            Explore.view.StatusBox.showError(Explore.i18n("ConfigurationTestResultDialigTitle"), b.Message)
        }
    })
},isNotificationServerRunning:function() {
    var a = new Ext.LoadMask(this.getEl(), Explore.i18n("MaskTextChecking"));
    a.show();
    Explore.data.NotificationDataStore.isNotificationServerRunning(function(b) {
        a.hide();
        if (b === null) {
            Explore.view.StatusBox.showInfo(Explore.i18n("ConfigurationTestResultDialigTitle"), Explore.i18n("NotificationServerRunning"))
        } else {
            Explore.view.StatusBox.showError(Explore.i18n("ConfigurationTestResultDialigTitle"), b.Message)
        }
    })
},isSocialMediaServerRunning:function() {
    var a = new Ext.LoadMask(this.getEl(), Explore.i18n("MaskTextChecking"));
    a.show();
    SourceService.IsSocialConnectorAvailable(function(b) {
        a.hide();
        if (b === null) {
            Explore.view.StatusBox.showInfo(Explore.i18n("ConfigurationTestResultDialigTitle"), Explore.i18n("SocialMediaConnectorRunning"))
        } else {
            Explore.view.StatusBox.showError(Explore.i18n("ConfigurationTestResultDialigTitle"), b.Message)
        }
    })
},isAgentImportServerRunning:function() {
    var a = new Ext.LoadMask(this.getEl(), Explore.i18n("MaskTextChecking"));
    a.show();
    MASService.IsAgentImportServerConfigRunning(function(b) {
        a.hide();
        if (b === null) {
            Explore.view.StatusBox.showInfo(Explore.i18n("ConfigurationTestResultDialigTitle"), Explore.i18n("AgentImportServerRunning"))
        } else {
            Explore.view.StatusBox.showError(Explore.i18n("ConfigurationTestResultDialigTitle"), b.Message)
        }
    })
},validateParametricFilterConfiguration:function() {
    var a = new Ext.LoadMask(this.getEl(), Explore.i18n("MaskTextChecking"));
    a.show();
    Explore.data.IDOLDataStore.validateParametricFilterConfiguration(function(b) {
        a.hide();
        if (b.ValidationStatus === Explore.model.ValidationStatus.Valid) {
            Explore.view.StatusBox.showInfo(Explore.i18n("ConfigurationTestResultDialigTitle"), Explore.i18n("ParametricFieldsValid"))
        } else {
            if (b.ValidationStatus === Explore.model.ValidationStatus.Invalid) {
                var c = b.Result.join();
                var d = String.format(Explore.i18n("ParametricFieldsInvalid"), c);
                Explore.view.StatusBox.showWarning(Explore.i18n("ConfigurationTestResultDialigTitle"), d)
            } else {
                if (b.ValidationStatus === Explore.model.ValidationStatus.Unknown) {
                    Explore.view.StatusBox.showWarning(Explore.i18n("ConfigurationTestResultDialigTitle"), Explore.i18n("ParametricFieldsConfigurationValidityUnknown"))
                }
            }
        }
    })
},checkDocumentDateIntegrity:function() {
    var a = new Ext.LoadMask(this.getEl(), Explore.i18n("MaskTextChecking"));
    a.show();
    Explore.data.IDOLDataStore.checkDocumentDateIntegrity(function(b) {
        a.hide();
        if (b.ValidationStatus === Explore.model.ValidationStatus.Valid) {
            Explore.view.StatusBox.showInfo(Explore.i18n("ConfigurationTestResultDialigTitle"), Explore.i18n("DocumentDateIntegrityValid"))
        } else {
            if (b.ValidationStatus === Explore.model.ValidationStatus.Invalid) {
                var c = String.format(Explore.i18n("DocumentDateIntegrityInvalid"), Explore.formatDateByPref(b.Result, {ignoreTime:true}));
                Explore.view.StatusBox.showWarning(Explore.i18n("ConfigurationTestResultDialigTitle"), c)
            } else {
                if (b.ValidationStatus === Explore.model.ValidationStatus.Unknown) {
                    Explore.view.StatusBox.showWarning(Explore.i18n("ConfigurationTestResultDialigTitle"), Explore.i18n("DocumentDateIntegrityUnknown"))
                }
            }
        }
    })
}});
Ext.reg("explore.view.configurationtests", Explore.view.ConfigurationTests);
Ext.ns("Explore.view");
Explore.view.DataImportList = Ext.extend(Ext.Panel, {initComponent:function() {
    var b = this;
    var e = this.initialConfig || {};
    var d = b.getdataImportPanel();
    var a = new Ext.Button({text:Explore.i18n("ImportNow"),hidden:true,handler:b.importBtnAction});
    var c = {frame:false,border:false,items:[d,a]};
    Ext.apply(this, Ext.apply(c, this.initialConfig));
    Explore.view.DataImportList.superclass.initComponent.apply(this, arguments)
},importBtnAction:function() {
    Ext.Msg.alert("importBtnAction", "Awaiting implementation")
},getdataImportPanel:function() {
    var l = this;
    if (!this.dataImportNameField) {
        var j = new Ext.form.DisplayField({fieldLabel:Explore.i18n("DataImportName"),itemId:"dataimportnamefield",readOnly:true});
        var g = new Ext.form.DisplayField({fieldLabel:Explore.i18n("Description"),itemId:"dataimportdescriptionfield",readOnly:true});
        var c = new Explore.view.common.DocCountComponent({fieldLabel:Explore.i18n("totalDocumentsIndexed"),itemId:"totalDocumentsIndexed"});
        var b = new Ext.form.DisplayField({fieldLabel:Explore.i18n("DateCreated"),itemId:"dataimportdatecreated",readOnly:true});
        var h = new Ext.form.DisplayField({fieldLabel:Explore.i18n("Import Data From"),itemId:"importdatafrom",readOnly:true});
        var m = new Ext.form.DisplayField({fieldLabel:Explore.i18n("Search Criteria"),itemId:"searchcriteria",readOnly:true});
        var d = new Ext.form.DisplayField({fieldLabel:Explore.i18n("DocumentCountLimit"),itemId:"documentcountlimit",readOnly:true});
        var f = new Ext.form.DisplayField({fieldLabel:Explore.i18n("LastImported"),itemId:"lastimportfield",readOnly:true});
        var k = new Ext.form.DisplayField({fieldLabel:Explore.i18n("Recurring"),itemId:"reportdataimport",readOnly:true});
        var e = new Ext.form.DisplayField({fieldLabel:Explore.i18n("Date"),itemId:"date"});
        var a = l.getGrid();
        this.dataImportNameField = new Ext.form.FormPanel({border:false,frame:false,itemCls:"sourcefield",itemId:"dataimportpanel",autoHeight:true,labelWidth:180,items:[j,g,c,b,h,m,e,a,d,f,k]})
    }
    return this.dataImportNameField
},getGrid:function() {
    if (!this.projectGrid) {
        this.projectGrid = {labelAlign:"left",itemId:"DataImportProjects",itemCls:"sourcefieldgrid",fieldLabel:Explore.i18n("UsedbyProjects"),xtype:"listview",emptyText:Explore.i18n("NotBeingUsedByAnyProject"),hideHeaders:true,width:250,columns:[
            {dataIndex:"Value",width:250}
        ],store:new Ext.data.JsonStore({fields:[
            {name:"Value"}
        ],data:[]})}
    }
    return this.projectGrid
},refreshGrid:function(b) {
    var a = this.getGrid()
},clearValues:function() {
    var b = this;
    var a = b.getByItemId("dataimportpanel");
    var c = a.getByItemId("dataimportnamefield");
    c.reset();
    c = a.getByItemId("dataimportdescriptionfield");
    c.reset();
    c = a.getByItemId("dataimportdatecreated");
    c.reset();
    c = a.getByItemId("documentcountlimit");
    c.reset()
},setDataImportId:function(b) {
    var a = this;
    Explore.data.DataImportStore.getDataImportDefinition(b, function(u) {
        try {
            a.fireEvent("dataimportloaded");
            var s = u.Id;
            var B = u.Name;
            var w = u.Description;
            var z = u.DocumentImportLimit;
            var n = u.Projects;
            var m = null;
            if (u.Origin == 3) {
                m = "Twitter"
            } else {
                if (u.Origin == 2) {
                    m = "Facebook"
                } else {
                    if (u.Origin == 1) {
                        m = "Radian6 - " + u.ImportFileUNC
                    }
                }
            }
            var r = (u && u.Criteria != null) ? u.Criteria : "";
            var j = (u && u.FromDate) ? new Date(u.FromDate) : "";
            var t = (u && u.ToDate) ? new Date(u.ToDate) : "";
            a.setImportDataFrom(m);
            a.setSearchCriteria(r);
            a.setDate(j, t, m, u.FilterByDateType);
            var q = a.getByItemId("dataimportpanel");
            q.getByItemId("searchcriteria").setVisible((m.indexOf("Radian6") == 0) ? false : true);
            q.getByItemId("documentcountlimit").setVisible((m.indexOf("Radian6") == 0) ? false : true);
            q.doLayout();
            a.setNameFieldText(B);
            a.setDescriptionText(w);
            a.setDocumentCountLimit(z);
            a.setProjects(n);
            a.getByItemId("totalDocumentsIndexed").loadCounts("DATA_IMPORT", s);
            var k = Explore.formatDateByPref(u.DateCreated);
            a.setDateCreated(k);
            var p = u;
            if (!p) {
                a.setReportDataImport("N/A")
            } else {
                if (p.Repeat) {
                    var h = (p.Schedule);
                    var f = {ignoreTime:false};
                    var A = Explore.getDateFromEpoch(u.StartDate / 1000).getTime() - Explore.getLocalTimeZoneOffset();
                    a.setReportDataImport("Repeats every " + h + " hours  starting on " + Explore.formatDateByPref(A, f) + " hrs")
                } else {
                    a.setReportDataImport(Explore.i18n("DoesNotRepeat"))
                }
            }
            var c = u.Executions;
            if (c && c.length > 0) {
                var l = 0;
                var g = 0;
                var o;
                for (var v = 0;
                     v < c.length; v++) {
                    if (l < c[v].ImportDate) {
                        l = c[v].ImportDate;
                        g = v;
                        o = c[v].IdolIndexingComplete
                    }
                }
                l = Explore.formatDateByPref(c[g].ImportDate);
                var x = null;
                if (o) {
                    x = l
                } else {
                    x = Explore.i18n("IDOLIndexing")
                }
                a.setLastImport(x)
            } else {
                a.setLastImport("N/A")
            }
        } catch(y) {
        }
    })
},setNameFieldText:function(c) {
    var b = this;
    var a = b.getByItemId("dataimportpanel");
    var d = a.getByItemId("dataimportnamefield");
    d.setRawValue(c)
},setDescriptionText:function(d) {
    var b = this;
    var a = b.getByItemId("dataimportpanel");
    var c = a.getByItemId("dataimportdescriptionfield");
    c.setRawValue(d)
},setDocumentCountLimit:function(b) {
    var c = this;
    var a = c.getByItemId("dataimportpanel");
    var d = a.getByItemId("documentcountlimit");
    d.setRawValue(b)
},setDateCreated:function(c) {
    var b = this;
    var a = b.getByItemId("dataimportpanel");
    var d = a.getByItemId("dataimportdatecreated");
    d.setRawValue(c)
},setImportDataFrom:function(d) {
    var b = this;
    var a = b.getByItemId("dataimportpanel");
    var c = a.getByItemId("importdatafrom");
    c.setRawValue(d)
},setSearchCriteria:function(d) {
    var b = this;
    var a = b.getByItemId("dataimportpanel");
    var c = a.getByItemId("searchcriteria");
    c.setRawValue(d)
},setDate:function(e, c, h, a) {
    var k = this;
    var b = k.getByItemId("dataimportpanel");
    var g = b.getByItemId("date");
    if (e && c) {
        e = Ext.util.Format.date(e, Explore.getDateFormatByPref({ignoreTime:true}));
        c = Ext.util.Format.date(c, Explore.getDateFormatByPref({ignoreTime:true}));
        var j = "{2} {0} {3} {1}";
        var f = Explore.i18n("from ");
        var d = Explore.i18n("to");
        g.setRawValue(String.format(j, e, c, f, d))
    } else {
        if (a == Explore.model.FilterByDateType.Any) {
            g.setRawValue(Explore.i18n("FilterByDateType_Any"))
        } else {
            if (a == Explore.model.FilterByDateType.PastDay) {
                g.setRawValue(Explore.i18n("FilterByDateType_PastDay"))
            } else {
                if (a == Explore.model.FilterByDateType.PastWeek) {
                    g.setRawValue(Explore.i18n("FilterByDateType_PastWeek"))
                } else {
                    if (a == Explore.model.FilterByDateType.PastMonth) {
                        g.setRawValue(Explore.i18n("FilterByDateType_PastMonth"))
                    } else {
                        if (a == Explore.model.FilterByDateType.PastYear) {
                            g.setRawValue(Explore.i18n("FilterByDateType_PastYear"))
                        }
                    }
                }
            }
        }
    }
},setLastImport:function(d) {
    var b = this;
    var a = b.getByItemId("dataimportpanel");
    var c = a.getByItemId("lastimportfield");
    c.setRawValue(d)
},setReportDataImport:function(d) {
    var b = this;
    var a = b.getByItemId("dataimportpanel");
    var c = a.getByItemId("reportdataimport");
    c.setRawValue(d)
},setProjects:function(a) {
    if (a) {
        this.getByItemId("DataImportProjects").getStore().removeAll(false);
        this.getByItemId("DataImportProjects").getStore().loadData(a);
        this.getByItemId("DataImportProjects").setVisible(true)
    }
}});
Ext.reg("explore.view.dataimportlist", Explore.view.DataImportList);
Ext.ns("Explore.view");
Explore.view.DataSourcePicker = Ext.extend(Explore.base.AdministrationTreePanel, {itemDescription:Explore.i18n("Source"),checkable:false,cls:"hierarchy-tree",collapsible:false,useArrows:true,autoScroll:true,animate:true,enableDD:false,containerScroll:true,padding:"0 0 50 0",rootVisible:true,initComponent:function() {
    var d = this;
    d.itemDescription = Explore.i18n("Source");
    d.loadFn = Explore.data.SourceDataStore.getDataSource;
    d.saveFn = Explore.data.SourceDataStore.saveDataSource;
    d.deleteFn = Explore.data.SourceDataStore.deleteDataSource;
    d.editDialogFn = d.createDataSource;
    var c = new Ext.tree.TreeNode({nodeType:"node",text:Explore.i18n("All Sources"),id:"root-node",expanded:true,singleClickExpand:true,tag:{type:-1,id:0,isCustom:false}});
    var f = d.checkable ? false : undefined;
    var b = new Ext.tree.TreeLoader({preloadChildren:true,clearOnLoad:true,directFn:SourceService.GetDataSourceNodes,baseAttrs:{uiProvider:Ext.tree.TriStateNodeUI,checked:f,singleClickExpand:true,expanded:d.checkable}});
    d.on("listen", function(g) {
        d.fireEvent("treeloaded", d)
    });
    b.load(c, function() {
        d.fireEvent("treeloaded", d);
        d.enable()
    });
    var e = {root:c,loader:b};
    Ext.apply(this, Ext.apply(this.initialConfig, e));
    Explore.view.DataSourcePicker.superclass.initComponent.apply(this, arguments);
    Explore.data.DataImportStore.on("dataimportchanged", function(g) {
        d.refreshAndSelectNode(null, "DATAIMPORT:" + g)
    });
    Explore.data.DataImportStore.on("dataimportsaved", function(g) {
        d.refreshAndSelectNode(null, "DATAIMPORT:" + g)
    });
    Explore.data.DataImportStore.on("dataimportdeleted", function(g) {
        d.refreshAndSelectNode(null, "ALL-DATAIMPORTS")
    });
    var a = "GROUP:1";
    Explore.data.SourceDataStore.on("sourceModified", function(g) {
        d.refreshAndSelectNode(null, "SOURCE:" + g)
    });
    Explore.data.SourceDataStore.on("sourceDeleted", function(g) {
        d.refreshAndSelectNode(null, a)
    });
    Explore.data.SourceDataStore.on("groupModified", function(g) {
        d.refreshAndSelectNode(null, "GROUP:" + g)
    });
    Explore.data.SnapshotDataStore.on("snapshotAdded", function(g) {
        d.refreshAndSelectNode(null, "SNAPSHOT:" + g)
    });
    Explore.data.SnapshotDataStore.on("snapshotModified", function(g) {
        d.refreshAndSelectNode(null, "SNAPSHOT:" + g)
    });
    Explore.data.SnapshotDataStore.on("snapshotDeleted", function(g) {
        d.refreshAndSelectNode(null, "ALL-SNAPSHOTS")
    })
},checkSource:function(c, a) {
    var b = this.getNodeById(c);
    if (b) {
        b.ensureVisible();
        b.select();
        b.getUI().toggleCheck(a)
    }
},createDataSource:function(b) {
    var a = this;
    var d = b.editObject;
    if (a.currentObject !== null) {
        var c = new Ext.LoadMask(Ext.getBody(), {msg:Explore.i18n("Please wait...")});
        c.show();
        Explore.data.SourceDataStore.getAutomationServerUrl(function(e) {
            if (e === null || e === "") {
                c.hide();
                Explore.showConfigMissingMessage("errorMessageNoAutomationServer")
            } else {
                Explore.data.SourceDataStore.getAutomationSettings(function(f) {
                    f.source = {Id:null,Name:null,GroupId:d.GroupId};
                    c.hide();
                    ExploreAutomation.MasMainWindowLauncher(f)
                })
            }
        })
    }
},editCommand:function(c) {
    var a = this;
    if (typeof c == "number") {
        a.loadFn(c, function(d) {
            a.editCommand(d)
        })
    } else {
        var b = new Ext.LoadMask(Ext.getBody(), {msg:Explore.i18n("Please wait...")});
        b.show();
        Explore.data.SourceDataStore.getAutomationServerUrl(function(d) {
            if (d === null || d === "") {
                b.hide();
                Explore.showConfigMissingMessage("errorMessageNoAutomationServer")
            } else {
                Explore.data.SourceDataStore.getAutomationSettings(function(e) {
                    e.source = c;
                    b.hide();
                    ExploreAutomation.MasMainWindowLauncher(e)
                })
            }
        })
    }
},deleteCommand:function(c, b) {
    var h = this;
    var f = this.itemDescription;
    var a = false;
    var j = Explore.data.PreferenceDataStore.getPreferences();
    if (j.SelectedProjectId == c && f == "Project") {
        a = true
    }
    log.info("deleteCommand", c, b);
    if (!c || c === 1) {
        var e = h.getSelectionModel().getSelectedNode();
        if (!e.attributes.leaf && c) {
            Explore.view.StatusBox.showWarning("Warning", "Can not delete root folder");
            return
        }
    }
    var g = function(k) {
        if (k) {
            if (k.ErrorCode == 0) {
                h.fireEvent("delete", k.Result, a)
            } else {
                Explore.view.StatusBox.showError(Explore.i18n("appTitle"), Explore.i18n(k.Message))
            }
        }
    };
    var d = (this.itemDescription === "Source") ? Explore.i18n("Deleting this source will delete the associated documents</br>") : "";
    d += String.format(Explore.i18n("AreYouSureYouWantToDeleteThe_"), this.itemDescription, b);
    if (a) {
        d = String.format(Explore.i18n("AreYouSureYouWantToDeleteThe_"), this.itemDescription, b) + Explore.i18n("RefreshApplication")
    }
    Explore.view.StatusBox.confirm(Explore.i18n("appTitle"), d, function() {
        var k = new Explore.view.DeleteConfirmationWindow({mytype:f,deleteFn:h.deleteFn,itemName:b,myId:c,callback:g});
        k.start()
    })
},getContextMenu:function() {
    var m = this;
    var u = Explore.view.DataSourcePicker.superclass.getContextMenu.call(this);
    var n = u.get("New" + m.itemDescription);
    var f = u.get("Delete" + m.itemDescription);
    var o = u.get("Edit" + m.itemDescription);
    var k = u.get("GroupSeparator");
    var d = u.getByItemId("RenameGroup");
    if (d == null) {
        d = u.insert(0, {itemId:"RenameGroup",text:Explore.i18n("EditGroup"),handler:function() {
            m.renameGroupCommand(m.contextMenuNode)
        }})
    }
    var g = u.getByItemId("AddGroup");
    if (g == null) {
        g = u.insert(1, {itemId:"AddGroup",iconCls:"new-icon",text:Explore.i18n("NewGroup"),handler:function() {
            m.newGroupCommand()
        }})
    }
    var a = u.getByItemId("DeleteGroup");
    if (a == null) {
        a = u.insert(2, {itemId:"DeleteGroup",iconCls:"delete-icon",text:Explore.i18n("DeleteGroup"),handler:function() {
            var w = m.contextMenuNode.attributes.tag.id;
            var v = m.contextMenuNode.attributes.text;
            m.confirmDeleteGroup(m.contextMenuNode.parentNode, v, w)
        }})
    }
    if (k == null) {
        k = u.insert(3, new Ext.menu.Separator({itemId:"GroupSeparator"}))
    }
    var r = u.get("NewSnapshot");
    if (r == null) {
        r = u.addItem({itemId:"NewSnapshot",iconCls:"new-icon",text:Explore.i18n("New") + " " + Explore.i18n("Snapshot"),handler:function() {
            var v = m.contextMenuNode.attributes.tag.snapshot;
            m.newSnapshot()
        }})
    }
    var l = u.get("EditSnapshot");
    if (l == null) {
        l = u.addItem({itemId:"EditSnapshot",iconCls:"edit-icon",text:Explore.i18n("Edit") + " " + Explore.i18n("Snapshot"),handler:function() {
            var v = m.contextMenuNode.attributes.tag.snapshot;
            m.editSnapshot(v, m.contextMenuNode, m.contextMenuNode.parentNode)
        }})
    }
    var q = u.get("DeleteSnapshot");
    if (q == null) {
        q = u.addItem({itemId:"DeleteSnapshot",iconCls:"delete-icon",text:Explore.i18n("Delete") + " " + Explore.i18n("Snapshot"),handler:function() {
            var w = m.contextMenuNode.attributes.tag.id;
            var v = m.contextMenuNode.attributes.text;
            m.confirmDeleteSnapshot(w, v, m.contextMenuNode.parentNode)
        }})
    }
    var t = u.get("newDataImport");
    if (t == null) {
        t = u.addItem({itemId:"newDataImport",iconCls:"new-icon",text:Explore.i18n("New") + " " + Explore.i18n("DataImport"),handler:function() {
            m.newDataImport()
        }})
    }
    var e = u.get("editDataImport");
    if (e == null) {
        e = u.addItem({itemId:"editDataImport",iconCls:"edit-icon",text:Explore.i18n("Edit") + " " + Explore.i18n("DataImport"),handler:function() {
            var x = m.contextMenuNode.attributes.tag.id;
            var v = m.contextMenuNode.attributes.text;
            var w = m.contextMenuNode.attributes.tag.dataimport;
            m.editDataImport(w, v)
        }})
    }
    var j = u.get("deleteDataImport");
    if (j == null) {
        j = u.addItem({itemId:"deleteDataImport",iconCls:"delete-icon",text:Explore.i18n("Delete") + " " + Explore.i18n("DataImport"),handler:function() {
            var w = m.contextMenuNode.attributes.tag.id || 0;
            var v = m.contextMenuNode.attributes.text;
            m.deleteDataImport(w, v)
        }})
    }
    var h = u.get("openMasbutton");
    if (!h) {
        h = u.addItem({itemId:"openMasbutton",text:Explore.i18n("MAS Profiles"),handler:function() {
            var v = new Ext.LoadMask(Ext.getBody(), {msg:Explore.i18n("Retrieving address of MAS")});
            v.show();
            ConfigurationService.GetConfigurationSettings(function(z) {
                v.hide();
                var x = z.CustomerMASGuid,y = z.AutomationServerUrl,w = String.format("{0}/?customerGUID={1}", y, x);
                window.open(w, "_blank")
            })
        }})
    }
    var b = m.contextMenuNode.attributes.id;
    var c = m.contextMenuNode.attributes.tag.type;
    var s = function() {
        var x = u.items.items;
        for (var v = 0; v < x.length; v++) {
            var w = x[v];
            w.hide()
        }
        u.disable()
    };
    s();
    if (m.contextMenuNode.attributes.id === "ALL-DATAIMPORTS") {
        u.enable();
        t.setVisible(true);
        t.setDisabled(!Explore.Security.isAuthorized("DATA_IMPORTS_CREATE"))
    } else {
        if (m.contextMenuNode.attributes.id === "ALL-SNAPSHOTS") {
            u.enable();
            r.setVisible(true);
            r.setDisabled(!Explore.Security.isAuthorized("SNAPSHOTS_CREATE"))
        } else {
            if (m.isLeafNode(m.contextMenuNode) && c === "SNAPSHOT") {
                u.enable();
                q.setVisible(true);
                q.setDisabled(!Explore.Security.isAuthorized("SNAPSHOTS_DELETE"));
                l.setVisible(true);
                l.setDisabled(!Explore.Security.isAuthorized("SNAPSHOTS_UPDATE"));
                r.setVisible(true);
                r.setDisabled(!Explore.Security.isAuthorized("SNAPSHOTS_CREATE"))
            } else {
                if (m.isLeafNode(m.contextMenuNode) && c === "SOURCE") {
                    u.enable();
                    n.setVisible(true);
                    n.setDisabled(!Explore.Security.isAuthorized("SOURCES_CREATE"));
                    o.setVisible(true);
                    o.setDisabled(!Explore.Security.isAuthorized("SOURCES_UPDATE"));
                    f.setVisible(true);
                    f.setDisabled(!Explore.Security.isAuthorized("SOURCES_DELETE"));
                    h.setVisible(true)
                } else {
                    if (m.isLeafNode(m.contextMenuNode) && c === "DATAIMPORT") {
                        u.enable();
                        t.setVisible(true);
                        t.setDisabled(!Explore.Security.isAuthorized("DATA_IMPORTS_CREATE"));
                        e.setVisible(true);
                        e.setDisabled(!Explore.Security.isAuthorized("DATA_IMPORTS_UPDATE"));
                        j.setVisible(true);
                        j.setDisabled(!Explore.Security.isAuthorized("DATA_IMPORTS_DELETE"))
                    } else {
                        if (!m.isLeafNode(m.contextMenuNode) && c === "GROUP") {
                            u.enable();
                            var p = m.contextMenuNode.attributes.tag.id;
                            g.setVisible(true);
                            g.setDisabled(!Explore.Security.isAuthorized("SOURCES_CREATE"));
                            k.setVisible(true);
                            k.setDisabled(!Explore.Security.isAuthorized("SOURCES_CREATE"));
                            n.setVisible(true);
                            n.setDisabled(!Explore.Security.isAuthorized("SOURCES_CREATE"));
                            o.setVisible(true);
                            o.setDisabled(!Explore.Security.isAuthorized("SOURCES_UPDATE"));
                            a.setVisible(true);
                            d.setVisible(true);
                            d.setDisabled(!Explore.Security.isAuthorized("SOURCES_UPDATE"));
                            a.setDisabled(m.contextMenuNode.attributes.tag.id == 1 || !Explore.Security.isAuthorized("SOURCES_DELETE"));
                            h.setVisible(true);
                            if (p !== 1) {
                                d.setDisabled(!Explore.Security.isAuthorized("SOURCES_CREATE"));
                                a.setDisabled(!Explore.Security.isAuthorized("SOURCES_DELETE"))
                            } else {
                                d.setVisible(false)
                            }
                        } else {
                            if (m.contextMenuNode.attributes.tag.id === 0) {
                                u.enable();
                                t.setVisible(true);
                                t.setDisabled(!Explore.Security.isAuthorized("DATA_IMPORTS_CREATE"));
                                r.setVisible(true);
                                r.setDisabled(!Explore.Security.isAuthorized("SNAPSHOTS_CREATE"));
                                n.setVisible(true);
                                n.setDisabled(!Explore.Security.isAuthorized("SOURCES_CREATE"))
                            }
                        }
                    }
                }
            }
        }
    }
    return u
},confirmDeleteGroup:function(h, b, c) {
    var m = this;
    var e = m.getNodeById("GROUP:" + c);
    var g = e.parentNode.attributes.id;
    var d = String.format(Explore.i18n("AreYouSureYouWantToDeleteThe_"), Explore.i18n("Source") + " " + Explore.i18n("Group"), b);
    var l = function(n) {
    };
    var k = function() {
        m.refreshAndSelectNode(null, "GROUP:" + c)
    };
    var a = Explore.data.SourceDataStore.deleteGroup;
    var f = function() {
        m.refreshAndSelectNode(null, g)
    };
    var j = "GROUP:" + c;
    Explore.view.StatusBox.confirm(Explore.i18n("appTitle"), d, function() {
        SourceService.GetSourceNodes(j, function(v) {
            var o = [];
            var u = {Id:c,leaf:false,name:b};
            o.push(u);
            var s = v;
            var n = function(x) {
                var A = x.text;
                var z = x.tag.id;
                var w = x.leaf;
                var y = {name:A,Id:z,leaf:w};
                return y
            };
            var t = function(x) {
                var z = n(x);
                o.push(z);
                for (var w = 0; x.children && w < x.children.length; w++) {
                    var y = n(x.children[w]);
                    o.push(y);
                    if (x.children[w].length > 0 || (x.children[w].children && x.children[w].children.length > 0)) {
                        t(x.children[w])
                    }
                }
            };
            for (var p = 0;
                 p < s.length; p++) {
                t(s[p])
            }
            var r = {mytype:"Source",results:o,deleteFn:m.deleteFn,deleteGroupFn:a,groupDelCallback:l,callback:l,cancelFn:k,doneFn:f};
            var q = new Explore.view.RecursiveDeleteWindow(r);
            q.start()
        })
    })
},confirmDeleteSnapshot:function(f, c, a) {
    var b = this;
    var d = String.format(Explore.i18n("AreYouSureYouWantToDeleteThe_"), Explore.i18n("Snapshot"), c);
    if (a === null) {
        a = b.getSelectionModel().getSelectedNode().parentNode
    }
    var e = function(g) {
        if (!g) {
            Explore.view.StatusBox.showError(Explore.i18n("appTitle"), Explore.i18n("RequestFailed"))
        }
        if (g && g.ErrorCode !== 0) {
            Explore.view.StatusBox.showError(Explore.i18n("appTitle"), g.Message)
        }
    };
    Explore.view.StatusBox.confirm(Explore.i18n("appTitle"), d, function() {
        var g = new Explore.view.DeleteConfirmationWindow({mytype:"Snapshot",deleteFn:Explore.data.SnapshotDataStore.deleteSnapshot,myId:f,callback:e});
        g.start()
    })
},editSnapshot:function(c, b, a) {
    var d = new Explore.view.SnapshotEditDialog({editObject:c,listeners:{save:function(e, f) {
        Explore.data.SnapshotDataStore.saveSnapshot(f, function(g) {
            log.info("saveSnapshot: ", g);
            if (g.ErrorCode > 0) {
                Explore.view.StatusBox.showWarning(Explore.i18n("appTitle"), g.Message)
            } else {
                e.close()
            }
        })
    }}});
    d.show()
},newSnapshot:function() {
    var a = new Explore.view.SnapshotSearchWindow();
    a.show()
},deleteDataImport:function(e, b) {
    var a = this;
    var c = String.format(Explore.i18n("AreYouSureYouWantToDeleteThe_"), Explore.i18n("DataImport"), b);
    var d = function(f) {
    };
    Explore.view.StatusBox.confirm(Explore.i18n("appTitle"), c, function() {
        var f = new Explore.view.DeleteConfirmationWindow({mytype:"DataImport",deleteFn:Explore.data.DataImportStore.deleteDataImport,myId:e,callback:d,itemName:b});
        f.start()
    })
},editDataImport:function(d, b) {
    var a = this;
    var c = new Explore.view.importdata.ImportDataWindow({obj:d});
    c.show()
},newDataImport:function() {
    var a = this;
    var b = new Explore.view.importdata.ImportDataWindow();
    b.show()
},renameGroupCommand:function(b) {
    var c = b.attributes.tag.id;
    var a = b.attributes.text;
    Explore.view.StatusBox.prompt(Explore.i18n("appTitle"), Explore.i18n("EnterGroupName"), a, function(d) {
        if (d) {
            Explore.data.SourceDataStore.renameGroup(c, d, function(e) {
                if (e.ErrorCode == 0) {
                } else {
                    Explore.view.StatusBox.showError(Explore.i18n("appTitle"), e.Message)
                }
            })
        }
    })
},newCommand:function() {
    var a = this;
    var b = a.getSelectionModel().getSelectedNode();
    if (b) {
        if (b.id === "ALL-SNAPSHOTS" || b.attributes.tag && b.attributes.tag.type === "SNAPSHOT") {
            var d = new Explore.view.SnapshotSearchWindow();
            d.show()
        } else {
            if (b.id === "ALL-DATAIMPORTS" || b.attributes.tag && b.attributes.tag.type === "DATAIMPORT") {
                a.newDataImport()
            } else {
                if (this.isLeafNode(b)) {
                    b = b.parentNode
                }
                var c = {GroupId:(b && b.attributes && b.attributes.tag && b.attributes.tag.id) ? b.attributes.tag.id : 1};
                var e = new a.editDialogFn({editObject:c,readOnly:false});
                if (e.on) {
                    e.on("save", function() {
                        a.onSave(c)
                    });
                    e.show(a)
                }
            }
        }
    } else {
        Explore.view.StatusBox.showWarning(Explore.i18n("appTitle"), String.format(Explore.i18n("FirstSelectAGroupInWhichToAddTheNew_"), this.itemDescription));
        return
    }
},newGroupCommand:function(b) {
    var a = this;
    var b = a.getSelectionModel().getSelectedNode();
    if (b) {
        if (this.isLeafNode(b)) {
            b = b.parentNode
        }
        Explore.view.StatusBox.prompt(Explore.i18n("appTitle"), Explore.i18n("EnterGroupName"), "", function(c) {
            if (c) {
                var d = {Parent:parseInt(b.attributes.tag.id, 10),Name:c,Description:""};
                Explore.data.SourceDataStore.saveGroup(d, function(e) {
                    if (e.ErrorCode != 0) {
                        Explore.view.StatusBox.showError(Explore.i18n("appTitle"), e.Message, function(f) {
                            if (e.ErrorCode === 54003) {
                                a.newGroupCommand()
                            }
                        })
                    }
                })
            }
        })
    } else {
        Explore.view.StatusBox.showWarning(Explore.i18n("appTitle"), String.format(Explore.i18n("FirstSelectAGroupInWhichToAddTheNew_"), Explore.i18n("Group")));
        return
    }
},getSelectedDataImports:function() {
    var b = this;
    var d = new Array();
    var a = b.getChecked();
    if (a && a.length > 0) {
        for (var c in a) {
            if (a[c].id) {
                var e = a[c].id.split(":");
                if (e[0] === "DATAIMPORT") {
                    d.push(parseInt(e[1]))
                }
            }
        }
    }
    return d
},setSelectedDataImports:function(b) {
    var a = this;
    if (b) {
        var c = new Array();
        for (id in b) {
            c.push("DATAIMPORT:" + b[id].toString())
        }
        a.checkObjectIds(c)
    }
},getSelectedSources:function() {
    var c = this;
    var b = new Array();
    var a = c.getChecked();
    if (a && a.length > 0) {
        for (var d in a) {
            if (a[d].id) {
                var e = a[d].id.split(":");
                if (e[0] === "SOURCE") {
                    b.push(parseInt(e[1]))
                }
            }
        }
    }
    return b
},setSelectedSources:function(c) {
    var b = this;
    if (c) {
        var a = new Array();
        for (id in c) {
            a.push("SOURCE:" + c[id].toString())
        }
        b.checkObjectIds(a)
    }
},getSelectedSnapshots:function() {
    var b = this;
    var e = new Array();
    var a = b.getChecked();
    if (a && a.length > 0) {
        for (var c in a) {
            if (a[c].id) {
                var d = a[c].id.split(":");
                if (d[0] === "SNAPSHOT") {
                    e.push(parseInt(d[1]))
                }
            }
        }
    }
    return e
},setSelectedSnapshots:function(b) {
    var a = this;
    if (b) {
        var c = new Array();
        for (id in b) {
            c.push("SNAPSHOT:" + b[id].toString())
        }
        a.checkObjectIds(c)
    }
}});
Ext.reg("explore.view.datasourcepicker", Explore.view.DataSourcePicker);
Ext.ns("Explore.view");
Explore.view.DateHistogram = Ext.extend(Ext.DataView, {No_items_to_display:"No items to display",outputDateFormat:null,hourlyOutputDateFormat:null,hourlyTooltipDateFormat:null,noData:null,initComponent:function() {
    var a = this;
    a.registerEvents();
    a.initVars();
    var b = {store:new Ext.data.JsonStore({fields:["text","count","fromDate","toDate","duration","css"],data:{histogram:[]},root:"histogram"}),tpl:a.noData,itemSelector:".ius-histogram-column",cls:"ius-histogram",overClass:"ius-histogram-column-over",listeners:{mouseenter:function(c, d, g, h) {
        var f = g.attributes.tip.nodeValue;
        if (!g.tooltip) {
            g.tooltip = new Ext.ToolTip({html:f,constrainPosition:true,target:g})
        } else {
            g.tooltip.show()
        }
    },mouseleave:function(c, d, f, g) {
    },click:function(f, k, d, c) {
        var g = f.getRecord(d);
        if (g) {
            var j = g.get("count");
            var e = g.get("duration");
            var m = g.get("fromDate");
            var h = g.get("toDate");
            var l = {fromDate:m,toDate:h,count:j,allowDrill:e > Explore.model.Duration.Hour};
            a.fireEvent("filterDateClick", l)
        }
    }}};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.DateHistogram.superclass.initComponent.apply(this, arguments)
},initVars:function() {
    var a = this;
    a.outputDateFormat = Explore.getDateFormatByPref({ignoreTime:true});
    a.hourlyOutputDateFormat = Explore.getDateFormatByPref({ignoreTime:true}) + "<\\b\\r />" + Explore.getDateFormatByPref({ignoreDate:true});
    a.hourlyTooltipDateFormat = Explore.getDateFormatByPref({ignoreTime:false});
    a.noData = new Ext.XTemplate(String.format('<div class="ius-results-header">{0}</div>', a.No_items_to_display))
},getLinearScaler:function(c, d, b) {
    var a = b / (d - c);
    return{scale:function(f) {
        var e = (f - c) * a;
        return e
    }}
},getLogarithmicScaler:function(c, d, b) {
    var a = b / Math.max(1, Math.log(d));
    return{scale:function(f) {
        var e = 0;
        if (f > 0) {
            e = Math.max(1, Math.log(f)) * a
        }
        return e
    }}
},loadResults:function(q) {
    var l = this;
    var A = l.noData;
    var B = {histogram:[]};
    if (q != null) {
        var p = q.ParametricData;
        var d = Explore.parseSerializedDate(q.FirstResultDate);
        var t = Explore.parseSerializedDate(q.LastResultDate);
        p = Explore.convertGraphDataEpochsData(q.ParametricData);
        if (p && p.length > 0) {
            var n = 0;
            var r = 0;
            var v = 0;
            var o = l.chartHeight || 200;
            var b = null;
            var s = null;
            var y = [];
            var a = Explore.determineTimeInterval(d, t, l.getTimeInterval());
            var c = Explore.i18n(Explore.model.Duration.getName(a).toLowerCase());
            var m = (a === Explore.model.Duration.Hour) ? l.hourlyOutputDateFormat : l.outputDateFormat;
            var j = (a === Explore.model.Duration.Hour) ? l.hourlyTooltipDateFormat : l.outputDateFormat;
            var w = false;
            for (r = 0; r < p.length; r++) {
                var k = Explore.parseSerializedDate(Explore.parseSerializedDate(p[r].StartDate));
                var x = Explore.parseSerializedDate(Explore.parseSerializedDate(p[r].EndDate));
                if (k && x) {
                    if (b === null || b > k) {
                        b = k
                    }
                    if (s === null || s < k) {
                        s = k
                    }
                    if (p[r].Count > 0) {
                        w = true
                    }
                    v++;
                    n = p[r].Count > n ? p[r].Count : n;
                    var u = Ext.util.Format.date(k, j);
                    y.push({text:String.format("{0} - Documents from <br/>{1} to<br/> {2}", Explore.formatNumber(p[r].Count), k.format("M-d-Y g:i a"), x.format("M-d-Y g:i a")),count:p[r].Count,fromDate:k,toDate:x,duration:a,css:"ius-histogram-column-data"})
                }
            }
            var e = o * 4;
            var f = (n <= e) ? l.getLinearScaler(0, n, o) : l.getLogarithmicScaler(0, n, o);
            for (r = 0; r < y.length; r++) {
                if (y[r]) {
                    y[r].count = f.scale(y[r].count)
                }
            }
            var z = Math.floor(100 / (y.length + 2));
            var h = Math.round(y.length / 2);
            formattedStartDate = "";
            formattedEndDate = "";
            B.histogram = y;
            if (w) {
                formattedStartDate = Ext.util.Format.date(d, m);
                formattedEndDate = Ext.util.Format.date(t, m);
                if (formattedStartDate === formattedEndDate || p.length <= 1) {
                    formattedEndDate = ""
                }
            }
            var g = (o + 25) + "px";
            A = new Ext.XTemplate('<table class="ius-histogram" cellpadding="0" cellspacing="0" height="' + g + '">', "<tbody>", '<tr class="ius-histogram-row" valign="bottom">', '<tpl for=".">', '<td class="ius-histogram-column {css}" tip="{text}" style="width:' + z + '%">', '<div style="height:{count}px"></div>', "</td>", "</tpl>", "</tr>", "<tr>", '<td class="ius-histogram-footer" style="text-align:left" colspan="' + h + '">' + (formattedStartDate) + "</td>", '<td class="ius-histogram-footer" style="text-align:right" colspan="' + (y.length - h) + '">' + formattedEndDate + "</td>", "</tr>", "</tbody>", "</table>")
        }
    }
    l.tpl = A;
    l.getStore().loadData(B)
},getTimeInterval:function() {
    var a = {byHour:3,bySixHours:8,byDay:46,byWeek:367,byYear:1085};
    return a
},registerEvents:function() {
    var a = this;
    var b = ["filterDateClick"];
    a.addEvents(b);
    a.enableBubble(b)
}});
Ext.reg("explore.view.datehistogram", Explore.view.DateHistogram);
Ext.ns("Explore.view");
Explore.view.DocCountColumn = Ext.extend(Ext.grid.Column, {header:Explore.i18n("Documents"),width:80,sortable:false,batchSize:5,grid:null,defaultType:"PROJECT",init:function(c) {
    var b = this;
    this.grid = c;
    this.tips = [];
    b.gridId = c.getId();
    var a = this.grid.getStore();
    a.on("load", this.onLoadData, this);
    this.grid.on("destroy", this.destroyTips, this);
    this.renderer = function(l, d, g, k, m, j) {
        var e = g.get("Id");
        var h = g.get("SourceType") || b.defaultType;
        var f = b.gridId + "-cell-" + h + "-" + e;
        return'<span id="' + f + '">' + Explore.i18n("Calculating") + "</span>"
    }
},onLoadData:function(f, b, j) {
    log.info("onLoadData");
    var h = this;
    h.docCounts = {};
    h.destroyTips();
    if (b && b.length > 0) {
        var g = [];
        for (var c = 0; c < b.length; c++) {
            var d = b[c];
            var a = d.get("Id");
            var e = d.get("SourceType") || this.defaultType;
            if (!Ext.isNumber(a)) {
                log.warn("Id is non-numeric in DocCountColumn: " + a)
            } else {
                g.push({Id:a,Type:e})
            }
        }
        DocumentCountService.GetDocCountsDb(g, function(k) {
            h.updateDocCounts(k);
            h.getMissingDocCountsFromIdol(g)
        })
    }
},destroyTips:function() {
    for (var a = 0; a < this.tips.length; a++) {
        this.tips[a].destroy()
    }
    this.tips = []
},updateDocCounts:function(h) {
    var b = this;
    if (h) {
        for (var c = 0; c < h.length; c++) {
            var f = h[c];
            var g = f.ParentId;
            var d = f.Type;
            b.docCounts[d + g] = f;
            var e = b.gridId + "-cell-" + d + "-" + g;
            var a = b.grid.getEl().child("#" + e);
            if (a) {
                a.update(Explore.formatNumber(f.TotalCount));
                if (f.TotalCount > 0) {
                    b.tips.push(new Explore.view.common.DocCountToolTip({target:a.up("td"),documentCounts:f}))
                }
            }
        }
    }
},getMissingDocCountsFromIdol:function(f) {
    var a = this;
    var e = [];
    var d = [];
    for (var c = 0; c < f.length; c++) {
        var b = f[c];
        if (!a.docCounts[b.Type + b.Id]) {
            if (e.length >= a.batchSize) {
                d.push(b)
            } else {
                e.push(b)
            }
        }
    }
    if (e.length > 0) {
        DocumentCountService.GetDocCountsIDOL(e, function(g) {
            a.updateDocCounts(g);
            if (d.length > 0) {
                a.getMissingDocCountsFromIdol(d)
            }
        })
    }
}});
Ext.reg("explore.view.doccountcolumn", Explore.view.DocCountColumn);
Ext.ns("Explore.view");
Explore.view.EngagementPicker = Ext.extend(Ext.tree.TreePanel, {itemDescription:Explore.i18n("Engagement"),cls:"engagement-picker-tree hierarchy-tree",useArrows:true,showExapndCollapseAll:true,maskDisabled:true,rootVisible:true,checkable:false,initComponent:function() {
    var a = this;
    this.refreshTimestamp = new Date();
    a.root = new Ext.tree.TreeNode({nodeType:"node",text:Explore.i18n("AllStatuses"),id:"root-node",expanded:true,tag:{type:-1,id:0,isCustom:false}});
    a.loadFn = Explore.data.EngagementDataStore.getEngagementStatus;
    a.saveFn = Explore.data.EngagementDataStore.saveEngagementStatus;
    a.deleteFn = Explore.data.EngagementDataStore.deleteEngagementStatus;
    a.editDialogFn = Explore.view.EngagementStatusDialog;
    var c = this.checkable ? false : undefined;
    this.loader = new Ext.tree.TreeLoader({preloadChildren:true,clearOnLoad:true,directFn:EngagementService.GetEngagementStatusNodes,baseParams:{},baseAttrs:{uiProvider:Ext.tree.TriStateNodeUI,checked:c,singleClickExpand:true}});
    if (!this.tools) {
        this.tools = []
    }
    this.tools.push({id:"refresh",qtip:Explore.i18n("refresh"),handler:function() {
        a.refresh()
    }});
    var b = {root:a.root,rootVisible:true,loader:this.loader};
    a.on("contextmenu", a.onEngagementContextMenu, a);
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.EngagementPicker.superclass.initComponent.apply(this, arguments);
    a.refresh();
    this.on("click", function(d) {
        if (d && d.toggle) {
            d.toggle()
        }
    });
    a.on("contextmenu", a.onEngagementContextMenu, a)
},newCommand:function(b) {
    var a = this;
    b = Ext.apply({editObject:{Id:0},readOnly:false}, b);
    a.showEngagementStatusDialog(b, {})
},editCommand:function(d, b) {
    var a = this;
    if (!d) {
        Explore.view.StatusBox.showWarning(Explore.i18n("SelectAEngagementStatus"), Explore.i18n("FirtsSelectAEngagementStatusToEdit"))
    } else {
        var c = d.id;
        var e = {Id:c};
        Explore.data.EngagementDataStore.getEngagementStatus(c, function(f) {
            if (f !== null) {
                b = Ext.apply({editObject:f,readOnly:false,title:Explore.i18n("EditEngagementStatus")}, b);
                log.debug("Open Engagement Status dialog for engagement: ", d.id, " config: ", b);
                a.showEngagementStatusDialog(b, f)
            }
        })
    }
},deleteCommand:function(c) {
    var a = this;
    var c = c || a.getSelectionModel().getSelectedNode();
    var f = c.id;
    if (!c) {
        Explore.view.StatusBox.showWarning(Explore.i18n("SelectAEngagementStatus"), Explore.i18n("FirstSelectAEngagementStatusToDelete"))
    } else {
        var b = c.attributes.tag.id;
        var e = function(g) {
            if (c.parentNode) {
                a.refresh(c.parentNode);
                a.requiresRefresh()
            }
            a.fireEvent("engagementStatusDeleted", b)
        };
        var d = String.format(Explore.i18n("AreYouSureYouWantToDeleteTheEngagement_"), c.text);
        Explore.view.StatusBox.confirm(Explore.i18n("appTitle"), d, function() {
            var g = new Explore.view.DeleteConfirmationWindow({mytype:"Engagement",deleteFn:Explore.data.EngagementDataStore.deleteEngagementStatus,myId:b,callback:e});
            g.start();
            rootNode = a.getRootNode();
            rootNode.select()
        })
    }
},showEngagementStatusDialog:function(b, c) {
    var a = this;
    var d = new a.editDialogFn({editObject:c,readOnly:false,config:b});
    d.on("save", function(e, f) {
        Explore.data.EngagementDataStore.saveEngagementStatus(f, function(g) {
            if (g.ErrorCode > 0) {
                log.error("Error saving engagement status. Error Code: " + g.ErrorCode.toString())
            } else {
                a.refresh(c, function() {
                    var h = a.getNodeById(g.Result.Id);
                    if (h) {
                        h.ensureVisible();
                        h.select()
                    }
                });
                a.fireEvent("engagementStatusSaved", f)
            }
        })
    });
    d.show(a)
},getEngagementContextMenu:function(b) {
    var a = this;
    if (!this._engagementContextMenu) {
        this._engagementContextMenu = new Ext.menu.Menu({items:[
            {itemId:"new",text:Explore.i18n("NewEngagementStatus"),iconCls:"new-icon",handler:function() {
                a.newCommand({})
            }},
            {itemId:"edit",text:Explore.i18n("EditEngagementStatus"),iconCls:"edit-icon",handler:function() {
                a.contextMenuNode.select();
                a.editCommand(a.contextMenuNode, {})
            }},
            {itemId:"delete",text:Explore.i18n("DeleteEngagementStatus"),iconCls:"delete-icon",handler:function() {
                a.contextMenuNode.select();
                a.deleteCommand(a.contextMenuNode)
            }}
        ]})
    }
    var c = this._engagementContextMenu;
    menuItem = c.getByItemId("new");
    menuItem.setDisabled(!Explore.Security.isAuthorized("ENGAGEMENT_STATUS_CREATE"));
    menuItem = c.getByItemId("edit");
    menuItem.setDisabled(((b.id == "root-node") || (!Explore.Security.isAuthorized("ENGAGEMENT_STATUS_UPDATE"))));
    menuItem = c.getByItemId("delete");
    menuItem.setDisabled(((b.id == "root-node") || (!Explore.Security.isAuthorized("ENGAGEMENT_STATUS_DELETE"))));
    return c
},onEngagementContextMenu:function(d, f) {
    var a = this;
    if (d && d.attributes && d.attributes.tag) {
        f.stopEvent();
        var c = d.attributes.tag.type;
        var h = d.attributes.tag.id;
        var g = d.attributes.tag.readOnly;
        var b = null;
        b = a.getEngagementContextMenu(d);
        if (b) {
            d.select();
            a.contextMenuNode = d;
            b.showAt(f.getXY())
        }
    }
},requiresRefresh:function() {
    Explore.view.EngagementPicker.lastRefresh = new Date()
},refreshDirty:function(b, c) {
    var a = this;
    if (a.refreshTimestamp < Explore.view.EngagementPicker.lastRefresh) {
        a.refreshTimestamp = new Date();
        a.refresh(b, c)
    } else {
        if (c) {
            c()
        }
    }
}});
Ext.reg("explore.view.engagementpicker", Explore.view.EngagementPicker);
Ext.ns("Explore.view");
Explore.view.EngagementStatusDialog = Ext.extend(Explore.base.EditorDialog, {itemDescription:Explore.i18n("EngagementStatus"),readOnly:true,height:200,initComponent:function() {
    var b = this;
    var c = this.editObject;
    var a = (c.id > 0) ? false : true;

    function d(e) {
        return(e === 1) ? true : false
    }

    b.formItems = [
        {name:"Name",allowBlank:false,width:"95%",maxLength:60,disabled:d(c.Id)},
        {name:"Description",allowBlank:true,width:120,xtype:"textarea",disabled:d(),fieldLabel:Explore.i18n("Description"),width:"95%",height:60,value:""}
    ];
    Explore.view.EngagementStatusDialog.superclass.initComponent.apply(this, arguments);
    b.on("afterrender", function() {
        b.getByItemId("myForm").getForm().isValid()
    }, b, {single:true})
},displayObject:function() {
    Explore.view.EngagementStatusDialog.superclass.displayObject.call(this);
    this.getByItemId("Name").setValue(this.editObject.Name);
    this.getByItemId("Description").setValue(this.editObject.Description)
},populateObject:function() {
    Explore.view.EngagementStatusDialog.superclass.populateObject.call(this)
}});
Explore.view.EngagementsDetail = Ext.extend(Explore.base.AdministrationDetailPanelBase, {initComponent:function() {
    var a = this;
    a.formItems = [
        {itemId:"allengagements",xtype:"explore.view.allengagements",anchor:"100% 100%",hidden:true},
        {name:"Name"},
        {name:"Description"}
    ];
    Explore.view.EngagementsDetail.superclass.initComponent.apply(this, arguments)
},displayObject:function(c) {
    Explore.view.EngagementsDetail.superclass.displayObject.call(this, c);
    this.getByItemId("allengagements").setVisible(!c);
    this.getByItemId("allengagements").refreshGrid();
    var d = this.topToolbar.getByItemId("newButton");
    var b = this.topToolbar.getByItemId("editButton");
    var e = this.topToolbar.getByItemId("deleteButton");
    var a = this.topToolbar.getByItemId("viewButton")
},updateButtonState:function() {
    var b = this.currentObject == null;
    if (this.topToolbar.getByItemId) {
        var c = this.topToolbar.getByItemId("editButton");
        if (c) {
            c.setDisabled(b || !Explore.Security.isAuthorized("ENGAGEMENT_STATUS_UPDATE"));
            c.setVisible(true)
        }
        var d = this.topToolbar.getByItemId("deleteButton");
        if (d) {
            d.setDisabled(b || (this.currentObject.Id === 1) || !Explore.Security.isAuthorized("ENGAGEMENT_STATUS_DELETE"));
            d.setVisible(true)
        }
        var a = this.topToolbar.getByItemId("viewButton");
        if (a) {
            a.setVisible(false)
        }
    }
}});
Ext.reg("explore.view.engagementsdetail", Explore.view.EngagementsDetail);
Ext.ns("Explore.view");
Explore.view.FileTypePanel = Ext.extend(Ext.Panel, {checkall:false,docTypes:[],initComponent:function() {
    var a = this;
    var b = {frame:false,border:false,disabled:true};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.FileTypePanel.superclass.initComponent.apply(this, arguments);
    this.postConstructorLoad()
},postConstructorLoad:function() {
    var a = this;
    a.disable();
    a.getDocumentTypeOptions(function(b) {
        var c = {itemId:"fileTypeChecks",autoScroll:true,xtype:"explore.view.common.checkboxgroup",showHeaderCheck:true,checked:a.checkall,headerText:Explore.i18n("AllFileTypes") + ":",items:b};
        a.add(c);
        a.doLayout();
        if (b.length > 0) {
            a.enable()
        } else {
            Explore.view.StatusBox.showError(Explore.i18n("Documents Load Error"), Explore.i18n("Failed to load document types"))
        }
        a.fireEvent("filetypesloaded")
    })
},getDocumentTypeOptions:function(c) {
    var b = this;
    var a = [];
    Explore.data.ProjectDataStore.getProjectDocumentTypes(function(f) {
        var d = f;
        if (d) {
            for (var e = 0; e < d.length; e++) {
                var g = d[e];
                a.push({itemId:g.toLowerCase(),boxLabel:Explore.i18n(g),checked:b.contains(g.toLowerCase())})
            }
        }
        c(a)
    })
},contains:function(c) {
    if (this.checkall && this.docTypes.length == 0) {
        return true
    }
    var a = this.docTypes;
    for (var b = 0; b < a.length;
         b++) {
        if (a[b] === c) {
            return true
        }
    }
    return false
}});
Ext.reg("explore.view.filetypepanel", Explore.view.FileTypePanel);
Ext.ns("Explore.view");
Explore.view.FilterOptions = Ext.extend(Ext.Panel, {myEvents:["searchFilterChange"],docTypesFilter:"Type",histogram:null,customFilters:null,nodeExpandedState:{},loadedIconCls:"loaded",unloadedIconCls:"unloaded",currentSearchCriteria:null,initComponent:function() {
    var a = this;
    a.preloadConfig();
    var c = {layout:"fit",border:false,items:[a.constructFilterTree()]};
    a.initTools(c);
    Ext.apply(this, Ext.apply(this.initialConfig, c));
    Explore.view.FilterOptions.superclass.initComponent.apply(this, arguments);
    this.addEvents(a.myEvents);
    this.enableBubble(a.myEvents);
    var b = Ext.getCmp("searchPanel");
    if (b) {
        var d = this.searchPresenter = b.getSearchPresenter();
        if (d) {
            d.on("newSearchStarted", function(h) {
                a.clearDateHistogram();
                a.clearTypeFilter();
                a.clearAllCustomFilters();
                var e = a.getByItemId("filter-tree");
                var g = e.getNodeById("filter-Type");
                var f = e.getNodeById("filter-Date");
                if (f) {
                    f.collapse()
                }
                if (g) {
                    g.setText(Explore.i18n("Type"))
                }
            });
            d.on("newSearchCompleted", function(f, e, g) {
                a.clearTypeFilter();
                a.getCriteriaItemsForDocTypeReturned(g)
            });
            d.on("searchErrored", function(g) {
                a.clearDateHistogram();
                a.clearAllCustomFilters();
                var e = a.getByItemId("filter-tree");
                var f = e.getNodeById("filter-Type");
                if (f) {
                    f.setText(Explore.i18n("Type"))
                }
            });
            d.on("searchCleared", function() {
                a.clearDateHistogram();
                a.clearAllCustomFilters();
                var e = a.getByItemId("filter-tree");
                var f = e.getNodeById("filter-Type");
                if (f) {
                    f.setText(Explore.i18n("Type"))
                }
            })
        }
    }
    a.toolDecorator = new Explore.view.common.DisabledToolDecorator(a, c)
},expandFilters:function(e) {
    var b = this;
    var f = false;
    var d;
    if (e && e.length > 0) {
        var a = b.getByItemId("filter-tree");
        if (a) {
            for (var c = 0; c < e.length; c++) {
                if (e[c].type == "Date") {
                    d = a.getNodeById("filter-Date");
                    b.loadHistogram(d);
                    d.expand()
                } else {
                    d = a.getNodeById("filter-" + e[c].friendlyType);
                    if (d) {
                        b.loadCustomFilter(d, f)
                    }
                }
            }
        }
    }
},getCriteriaItemsForDocTypeReturned:function(e) {
    var c = this;
    var a = Ext.getCmp("searchPanel");
    if (a) {
        var d = Ext.getCmp("searchPanel").getSearchPresenter();
        if (d && d.currentResultsJsonData) {
            var b = d.currentResultsJsonData.countsByType;
            if (b) {
                Explore.data.IDOLDataStore.getParametricFiltersForResultDocs(b, function(g) {
                    c.clearAllCustomFilters();
                    c.customFilters = g;
                    if (g) {
                        var f = c.getByItemId("filter-tree");
                        c.createNodes(f, g, f.getRootNode());
                        c.expandFilters(e)
                    }
                })
            }
        }
    }
},loadHistogram:function(e) {
    var b = this;
    var c = Ext.getCmp("searchPanel");
    if (c) {
        var d = this.searchPresenter = c.getSearchPresenter();
        if (d && d.getCurrentSearchCriteria() !== b.currentSearchCriteria) {
            var a = new Ext.LoadMask(b.getEl(), {msg:"Loading Histogram"});
            a.show();
            d.loadHistogramByCriteria(d.getCurrentSearchCriteria(), function(f) {
                a.hide();
                b.currentSearchCriteria = d.getCurrentSearchCriteria();
                b.loadDateHistogram(f)
            })
        }
    }
},preloadConfig:function() {
    var a = this;
    a.histogram = new Explore.view.DateHistogram({itemId:"histogram",height:130,chartHeight:100,dateHistogramItemText:"{0} documents during {1} {2}"})
},initTools:function(a) {
    var b = this;
    a.tools = [
        {id:"collapse",qtip:Explore.i18n("EnableMultiSelect"),disabled:false,handler:function(e, d, c) {
            b.toggleMultiSelect()
        }},
        {id:"applyFilter",qtip:Explore.i18n("ApplyFilters"),disabled:true,handler:function(e, d, c) {
            if (b.enableMultiSelect) {
                b.applyMultiFilters()
            }
        }}
    ];
    b.toolDecorator = new Explore.view.common.DisabledToolDecorator(b, a)
},getIconCls:function(a) {
    var b = "";
    if (!a || a.UseIcons !== true) {
        b = "no-icon"
    }
    return b
},getIcon:function(a, c) {
    var b = null;
    if (a && c && a.TagName && c.Field) {
        b = "../resources/images/icons/icn_filter_" + a.TagName + "_" + c.Field + "_16.png"
    }
    return b
},clearCustomFiltersByName:function(d) {
    var c = this;
    if (d) {
        var a = c.getByItemId("filter-tree");
        if (a) {
            var e = a.getNodeById("filter-" + d);
            if (e) {
                e.loaded = false;
                var b = e.isExpanded();
                if (b) {
                    e.collapse()
                }
                e.removeAll();
                this.nodeExpandedState[e.id] = b
            }
        }
    }
},retrieveFilterOptions:function() {
    var b = this;
    b.customFilters = null;
    var a = {text:"",id:"filterOptionsRootNode",children:[]};
    a.children.push({id:"filter-Date",text:Explore.i18n("Date"),iconCls:"no-icon",leaf:false,singleClickExpand:true,expanded:false,listeners:{expand:b.loadHistogram,scope:b},children:[
        {id:"date-histogram-node",nodeType:"node",leaf:true,checked:false,uiProvider:Explore.view.TreeNodeUIContainer,item:b.histogram}
    ]});
    a.children.push({id:"filter-Type",text:Explore.i18n("Type"),iconCls:this.unloadedIconCls,leaf:false,nodeType:"node",singleClickExpand:true,expanded:true});
    return a
},treeNodeMultiSelectHandler:function(c) {
    var a = this;
    if (a.enableMultiSelect) {
        c.getUI().toggleCheck()
    } else {
        if (c.leaf) {
            var b = [a.createFilterFromTag(c.attributes.tag)];
            log.info("FilterOptions firing event searchFilterChange", b);
            a.fireEvent("searchFilterChange", b)
        }
    }
},getCustomImageFile:function(b) {
    var c = "../resources/images/icons/search_dis.gif";
    var a = "../resources/images/filter_icons/";
    if (b) {
        if (b.trim().length > 0) {
            c = a.concat(b.trim())
        }
    }
    return c
},constructFilterTree:function() {
    var b = this;
    var a = {xtype:"treepanel",itemId:"filter-tree",cls:"filter-tree",root:b.retrieveFilterOptions(),border:false,collapsible:false,useArrows:true,autoScroll:true,animate:true,animCollapse:true,enableDD:false,containerScroll:true,rootVisible:false,padding:"0 0 10 0",lines:false,selModel:new Ext.tree.DefaultSelectionModel({listeners:{selectionchange:function(c, d) {
        if (d) {
            b.treeNodeMultiSelectHandler(d)
        }
    }}}),listeners:{beforeload:function(c) {
        if (c.attributes.isCustomFilter) {
            var d = true;
            b.loadCustomFilter(c, b, d);
            return false
        }
        return true
    },expandnode:function(c) {
        this.nodeExpandedState[c.id] = true
    },collapsenode:function(c) {
        this.nodeExpandedState[c.id] = false
    },beforerender:function(c) {
        b.toggleMultiSelect(false)
    },scope:this}};
    return a
},createNodes:function(m, j, e) {
    var b;
    for (var f = 0;
         f < j.Groups.length; f++) {
        var h = j.Groups[f];
        b = "group-" + h.Name;
        var a = e.appendChild({id:b,text:h.Name,singleClickExpand:true,isCustomFilterGroup:true,nodeType:"node",expanded:this.nodeExpandedState[b],leaf:false});
        this.createNodes(m, h, a)
    }
    for (var d = 0; d < j.Items.length; ++d) {
        var l = j.Items[d];
        var k = m.getNodeById("filter-" + l.Name);
        if (!(l.Name === "Sentiment" && !(Explore.data.PreferenceDataStore.getShowSentimentPreference())) && !k) {
            b = "filter-" + l.Name;
            var c = e.appendChild({id:b,text:l.Name,tag:l.FilterTag,isCustomFilter:true,iconCls:"filter-clear",icon:this.getCustomImageFile(l.IconFileName),leaf:false,nodeType:"async",singleClickExpand:true});
            if (this.nodeExpandedState[b]) {
                c.expand()
            }
        }
    }
},toggleMultiSelect:function(c) {
    var b = this;
    if (c !== undefined) {
        b.enableMultiSelect = c
    } else {
        b.enableMultiSelect = !b.enableMultiSelect
    }
    if (b.enableMultiSelect) {
        b.toolDecorator.enableTools(["applyFilter"])
    } else {
        b.toolDecorator.disableTools(["applyFilter"])
    }
    var a = b.getByItemId("filter-tree");
    if (a) {
        if (b.enableMultiSelect === true) {
            a.removeClass("hide-node-checkbox");
            b.toolDecorator.enableTools(["cloud"])
        } else {
            a.addClass("hide-node-checkbox");
            b.toolDecorator.disableTools(["cloud"])
        }
    }
},findFilter:function(c, b) {
    if (c && b) {
        for (var a = 0;
             a < c.length; ++a) {
            if (c[a] && c[a].type === b) {
                return c[a]
            }
        }
    }
    return null
},createFilterFromTag:function(a) {
    var c = function(d) {
        if (typeof(d) === "string") {
            return[d]
        }
        return d
    };
    var b = {type:a.type,friendlyValue:a.friendlyValue,friendlyType:a.friendlyType,values:c(a.val),friendlyValues:[a.friendlyValue || a.value]};
    return b
},_appendTagToFilter:function(b, a) {
    b.values = b.values.concat(a.val);
    b.friendlyValue += "," + a.friendlyValue;
    b.friendlyValues.push(a.friendlyValue || a.value)
},appendTagToFilter:function(f) {
    var c = this;
    var b = [];
    for (var d = 0; d < f.length; ++d) {
        var a = f[d];
        var e = c.findFilter(b, a.type);
        if (e) {
            c._appendTagToFilter(e, a)
        } else {
            e = c.createFilterFromTag(a);
            b.push(e)
        }
    }
    return b
},applyMultiFilters:function() {
    var c = this;
    if (c.enableMultiSelect === true) {
        var a = c.getByItemId("filter-tree");
        if (a) {
            var f = a.getChecked();
            if (f && f.length > 0) {
                var e = [];
                for (var d = 0; d < f.length; ++d) {
                    e.push(f[d].attributes.tag)
                }
                var b = c.appendTagToFilter(e);
                c.fireEvent("searchFilterChange", b)
            }
        }
    }
},loadDateHistogram:function(b) {
    var a = this;
    var c = a.histogram;
    if (c) {
        c.loadResults(b)
    }
},clearDateHistogram:function() {
    var a = this;
    var b = a.histogram;
    if (b) {
        b.loadResults(null, null)
    }
},loadFilterOptionsDocCounts:function(h) {
    var m = this;
    var n = m.getByItemId("filter-tree");
    var l = n.getNodeById("filter-Type");
    if (!l) {
        log.warn("Returning early from loadFilterOptionsDocCounts.");
        return
    }
    this.clearTypeFilter();
    if (h) {
        var f = h.countsByType;
        var k = [];
        for (var g in f) {
            if (f.hasOwnProperty(g)) {
                var e = f[g];
                var c = g.replace(" ", "");
                var j = Explore.i18n("docType" + c);
                if (j === "docType" + c) {
                    j = g
                }
                var d = String.format(Explore.i18n("linkTooltip"), j);
                var b = {id:"type-" + c,text:j + " (" + Explore.formatNumber(e) + ")",tag:{type:m.docTypesFilter,friendlyType:"Type",val:g,friendlyValue:g},icon:Explore.SearchResults.getIcnSmallByType(g),leaf:true,checked:false,qtip:d};
                k.push(b)
            }
        }
        var a = "{0} ({1} {2})";
        l.setText(String.format(a, Explore.i18n("Type"), k.length, Explore.i18n("filters")));
        k.sort(function(p, o) {
            return p.text.localeCompare(o.text)
        });
        l.appendChild(k);
        if (m.nodeExpandedState[l.id]) {
            l.expand()
        }
    }
},getCustomFilter:function(a) {
    return Explore.utils.SearchCriteriaUtil.findFilter(this.customFilters, a)
},loadCustomFilter:function(f, g) {
    var c = this;
    if (c.customFilters) {
        var a = c.getByItemId("filter-tree");
        var d = f.text;
        var e = c.getCustomFilter(f.attributes.tag);
        if (e) {
            if (g) {
                var b = new Ext.LoadMask(a.getEl(), {msg:Explore.i18n("Loading") + " " + d + " " + Explore.i18n("Values")});
                b.show()
            }
            this.searchPresenter.getParametricFilterValue(e.FilterTag, function(h) {
                if (g) {
                    b.hide()
                }
                var k = "{0} ({1} {2})";
                if (h && h[0].Counts) {
                    c.loadParametricFilterResults(h, c)
                } else {
                    var j = a.getNodeById("filter-" + e.Name);
                    j.setText(String.format(k, e.Name, Explore.i18n("Error"), ""));
                    j.expand()
                }
            })
        }
    }
},loadParametricFilterResults:function(k) {
    var h = this;
    var l = h.getByItemId("filter-tree");
    if (k) {
        for (var d = 0;
             d < k.length; d++) {
            var g = k[d];
            var b = l.getNodeById("filter-" + g.Name);
            if (b) {
                h.clearCustomFiltersByName(g.Name);
                for (var c = 0; c < g.Counts.length;
                     ++c) {
                    var e = g.Counts[c];
                    var f = {text:e.FriendlyName + " (" + e.Count + ")",tag:{type:g.FilterTag,friendlyType:g.Name,val:(e.Fields ? e.Fields : ([e.Field])),friendlyValue:e.FriendlyName},iconCls:h.getIconCls(g),icon:h.getIcon(g, e),leaf:true,checked:false,qtip:String.format(Explore.i18n("linkTooltip"), e.FriendlyName + " " + g.Name)};
                    b.appendChild(f)
                }
                b.loaded = true;
                var a = "{0} ({1} {2})";
                b.setText(String.format(a, g.Name, g.Counts.length, Explore.i18n("filters")));
                b.ensureVisible();
                b.expand()
            }
        }
    }
},clearAllCustomFilters:function(b) {
    var d = this;
    var a = d.getByItemId("filter-tree");
    var c = a.getRootNode();
    for (var e = 0; e < c.childNodes.length; e++) {
        var f = c.childNodes[e];
        if (f.attributes.isCustomFilterGroup || f.attributes.isCustomFilter) {
            f.remove(true);
            e--
        }
    }
    a.doLayout()
},clearTypeFilter:function() {
    var c = this;
    var a = c.getByItemId("filter-tree");
    var d = a.getNodeById("filter-Type");
    if (!d) {
        log.warn("Returning early from clearTypeFilter.");
        return
    }
    if (d.hasChildNodes()) {
        var b = d.isExpanded();
        d.removeAll();
        c.nodeExpandedState[d.id] = b
    }
}});
Ext.reg("explore.view.filteroptions", Explore.view.FilterOptions);
Ext.ns("Explore.view");
Explore.view.HomeAsideBar = Ext.extend(Ext.Panel, {initComponent:function() {
    var a = this;
    var b = {title:Explore.i18n("QuickStart"),width:200,minSize:175,maxSize:400,margins:"0 0 0 0",padding:"4",layout:{type:"vbox",pack:"start",align:"stretch"},defaults:{baseCls:"x-sidepanel",margins:"0 0 15 0"},items:[
        {xtype:"explore.view.activities",autoHeight:true,cls:"demoMode",hidden:!Explore.demoMode},
        {title:Explore.i18n("QuickSearch"),padding:"4",layout:"hbox",autoHeight:true,items:[
            {xtype:"textfield",id:"quick-search-text",margins:"0 4 0 0",flex:1,enableKeyEvents:true,listeners:{keypress:function(c, d) {
                if (d.getKey() == d.RETURN || d.getKey() == d.ENTER) {
                    d.stopEvent()
                }
            },keyup:function(c, f) {
                if (f.getKey() == f.RETURN || f.getKey() == f.ENTER) {
                    var d = c.getValue();
                    if (d) {
                        a.searchByText(d)
                    }
                }
            }}},
            {xtype:"button",iconCls:"button-search",handler:function(c, f) {
                var d = Ext.fly("quick-search-text").dom.value;
                if (d) {
                    a.searchByText(d)
                }
            }}
        ]},
        {xtype:"explore.view.savedsearches",flex:1,listeners:{click:function(c) {
            a.searchById(c.attributes.tag, c.text, Explore.model.ASType.SavedSearch)
        }}},
        {title:Explore.i18n("Topics"),xtype:"explore.view.topicpicker",padding:"4",baseCls:"x-sidepanel",flex:1,margins:"0",listeners:{click:function(c) {
            if (c.attributes.tag.type == "TOPIC") {
                a.searchByTopic(c.attributes.tag.id, c.text)
            }
        }}}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.HomeAsideBar.superclass.initComponent.apply(this, arguments)
},searchByText:function(a) {
    var b = Explore.showSearchPanel();
    b.searchByText(a)
},searchById:function(b, c, d) {
    var a = Explore.showSearchPanel();
    a.searchById(b, c, d)
},searchByTopic:function(b, c) {
    var a = Explore.showSearchPanel();
    a.searchByTopic(b, c)
}});
Ext.reg("explore.view.homeasidebar", Explore.view.HomeAsideBar);
Ext.ns("Explore.view");
Explore.view.HomeDocumentCountPanel = Ext.extend(Ext.Panel, {disabled:true,initComponent:function() {
    var a = this;
    var b = {layout:"auto",bodyStyle:{overflowY:"auto"},border:false,title:Explore.i18n("LicenseSummary"),cls:"explore-view-widgets-licensesummary",padding:5,items:[
        {xtype:"explore.view.common.linearguage",itemId:"guage",hideLabel:true,height:80},
        {xtype:"container",border:false,layout:"form",itemId:"myform",height:55,defaults:{xtype:"displayfield",height:15},items:[
            {fieldLabel:Explore.i18n("Current project"),itemId:"CurrentProject"},
            {fieldLabel:Explore.i18n("System"),itemId:"System"},
            {fieldLabel:Explore.i18n("Licensed"),itemId:"Licensed"}
        ]}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.HomeDocumentCountPanel.superclass.initComponent.apply(this, arguments);
    a.on("afterlayout", function() {
        if (a.disabled) {
            var c = new Ext.LoadMask(a.getEl(), Explore.i18n("Loading_"));
            c.show();
            a.on("enable", function() {
                c.hide()
            })
        }
    });
    a.on("afterrender", function() {
        var c = a.findParentBy(function(d) {
            return(d.collapsible ? true : false)
        });
        if (c) {
            c.on("expand", a.layoutGuage, a, {single:true})
        }
        ProjectService.GetHomeProjectData(function(m) {
            a.enable();
            var e = {};
            if (m) {
                for (var j in m) {
                    if (m.hasOwnProperty(j)) {
                        var h = m[j];
                        var k = h.TotalCount;
                        e[j] = k;
                        var g = a.getByItemId(j);
                        g.setValue(Explore.formatNumber(k) + " docs");
                        if (h.CountsByType.length > 0) {
                            a._docTooltip = new Explore.view.common.DocCountToolTip({target:g.getEl(),documentCounts:h})
                        }
                    }
                }
            }
            var d = e.System;
            var l = e.Licensed;
            var f = Math.round(100 * d / l);
            a.getByItemId("guage").setChartData({min:0,max:l,value:d,indicatorText:f + "% used"})
        })
    }, a);
    a.on("resize", this.layoutGuage, a)
},layoutGuage:function() {
    var c = this;
    var f = c.getByItemId("guage");
    var h = 0;
    var g = c.getByItemId("myform").getHeight();
    var d = 80 + g + 10;
    var a = c.body.getHeight(true) - d;
    log.info("requiredHeight: " + d + ", extraHeight: " + a);
    if (a < 0) {
        a = 0;
        h = Ext.getScrollBarWidth()
    }
    var e = f.getEl();
    if (e) {
        e.setStyle({marginTop:Math.floor(a / 2) + "px",marginBottom:Math.floor(a / 2) + "px"})
    }
    var b = this.getWidth();
    f.setWidth(b - 10 - h)
}});
Explore.view.HomeFavoritesGrid = Ext.extend(Ext.grid.GridPanel, {border:false,frame:false,autoScroll:true,disabled:true,title:Explore.i18n("FavoriteWidgets"),initComponent:function() {
    var b = this;
    var d = new Ext.SplitButton({text:Explore.i18n("Edit"),iconCls:"edit-icon",menu:new Ext.menu.Menu({items:[b.getEditSearchCriteriaAction(),b.getReportSettingsAction()]})});
    var a = new Ext.Toolbar({enableOverflow:true,items:[b.getLaunchAction(),d,b.getDeleteAction()]});
    var c = {store:b.getStore(),columns:[
        {id:"Name",menuDisabled:true,dataIndex:"Name"}
    ],autoExpandColumn:"Name",viewConfig:{forceFit:true},sm:new Ext.grid.RowSelectionModel({singleSelect:true})};
    Ext.apply(this, c);
    Explore.view.HomeFavoritesGrid.superclass.initComponent.apply(this, arguments);
    b.addListeners();
    b.refresh(false)
},addListeners:function() {
    var a = this;
    Explore.data.FavoriteReportDataStore.on("favoriteAdded", function(b) {
        a.refresh()
    });
    Explore.data.FavoriteReportDataStore.on("favoriteChanged", function(b) {
        a.refresh()
    });
    Explore.data.FavoriteReportDataStore.on("favoriteDeleted", function(b) {
        a.refresh()
    });
    a.on("rowcontextmenu", function(c, f, d) {
        d.stopEvent();
        c.getSelectionModel().selectRow(f);
        var b = a.getContextMenu();
        b.showAt(d.getXY())
    });
    a.getSelectionModel().on("rowselect", function(c, d, b) {
        a.enableActions(b)
    });
    a.on("rowdblclick", function(b, d, c) {
        a.getLaunchAction().execute()
    });
    a.on("afterlayout", function() {
        var b = new Ext.LoadMask(a.getEl(), "Loading...");
        if (a.disabled) {
            b.show();
            a.on("enable", function() {
                b.hide()
            })
        }
    })
},enableActions:function(b) {
    var e = this.getLaunchAction();
    var d = this.getEditSearchCriteriaAction();
    var c = this.getReportSettingsAction();
    var a = this.getDeleteAction();
    if (b) {
        e.setDisabled(false);
        d.setDisabled(false);
        c.setDisabled(false);
        a.setDisabled(false)
    } else {
        e.setDisabled(true);
        d.setDisabled(true);
        c.setDisabled(true);
        a.setDisabled(true)
    }
},getLaunchAction:function() {
    if (!this._launchAction) {
        this._launchAction = new Ext.Action({text:Explore.i18n("Launch"),itemId:"launch",disabled:true,iconCls:"buttonFavorite",handler:this.launchFavorite,scope:this})
    }
    return this._launchAction
},getEditSearchCriteriaAction:function() {
    if (!this._editSearchCriteriaAction) {
        this._editSearchCriteriaAction = new Ext.Action({text:Explore.i18n("Edit Search Criteria"),itemId:"editSearchCriteria",disabled:true,iconCls:"edit-icon",handler:this.editFavoriteSearchCriteria,scope:this})
    }
    return this._editSearchCriteriaAction
},getReportSettingsAction:function() {
    if (!this._reportSettingsAction) {
        this._reportSettingsAction = new Ext.Action({text:Explore.i18n("Edit Report setting"),itemId:"editReportSetting",disabled:true,iconCls:"edit-icon",handler:this.editFavoriteReportSetting,scope:this})
    }
    return this._reportSettingsAction
},getDeleteAction:function() {
    if (!this._deleteAction) {
        this._deleteAction = new Ext.Action({text:Explore.i18n("Delete"),itemId:"delete",disabled:true,iconCls:"delete-icon",handler:this.deleteFavorite,scope:this})
    }
    return this._deleteAction
},getContextMenu:function() {
    var a = this;
    if (!this._contextMenu) {
        this._contextMenu = new Ext.menu.Menu({items:[a.getLaunchAction(),a.getEditSearchCriteriaAction(),a.getReportSettingsAction(),a.getDeleteAction()]})
    }
    return this._contextMenu
},getStore:function() {
    if (!this._store) {
        this._store = new Ext.data.JsonStore({fields:["Name"]})
    }
    return this._store
},getSelectedRecord:function() {
    var a = this.getSelectionModel();
    if (a.hasSelection()) {
        return a.getSelected()
    } else {
        return null
    }
},launchFavorite:function() {
    var a = new Ext.LoadMask(this.getEl(), {msg:Explore.i18n("LaunchingFavorite")});
    a.show();
    var b = this.getSelectedRecord().json.Id;
    var c = this.getSelectedRecord().json.AdvancedSearchId;
    Explore.data.FavoriteReportDataStore.getFavoriteReportSettings(b, function(d) {
        Explore.data.FavoriteReportDataStore.getFavoriteReportSearchSettings(c, function(f) {
            var e = Explore.getSearchPresenter();
            e.runReport(f, d, true);
            a.hide()
        })
    })
},editFavoriteSearchCriteria:function() {
    var b = this;
    var c = this.getSelectedRecord().json.AdvancedSearchId;
    var d = this.getSelectedRecord().json.Id;
    var a = new Ext.LoadMask(b.body, {msg:Explore.i18n("Editing favorite search settings...")});
    a.show();
    Explore.data.FavoriteReportDataStore.getFavoriteReportSearchSettings(c, function(e) {
        a.hide();
        var f = new Explore.view.AdvancedSearchCriteriaDialog({title:Explore.i18n("AdvancedSearch"),saveButtonText:Explore.i18n("Ok"),bypassDirtyCheck:true,showName:false,showSearchTerms:true,editObject:e});
        f.on("save", function() {
            var g = new Ext.LoadMask(this.getEl(), {msg:Explore.i18n("SavingSettings")});
            g.show();
            Explore.data.FavoriteReportDataStore.updateReportSearchSettings(d, e, function(h) {
            })
        });
        f.show()
    })
},editFavoriteReportSetting:function() {
    var b = this;
    var c = this.getSelectedRecord().json.Id;
    var a = new Ext.LoadMask(b.body, {msg:Explore.i18n("Editing favorite report settings...")});
    a.show();
    Explore.data.FavoriteReportDataStore.getFavoriteReportSettings(c, function(d) {
        a.hide();
        var e = new Explore.view.widgets.WidgetSettingsDialog({saveSettings:true,reportSettings:d,listeners:{save:function(g) {
            var f = new Ext.LoadMask(this.getEl(), {msg:Explore.i18n("SavingSettings")});
            f.show();
            Explore.data.FavoriteReportDataStore.updateReportFavoriteSettings(c, g, function(h) {
                b.refresh(true)
            })
        }}});
        e.show()
    })
},deleteFavorite:function() {
    var a = this;
    var e = function(f) {
        if (f) {
            a.refresh()
        }
    };
    var b = this.getSelectedRecord().json.Id;
    var d = this.getSelectedRecord().json.Name;
    log.info("HomeFavoriteGrid.deleteFavorite");
    var c = String.format("{0} {1}", Explore.i18n("AreYouSureYouWantToDeleteFavorite_"), d);
    Explore.view.StatusBox.confirm(Explore.i18n("appTitle"), c, function() {
        var f = new Explore.view.DeleteConfirmationWindow({mytype:"ReportFavoriteInfo",deleteFn:Explore.data.FavoriteReportDataStore.deleteFavoriteReport,myId:b,callback:e});
        f.start()
    })
},refresh:function(d) {
    var c = this;
    var b = c.getStore();
    b.loadData([]);
    c.enableActions();
    if (c.body) {
        if (!d) {
            var a = new Ext.LoadMask(c.body, {msg:Explore.i18n("Loading Data Import List")});
            a.show()
        }
    }
    Explore.data.FavoriteReportDataStore.getFavoriteReportsForCurrentUser(function(e) {
        c.enable();
        if (a && a.hide) {
            a.hide()
        }
        b.loadData(e)
    })
}});
Ext.ns("Explore.view");
Explore.view.HomePanel = Ext.extend(Ext.Panel, {cloudCount:null,initComponent:function() {
    this.cloudCount = Explore.data.PreferenceDataStore.getCloudCountPreference();
    var d = this._createTopicPanel(0, 1, {itemId:"topIdeaCloud"});
    var b = this._createTopicPanel(2, 3, {itemId:"bottomIdeaCloud",hidden:this._isBottomPanelHidden()});
    var c = !Explore.isDemo ? {xtype:"explore.view.homepanelasidebar",itemId:"aside-panel",stateful:true,stateId:"home-aside-panel",title:Explore.i18n("Sidebar"),split:true,collapsible:true,hidden:false,region:"east"} : {xtype:"explore.view.homeasidebar",itemId:"aside-panel",stateful:true,stateId:"home-aside-panel",title:Explore.i18n("QuickStart"),split:true,collapsible:true,hidden:false,region:"east"};
    var a = {layout:"border",border:false,items:[
        {xtype:"panel",itemId:"topicsContainer",region:"center",bodyStyle:"padding:5px 0px 0px 5px",layout:{type:"vbox",pack:"start",align:"stretch"},items:[d,b]},
        {itemId:"recentTicker",xtype:"explore.view.ticker",height:25,border:false,region:"north",cls:"demoMode",hidden:true},
        c
    ]};
    Ext.apply(this, a);
    Explore.view.HomePanel.superclass.initComponent.apply(this, arguments)
},_createTopicPanel:function(b, a, d) {
    var f = new Explore.view.IdeaCloud({itemId:"ideaCloud" + b,position:b,margins:"0 5 5 0",flex:1,hidden:this._isCloudHidden(b)});
    var e = new Explore.view.IdeaCloud({itemId:"ideaCloud" + a,position:a,margins:"0 5 5 0",flex:1,hidden:this._isCloudHidden(a)});
    var c = {xtype:"container",itemId:d.itemId,flex:1,padding:"10px 5px",border:false,layout:{type:"hbox",pack:"start",align:"stretch"},items:[f,e],listeners:{scope:this,afterrender:this._afterRenderHandler}};
    Ext.apply(c, d);
    return c
},_setCloudLayout:function(c) {
    var a = c;
    var d = this.getByItemId("topicsContainer");
    d.removeClass("large-cloud");
    d.removeClass("medium-cloud");
    for (var b = 0; b <= 3; b++) {
        var e = this.getByItemId("ideaCloud" + b);
        if (this._isCloudHidden(a, b)) {
            e.hide()
        } else {
            e.show()
        }
    }
    if (this._isBottomPanelHidden(a)) {
        this.getByItemId("bottomIdeaCloud").hide()
    } else {
        this.getByItemId("bottomIdeaCloud").show()
    }
    switch (a) {case 1:d.addClass("large-cloud");break;case 2:d.addClass("medium-cloud");break;case 4:break
    }
    d.doLayout()
},_isCloudHidden:function(b, a) {
    switch (b) {case 1:return(a > 0);
        case 2:return(a === 1 || a === 3);case 4:return false
    }
},_isBottomPanelHidden:function(a) {
    return(a === 1)
},_afterRenderHandler:function() {
    if (this.cloudCount != 4) {
        this._setCloudLayout(this.cloudCount)
    }
},getQuickActions:function() {
    return null
},panelHide:function() {
    this.getByItemId("recentTicker").stopTicker()
},panelShow:function() {
    this.getByItemId("recentTicker").startTicker()
}});
Ext.reg("explore.view.homepanel", Explore.view.HomePanel);
Ext.ns("Explore.view");
Explore.view.HomePanelAsideBar = Ext.extend(Ext.Panel, {widgetLayout:[1,2,3],widgetDuration:[5,5,5],activePage:0,durationIndex:0,numPages:0,hideTools:false,initComponent:function() {
    var b = this;
    var a = Explore.data.PreferenceDataStore.getExploreWidgets();
    var d = Explore.data.PreferenceDataStore.getIngestionTrendWidgetDuration();
    if (a) {
        b.widgetLayout = a
    }
    if (d) {
        b.widgetDuration = d
    }
    if (!b.hideTools) {
        b.tools = [
            {id:"down",qtip:Explore.i18n("Back one page"),hidden:true,handler:function() {
                b.changePage(b.activePage - 1)
            },scope:b},
            {id:"up",qtip:Explore.i18n("Foward one page"),hidden:(b.numPages < 2),handler:function() {
                b.changePage(b.activePage + 1)
            },scope:b},
            {id:"gear",qtip:Explore.i18n("Settings"),handler:b.openSettingsWindow,scope:b}
        ]
    }
    var c = {width:300,minSize:175,maxSize:400,frame:false,border:false,layout:"card",activeItem:b.activePage,items:b.getPages()};
    Ext.apply(this, Ext.apply(this.initialConfig, c));
    Explore.view.HomePanelAsideBar.superclass.initComponent.apply(this, arguments);
    b.on("afterrender", function() {
        var e = b.getByItemId("ideaCloud4");
        if (e) {
            e.show()
        }
        e = b.getByItemId("ideaCloud5");
        if (e) {
            e.show()
        }
        e = b.getByItemId("ideaCloud6");
        if (e) {
            e.show()
        }
    })
},openSettingsWindow:function() {
    var a = this;
    if (!this._settingsWindow) {
        this._settingsWindow = new Explore.view.HomePanelAsideBarSettingsWindow({widgetLayout:a.widgetLayout,widgetDuration:a.widgetDuration,homePanel:a});
        this._settingsWindow.on("save", function() {
            a.redoWidgets(a.widgetLayout, a.widgetDuration);
            a._settingsWindow.destroy();
            a._settingsWindow = null
        })
    }
    this._settingsWindow.show()
},changePage:function(c) {
    var a = this;
    var d = this.tools;
    var b = a.getLayout();
    if (c >= 0 && c < a.numPages) {
        b.setActiveItem(c);
        a.activePage = c;
        if (d && d.length && d.length > 0) {
            if (c == 0) {
                d.down.hide()
            } else {
                d.down.show()
            }
            if (c < a.numPages - 1) {
                d.up.show()
            } else {
                d.up.hide()
            }
        }
    }
},getPages:function() {
    var a = [];
    var b = this.getItems();

    function e() {
        return{xtype:"panel",lazyRender:true,width:300,minSize:175,maxSize:400,layout:{type:"vbox",pack:"start",align:"stretch"},defaults:{cls:"idea-cloud",bodyCssClass:"idea-cloud-body",margins:"4 4 4 4",border:true,flex:1},items:[]}
    }

    var d = e();
    for (var c = 0; c < b.length; c++) {
        d.items.push(b[c]);
        if (d.items.length == 3) {
            a.push(d);
            d.included = true;
            if (c != (b.length - 1)) {
                d = e()
            }
        }
    }
    if (!d.included) {
        a.push(d)
    }
    this.numPages = a.length;
    return a
},getItems:function() {
    var b = this;
    var a = [];
    for (var c = 0; c < b.widgetLayout.length;
         c++) {
        var d = {Type:b.widgetLayout[c],Duration:b.widgetDuration[c],position:c};
        var e = b.getItem(d);
        a.push(e)
    }
    return a
},getItem:function(b) {
    var a = b.Type;
    if (Ext.isNumber(a)) {
        switch (a) {case Explore.model.ExploreWidgets.IDOLDocumentCount:return this.getIDOLDocumentCount(b);case Explore.model.ExploreWidgets.IDOLIndexingTrend:return this.getIDOLIndexingTrend(b);
            case Explore.model.ExploreWidgets.FavoriteGrid:return this.getFavoriteGrid(b);case Explore.model.ExploreWidgets.SourceTree:return this.getSourceTree(b);
            case Explore.model.ExploreWidgets.ProjectTree:return this.getProjectTree(b)
        }
    }
    return this.getEmpty()
},getEmpty:function() {
    return{xtype:"panel",layout:"fit",items:[]}
},getIDOLDocumentCount:function() {
    return{xtype:"panel",layout:"fit",items:[new Explore.view.HomeDocumentCountPanel()]}
},getDurationItem:function() {
    var a = this;
    var b = a.durationIndex;
    a.durationIndex += 1;
    return a.widgetDuration[b]
},getIDOLIndexingTrend:function(a) {
    if (!a) {
        a = {}
    }
    return{xtype:"panel",layout:"fit",items:[new Explore.view.IndexDocumentsCountPanel(a)]}
},getFavoriteGrid:function() {
    return{xtype:"panel",layout:"fit",items:[new Explore.view.HomeFavoritesGrid()]}
},getSourceTree:function() {
    var a = new Explore.view.DataSourcePicker({rootVisible:false,frame:false,border:false,title:Explore.i18n("Sources")});
    a.tools = [];
    return{xtype:"panel",layout:"fit",items:[a]}
},getProjectTree:function() {
    var a = new Explore.view.ProjectsTree({title:Explore.i18n("Projects"),rootVisible:false,frame:false,border:false,permissions:{view:Explore.Security.isAuthorized("PROJECTS_VIEW"),create:Explore.Security.isAuthorized("PROJECTS_CREATE"),update:Explore.Security.isAuthorized("PROJECTS_UPDATE"),"delete":Explore.Security.isAuthorized("PROJECTS_DELETE")}});
    a.tools = [];
    return{xtype:"panel",layout:"fit",items:[a]}
},redoWidgets:function(b) {
    this.widgetLayout = b;
    this.removeAll();
    var a = this.getPages();
    this.add(a);
    this.changePage(0);
    this.doLayout()
}});
Ext.reg("explore.view.homepanelasidebar", Explore.view.HomePanelAsideBar);
Explore.view.HomePanelAsideBarSettingsWindow = Ext.extend(Ext.Window, {width:600,height:600,modal:true,cls:"white-bg-dialog",title:Explore.i18n("Home Page Widget Layout"),closeAction:"hide",constrain:true,widgetLayout:[],widgetDuration:[],durationIndex:0,homePanel:null,initComponent:function() {
    var c = this;
    if (!this.homePanel) {
        this.homePanel = new Explore.view.HomePanelAsideBar()
    }
    var d = {fbar:[
        {xtype:"button",text:"Save",itemId:"saveBtn",disabled:true,handler:this.saveAction,scope:this}
    ],layout:{type:"vbox",pack:"start",align:"stretch"},defaults:{frame:false,border:false,baseCls:"x-sidepanel",flex:1},items:c.getWidgetSelectorPanels()};
    Ext.apply(this, Ext.apply(this.initialConfig, d));
    Explore.view.HomePanelAsideBarSettingsWindow.superclass.initComponent.apply(this, arguments);
    for (var e = 0; e < this.widgetLayout.length; e++) {
        var b = this.getByItemId(e);
        var a = function() {
            var g = false;
            for (var f = 0; f < c.widgetLayout.length;
                 f++) {
                g = g || c.getByItemId(f).getComboBox().isDirty()
            }
            c.fbar.getByItemId("saveBtn").setDisabled(!g)
        };
        b.on("change", a)
    }
},getWidgetSelectorPanels:function() {
    var c = this;
    var b = [],a = this.widgetLayout;
    for (var d = 0; d < a.length; d++) {
        b.push(new Explore.view.HomePanelSelector({widgetId:a[d],widgetDuration:this.widgetDuration[d],indexTrend:c.durationIndex,itemId:d,pos:d + 1,border:true,padding:2,homePanel:this.homePanel}));
        if (this.widgetId === Explore.model.ExploreWidgets.IDOLIndexingTrend) {
            c.durationIndex += 1
        }
    }
    return b
},saveAction:function() {
    var h = this;
    var b = 0;
    var k = new Ext.LoadMask(h.getEl(), "Saving widget layout");
    k.show();
    var d = this.widgetLayout;
    var e = this.widgetDuration;
    var f = [];
    for (var c = 0; c < d.length; c++) {
        var g = this.getByItemId(c);
        var a = g.getWidgetSettings();
        d[c] = a.Type;
        e[c] = a.Duration;
        f.push(a)
    }
    Explore.data.PreferenceDataStore.saveExploreWidgets(d, e, function() {
        k.hide();
        h.widgetLayout = d;
        h.fireEvent("save", d, e);
        h.hide()
    })
}});
Explore.view.HomePanelSelector = Ext.extend(Ext.Panel, {widgetId:0,widgetDuration:5,indexTrend:0,homePanel:null,layout:"fit",frame:true,border:true,pos:0,initComponent:function() {
    var a = this;
    if (!a.homePanel) {
        a.homePanel = new Explore.view.HomePanelAsideBar()
    }
    var c = a.getWidgetBasedOnId();
    var b = {items:[c]};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.HomePanelSelector.superclass.initComponent.apply(this, arguments);
    var d = a.getCurrentItem();
    d.on("enable", function() {
        a.getComboBox().enable()
    })
},getComboBox:function() {
    if (!this._combo) {
        var a = this;
        this._combo = new Explore.view.common.SelectBoxField({allowBlank:false,disabled:true,forceSelection:true,fieldLabel:"<b>Position: " + a.pos + ": </b>",mode:"local",store:a.getComboStore(),valueField:"widgetId",displayField:"display",value:this.widgetId,listeners:{scope:a,select:a.changeOfCombo}})
    }
    return this._combo
},getComboStore:function() {
    if (!this._comboStore) {
        var a = this;
        this._comboStore = new Ext.data.ArrayStore({id:0,fields:["widgetId","display"],data:[
            [Explore.model.ExploreWidgets.IDOLDocumentCount,Explore.i18n("LicenseSummary")],
            [Explore.model.ExploreWidgets.IDOLIndexingTrend,Explore.i18n("IndexedTrend")],
            [Explore.model.ExploreWidgets.FavoriteGrid,Explore.i18n("FavoriteWidgets")],
            [Explore.model.ExploreWidgets.SourceTree,Explore.i18n("Sources")],
            [Explore.model.ExploreWidgets.ProjectTree,Explore.i18n("Projects")]
        ]})
    }
    return this._comboStore
},changeOfCombo:function(e, a, c) {
    var b = this;
    e.disable();
    this.remove(this.getCurrentItem());
    this.widgetId = a.get("widgetId");
    var f = this.getWidgetBasedOnId();
    this.add(f);
    var d = f.items.items[0];
    d.on("enable", function() {
        e.enable();
        b.fireEvent("change")
    });
    this.doLayout()
},getCurrentItem:function() {
    return this.getByItemId("currentItem").items.items[0]
},getCurrentValue:function() {
    return this.getComboBox().getValue()
},getWidgetSettings:function() {
    var a = this.getCurrentValue();
    var c = Explore.model.FilterByDateType.PastYear;
    var b = this.getCurrentItem();
    if (b && b.getDuration && b.getDuration()) {
        c = b.getDuration()
    }
    return{Type:a,Duration:c}
},getWidgetBasedOnId:function() {
    var a = this;
    var c = this.homePanel.getItem({Type:this.widgetId,Duration:this.widgetDuration});
    var d = a.getComboBox();
    var b = new Ext.form.Label({html:d.fieldLabel,width:200});
    var e = [b,d];
    c.itemId = "currentItem";
    c.tbar = e;
    return new Ext.Panel(c)
}});
Ext.ns("Explore.view");
Explore.view.IdeaCloud = Ext.extend(Explore.base.WidgetBase, {activeCloud:null,activeHarvestDate:null,viewDataInitialized:null,updatePollIntervalId:null,prefs:null,updateCheckIntervalMs:null,intervalDisplay:null,widget:null,conextMenu:null,contextMenuItem:null,initComponent:function() {
    var a = this;
    this.activeHarvestDate = new Date();
    this.viewDataInitialized = false;
    this.prefs = Explore.data.PreferenceDataStore.getPreferences();
    this.updateCheckIntervalMs = this.prefs.AutoRefreshInterval * 60000;
    this.intervalDisplay = (this.prefs.AutoRefreshInterval === 0) ? "" : String.format("({0}: {1} {2})", Explore.i18n("RefreshInterval"), this.prefs.AutoRefreshInterval, Explore.i18n("minutes"));
    var b = {title:Explore.i18n("Loading..."),frame:true,cls:"idea-cloud",bodyCssClass:"idea-cloud-body",hidden:false,layout:{type:"vbox",pack:"start",align:"stretch"},tbar:{items:[
        {xtype:"tbtext",itemId:"description",ctCls:"toolbar-text",style:"overflow: hidden",text:"..."},
        "->",
        {xtype:"button",itemId:"exportButton",iconCls:"buttonExport",disabled:true,hidden:!Explore.Security.isAuthorized("HOME_WIDGET_EXPORT"),handler:a._exportData,scope:a},
        {xtype:"button",itemId:"publishButton",iconCls:"buttonSearchAnalytics",tooltip:Explore.i18n("publishToWorkspaces"),handler:a._publishWidget,scope:a,cls:"demoMode",hidden:!Explore.demoMode,disabled:true},
        {xtype:"button",itemId:"cloudSettingsButton",iconCls:"buttonConfigureTopic",disabled:true,handler:a._showCloudSettingsDialog,scope:a}
    ],listeners:{afterlayout:a._setDescriptionWidth,scope:a}},items:[
        {xtype:"container",itemId:"cardContainer",flex:1,border:false,layout:"fit",items:[]}
    ],bbar:new Ext.Toolbar({cls:"cloud-refresh",height:18,items:[
        {xtype:"tbtext",itemId:"wasNotRunDescription",hidden:true,ctCls:"toolbar-text-last-refresh",style:"overflow: hidden",text:"*" + Explore.i18n("cloudTopicNotResultsNotRunYet")},
        "->",
        {xtype:"tbtext",itemId:"lastRefreshed",ctCls:"toolbar-text-last-refresh",style:"overflow: hidden",text:""}
    ]})};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.IdeaCloud.superclass.initComponent.apply(this, arguments);
    a.on({afterrender:function(c) {
        if (!c.hidden) {
            a._initViewData()
        }
    },beforeshow:function(c) {
        a._initViewData()
    }})
},_checkForUpdates:function() {
    if (this.activeCloud) {
        log.info("checking for cloud updates: " + this.activeCloud.Name);
        var a = Explore.presenter.ProjectsPresenter.getCurrentProjectId();
        this.getByItemId("lastRefreshed").setText(String.format("{0}: {1} {2}", Explore.i18n("LastRefreshed"), Explore.formatDate(new Date(), Explore.datePatterns.LongTime), this.intervalDisplay));
        Explore.data.IDOLDataStore.getLastCloudTopicResultHarvestDate(this.activeCloud.Id, a, function(b) {
            if (b) {
                log.info("Last cloud harvest: " + c);
                var c = Explore.parseSerializedDate(b);
                if (c > this.activeHarvestDate) {
                    this._loadData(true)
                }
            }
        })
    }
},_startPollForUpdates:function() {
    this.getByItemId("lastRefreshed").setText(String.format("{0}: {1} {2}", Explore.i18n("LastRefreshed"), Explore.formatDate(new Date(), Explore.datePatterns.LongTime), this.intervalDisplay));
    this._stopPollForUpdates();
    if (this.updateCheckIntervalMs > 0) {
        this.updatePollIntervalId = setInterval(this._checkForUpdates.createDelegate(this), this.updateCheckIntervalMs)
    }
},_stopPollForUpdates:function() {
    clearInterval(this.updatePollIntervalId)
},_initViewData:function() {
    if (!this.viewDataInitialized) {
        this.viewDataInitialized = true;
        this._loadData()
    }
},_showCloudVisualizer:function(a) {
    var b = this.getByItemId("cardContainer");
    b.removeAll();
    if (a) {
        b.add(a)
    }
    b.doLayout()
},_loadData:function(c) {
    var b = this;
    this._stopPollForUpdates();
    log.info("Loading cloud data");
    var a = Explore.presenter.ProjectsPresenter.getCurrentProjectId();
    if (!c) {
        b._showCloudVisualizer(false)
    }
    Explore.data.IDOLDataStore.getCloud(b.position, a, function(d) {
        b._displayCloud(d)
    })
},_setDescriptionWidth:function() {
    if (!Ext.isIE6) {
        var b = this.getByItemId("description");
        if (b) {
            var a = b.ownerCt.getWidth() - 10;
            b.ownerCt.items.each(function(c) {
                if (c.rendered) {
                    if (c.itemId != "description") {
                        a -= c.getWidth()
                    }
                }
                return true
            });
            b.setWidth(a)
        }
    }
},_setDescription:function(b) {
    var a = this.getByItemId("description");
    if (a) {
        a.setText(b);
        this._setDescriptionWidth()
    }
},_displayCloud:function(f) {
    this.activeCloud = f;
    var h = this.getByItemId("publishButton");
    var b = this.getByItemId("cloudSettingsButton");
    var c = this.getByItemId("exportButton");
    this._checkForUpdates();
    if (!f) {
        log.error("Cloud is null for Explore.data.IDOLDataStore.getCloud position: ", this.position);
        h.setDisabled(true);
        c.setDisabled(true)
    } else {
        if (f.Id === 0) {
            var d = this.getByItemId(d);
            this.setTitle("&nbsp;");
            b.setTooltip(Explore.i18n("TopicAreaSettings"));
            b.setDisabled(false);
            h.setDisabled(true);
            c.setDisabled(true);
            this._showCloudVisualizer({xtype:"container",cls:"no-area-message",items:{xtype:"component",autoEl:{tag:"span",html:Explore.i18n("NoTopicAreaIsDefinedClickHereToSetup")},listeners:{render:this._containerRenderHandler,scope:this}}})
        } else {
            this.setTitle(this.activeCloud.Name);
            var j = "{0}: {1}";
            var k = null;
            if (this.activeCloud.ViewType === Explore.model.CloudViewType.SpectrographsView) {
                k = String.format(j, Explore.i18n("SpectrographsFor"), this.activeCloud.SearchName);
                this._setDescription(k)
            } else {
                if (this.activeCloud.ViewType === Explore.model.CloudViewType.ClustersView) {
                    k = String.format(j, Explore.i18n("ClustersFor"), this.activeCloud.SearchName);
                    this._setDescription(k)
                } else {
                    if (this.activeCloud.ViewType === Explore.model.CloudViewType.BreakingClusters) {
                        k = String.format(j, Explore.i18n("BreakingClustersFor"), this.activeCloud.SearchName);
                        this._setDescription(k)
                    } else {
                        if (this.activeCloud.ViewType === Explore.model.CloudViewType.HotClusters) {
                            k = String.format(j, Explore.i18n("HotClustersFor"), this.activeCloud.SearchName);
                            this._setDescription(k)
                        } else {
                            if (this.activeCloud.ViewType === Explore.model.CloudViewType.RootCauseView) {
                                j = "{1}: {0}";
                                this._setRootCauseViewDescription(this.activeCloud, null)
                            } else {
                                if (this.activeCloud.ViewType === Explore.model.CloudViewType.SentimentView) {
                                    j = "{1}: {0}";
                                    if (this.activeCloud.TimeWindow === Explore.model.TimeWindow.Between) {
                                        var l = "Between {0} and {1}";
                                        l = String.format(l, Explore.formatDateByPref(this.activeCloud.FromDate, {ignoreTime:true}), Explore.formatDateByPref(this.activeCloud.ToDate, {ignoreTime:true}));
                                        k = String.format("{1} - {0}", l, String.format(j, this.activeCloud.SearchName, Explore.i18n("SentimentFor")))
                                    } else {
                                        k = String.format(j, this.activeCloud.SearchName, Explore.i18n("SentimentFor"))
                                    }
                                    this._setDescription(k)
                                } else {
                                    if (this.activeCloud.ViewType === Explore.model.CloudViewType.DocumentsFilter) {
                                        j = "{0} - ({1}): {2}";
                                        var g = Explore.data.IDOLDataStore.getFilterByFilterTag(this.activeCloud.Category);
                                        var e = g.Name || this.activeCloud.Category;
                                        var a = String.format(Explore.i18n("Documents Count By {0}"), e);
                                        if (this.activeCloud.TimeWindow === Explore.model.TimeWindow.Between) {
                                            var l = "Between {0} and {1}";
                                            l = String.format(l, Explore.formatDateByPref(this.activeCloud.FromDate, {ignoreTime:true}), Explore.formatDateByPref(this.activeCloud.ToDate, {ignoreTime:true}));
                                            k = String.format(j, a, this.activeCloud.SearchName, l)
                                        } else {
                                            k = String.format(j, a, this.activeCloud.SearchName, Explore.i18n("cloudSettingsTimePeriod" + this.activeCloud.TimeWindow))
                                        }
                                        this._setDescription(k)
                                    } else {
                                        j = "{1}: {0}";
                                        if (this.activeCloud.TimeWindow === Explore.model.TimeWindow.Between) {
                                            var l = "Between {0} and {1}";
                                            l = String.format(l, Explore.formatDateByPref(this.activeCloud.FromDate, {ignoreTime:true}), Explore.formatDateByPref(this.activeCloud.ToDate, {ignoreTime:true}));
                                            k = String.format(j, l, Explore.i18n("cloudSettingsBasedOn" + this.activeCloud.Basis))
                                        } else {
                                            k = String.format(j, Explore.i18n("cloudSettingsTimePeriod" + this.activeCloud.TimeWindow), Explore.i18n("cloudSettingsBasedOn" + this.activeCloud.Basis))
                                        }
                                        this._setDescription(k)
                                    }
                                }
                            }
                        }
                    }
                }
            }
            var m = String.format(Explore.i18n("ideaCloudSettingsIconFormat"), this.activeCloud.DisplayCount, Explore.i18n("cloudSettingsBasedOn" + this.activeCloud.Basis), Explore.i18n("cloudSettingsTimePeriod" + this.activeCloud.TimeWindow));
            m = Explore.i18n("Settings");
            b.setTooltip(m);
            b.setDisabled(false);
            h.setDisabled(!(f.ViewType === Explore.model.CloudViewType.BreakingClusters || f.ViewType === Explore.model.CloudViewType.HotClusters || f.ViewType === Explore.model.CloudViewType.ClustersView || f.ViewType === Explore.model.CloudViewType.SpectrographsView || f.ViewType === Explore.model.CloudViewType.SentimentView));
            c.setDisabled(false);
            this._regenerateCloud()
        }
    }
},_containerRenderHandler:function(a) {
    a.getEl().on("click", this._showCloudSettingsDialog, this)
},_setRootCauseViewDescription:function(b, c) {
    if (b) {
        if (this.activeCloud.TimeWindow === Explore.model.TimeWindow.Between) {
            var d = "Between {0} and {1}";
            d = String.format(d, Explore.formatDateByPref(this.activeCloud.FromDate, {ignoreTime:true}), Explore.formatDateByPref(this.activeCloud.ToDate, {ignoreTime:true}));
            dateStr = d
        } else {
            dateStr = Explore.i18n("cloudSettingsTimePeriod" + b.TimeWindow)
        }
        var a = Explore.i18n("RootCauseAnalysis") + ", " + Explore.i18n("cloudSettingsBasedOn" + b.Basis) + ": " + dateStr;
        if (c && c.TotalResults) {
            a += ", " + c.TotalResults + " " + Explore.i18n("TotalResults")
        }
        this._setDescription(a)
    }
},_regenerateCloud:function() {
    this._stopPollForUpdates();
    var c = null;
    var b = this;
    if (this.activeCloud.ViewType === Explore.model.CloudViewType.SpectrographsView) {
        c = new Explore.view.common.Spectrograph({itemId:"spectrograph",isExplore:true,errorCls:"no-spectrograph-message",searchId:this.activeCloud.AdvancedSearchId,searchType:1})
    } else {
        if (this.activeCloud.ViewType === Explore.model.CloudViewType.ClustersView) {
            c = new Explore.view.common.Cluster({itemId:"cluster",isExplore:true,errorCls:"no-cluster-message",searchId:this.activeCloud.AdvancedSearchId,searchType:1})
        } else {
            if (this.activeCloud.ViewType === Explore.model.CloudViewType.HotClusters) {
                c = new Explore.view.widgets.HotClustersWidget({isExplore:true,searchId:this.activeCloud.AdvancedSearchId})
            } else {
                if (this.activeCloud.ViewType === Explore.model.CloudViewType.BreakingClusters) {
                    c = new Explore.view.widgets.BreakingClustersWidget({isExplore:true,projectId:Explore.presenter.ProjectsPresenter.getCurrentProjectId(),searchId:this.activeCloud.AdvancedSearchId})
                } else {
                    if (this.activeCloud.ViewType === Explore.model.CloudViewType.SentimentView) {
                        var a = "M-d-Y";
                        var e = this.activeCloud.TimeWindow;
                        if (e === Explore.model.TimeWindow.PastHour || e === Explore.model.TimeWindow.Past24Hours || e === Explore.model.TimeWindow.Past5Minutes || e === Explore.model.TimeWindow.PastWeek) {
                            a = "M-d-Y g:i a"
                        } else {
                            if (e === Explore.model.TimeWindow.Between) {
                                var d = Explore.determineTimeInterval(b.activeCloud.FromDate, b.activeCloud.ToDate, b.getTimeInterval());
                                durationName = Explore.i18n(Explore.model.Duration.getName(d).toLowerCase());
                                if (durationName === "hour" || durationName === "sixhours") {
                                    a = "M-d-Y g:i a"
                                }
                            }
                        }
                        c = new Explore.view.widgets.SavedSearchSentimentWidget({isExplore:true,dateFormat:a,searchId:this.activeCloud.AdvancedSearchId,name:this.activeCloud.name,TimeWindow:this.activeCloud.TimeWindow,StartDate:this.activeCloud.FromDate,EndDate:this.activeCloud.ToDate,projectId:Explore.presenter.ProjectsPresenter.getCurrentProjectId()})
                    } else {
                        if (this.activeCloud.ViewType === Explore.model.CloudViewType.DocumentsFilter) {
                            c = new Explore.view.widgets.DocumentCountsByFilter({cloud:this.activeCloud})
                        } else {
                            c = new Explore.view.widgets.HomeTopicsWidget({Id:this.activeCloud.Id,Position:this.activeCloud.Position,Name:this.activeCloud.Name,ViewType:this.activeCloud.ViewType,DisplayCount:this.activeCloud.DisplayCount,Basis:this.activeCloud.Basis,TimeWindow:this.activeCloud.TimeWindow,FromDate:this.activeCloud.FromDate,ToDate:this.activeCloud.ToDate,projectId:Explore.presenter.ProjectsPresenter.getCurrentProjectId(),listeners:{scope:this,contextMenu:this._showContextMenu,dataLoaded:function(f) {
                                this.activeHarvestDate = new Date();
                                this._startPollForUpdates()
                            }}})
                        }
                    }
                }
            }
        }
    }
    this.widget = c;
    if (c != null) {
        this._showCloudVisualizer(c)
    }
    b.getByItemId("wasNotRunDescription").setVisible(false);
    this.widget.on("showUncalcultedLabel", function(f) {
        b.getByItemId("wasNotRunDescription").setVisible(f)
    })
},_showCloudSettingsDialog:function() {
    var a = this;
    var b = new Explore.view.CloudSettingsDialog({readOnly:false,editObject:this.activeCloud});
    b.on("save", function(c) {
        a._displayCloud(c)
    });
    b.show()
},_exportData:function() {
    if (this.widget != null && typeof(this.widget.exportData) === "function") {
        this.widget.exportData()
    } else {
        Explore.view.StatusBox.showWarning(Explore.i18n("ExportNotSupported"), Explore.i18n("ExportNotSupported"))
    }
},_publishWidget:function() {
    var a = Explore.presenter.ProjectsPresenter.getCurrentProjectId();
    Explore.data.WidgetDataStore.publishHomeWidget(this.activeCloud, a, function(b) {
        if (b.ErrorCode === 0) {
            Explore.view.StatusBox.showInfo(Explore.i18n("SuccessfullyPublishedWidget"), Explore.i18n("SuccessfullyPublishedWidget") + " " + this.activeCloud.Name)
        } else {
            Explore.view.StatusBox.showWarning(Explore.i18n("ErrorPublishingWidget"), Explore.i18n("ThereWasAnErrorPublishingTheWidget") + b.Message)
        }
    })
},_onTopicSearch:function(b) {
    if (b) {
        var e = Explore.showSearchPanel();
        var a = null,c = null;
        if (b.ResultCounts && b.ResultCounts.length > 0) {
            var f = b.ResultCounts[0];
            var d = Explore.getLocalTimeZoneOffset();
            a = new Date(Explore.parseSerializedDate(f.StartDate).getTime() + d);
            c = new Date(Explore.parseSerializedDate(f.EndDate).getTime() + d);
            e.searchByCloudTopic(b.TopicId, b.TopicName, a, c)
        } else {
            if (this.activeCloud) {
                c = new Date();
                a = Explore.getStartDateFromTimeWindow(this.activeCloud.TimeWindow, c, this.activeCloud.FromDate);
                e.searchByTopic(pTopicResult.TopicId, pTopicResult.TopicName, a, c)
            } else {
                e.searchByTopic(pTopicResult.TopicId, pTopicResult.TopicName)
            }
        }
    }
},getTimeInterval:function() {
    var a = {byHour:3,bySixHours:8,byDay:46,byWeek:367,byYear:1085};
    return a
},_showContextMenu:function(d, c) {
    var a = this;
    var b = this.contextMenuItem;
    b = d;
    if (!this.contextMenu) {
        this.contextMenu = new Ext.menu.Menu({items:[
            {text:Explore.i18n("Search"),handler:function() {
                a._onTopicSearch(b)
            }},
            {text:Explore.i18n("ViewTopic"),handler:function() {
                var e = b.TopicId;
                Explore.data.TopicDataStore.getTopic(e, function(f) {
                    if (f !== null) {
                        var h = {readOnly:!f.IsCustom,editObject:f,title:(f.IsCustom) ? Explore.i18n("EditCustomTopic") : Explore.i18n("ViewTopic")};
                        log.debug("Open topic dialog for topic: ", e, " config: ", h);
                        var g = new Explore.view.TopicDialog(h);
                        g.show()
                    }
                })
            }}
        ]})
    }
    c.stopEvent();
    this.contextMenu.showAt(c.getXY())
}});
Ext.reg("explore.view.ideacloud", Explore.view.IdeaCloud);
Ext.ns("Explore.view");
Explore.view.IndexDocumentsCountPanel = Ext.extend(Ext.Panel, {chart_4:null,chartStore_4:null,filterType:null,itemId:"indexchart",disabled:true,position:null,prefs:null,initComponent:function() {
    var c = this;
    if (!c.filterType) {
        c.filterType = c.Duration || Explore.model.FilterByDateType.PastWeek
    }
    this.prefs = Explore.data.PreferenceDataStore.getPreferences();
    var b = c.getProjectName();
    var a = new Ext.Toolbar({items:[Explore.i18n("SelectDuration"),c.getComboBox()]});
    if (!this.chartStore_4) {
        this.chartStore_4 = new Ext4.data.ArrayStore({fields:["RealDate","startDate","endDate","Documents"]});
        c.reloadData()
    }
    var d = {layout:"fit",border:false,itemId:"ingestionTrendPanel",title:Explore.i18n("IndexedTrend"),cls:"Explore.view.widgets.TrendWidget",tbar:a,items:[
        {xtype:"box",itemId:"chartContainer",listeners:{resize:{fn:this.setupChart,buffer:250,scope:this}}}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, d));
    Explore.view.IndexDocumentsCountPanel.superclass.initComponent.apply(this, arguments);
    c.on("afterlayout", function() {
        var e = new Ext.LoadMask(c.getEl(), Explore.i18n("Loading_"));
        if (c.disabled) {
            e.show();
            c.on("enable", function() {
                e.hide()
            })
        }
    })
},_setTitle:function(b) {
    var a = this.getByItemId("ingestionTrendPanel");
    a.setTitle(Explore.i18n("IndexedTrend") + " : " + b)
},getComboBox:function() {
    if (!this._comboBox) {
        var a = this;
        this._comboBox = new Explore.view.common.SelectBoxField({allowBlank:false,forceSelection:true,triggerAction:"all",mode:"local",width:120,value:this.filterType,editable:false,listeners:{select:function(d, b, c) {
            a.filterType = b.get("timeCriteria");
            a.fireEvent("DurationChange", a.filterType);
            if (a.position !== null) {
                Explore.data.PreferenceDataStore.saveIngestionWidgetDuration(a.position, a.filterType)
            }
            a.reloadData()
        }},store:new Ext.data.ArrayStore({id:0,fields:["timeCriteria","friendlyName"],data:[
            [Explore.model.FilterByDateType.PastWeek,Explore.i18n("LastWeek")],
            [Explore.model.FilterByDateType.PastMonth,Explore.i18n("LastMonth")],
            [Explore.model.FilterByDateType.PastYear,Explore.i18n("LastYear")],
            [Explore.model.FilterByDateType.PastDay,Explore.i18n("Last24hrs")],
            [Explore.model.FilterByDateType.LastLogin,Explore.i18n("LastLogin")]
        ]}),valueField:"timeCriteria",displayField:"friendlyName"})
    }
    return this._comboBox
},getProjectName:function() {
    var a = this;
    Explore.data.ProjectDataStore.listMyProjects(function(b) {
        if (b != null && b.length > 0) {
            var d = b;
            for (var c = 0; c < d.length; c++) {
                if (d[c].Id === a.prefs.SelectedProjectId) {
                    a._setTitle(d[c].Name)
                }
            }
        }
    })
},getDuration:function() {
    return this.getComboBox().getValue()
},getDateFromEpoch:function(a) {
    var b = null;
    if (a && a > 0) {
        b = Explore.getDateFromEpoch(a, true)
    } else {
        b = Explore.getDateFromEpoch(0, true)
    }
    return b
},reloadData:function() {
    var c = this,d = c.getEl(),a = null;
    c.disable();
    if (d) {
        a = new Ext.LoadMask(d, Explore.i18n("Loading_"));
        a.show()
    }
    var b = new Ext.util.DelayedTask(function() {
        IDOLService.GetIndexedDocumentsTrend(c.getSearchCriteria(), c.getReportSettings(c.filterType), function(e) {
            if (a) {
                a.hide()
            }
            c.enable();
            if (e != null && e.Fields != null) {
                e.Fields.push("RealDate");
                for (var f = 0; f < e.GraphData.length; f++) {
                    var g = e.GraphData[f][0];
                    var h = c.getDateFromEpoch(g);
                    e.GraphData[f].push(h)
                }
                e.GraphData = Explore.convertGraphDataEpochsData(e.GraphData);
                c.chartStore_4.loadData(e.GraphData)
            }
        })
    });
    b.delay(1000)
},setupChart:function(d) {
    var e = this,g = d.getEl(),f = g.getComputedWidth(),c = g.getComputedHeight();
    dom = g.dom;
    var b = null;
    if (!this.chart_4) {
        var a = {autoHeight:true,autoWidth:true,constrainPosition:true,resizable:false,renderer:function(j, h) {
            if (j != null && j.data != null && j.data.Documents != null && j.data.Documents >= 0) {
                b = e.getTimeTag(e.filterType);
                if (b != null) {
                    if (e.filterType === Explore.model.FilterByDateType.PastDay || e.filterType === Explore.model.FilterByDateType.LastLogin) {
                        this.update(j.data.Documents + " " + Explore.i18n("Documents").toLowerCase() + " " + b + " " + j.data.RealDate.format("m/d/Y g:i a"))
                    } else {
                        this.update(j.data.Documents + " " + Explore.i18n("Documents").toLowerCase() + " " + b + " " + Explore.formatDateByPref(j.data.RealDate, {ignoreTime:true}))
                    }
                }
            }
        }};
        this.chart_4 = Ext4.create("widget.chart", {store:this.chartStore_4,renderTo:dom,shadow:false,width:f,height:c,theme:"Blue:gradients",axes:[
            {type:"Numeric",position:"left",fields:"Documents",label:{font:"11px Arial",renderer:Ext4.util.Format.numberRenderer("0,0")},grid:true,minimum:0},
            {type:"Time",position:"bottom",groupBy:"year,month,day,hour",fields:"RealDate",hideOverlappingLabels:true,minorTickSteps:1,majorTickSteps:5,label:{font:"11px Arial",renderer:function(h) {
                if (e.filterType === Explore.model.FilterByDateType.PastYear) {
                    return h.format("M")
                }
                if ((e.filterType === Explore.model.FilterByDateType.PastDay) || (e.filterType === Explore.model.FilterByDateType.LastLogin)) {
                    return h.format("M-d g:i a")
                } else {
                    return h.format("M-d")
                }
            }}}
        ],series:[
            {type:"line",axis:"left",xField:"RealDate",yField:"Documents",tips:a}
        ]})
    } else {
        this.chart_4.setSize(f, c)
    }
},getSearchCriteria:function() {
    var a = {searchTerms:"*",searchTermsUI:"*",timezoneOffsetMilliseconds:300};
    return a
},getReportSettings:function(b) {
    var a = {Category:"date",reportType:1,searchTerms:"*"};
    if (b === Explore.model.FilterByDateType.PastYear) {
        a.filterByDateType = Explore.model.FilterByDateType.PastYear
    } else {
        if (b === Explore.model.FilterByDateType.PastMonth) {
            a.filterByDateType = Explore.model.FilterByDateType.PastMonth
        } else {
            if (b === Explore.model.FilterByDateType.LastLogin) {
                a.filterByDateType = Explore.model.FilterByDateType.LastLogin
            } else {
                if (b === Explore.model.FilterByDateType.PastDay) {
                    a.filterByDateType = Explore.model.FilterByDateType.PastDay
                } else {
                    a.filterByDateType = Explore.model.FilterByDateType.PastWeek
                }
            }
        }
    }
    return a
},getTimeTag:function(b) {
    var a = null;
    if (b === Explore.model.FilterByDateType.PastWeek) {
        a = Explore.i18n("ingestedWeek")
    } else {
        if (b === Explore.model.FilterByDateType.PastMonth) {
            a = Explore.i18n("ingestedMonth")
        } else {
            if (b === Explore.model.FilterByDateType.PastYear) {
                a = Explore.i18n("ingestedYear")
            } else {
                if (b === Explore.model.FilterByDateType.LastLogin) {
                    a = Explore.i18n("ingestedLastLogin")
                } else {
                    if (b === Explore.model.FilterByDateType.PastDay) {
                        a = Explore.i18n("ingestedWeek")
                    }
                }
            }
        }
    }
    return a
}});
Ext.ns("Explore.view");
Explore.view.LexiconDialog = Ext.extend(Explore.base.EditorDialog, {itemDescription:Explore.i18n("Lexicon"),newTerms:null,newTermsAdded:false,initComponent:function() {
    var b = this;
    var d = b.editObject;
    b.formItems = [
        {name:"Name",allowBlank:false,maxLength:60},
        {xtype:b.readOnly ? "displayfield" : "textarea",name:"Description",allowBlank:true,height:40,maxLength:500},
        {xtype:"explore.view.phraseweights",name:"Phrases",hideLabel:true,margins:"0 10 10 10",readOnly:b.readOnly,allowLexicons:false,getSavedPhrase:function(e) {
            var f = d.Phrases;
            for (var g = 0; g < f.length; g++) {
                if (f[g]["Id"] === e.Id) {
                    return f[g]
                }
            }
            return null
        },comparePhrases:function(g, f) {
            for (var e in g) {
                if (g[e] !== f[e]) {
                    return false
                }
            }
            return true
        },isDirty:function() {
            var g = this.getValue();
            if (d.Phrases && d.Phrases.length !== g.length) {
                return true
            } else {
                for (var e = 0;
                     e < g.length; e++) {
                    var f = this.getSavedPhrase(g[e]);
                    if (!f || !this.comparePhrases(f, g[e])) {
                        return true
                    }
                }
            }
            return false
        },anchor:"100% -90"}
    ];
    Explore.view.LexiconDialog.superclass.initComponent.apply(this, arguments);
    var a = b.getByItemId("Phrases");
    if (b.newTerms && a) {
        for (var c = 0;
             c < b.newTerms.length; c++) {
            a.addTermToGrid(b.newTerms[c])
        }
    }
}});
Explore.view.LexiconManagerDialog = Ext.extend(Ext.Window, {modal:true,terms:null,width:600,height:350,phrases:null,initComponent:function() {
    var a = this;
    a.permissions = {view:Explore.Security.isAuthorized("LEXICONS_VIEW"),create:Explore.Security.isAuthorized("LEXICONS_CREATE"),update:Explore.Security.isAuthorized("LEXICONS_UPDATE"),"delete":Explore.Security.isAuthorized("LEXICONS_DELETE"),importExport:Explore.Security.isAuthorized("LEXICONS_IMPORT_EXPORT")};
    a.phrases = [];
    for (var c = 0; (a.terms && c < a.terms.length); c++) {
        a.phrases.push({Id:0,Weight:100,Phrase:a.terms[c]})
    }
    a.lexiconPicker = new Explore.view.LexiconTree({rootVisible:false,permissions:a.permissions,hideTools:true,root:{text:Explore.i18n("AllLexicons"),id:"root",singleClickExpand:true,expanded:true,tag:{type:"SECTION",id:1}}});
    var b = {title:Explore.i18n("AddToCreateLexicon"),layout:"fit",items:[a.lexiconPicker],buttons:[
        {xtype:"button",itemId:"editLexiconButton",text:Explore.i18n("EditLexicon"),disabled:true,handler:function() {
            var d = a.lexiconPicker.getSelectionModel().getSelectedNode();
            Explore.data.LexiconDataStore.getLexicon(d.attributes.id, function(e) {
                var f = new Explore.view.LexiconDialog({editObject:e,newTerms:a.terms});
                f.on("save", function() {
                    a.lexiconPicker.onSave(e)
                });
                f.show()
            })
        }},
        {xtype:"button",text:Explore.i18n("CreateLexicon"),itemId:"createLexiconButton",disabled:!a.permissions.create,handler:function() {
            var d = {};
            var e = new Explore.view.LexiconDialog({editObject:d,newTerms:a.terms});
            e.on("save", function() {
                a.lexiconPicker.onSave(d)
            });
            e.show()
        }},
        {xtype:"button",text:Explore.i18n("Close"),handler:function() {
            a.close()
        }}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.TopicManagerDialog.superclass.initComponent.apply(this, arguments);
    a.lexiconPicker.getSelectionModel().on("selectionchange", function() {
        a.treeSelection(a.lexiconPicker.getSelectionModel().getSelectedNode())
    })
},treeSelection:function(a) {
    if (a && !a.isRoot) {
        this.getByItemId("editLexiconButton").setDisabled(false)
    }
}});
Ext.namespace("Explore.view");
Explore.view.LoginWindow = Ext.extend(Ext.Window, {i18n:{title:"Login",description:"Please enter your username and password.",loadingMessage:"Please wait...",invalidCredentialsMessage:"Your credentials are invalid.",form:{fields:{user:"<u>U</u>sername",pass:"Pass<u>w</u>ord",rememberMe:"<u>R</u>emember Me",keepMeSignedIn:"<u>K</u>eep Me Signed In For 24 Hours"}}},constructor:function(a) {
    this.loginUrl = a.loginUrl || "/user/login";
    this.logoUrl = a.logoUrl;
    this.logoAltText = a.logoAltText;
    this.loadingMessage = a.loadingMessage || i18n(this.i18n.loadingMessage);
    this.autonomyLogoUrl = a.autonomyLogoUrl || "/img/autonomylogo.gif";
    this.usernameParameter = "username";
    this.passwordParameter = "password";
    this.useAccountField = a.useAccountField || false;
    var b = Ext.apply({userNickname:""}, a.formValues || {});
    this.addEvents(["beforelogin","login"]);
    this.formPanel = new Ext.form.FormPanel({border:false,labelWidth:100,method:"POST",url:a.loginUrl,buttons:[
        {text:i18n("Login"),handler:this._loginClick,scope:this},
        {text:i18n("SignUp"),handler:this._signupClick,scope:this,hidden:(this.useAccountField) ? false : true}
    ],defaults:{anchor:Ext.isIE ? "100%" : "95%",xtype:"textfield",validationEvent:false},items:[
        {allowBlank:false,blankText:(this.useAccountField ? "AccountName\\Username" : ""),fieldLabel:i18n(this.i18n.form.fields.user),id:"user",name:this.usernameParameter,emptyText:(this.useAccountField ? "AccountName\\Username" : ""),value:b.userNickname,validator:function(c) {
            if (a.useAccountField) {
                if (c.indexOf("\\") != -1) {
                    return true
                } else {
                    return"AccountName\\Username Eg:Autonomy\\Administrator"
                }
            } else {
                if (c) {
                    return true
                } else {
                    return"This field is required"
                }
            }
        }},
        {allowBlank:false,fieldLabel:i18n(this.i18n.form.fields.pass),id:"pass",inputType:"password",name:this.passwordParameter},
        {height:7,html:"&nbsp;",xtype:"box"},
        {checked:false,boxLabel:i18n(this.i18n.form.fields.rememberMe),id:"rememberMe",inputValue:true,name:"rememberMe",xtype:"checkbox",hidden:true},
        {checked:false,boxLabel:i18n(this.i18n.form.fields.keepMeSignedIn),id:"keepMeSignedIn",inputValue:true,name:"keepMeSignedIn",xtype:"checkbox",hidden:true}
    ],keys:[
        {key:Ext.EventObject.ENTER,fn:this._keyPressEnter,scope:this},
        {key:"a",alt:true,fn:this._keyPressAltA,scope:this},
        {key:"k",alt:true,fn:this._keyPressAltK,scope:this},
        {key:"r",alt:true,fn:this._keyPressAltR,scope:this},
        {key:"u",alt:true,fn:this._keyPressAltU,scope:this},
        {key:"w",alt:true,fn:this._keyPressAltW,scope:this}
    ],layoutConfig:{align:"stretch"},plugins:[Autonomy.ux.form.FirstInvalidField]});
    Explore.view.LoginWindow.superclass.constructor.call(this, Ext.apply({closable:false,cls:"autn-login-window",constrain:true,height:252,layout:"fit",resizable:false,title:i18n(this.i18n.title),width:450,items:{border:false,cls:"autn-login-panel",layout:"vbox",items:[Ext.apply(this.formPanel, {flex:1,margins:"20 30 0 30"}),{cls:"autn-login-logo",height:60,margins:"0 15 5 15",xtype:"box",html:Ext.isEmpty(this.logoUrl) ? "" : ['<img src="',this.logoUrl,'" alt="',this.logoAltText,'"/>'].join("")}],layoutConfig:{align:"stretch"},tbar:[
        {html:i18n(this.i18n.description),xtype:"box"}
    ]},listeners:{afterlayout:{fn:this._loginWindowAfterLayout,scope:this,single:true}}}, a))
},_loginWindowAfterLayout:function() {
    var b = Ext.DomQuery.select("div[class*=x-panel-footer] td[class=x-toolbar-left]")[0];
    Ext.fly(b).setWidth("100%");
    this.messageCtEl = Ext.get(Ext.DomHelper.append(b, {cls:"loading-message-wrap x-mask-loading",children:[
        {html:this.loadingMessage}
    ]}));
    this.messageCtEl.setVisible(false);
    this.messageCtEl.unselectable();
    var a = this._keyPressAltA.createDelegate(this);
    if (document.onload) {
        a = document.onload.createSequence(a)
    }
    document.onload = a
},_keyPressAltA:function() {
},_keyPressAltK:function() {
    var a = this.formPanel.getForm().findField("keepMeSignedIn");
    a.setValue(!a.getValue())
},_keyPressAltR:function() {
    var a = this.formPanel.getForm().findField("rememberMe");
    a.setValue(!a.getValue())
},_keyPressAltU:function() {
    this.formPanel.getForm().findField("user").focus()
},_keyPressAltW:function() {
    this.formPanel.getForm().findField("pass").focus()
},_keyPressEnter:function() {
    this._loginClick()
},_loginClick:function() {
    var a = this.formPanel.getForm();
    this.formPanel.buttons[0].focus();
    if (a.isValid()) {
        var b = this.formPanel.getForm().getValues();
        if (this.fireEvent("beforelogin", b)) {
            this.messageCtEl.addClass("x-mask-loading");
            this.messageCtEl.down("div").update(i18n(this.i18n.loadingMessage));
            this.formPanel.buttons[0].setDisabled(true);
            this.messageCtEl.fadeIn(0.1);
            Ext.Ajax.request({method:"POST",url:this.loginUrl,params:b,callback:this._loginCallback,scope:this});
            return true
        }
        return false
    } else {
        this.formPanel.getFirstInvalidField().focus("");
        return false
    }
},_loginCallback:function(m, l, c) {
    var f = c.getAllResponseHeaders();
    var j = f.split("\n");
    var h = 0;
    var g = "";
    var a = "Pages/Default.aspx";
    for (var d = 0; d < j.length; d++) {
        var e = j[d].indexOf(":");
        if (e >= 0) {
            var k = j[d].substring(0, e);
            var b = j[d].substring(e + 1);
            if (k === "errorCode") {
                h = parseInt(b, 10)
            } else {
                if (k === "errorMessage") {
                    g = b
                } else {
                    if (k === "X-redirectUrl") {
                        a = b
                    }
                }
            }
        }
    }
    if (h === 0) {
        top.location.href = a
    } else {
        this.messageCtEl.removeClass("x-mask-loading");
        this.messageCtEl.down("div").update(i18n(g));
        this.messageCtEl.stopFx();
        this.messageCtEl.fadeIn(0.1);
        this.formPanel.getForm().reset();
        this._keyPressAltA();
        this.formPanel.buttons[0].setDisabled(false)
    }
},_signupClick:function() {
    var a = new Explore.view.SignupWindow().show()
}});
Ext.ns("Explore.view");
Explore.view.MicroMediaInfluencerGrid = Ext.extend(Ext.Panel, {grid:null,contextMenu:null,initComponent:function(a) {
    var a = {layout:"card",activeItem:0,border:false,items:[this.createGrid()]};
    Ext.apply(this, Ext.apply(this.initialConfig, a));
    Explore.view.MicroMediaInfluencerGrid.superclass.initComponent.apply(this, arguments)
},loadDataSource:function() {
    var a = this;
    Explore.data.InfluencerDataStore.getMicroMediaInfluencers(function(b) {
        if (b) {
            var c = a.grid.getStore();
            c.loadData(b)
        }
    })
},changeInfluencerCount:function(a) {
},createGrid:function() {
    var a = this;
    a.grid = new Ext.grid.EditorGridPanel({itemId:"mediaInfluencer",flex:1,clicksToEdit:"auto",enableColumnHide:false,enableColumnMove:false,selModel:new Ext.grid.RowSelectionModel({singleSelect:true}),margins:"10 0 0 0",tbar:[
        {text:Explore.i18n("AddInfluencer"),handler:function() {
            var d = a.grid.getStore();
            var e = d.recordType;
            var c = new e({Id:0,Rating:"High",Score:0,Source:"Source",TotalFollowers:0,TotalFollowings:0,TotalUpdates:0});
            a.grid.stopEditing();
            d.insert(0, c);
            a.grid.startEditing(0, 0)
        }}
    ],columns:[
        {header:"Id",sortable:true,dataIndex:"Id",editor:new Ext.form.TextField({allowBlank:false})},
        {header:"Rating",sortable:true,dataIndex:"Rating",editor:new Ext.form.TextField({allowBlank:false})},
        {header:"Score",sortable:true,dataIndex:"Score",editor:new Ext.form.TextField({allowBlank:false})},
        {header:"Source",sortable:true,dataIndex:"Source",width:200,editor:new Ext.form.TextField({allowBlank:false})},
        {header:"TotalFollowers",sortable:true,dataIndex:"TotalFollowers",editor:new Ext.form.TextField({allowBlank:false})},
        {header:"TotalFollowings",sortable:true,dataIndex:"TotalFollowings",editor:new Ext.form.TextField({allowBlank:false})},
        {header:"TotalUpdates",sortable:true,dataIndex:"TotalUpdates",editor:new Ext.form.TextField({allowBlank:false})}
    ],store:new Ext.data.JsonStore({storeId:"blogInfluencerGridStore",fields:["Id","Rating","Score","Source","TotalFollowers","TotalFollowings","TotalUpdates"],data:[]}),buttonAlign:"left",listeners:{rowcontextmenu:this.onContextMenu,scope:this}});
    return a.grid
},onContextMenu:function(c, f, d) {
    var b = this;
    if (!this.contextMenu) {
        this.contextMenu = new Ext.menu.Menu({items:[
            {text:Explore.i18n("AddToSearch"),handler:function() {
                b.fireEvent("addToSearch")
            }},
            {xtype:"menuseparator"},
            {text:Explore.i18n("AddToTopic"),handler:function() {
                b.fireEvent("addToTopic")
            }}
        ]})
    }
    var a = this.grid.getSelectionModel();
    if (!a.isSelected(f)) {
        a.selectRow(f)
    }
    d.stopEvent();
    this.contextMenu.showAt(d.getXY())
}});
Ext.reg("explore.view.microMediaInfluencerGrid", Explore.view.MicroMediaInfluencerGrid);
Ext.ns("Explore.view");
Explore.view.MultiChannelLoginDialog = Ext.extend(Ext.Window, {rowObjects:null,width:680,height:260,closeAction:"close",modal:true,defaultChannel:null,cls:"white-bg-dialog",defaults:{padding:5},buildSignInButton:function() {
    var a = this;
    switch (a.defaultChannel) {case Explore.model.SocialMediaType.Twitter:return{border:false,xtype:"button",width:136,itemId:"buttonSignIn",fieldLabel:Explore.i18n("Add new account"),labelWidth:a.labelWidth,padding:"5 0 5 0",iconCls:"buttonSignInTwitter",handler:function() {
        a.signInTwitter()
    },style:{"margin-right":"auto","margin-top":"10px","margin-bottom":"10px"}};case Explore.model.SocialMediaType.Facebook:return{border:false,xtype:"button",fieldLabel:Explore.i18n("Add new account"),width:154,itemId:"buttonSignIn",iconCls:"buttonSignInFacebook",style:{"margin-right":"auto","margin-top":"10px","margin-bottom":"10px"}};
        case Explore.model.SocialMediaType.Linkedin:return{border:false,xtype:"button",itemId:"buttonSignIn",fieldLabel:Explore.i18n("Add new account"),width:130,iconCls:"buttonSignInLinkedIn",style:{"margin-right":"auto","margin-top":"10px","margin-bottom":"10px"}}
    }
},getPlatformComboBox:function() {
    if (!this._comboBox) {
        var a = this;
        this._comboBox = new Explore.view.common.SelectBoxField({allowBlank:false,fieldLabel:Explore.i18n("Platform"),forceSelection:true,triggerAction:"all",mode:"local",width:136,value:this.defaultChannel,editable:false,listeners:{select:function(d, b, c) {
            a.defaultChannel = b.get("platformSelection");
            a.refreshAccounts()
        }},store:new Ext.data.ArrayStore({id:0,fields:["platformSelection","friendlyName"],data:(Explore.demoMode) ? [
            [Explore.model.SocialMediaType.Twitter,Explore.i18n("docTypeTWITTER")],
            [Explore.model.SocialMediaType.Facebook,Explore.i18n("docTypeFacebook")],
            [Explore.model.SocialMediaType.Linkedin,Explore.i18n("docTypeLinkedIn")]
        ] : [
            [Explore.model.SocialMediaType.Twitter,Explore.i18n("docTypeTWITTER")]
        ]}),valueField:"platformSelection",displayField:"friendlyName"})
    }
    return this._comboBox
},refreshAccounts:function() {
    var a = this;
    a.updatePlatformButton();
    a.updateSocialMediaAccounts()
},removeAccount:function(b) {
    var a = this;
    var c;
    if (b.DefaultAccount) {
        c = Explore.i18n("AreYouSureYouWantToDeleteTheDefaultAccount_")
    } else {
        c = Explore.i18n("AreYouSureYouWantToDeleteTheAccount_")
    }
    Ext.MessageBox.confirm(Explore.i18n("DeleteDefaultAccount"), c, function(d) {
        if (d == "yes") {
            SourceService.DeleteSocialMediaAccount(b.AccountId, function(e) {
                if (e) {
                    if (!e.Message) {
                        currentUser = e.Result;
                        a.updateSocialMediaAccounts()
                    } else {
                        Explore.view.StatusBox.showWarning(Explore.i18n("appTitle"), e.Message)
                    }
                }
            })
        }
    })
},setDefaultAccount:function(b) {
    var a = this;
    if (b.DefaultAccount) {
        return
    }
    SourceService.SetDefaultSocialMediaAccount(b.AccountType, b.AccountId, function(c) {
        if (c) {
            if (!c.Message) {
                currentUser = c.Result;
                a.updateSocialMediaAccounts()
            } else {
                Explore.view.StatusBox.showWarning(Explore.i18n("appTitle"), c.Message)
            }
        } else {
        }
    })
},updatePlatformButton:function() {
    var b = this;
    var a = b.getByItemId("editAccountsPanel");
    if (a) {
        var c = a.getByItemId("buttonSignIn");
        if (c) {
            a.remove("buttonSignIn");
            a.add(b.buildSignInButton());
            a.doLayout()
        }
    }
},updateSocialMediaAccounts:function() {
    var b = this;
    var a = b.getByItemId("multichannel-accounts");
    if (a) {
        var e = a.removeAll();
        var d = Explore.getSocialAccountsByType(b.defaultChannel);
        if (d && d.length > 0) {
            var c = b.buildRegisteredAccountsPanels();
            if (c) {
                a.add(c);
                a.doLayout()
            }
        }
    }
},getUserNameLink:function(b) {
    var a = "";
    if (b) {
        switch (b.AccountType) {case Explore.model.SocialMediaType.Twitter:a = '<a href="' + Explore.i18n("TwitterURL") + "/@" + b.ScreenName + '" style="color:black;text-decoration:underline" target="_blank">@' + b.ScreenName + "</a>";
            break;case Explore.model.SocialMediaType.Facebook:a = Explore.i18n("FacebookURL");break;case Explore.model.SocialMediaType.Linkedin:a = Explore.i18n("LinkedInURL");
            break
        }
    }
    return a
},buildRegisteredAccountPanel:function(b) {
    var a = this;
    var c = {xtype:"panel",border:false,height:42,hidden:false,padding:"5 5 0 5",layout:"column",items:[
        {columnWidth:0.13,xtype:"box",hidden:false,autoEl:{tag:"div",children:[
            {tag:"img",src:b.ProfileImageUrl}
        ]}},
        {columnWidth:0.41,xtype:"box",hidden:false,align:"left",autoEl:{tag:"div",children:[
            {html:String.format("<b>{0}</b>", b.FullUserName || b.ScreenName)},
            {html:a.getUserNameLink(b)}
        ]}},
        {columnWidth:0.07,xtype:"box",border:false,itemId:"defaultAccountSelectionBox",autoEl:{tag:"div",children:[
            {tag:"img",src:(b.DefaultAccount) ? "../resources/images/icons/selected.png" : "../resources/images/icons/selected_clear.png"}
        ]}},
        {columnWidth:0.39,layout:"hbox",border:false,layoutConfig:{align:"middle",pack:"start"},items:[
            {xtype:"button",disabled:b.DefaultAccount,text:Explore.i18n("SocialAccount_Default"),scale:"small",handler:function() {
                a.setDefaultAccount(b)
            },margins:"0 1 0 0"},
            {xtype:"button",scale:"small",text:Explore.i18n("SocialAccount_Remove"),handler:function() {
                a.removeAccount(b)
            }}
        ]}
    ]};
    return c
},getNumberSocialMediaAccounts:function(a) {
    var c = 0;
    var b = Explore.getSocialAccountsByType(a);
    if (b) {
        c = b.length
    }
    return c
},buildRegisteredAccountsPanels:function() {
    var b = this;
    if (currentUser) {
        var e = Explore.getSocialAccountsByType(b.defaultChannel);
        if (e != null && e.length > 0) {
            var d = new Array();
            for (var c = 0; c < e.length; c++) {
                var a = this.buildRegisteredAccountPanel(e[c]);
                d.push(a)
            }
            return d
        } else {
            return null
        }
    } else {
        return null
    }
},initComponent:function() {
    var a = this;
    if (!a.defaultChannel) {
        a.defaultChannel = Explore.model.SocialMediaType.Twitter
    }
    var b = {itemId:"multichannellogin-dialog",title:Explore.i18n("EditAccounts"),border:false,layout:"hbox",layoutConfig:{align:"stretch"},fbar:[
        {xtype:"button",text:Explore.i18n("Close"),handler:function() {
            a.close()
        }}
    ],items:[
        {flex:17,border:false,items:[
            {xtype:"panel",itemId:"editAccountsPanel",height:120,layout:"form",border:false,items:[
                {xtype:"label",html:"<b>" + Explore.i18n("ActivateAccounts") + "</b>"},
                this.getPlatformComboBox(),
                this.buildSignInButton()
            ]}
        ]},
        {flex:25,layout:"vbox",layoutConfig:{align:"stretch"},border:false,items:[
            {xtype:"label",height:12,html:"<b>" + Explore.i18n("RegisteredAccounts") + "</b>"},
            {xtype:"panel",padding:5,flex:1,itemId:"multichannel-accounts",border:true,autoScroll:true,defaults:{border:false},items:[(a.getNumberSocialMediaAccounts(a.defaultChannel) != 0) ? a.buildRegisteredAccountsPanels() : {}]}
        ]}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.MultiChannelLoginDialog.superclass.initComponent.apply(this, arguments)
},signInTwitter:function() {
    SourceService.SignInWithTwitter(function(a) {
        if (a) {
            if (!a.Message) {
                var b = a.Result;
                Explore.popupWindow(b, "", 800, 600)
            } else {
                Explore.view.StatusBox.showWarning(Explore.i18n("appTitle"), a.Message)
            }
        } else {
        }
    })
}});
Ext.reg("explore.view.multichannellogindialog", Explore.view.MultiChannelLoginDialog);
Ext.ns("Explore.view");
Explore.view.NotificationRuleResultsDialog = Ext.extend(Ext.Window, {grid:null,searchInfo:null,initComponent:function() {
    var a = this;
    var b = {width:700,height:500,modal:true,maximizable:true,constrain:true,title:Explore.i18n("Preview"),layout:"fit",cls:"white-bg-dialog",items:{xtype:"container",layout:{type:"vbox",align:"stretch"},defaults:{xtype:"label"},items:[a.getGrid()],listeners:{afterrender:function() {
        a.showResults()
    }}}};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.NotificationRuleResultsDialog.superclass.initComponent.apply(this, arguments)
},getGrid:function() {
    var a = this;
    if (!this.grid) {
        this.grid = new Explore.view.ConciseSearchGrid({showGridMask:true,itemId:"grid",hidden:true,gridType:Explore.model.GridType.Compact,hideFooter:true,pageSize:0,flex:1,listeners:{gridContextOpen:function() {
            a.openRowResults()
        },rowDoubleClick:function() {
            a.openRowResults()
        },storeBeforeLoad:function(c, e) {
            var d = (e && e.params && e.params.dir && e.params.dir === "ASC" && a.lastDir !== "ASC") ? Explore.model.SortDirection.Ascending : Explore.model.SortDirection.Descending;
            a.lastDir = (d === Explore.model.SortDirection.Ascending) ? "ASC" : "DESC";
            var g = Explore.model.SortProperty.Weight;
            if (e && e.params && e.params.sort) {
                var j = e.params.sort;
                if (j === "type") {
                    g = Explore.model.SortProperty.MediaType
                } else {
                    if (j === "source") {
                        g = Explore.model.SortProperty.MediaType
                    } else {
                        if (j === "date") {
                            g = Explore.model.SortProperty.DateTime
                        }
                    }
                }
            }
            var h = {PageNumber:1,PageSize:50,SortDirection:d,SortProperty:g};
            var f = {bypassDocCounts:true};
            var b = new Ext.LoadMask(a.getGrid().getEl(), Explore.i18n("Loading_"));
            b.show();
            Explore.data.IDOLDataStore.getAdvancedSearchResults(a.searchInfo, h, f, function(k) {
                b.hide();
                a.getGrid().showData(k);
                a.getGrid().show();
                a.doLayout()
            })
        }}})
    }
    return this.grid
},showResults:function() {
    var b = this,d = b.getEl(),a = null;
    var e = {PageNumber:1,PageSize:50,SortDirection:Explore.model.SortDirection.Descending,SortProperty:Explore.model.SortProperty.Weight};
    var c = {bypassDocCounts:true};
    if (d) {
        a = new Ext.LoadMask(d, Explore.i18n("Loading_"));
        a.show()
    }
    Explore.data.IDOLDataStore.getAdvancedSearchResults(b.searchInfo, e, c, function(f) {
        if (a) {
            a.hide()
        }
        b.getGrid().showData(f);
        b.getGrid().show();
        b.doLayout()
    })
},openRowResults:function(e) {
    var a = this;
    var d = a.grid.getSelectedRows();
    if (d.length > 0) {
        var c = a.getGrid().getAllRows();
        var b = a.getGrid().getIndexOfRow(d[0]);
        Explore.SearchResults.openSearchResults(d, c, b)
    }
}});
Ext.reg("explore.view.notificationRuleResultsDialog", Explore.view.NotificationRuleResultsDialog);
Ext.ns("Explore.view");
Explore.view.OptimizationDialog = Ext.extend(Explore.base.EditorDialog, {itemDescription:Explore.i18n("optimization"),newTerms:null,newTermsAdded:false,initComponent:function() {
    var c = this;
    var b = c.editObject;
    c.formItems = [
        {name:"Name",allowBlank:false,maxLength:60},
        {xtype:c.readOnly ? "displayfield" : "textarea",name:"Description",allowBlank:true,height:40,maxLength:500},
        {xtype:"explore.view.phraseweights",name:"Phrases",hideLabel:true,margins:"0 10 10 10",readOnly:c.readOnly,showWeight:false,permissions:{"export":false,"import":false},allowLexicons:false,isDirty:function() {
            var f = false;
            var e = this.getValue();
            if (b.Phrases && b.Phrases.length !== e.length) {
                f = true
            } else {
                f = (Explore.areArraysSame(e, b.Phrases))
            }
            return f
        },anchor:"100% -90"}
    ];
    Explore.view.OptimizationDialog.superclass.initComponent.apply(this, arguments);
    var a = c.getByItemId("Phrases");
    if (c.newTerms && a) {
        for (var d = 0; d < c.newTerms.length; d++) {
            a.addTermToGrid(c.newTerms[d])
        }
    }
}});
Explore.view.OptimizationManagerDialog = Ext.extend(Ext.Window, {modal:true,terms:null,width:600,height:350,phrases:null,initComponent:function() {
    var a = this;
    a.permissions = {view:true,create:true,update:true,"delete":true,importExport:false};
    a.phrases = [];
    for (var c = 0; (a.terms && c < a.terms.length);
         c++) {
        a.phrases.push({Id:0,Weight:100,Phrase:a.terms[c]})
    }
    var b = {title:Explore.i18n("AddToOptimazationCampaign"),layout:"fit",items:[a.getTree()],buttons:[
        {xtype:"button",itemId:"editOptimizationButton",text:Explore.i18n("EditOptimization"),disabled:true,handler:function() {
            var d = a.getTree().getSelectionModel().getSelectedNode();
            var e = new Explore.data.model.Optimization(d.attributes.tag);
            var f = new Explore.view.OptimizationDialog({editObject:e,newTerms:a.terms});
            f.on("save", function() {
            });
            f.show()
        }},
        {xtype:"button",text:Explore.i18n("CreateOptimization"),itemId:"createOptimizationButton",disabled:!a.permissions.create,handler:function() {
            var d = new Explore.data.model.Optimization();
            var e = new Explore.view.OptimizationDialog({editObject:d,newTerms:a.terms});
            e.on("save", function() {
            });
            e.show()
        }},
        {xtype:"button",text:Explore.i18n("Close"),handler:function() {
            a.close()
        }}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.OptimizationManagerDialog.superclass.initComponent.apply(this, arguments);
    a.getTree().getSelectionModel().on("selectionchange", function() {
        a.treeSelection(a.getTree().getSelectionModel().getSelectedNode())
    })
},treeSelection:function(a) {
    if (a && !a.isRoot) {
        this.getByItemId("editOptimizationButton").setDisabled(false)
    }
},getTree:function() {
    var a = this;
    if (!this._tree) {
        this._tree = new Explore.view.OptimizationTree({terms:a.terms})
    }
    return this._tree
}});
Explore.view.OptimizationTree = Ext.extend(Ext.tree.TreePanel, {useArrows:true,autoScroll:true,animate:true,enableDD:false,containerScroll:true,border:false,rootVisible:false,terms:null,initComponent:function() {
    var a = this;
    var b = {root:{singleClickExpand:true,id:"root",children:a.getData()}};
    Ext.apply(this, b);
    Explore.view.OptimizationTree.superclass.initComponent.apply(this, arguments)
},getData:function() {
    if (!this._treeData) {
        this._treeData = [];
        data = [
            {text:"optimization phrase1",tag:{Name:"optimization phrase1"},leaf:true},
            {text:"optimization phrase2",tag:{Name:"optimization phrase2"},leaf:true},
            {text:"optimization phrase3",tag:{Name:"optimization phrase3"},leaf:true},
            {text:"optimization phrase4",tag:{Name:"optimization phrase4"},leaf:true},
        ];
        for (var a = 0; a < data.length; a++) {
            if (data[a]) {
                var b = new Ext.tree.TreeNode({id:a,text:data[a].text,leaf:data[a].leaf,tag:data[a].tag});
                this._treeData.push(b)
            }
        }
    }
    return this._treeData
}});
Ext.ns("Explore.view");
Explore.view.PermissionSelector = Ext.extend(Ext.tree.TreePanel, {readOnly:true,name:"",displayOnlyMode:false,_initialValue:null,initComponent:function() {
    var c = this;
    var b = new Ext.tree.TreeNode({nodeType:"node",text:"",id:"root",expanded:true});
    var a = new Ext.tree.TreeLoader({preloadChildren:true,directFn:UserService.GetPermissionHierarchy,paramOrder:"node roleId",baseParams:{roleId:null},baseAttrs:{uiProvider:Ext.tree.TriStateNodeUI,iconCls:"no-icon",checked:c.displayOnlyMode ? undefined : false,singleClickExpand:true,expanded:true,disabled:c.readOnly}});
    if (!c.displayOnlyMode) {
        a.load(b, function() {
            if (c._initialValue != null) {
                c.setValue(c._initialValue)
            }
            if (!c.readOnly) {
                c.setReadOnly(c.readOnly)
            }
        })
    }
    var d = {title:Explore.i18n("Permissions"),cls:"user-picker-tree hierarchy-tree",collapsible:false,useArrows:true,autoScroll:true,animate:true,containerScroll:true,itemDescription:Explore.i18n("Permission"),root:b,rootVisible:false,loader:a};
    Ext.apply(this, Ext.apply(this.initialConfig, d));
    Explore.view.PermissionSelector.superclass.initComponent.apply(this, arguments);
    this.on("render", function() {
        var e = c.getMask();
        this.getLoader().on("beforeload", function(f) {
            e.show()
        });
        this.getLoader().on("load", function(f) {
            e.hide()
        });
        this.getLoader().on("loadexception", function(f, h, g) {
            e.hide()
        })
    });
    this.on("checkchange", this.applyDependencies, this)
},getMask:function() {
    return new Ext.LoadMask(this.getEl(), Explore.i18n("Loading..."))
},getName:function() {
    return this.name
},setValue:function(a) {
    this._initialValue = a;
    if (!this.displayOnlyMode) {
        this.clearAll();
        this.checkPermissions(a);
        this.setDirty(false)
    }
},getValue:function() {
    var a = [];
    var b = function() {
        var c = this.ui.getChecked();
        if (c === true || c === null) {
            a.push({Id:this.attributes.tag.id,Type:this.attributes.tag.type})
        }
    };
    this.getRootNode().cascade(b);
    return a
},setRoleId:function(a) {
    this.getLoader().baseParams.roleId = a;
    this.refresh()
},markInvalid:function() {
    this.addClass("grid-invalid")
},clearInvalid:function() {
    this.removeClass("grid-invalid")
},validate:function(a) {
    return this.isValid(a)
},isValid:function(a) {
    var b = true;
    return b
},checkPermissions:function(c) {
    if (c) {
        for (var a = 0; a < c.length; a++) {
            var b = c[a];
            if (b.Type !== Explore.model.PermissionType.Folder) {
                var d = this.getNodeById(b.Id);
                if (d) {
                    d.getUI().toggleCheck(true)
                }
            }
        }
    }
},applyDependencies:function(e, d) {
    if (d === true) {
        if (e.attributes.tag && e.attributes.tag.depends) {
            var f = e.attributes.tag.depends;
            for (var c = 0; c < f.length; c++) {
                var e = this.getNodeById(f[c]);
                if (e) {
                    e.getUI().toggleCheck(true)
                }
            }
        }
    } else {
        if (d === false) {
            var b = e.attributes.tag.id;
            var a = this;
            this.getRootNode().cascade(function() {
                if (this.attributes.tag && this.attributes.tag.depends) {
                    var h = this.attributes.tag.depends;
                    for (var g = 0; g < h.length; g++) {
                        if (h[g] === b) {
                            this.getUI().toggleCheck(false)
                        }
                    }
                }
            })
        }
    }
}});
Ext.reg("explore.view.permissionselector", Explore.view.PermissionSelector);
Explore.view.PhraseSuggestionWindow = Ext.extend(Ext.Window, {height:500,width:500,modal:true,phrases:[],title:"Suggested Terms",initComponent:function() {
    var b = this;
    var a = {layout:"fit",fbar:[
        {text:Explore.i18n("Add Selected Terms"),handler:function() {
            b.processSugguestions()
        }}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, a));
    Explore.view.PhraseSuggestionWindow.superclass.initComponent.apply(this, arguments);
    this.postConstructorLoad()
},processSugguestions:function() {
    var a = this;
    var c = a.getByItemId("processSugguestions");
    var b = c.getValue();
    a.fireEvent("addsuggestions", b);
    a.close()
},postConstructorLoad:function() {
    var a = this;
    a.disable();
    a.getSuggestions(function(b) {
        var c = {itemId:"processSugguestions",autoScroll:true,xtype:"explore.view.common.checkboxgroup",showHeaderCheck:true,headerText:Explore.i18n("Select All"),checked:a.checkall,items:b};
        a.add(c);
        a.doLayout();
        a.enable()
    })
},getSuggestions:function(f) {
    var b = this;
    var a = ["term1","term2"];
    var e = [];
    for (var d = 0; d < a.length;
         d++) {
        var c = a[d];
        e.push({itemId:c.toLowerCase(),boxLabel:c,checked:false})
    }
    f(e)
}});
Ext.ns("Explore.view");
Explore.view.PhraseWeights = Ext.extend(Ext.Container, {readOnly:true,value:[],allowLexicons:false,allowLexiconEdit:false,_isDirty:false,name:"",markedInvalid:false,showWeight:true,lexicons:[],initComponent:function() {
    var b = this;
    if (!b.permissions) {
        b.permissions = {"export":true,"import":true}
    }
    var a = [];
    if (!b.readOnly) {
        a.push({layout:{type:"hbox",align:"middle"},border:false,defaults:{margins:"0 5 0 0"},items:[
            {xtype:"label",text:Explore.i18n("Add")},
            b.getAddTextFieldConfig(),
            {xtype:"label",text:Explore.i18n("withWeight"),hidden:!b.showWeight},
            {xtype:"spinnerfield",itemId:"add-weight",width:60,minValue:0,maxValue:100,format:"0",width:60,value:100,hidden:!b.showWeight},
            {xtype:"button",itemId:"add-phrase-button",text:Explore.i18n("Add"),disabled:true,handler:b.addPhraseToGrid,scope:b}
        ]})
    }
    a.push(b.createGrid());
    var c = {layout:{type:"vbox",align:"stretch"},items:a};
    Ext.apply(this, Ext.apply(this.initialConfig, c));
    Explore.view.PhraseWeights.superclass.initComponent.apply(this, arguments)
},getName:function() {
    return this.name
},setValue:function(c) {
    var b = this;
    b.value = c;
    b._isDirty = false;
    var a = b._grid.getStore();
    if (c) {
        a.loadData(c)
    } else {
        a.removeAll()
    }
},getValue:function() {
    var c = this;
    var f = [];
    var b = c._grid.getStore();
    var e = b.getCount();
    for (var d = 0; d < e; d++) {
        var a = b.getAt(d);
        f.push({Id:a.get("Id") || 0,Phrase:a.get("Phrase"),LexiconId:a.get("LexiconId"),Weight:a.get("Weight")})
    }
    return f
},isDirty:function() {
    return this._isDirty || this.getByItemId("add-text-field").isDirty()
},markInvalid:function() {
    var a = this;
    if (!a.markedInvalid) {
        a.markedInvalid = true;
        a._grid.addClass("grid-invalid")
    }
},clearInvalid:function() {
    var a = this;
    if (a.markedInvalid) {
        a.markedInvalid = false;
        a._grid.removeClass("grid-invalid")
    }
},validate:function(a) {
    return this.isValid(a)
},isValid:function(a) {
    var d = this;
    var c = d._grid.getStore();
    var f = c.getCount();
    var h = f > 0;
    if (h) {
        for (var e = 0; e < f; e++) {
            var b = c.getAt(e);
            var g = b.get("Phrase");
            if (g === null || g.trim() === "") {
                h = false;
                break
            }
        }
    }
    if (h) {
        d.clearInvalid()
    } else {
        if (!a) {
            d.markInvalid()
        }
    }
    return h
},getAddTextFieldConfig:function() {
    var a = this;
    var b = {xtype:"combo",store:new Ext.data.JsonStore({id:"Id",idProperty:"DisplayText",fields:["Id","DisplayText"],data:[]}),typeAhead:true,triggerAction:"all",mode:"local",valueField:"DisplayText",displayField:"DisplayText",itemId:"add-text-field",width:300,emptyText:"(" + Explore.i18n("entertopicword") + ")",invalidText:Explore.i18n("ClickTheAddButtonToAddThisWordphraseToTheGridBelow"),enableKeyEvents:true,listeners:{keyup:function(g, j) {
        var k = (g.getRawValue().trim() === "");
        a.getByItemId("add-phrase-button").setDisabled(k);
        var h = new RegExp(String.format("^{0}", f), "i");
        if ((j.getKey() == j.RETURN || j.getKey() == j.ENTER) && !k) {
            a.addPhraseToGrid()
        } else {
            if (!k && !j.isNavKeyPress()) {
                var f = g.getRawValue().trim();
                if (f) {
                    var h = new RegExp(String.format("^{0}", f), "i");
                    var d = g.getStore();
                    d.filter("DisplayText", h, true, false, true);
                    IDOLService.GetExpandedTerms(f, function(m) {
                        var l = [];
                        if (m && m.Result) {
                            l = m.Result
                        }
                        d.clearData();
                        var s = [
                            {Id:f,DisplayText:f,Phrase:f}
                        ];
                        for (var o = 0; o < l.length; o++) {
                            var n = {Id:l[o],DisplayText:l[o],Phrase:l[o]};
                            s.push(n)
                        }
                        var q = a.lexicons.concat(s);
                        var p = [];
                        for (var o = 0; o < q.length; o++) {
                            try {
                                if (h.test(q[o].DisplayText)) {
                                    p.push(q[o])
                                }
                            } catch(r) {
                            }
                        }
                        d.loadData(p);
                        d.filter("DisplayText", h, true, false, true)
                    })
                }
            }
        }
    },select:function(d, f) {
        var g = (d.getValue() === "");
        a.getByItemId("add-phrase-button").setDisabled(g)
    }}};
    if (a.allowLexicons) {
        var c = new Ext.data.JsonStore({id:"Id",fields:["Id","DisplayText"],data:[]});
        b = Ext.apply(b, {xtype:"combo",store:c,typeAhead:true,triggerAction:"all",lazyRender:true,mode:"local",valueField:"Id",displayField:"DisplayText",typeAhead:false});
        b.listeners.afterrender = function(d) {
            Explore.data.LexiconDataStore.getLexicons(function(e) {
                if (e) {
                    for (var f = 0; f < e.length; f++) {
                        e[f].DisplayText = Explore.i18n("Lexicon") + ": " + e[f].Name
                    }
                    a.lexicons = e;
                    c.loadData(e)
                }
            })
        }
    }
    return b
},addTermToGrid:function(c) {
    var b = this._grid.getStore();
    var a = new b.recordType({Phrase:c,LexiconId:null,Weight:100});
    b.add(a)
},addPhraseToGrid:function() {
    log.info("Add word/phrase to grid");
    var k = this;
    var c = k.getByItemId("add-text-field");
    var h = k.getByItemId("add-weight");
    var j = k._grid.getStore();
    var a = c.getValue();
    var b,g = null;
    var e = c.getRawValue().trim() === "";
    if (c.isVisible() && h.isValid() && !e) {
        if (typeof a === "number") {
            var f = c.getStore().getById(a);
            b = f.get("DisplayText");
            g = f.get("Id")
        } else {
            b = c.getRawValue().trim()
        }
        var d = new j.recordType({Phrase:b,LexiconId:g,Weight:h.getValue()});
        k._grid.stopEditing();
        j.add(d);
        var l = j.getSortState();
        j.sort(l.field, l.direction);
        k.setFooterButtonsDisabled(true);
        c.setValue("");
        c.focus();
        k.validate();
        k._isDirty = true;
        k.getByItemId("add-phrase-button").setDisabled(true)
    }
},setEditButtonDisabled:function(b) {
    if (!this.readOnly) {
        var a = this._grid.fbar.getByItemId("delete-phrase-button");
        a.setDisabled(b)
    }
},setViewLexiconDisabled:function(b) {
    if (this.allowLexicons) {
        var a = this._grid.fbar.getByItemId("lexicon-detail-button");
        a.setDisabled(b)
    }
},setFooterButtonsDisabled:function(a) {
    this.setEditButtonDisabled(a);
    this.setViewLexiconDisabled(a)
},editLexicon:function(b) {
    var a = this;
    Explore.data.LexiconDataStore.getLexicon(b, function(c) {
        var d = new Explore.view.LexiconDialog({editObject:c,readOnly:!a.allowLexiconEdit});
        d.on("lexiconSave", function() {
            Explore.data.LexiconDataStore.saveLexicon(c, function(e) {
            })
        });
        d.show(a)
    })
},exportPhrases:function() {
    var a = this;
    var c = a._grid;
    var d = c.getStore();
    var b = a.getValue();
    if (b.length > 0) {
        Explore.data.TopicDataStore.getPhrases(b, function(e) {
            Explore.utils.Exporter.exportTextToCsV("text/csv", "phrases.csv", e.Payload)
        })
    } else {
    }
},importPhrases:function() {
    var b = this;
    if (!b.readOnly) {
        var a = new Ext.LoadMask(b.getEl(), "Importing");
        a.show();
        try {
            var d = new Explore.view.ImportTopicPhraseWindow();
            d.show();
            d.on("import", function(e) {
                b._grid.getStore().loadData(e);
                b._isDirty = true;
                d.close()
            });
            d.on("close", function() {
                a.hide()
            })
        } catch(c) {
            a.hide()
        }
    }
},deletePhrase:function() {
    var b = this;
    if (!b.readOnly) {
        try {
            var d = b._grid;
            selModel = d.getSelectionModel(),store = d.getStore(),selections = selModel.getSelections();
            if (selections) {
                for (var c = 0; c < selections.length; c++) {
                    var a = selections[c];
                    store.remove(a)
                }
                b.setFooterButtonsDisabled(true);
                b._isDirty = true
            }
        } catch(f) {
        }
    }
},viewLexicon:function() {
    var c = this;
    try {
        var f = c._grid,b = f.getSelectionModel(),d = b.getSelected();
        if (d) {
            var a = d.get("LexiconId");
            if (a > 0) {
                c.editLexicon(a)
            }
        }
    } catch(h) {
    }
},permitExport:function(a) {
    if (a) {
        return Explore.Security.isAuthorized("TOPICS_IMPORT_EXPORT")
    } else {
        return Explore.Security.isAuthorized("LEXICONS_IMPORT_EXPORT")
    }
},getFooterConfig:function() {
    var b = this;
    var a = [];
    a.push({xtype:"button",itemId:"export-phrase-button",text:Explore.i18n("Export"),disabled:!this.permitExport(this.allowLexicons),hidden:!b.permissions["export"],handler:b.exportPhrases,scope:this});
    if (!b.readOnly) {
        a.push({xtype:"button",itemId:"import-phrase-button",text:Explore.i18n("Import"),disabled:false,hidden:!b.permissions["export"],handler:b.importPhrases,scope:this})
    }
    if (!b.readOnly) {
        a.push({xtype:"button",itemId:"delete-phrase-button",text:Explore.i18n("Delete"),disabled:true,handler:b.deletePhrase,scope:this})
    }
    if (b.allowLexicons) {
        a.push({xtype:"button",itemId:"lexicon-detail-button",text:b.allowLexiconEdit ? Explore.i18n("EditLexicon") : Explore.i18n("ViewLexicon"),disabled:true,handler:b.viewLexicon,scope:this})
    }
    return a
},showSuggestions:function() {
    var c = this;
    var e = this._grid,b = e.getSelectionModel(),g = b.getSelections(),a = [];
    for (var d = 0;
         d < g.length; d++) {
        var f = g[d];
        if (f.get("LexiconId")) {
            a = a.concat(this.getLexiconPhrases(f.get("LexiconId")))
        } else {
            a.push(f.get("Phrase"))
        }
    }
    var h = new Explore.view.PhraseSuggestionWindow({phrases:a,listeners:{addsuggestions:function(k) {
        if (k && k.length) {
            for (var j = 0;
                 j < k.length; j++) {
                c.addTermToGrid(k[j])
            }
        }
    }}});
    h.show()
},getLexicon:function(d) {
    var a = this.lexicons;
    for (var b = 0; b < a.length; b++) {
        var c = a[b];
        if (c.Id === d) {
            return c
        }
    }
},getLexiconPhrases:function(d) {
    var c = this.getLexicon(d);
    var a = [];
    for (var b = 0; b < c.Phrases.length; b++) {
        a.push(c.Phrases[b].Phrase)
    }
    return a
},getGridContextMenu:function() {
    if (!this._gridContextMenu) {
        var c = this;
        var b = this._deleteAction = new Ext.Action({text:Explore.i18n("Delete"),id:"deletePhrases",iconCls:"delete-icon",handler:function() {
            c.deletePhrase()
        }});
        var e = this._viewLexiconAction = new Ext.Action({text:Explore.i18n("ViewLexicon"),id:"viewLexicon",handler:function() {
            c.viewLexicon()
        }});
        var h = this._suggestTermsAction = new Ext.Action({text:Explore.i18n("Suggest Terms"),id:"suggestTerms",handler:function() {
            c.showSuggestions()
        }});
        this._gridContextMenu = new Ext.menu.Menu({items:[h,e,b]})
    }
    var d = this._grid,a = d.getSelectionModel(),f = a.getSelections(),g = f.length;
    this._viewLexiconAction.setDisabled((g > 1) || !f[0].get("LexiconId"));
    return this._gridContextMenu
},createGrid:function() {
    var a = this;
    a._grid = new Ext.grid.EditorGridPanel({itemId:"topicsEditGrid",flex:1,clicksToEdit:"auto",autoExpandColumn:"Phrase",enableColumnHide:false,enableColumnMove:false,enableColumnResize:false,autoExpandMax:2000,selModel:new Ext.grid.RowSelectionModel({singleSelect:false}),keys:[
        {key:"e",fn:a.exportPhrases,scope:this},
        {key:"i",fn:a.importPhrases,scope:this},
        {key:"d",fn:a.deletePhrase,scope:this},
        {key:"v",fn:a.viewLexicon,scope:this}
    ],margins:"10 0 0 0",columns:[
        {header:Explore.i18n("WordOrPhrase"),sortable:true,dataIndex:"Phrase",id:"Phrase",readOnly:a.readOnly,editor:new Ext.form.TextField({allowBlank:false})},
        {header:Explore.i18n("Weight"),width:100,sortable:true,dataIndex:"Weight",hidden:!a.showWeight,readOnly:a.readOnly,editor:new Ext.form.SpinnerField({allowBlank:false,minValue:0,maxValue:100,format:"0"})}
    ],store:new Ext.data.JsonStore({storeId:"gridStore",fields:[
        {name:"Id"},
        {name:"Phrase",sortType:"asUCString"},
        {name:"LexiconId"},
        {name:"Weight"}
    ],data:a.value,sortInfo:{field:"Phrase",direction:"ASC"},listeners:{update:function(d, b, c) {
        a._isDirty = true
    }}}),buttonAlign:"left",viewConfig:{emptyText:(a.readOnly ? "" : "(" + Explore.i18n("onewordorphraserequired") + ")"),deferEmptyText:false},fbar:a.getFooterConfig(),listeners:{rowcontextmenu:function(b, d, c) {
        c.stopEvent();
        a.getGridContextMenu().showAt(c.xy)
    },beforeedit:function(b) {
        if (a.readOnly) {
            b.cancel = true;
            return
        }
        if (b.field === "Phrase" && b.record.get("LexiconId") > 0) {
            b.cancel = true
        }
    }}});
    a._grid.getSelectionModel().on("selectionchange", function(b) {
        var c = b.getSelections();
        if (c && c.length > 0) {
            a.setEditButtonDisabled(false);
            if (c.length === 1 && c[0].get("LexiconId")) {
                a.setViewLexiconDisabled(false)
            } else {
                a.setViewLexiconDisabled(true)
            }
        } else {
            a.setEditButtonDisabled(true);
            a.setViewLexiconDisabled(true)
        }
    });
    return a._grid
}});
Ext.reg("explore.view.phraseweights", Explore.view.PhraseWeights);
Ext.ns("Explore.view");
Explore.view.PreferencesDialog = Ext.extend(Explore.base.EditorDialog, {readOnly:false,itemDescription:Explore.i18n("Preferences"),labelWidth:220,height:670,initComponent:function() {
    var k = this;
    k.editObject = Explore.data.PreferenceDataStore.getPreferences();
    var j = {xtype:"displayfield",name:"UserName",fieldLabel:Explore.i18n("DisplayName"),value:currentUser.FullNameFML};
    var l = {xtype:"displayfield",name:"RoleName",fieldLabel:Explore.i18n("Role"),value:currentUser.Role.Name};
    var b = {xtype:"button",width:136,fieldLabel:Explore.i18n("textChangePassword"),labelWidth:k.labelWidth,padding:"5 0 5 0",text:Explore.i18n("textChangePassword"),handler:function() {
        var t = new Explore.view.ChangeLoginPasswordWindow({userName:""});
        t.show()
    }};
    var e = {name:"QfinitiUsername",width:120,hidden:(Explore.PlayerUrl == null || Explore.PlayerUrl == "")};
    var o = {name:"QfinitiPassword",inputType:"password",width:120,hidden:(Explore.PlayerUrl == null || Explore.PlayerUrl == "")};
    var p = {xtype:"selectboxfield",name:"Language",width:100,mode:"local",store:new Ext.data.ArrayStore({id:0,fields:["id","text"],data:[
        ["English",Explore.i18n("English")]
    ]}),valueField:"id",displayField:"text"};
    var a = {xtype:"selectboxfield",name:"CloudCount",width:130,mode:"local",store:new Ext.data.ArrayStore({id:0,fields:["id","text"],data:[
        [1,Explore.i18n("topicArea")],
        [2,String.format(Explore.i18n("topicAreas"), 2)],
        [4,String.format(Explore.i18n("topicAreas"), 4)]
    ]}),valueField:"id",displayField:"text"};
    var f = {xtype:"container",fieldLabel:Explore.i18n("TopicAreasAutoRefreshInterval"),layout:{type:"hbox",align:"middle"},border:false,items:[
        {xtype:"selectboxfield",margins:"0 5 0 0",name:"AutoRefreshInterval",itemId:"AutoRefreshInterval",width:70,mode:"local",store:new Ext.data.ArrayStore({id:0,fields:["id","text"],data:[
            [0,Explore.i18n("off")],
            [1,"1"],
            [2,"2"],
            [3,"3"],
            [4,"4"],
            [5,"5"],
            [10,"10"],
            [15,"15"],
            [30,"30"],
            [45,"45"],
            [60,"60"]
        ]}),valueField:"id",displayField:"text"},
        {xtype:"label",text:Explore.i18n("minutes"),itemId:"lMinutes"}
    ]};
    var h = {xtype:"container",fieldLabel:Explore.i18n("SearchAutoRefreshInterval"),layout:{type:"hbox",align:"middle"},border:false,items:[
        {xtype:"selectboxfield",margins:"0 5 0 0",name:"SearchAutoRefreshInterval",itemId:"SearchAutoRefreshInterval",width:70,mode:"local",store:new Ext.data.ArrayStore({id:0,fields:["id","text"],data:[
            [0,Explore.i18n("off")],
            [5,"5"],
            [10,"10"]
        ]}),valueField:"id",displayField:"text"},
        {xtype:"label",text:Explore.i18n("minutes"),itemId:"lMinutes"}
    ]};
    var d = {xtype:"selectboxfield",name:"ShowSentiment",itemId:"idShowSentiment",fieldLabel:Explore.i18n("ShowSentiment"),width:70,mode:"local",store:new Ext.data.ArrayStore({id:0,fields:["id","text"],data:[
        [true,Explore.i18n("Yes")],
        [false,Explore.i18n("No")]
    ]}),valueField:"id",displayField:"text",listeners:{select:function(v, u, t) {
        if (t === 0) {
            k.getByItemId("idShowVibe").enable()
        }
        if (t === 1) {
            k.getByItemId("idShowVibe").setValue(false);
            k.getByItemId("idShowVibe").disable()
        }
    }}};
    var r = {xtype:"selectboxfield",name:"ShowVibe",itemId:"idShowVibe",fieldLabel:Explore.i18n("ShowVibe"),width:70,mode:"local",store:new Ext.data.ArrayStore({id:0,fields:["id","text"],data:[
        [true,Explore.i18n("Yes")],
        [false,Explore.i18n("No")]
    ]}),valueField:"id",displayField:"text",listeners:{afterrender:function(t) {
        if (Explore.data.PreferenceDataStore.getShowSentimentPreference()) {
            t.enable()
        } else {
            t.disable()
        }
    }}};
    var c = {xtype:"selectboxfield",name:"ShowEmotionMarkers",width:70,mode:"local",store:new Ext.data.ArrayStore({id:0,fields:["id","text"],data:[
        [true,Explore.i18n("Yes")],
        [false,Explore.i18n("No")]
    ]}),valueField:"id",displayField:"text",hidden:(Explore.PlayerUrl == null || Explore.PlayerUrl == "")};
    var g = {xtype:"selectboxfield",name:"RelatedTermsAction",width:200,mode:"local",store:new Ext.data.ArrayStore({id:0,fields:["id","text"],data:[
        ["OR",Explore.i18n("ORWithOriginalQuery")],
        ["AND",Explore.i18n("ANDWithOriginalQuery")],
        ["NEW",Explore.i18n("PerformNewSearch")]
    ]}),valueField:"id",displayField:"text",value:Explore.data.PreferenceDataStore.getRelatedTermsAction()};
    var s = {xtype:"selectboxfield",name:"HighlightingOptions",width:215,mode:"local",store:new Ext.data.ArrayStore({id:0,fields:["id","text"],data:[
        ["HighlightTermsOnly",Explore.i18n("ShowHighlightTermsOnly")],
        ["MatchTermsOnly",Explore.i18n("ShowMatchTermsOnly")],
        ["HilighTermAndMatchTerms",Explore.i18n("ShowHighlightAndMatchTerms")]
    ]}),valueField:"id",displayField:"text",value:Explore.data.PreferenceDataStore.getSelectedHighlightingOption()};
    var q = {name:"DocCountForTerms",width:75};
    var m = {name:"DocCountForRelatedTerms",width:75};
    var n = {xtype:"selectboxfield",name:"DateTimeFormat",fieldLabel:Explore.i18n("DateTimeFormat"),width:230,mode:"local",store:new Ext.data.ArrayStore({id:0,fields:["id","timezone"],data:[
        [0,Explore.i18n(Explore.model.DateFormats.getName(0))],
        [1,Explore.i18n(Explore.model.DateFormats.getName(1))],
        [2,Explore.i18n(Explore.model.DateFormats.getName(2))]
    ]}),valueField:"id",displayField:"timezone",value:Explore.i18n(Explore.model.DateFormats.getName(2))};
    k.formItems = [j,l,b,e,o,a,f,h,d,r,c,g,s,q,m,n];
    Explore.view.PreferencesDialog.superclass.initComponent.apply(this, arguments)
},getTitle:function() {
    return Explore.i18n("Preferences")
},saveAndClose:function() {
    var a = this;
    Explore.data.PreferenceDataStore.save(function(b) {
        if (b.ErrorCode == 0) {
            var c = a.editObject = b.Result;
            a.fireEvent("save", a, c);
            a.bypassDirtyCheck = true;
            a.close();
            Explore.reload()
        } else {
            log.warn("Explore.data.PreferenceDataStore.save had result", b);
            Explore.view.StatusBox.showWarning(Explore.i18n("appTitle"), b.Message)
        }
    })
}});
Ext.ns("Explore.view");
Explore.view.ProjectDefinitionsDialog = Ext.extend(Explore.base.EditorDialog, {itemDescription:Explore.i18n("Project"),EMPTY_ITEM_ID:"-",height:520,width:600,initComponent:function() {
    var t = this;
    var c = ["save"];
    t.addEvents(c);
    var e = this.editObject;
    this.langDataStore = new Ext.data.JsonStore({fields:["id","text"],data:[]});
    function y() {
        return(e.Id <= 0) ? false : true
    }

    function s() {
        return(e.Type < 0) ? true : false
    }

    function q(G) {
        var H = '<div class = "project-description-message">{0} <span>{1}</span> </div>';
        var F = '<img  class="x-toolUR x-toolUR-about" width="16" height="16" style="margin-bottom: 0; margin-left: 5px; margin-top: 5px;  margin-top: 5px; padding: 0;" src="data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==">';
        return String.format(H, F, G)
    }

    var a = {xtype:"textfield",disabled:s(),itemId:"projectname",name:"Name",regex:new RegExp("[^ ]"),fieldLabel:Explore.i18n("ProjectName"),allowBlank:false,width:"95%",value:""};
    var x = {xtype:"textarea",disabled:s(),name:"Description",fieldLabel:Explore.i18n("Description"),width:"95%",height:60,value:""};
    var C = {xtype:"selectboxfield",disabled:s(),name:"DefaultLanguage",width:300,hidden:true,itemId:"lang-field",fieldLabel:Explore.i18n("DefaultLanguage"),padding:"0 0 0 5",store:this.langDataStore,valueField:"id",allowBlank:false,displayField:"text"};
    var j = {xtype:"panel",itemId:"sourceContainer",frame:false,border:false,bodyStyle:"padding:0px 5px 5px 0px",items:{xtype:"checkbox",itemId:"AllSources",checked:false,disabled:s(),boxLabel:Explore.i18n("All Sources"),name:"AllSources",listeners:{check:function(F, G) {
        if (G) {
            t.getByItemId("sourcePicker").checkAll();
            t.getByItemId("sourcePicker").disable()
        } else {
            t.getByItemId("sourcePicker").enable();
            t.getByItemId("sourcePicker").clearAll()
        }
    }}}};
    var D = {itemId:"sourcePicker",hideTools:true,xtype:"explore.view.datasourcepicker",name:"*Sources",border:true,height:175,includeSnapshots:true,checkable:true,listeners:{treeloaded:function(F) {
        if (t.getByItemId("AllSources").checked === true) {
            this.checkAll();
            F.disable()
        } else {
            F.setSelectedDataImports(e.DataImports);
            F.setSelectedSources(e.Sources);
            F.setSelectedSnapshots(e.Snapshots)
        }
    }}};
    var b = {disabled:false,iconCls:"new-icon",itemId:"createTopic",text:Explore.i18n("AddTopic"),hidden:!Explore.Security.isAuthorized("SOURCES_CREATE"),handler:function() {
        var F = t.getByItemId("topicPicker");
        var G = F.getSelectionModel();
        var H = G.getSelectedNode();
        if (H && H.isRoot) {
            H = H.firstChild;
            H.select()
        }
        var I = parseInt(H.attributes.tag.id, 10);
        log.info("AdministrationTopicsPanel - Add Topic parentTopicSectionId=", I);
        F.createTopicInSection({}, H)
    }};
    var l = {disabled:false,iconCls:"new-icon",itemId:"createTopicSection",text:Explore.i18n("AddSection"),hidden:!Explore.Security.isAuthorized("SOURCES_CREATE"),handler:function() {
        var F = t.getByItemId("topicPicker");
        var G = F.getSelectionModel();
        var H = G.getSelectedNode();
        if (H && H.isRoot) {
            H = H.firstChild;
            H.select()
        }
        F.createTopicSection({}, H)
    }};
    var k = {layout:"anchor",border:false,itemId:"topicForm",height:240,tbar:new Ext.Toolbar({height:28,disabled:s(),hidden:!(Explore.Security.isAuthorized("SOURCES_CREATE") || Explore.Security.isAuthorized("SNAPSHOTS_CREATE") || Explore.Security.isAuthorized("DATA_IMPORTS_CREATE")),items:[
        {xtype:"button",iconCls:"new-icon",text:Explore.i18n("New Topic/ Topic Section"),tooltip:String.format(Explore.i18n("CreateANew_"), Explore.i18n("Topic")),handler:function(F) {
        },menu:new Ext.menu.Menu({items:[b,l]})}
    ]}),items:[
        {xtype:"panel",frame:false,border:false,bodyStyle:"padding:0px 5px 5px 0px",items:[
            {xtype:"checkbox",itemId:"AllTopics",checked:false,disabled:s(),boxLabel:Explore.i18n("All Topics"),name:"AllTopics",listeners:{check:function(F, G) {
                if (G) {
                    t.getByItemId("topicPicker").checkAll();
                    t.getByItemId("topicPicker").disable()
                } else {
                    t.getByItemId("topicPicker").enable();
                    t.getByItemId("topicPicker").clearAll()
                }
            }}}
        ]},
        {itemId:"topicPicker",xtype:"explore.view.topicpicker",name:"Topics",border:true,height:175,checkable:true,includeMyTopics:false,includeAllProjects:true,listeners:{loaded:function(F) {
            if (t.getByItemId("AllTopics").checked === true || e.defaultSettings === true) {
                t.getByItemId("topicPicker").disable();
                this.checkAll()
            } else {
                F.checkNodesByIds(e.Topics)
            }
        },treeloaded:function() {
            if (t.getByItemId("AllTopics").checked === true || e.defaultSettings === true) {
                t.getByItemId("topicPicker").disable();
                this.checkAll()
            } else {
                t.getByItemId("topicPicker").checkNodesByIds(e.Topics)
            }
        },checkAllTopics:function(F) {
            if (t.getByItemId("AllTopics").checked === true || e.defaultSettings === true) {
                t.getByItemId("topicPicker").disable();
                this.checkAll()
            } else {
                t.getByItemId("topicPicker").checkNodesByIds(e.Topics)
            }
        }}},
        {border:false,frame:false,autoEl:{html:q(Explore.i18n("AddTopicMessage"))}}
    ]};
    var B = {disabled:!s,iconCls:"new-icon",itemId:"addUserBtn",text:String.format(Explore.i18n("New_"), Explore.i18n("User")),hidden:!Explore.Security.isAuthorized("USERS_CREATE"),handler:function() {
        var F = {LoginType:Explore.model.LoginType.Explore,RoleId:1,GroupId:1};
        var G = new Explore.view.UserDialog({editObject:F,readOnly:false});
        G.on("save", function() {
            Explore.data.UserDataStore.saveUser(F, function() {
                t.displayUsers(t.editObject)
            })
        });
        G.show(t)
    }};
    var r = {layout:"anchor",border:false,height:200,margins:"10 15 0 0",tbar:new Ext.Toolbar({height:28,disabled:s(),hidden:!(Explore.Security.isAuthorized("SOURCES_CREATE") || Explore.Security.isAuthorized("SNAPSHOTS_CREATE") || Explore.Security.isAuthorized("DATA_IMPORTS_CREATE")),items:[B]}),items:[
        {xtype:"panel",frame:false,border:false,bodyStyle:"padding:0px 5px 5px 0px",itemId:"container",items:{xtype:"checkbox",itemId:"AllUsers",boxLabel:Explore.i18n("All Users"),checked:false,disabled:s(),name:"AllUsers",listeners:{check:function(F, G) {
            if (t.getByItemId("usersCheckGroup")) {
                if (G) {
                    Ext.each(t.getByItemId("usersCheckGroup").items.items, function(I, H) {
                        t.getByItemId("usersCheckGroup").setValue(I.id, true)
                    });
                    t.getByItemId("usersPanel").disable()
                } else {
                    Ext.each(t.getByItemId("usersCheckGroup").getValue(), function(I, H) {
                        t.getByItemId("usersCheckGroup").setValue(I.id, false)
                    });
                    t.getByItemId("usersPanel").enable()
                }
            } else {
                if (G) {
                    t.getByItemId("usersPanel").disable()
                }
            }
        }}}},
        {xtype:"panel",padding:"0 0 0 5",height:175,layout:"fit",name:"Users",itemId:"usersPanel"},
        {border:false,frame:false,autoEl:{html:q(Explore.i18n("AddUserMessage"))}}
    ]};
    var o = {disabled:false,iconCls:"new-icon",itemId:"miNewMediaAggregationService",text:Explore.i18n("MediaAggregationService"),hidden:!Explore.Security.isAuthorized("SOURCES_CREATE"),handler:function() {
        var F = t.getByItemId("sourcePicker");
        var G = F.getSelectionModel();
        var H = F.getTreeNodeById("GROUP:1");
        G.select(H);
        F.newCommand()
    }};
    var p = {disabled:false,iconCls:"new-icon",itemId:"miNewSnapshot",text:Explore.i18n("Snapshot"),hidden:!Explore.Security.isAuthorized("SNAPSHOTS_CREATE"),handler:function() {
        var F = t.getByItemId("sourcePicker");
        var G = F.getSelectionModel();
        var H = F.getTreeNodeById("ALL-SNAPSHOTS");
        G.select(H);
        F.newCommand()
    }};
    var u = {disabled:false,iconCls:"new-icon",itemId:"miNewDataImport",text:Explore.i18n("DataImport"),hidden:!Explore.Security.isAuthorized("DATA_IMPORTS_CREATE"),handler:function() {
        var F = t.getByItemId("sourcePicker");
        if (F) {
            F.newDataImport()
        }
    }};
    var h = {layout:"anchor",name:"sourceForm",itemId:"sourceForm",border:false,autoScroll:false,tbar:new Ext.Toolbar({height:28,disabled:s(),hidden:!(Explore.Security.isAuthorized("SOURCES_CREATE") || Explore.Security.isAuthorized("SNAPSHOTS_CREATE") || Explore.Security.isAuthorized("DATA_IMPORTS_CREATE")),items:[
        {xtype:"button",iconCls:"new-icon",text:Explore.i18n("New Sources"),tooltip:String.format(Explore.i18n("CreateANew_"), Explore.i18n("Source")),handler:function(F) {
        },menu:new Ext.menu.Menu({items:[u,o,p]})}
    ]}),items:[j,D,{border:false,frame:false,autoEl:{html:q(Explore.i18n("AddSourceMessage"))}}]};
    var g = {layout:"anchor",border:false,margins:"10 15 0 0",items:[
        {xtype:"checkbox",itemId:"AllFilters",boxLabel:Explore.i18n("AllFilters"),checked:false,disabled:s(),name:"AllFilters",listeners:{check:function(F, G) {
            if (t.getByItemId("filtersCheckGroup")) {
                if (G) {
                    Ext.each(t.getByItemId("filtersCheckGroup").items.items, function(I, H) {
                        t.getByItemId("filtersCheckGroup").setValue(I.id, true)
                    });
                    t.getByItemId("filtersPanel").disable()
                } else {
                    Ext.each(t.getByItemId("filtersCheckGroup").getValue(), function(I, H) {
                        t.getByItemId("filtersCheckGroup").setValue(I.id, false)
                    });
                    t.getByItemId("filtersPanel").enable()
                }
            } else {
                if (G) {
                    t.getByItemId("filtersPanel").disable()
                }
            }
        }}},
        {xtype:"panel",padding:"0 0 0 5",height:220,layout:"fit",name:"Filters",itemId:"filtersPanel"}
    ]};
    var E = {xtype:"checkbox",itemId:"AllDocumentTypes",boxLabel:Explore.i18n("AllFileTypes") + ":",checked:false,disabled:s(),name:"AllDocumentTypes",listeners:{check:function(F, G) {
        if (t.getByItemId("docTypeCheckGroup")) {
            if (G) {
                Ext.each(t.getByItemId("docTypeCheckGroup").items.items, function(I, H) {
                    t.getByItemId("docTypeCheckGroup").setValue(I.id, true)
                });
                t.getByItemId("docTypePanel").disable()
            } else {
                Ext.each(t.getByItemId("docTypeCheckGroup").getValue(), function(I, H) {
                    t.getByItemId("docTypeCheckGroup").setValue(I.id, false)
                });
                t.getByItemId("docTypePanel").enable()
            }
        } else {
            if (G) {
                t.getByItemId("docTypePanel").disable()
            }
        }
    }}};
    var d = {xtype:"panel",padding:"0 0 0 5",height:220,layout:"fit",name:"DocTypes",itemId:"docTypePanel"};
    var A = {layout:"anchor",border:false,margins:"10 15 0 0",items:[E,d]};
    var f = {xtype:"container",itemId:"docTypeTab",title:Explore.i18n("DocType"),autoScroll:true,layout:"fit",defaults:{padding:"5",flex:1,margins:"10 15 0 0"},items:[A]};
    var v = {xtype:"container",itemId:"sourceTab",title:Explore.i18n("Sources"),autoScroll:true,layout:"fit",defaults:{padding:"5",flex:1,margins:"10 15 0 0"},items:[h]};
    var n = {xtype:"container",itemId:"topicsTab",title:Explore.i18n("Topics"),layout:"fit",defaults:{padding:"5",flex:1,margins:"10 15 0 0"},items:[k]};
    var w = {xtype:"container",itemId:"usersTab",title:Explore.i18n("Users"),layout:"fit",defaults:{padding:"5",flex:1,margins:"10 15 0 0"},items:[r]};
    var m = {xtype:"container",itemId:"filtersTab",title:Explore.i18n("Filters"),layout:"fit",defaults:{padding:"5",flex:1,margins:"10 15 0 0"},items:[g]};
    var z = {xtype:"tabpanel",anchor:"form",itemId:"tabContainer",border:false,tabWidth:180,width:"100%",height:280,activeItem:0,listeners:{tabchange:function(G, F) {
        if (F.title === "Topics") {
            var H = F.getByItemId("topicPicker");
            H.fireEvent("loaded", H)
        }
        F.show();
        F.doLayout();
        G.doLayout()
    }},items:[v,n,w]};
    t.formItems = [a,x,C,z];
    Explore.view.ProjectDefinitionsDialog.superclass.initComponent.apply(this, arguments);
    t.on("afterrender", function() {
        t.forceLayoutOnTabs(t)
    }, t, {single:true});
    t.addTreeListeners()
},addTreeListeners:function() {
    var b = this;
    var d = b.getByItemId("sourcePicker");
    var c = b.getByItemId("topicPicker");
    Explore.data.DataImportStore.on("dataimportsaved", function(e) {
        if (d && d.getLoader()) {
            d.getLoader().on("load", function() {
                d.checkNodeById("DATAIMPORT:" + e)
            }, d, {single:true})
        }
    });
    var a = "GROUP:1";
    Explore.data.SourceDataStore.on("sourceModified", function(e) {
        if (d && d.getLoader()) {
            d.getLoader().on("load", function() {
                d.checkNodeById("SOURCE:" + e)
            }, d, {single:true})
        }
    });
    Explore.data.SnapshotDataStore.on("snapshotAdded", function(e) {
        if (d && d.getLoader()) {
            d.getLoader().on("load", function() {
                d.expand(true);
                d.checkNodeById("SNAPSHOT:" + e)
            }, d, {single:true})
        }
    });
    Explore.data.SnapshotDataStore.on("snapshotModified", function(e) {
        if (d && d.getLoader()) {
            d.getLoader().on("load", function() {
                d.checkNodeById("SNAPSHOT:" + e)
            }, d, {single:true})
        }
    })
},getDocumentTypeOptions:function(a) {
    var g = this;
    var j = [];
    var c = a.DocumentTypes;

    function f(l) {
        var m = false;
        if (a.AllDocumentTypes == true) {
            return true
        } else {
            if (c && c.length > 0) {
                for (var k = 0; k < c.length; k++) {
                    if (c[k] === l) {
                        return true
                    }
                }
            }
        }
        return m
    }

    var h = Explore.data.IDOLDataStore.getSupportedDocTypes();
    if (h) {
        for (var b = 0; b < h.length; b++) {
            var d = h[b];
            var e = {itemId:d.toLowerCase(),boxLabel:Explore.i18n(d),checked:f(d.toLowerCase())};
            j.push(e)
        }
    }
    return j
},displayUsers:function(e) {
    var b = this;
    var g = this.editObject;

    function d(m, l, h, k, j) {
        if (b.getByItemId("AllUsers").getValue()) {
            return true
        }
        if (j == 1) {
            return(h == 1) ? true : false
        } else {
            return((m != null && m.indexOf(l) >= 0) || ((h === 1) && (k < 0)))
        }
    }

    var f = b.getByItemId("usersPanel");
    var c = false;
    var a = null;
    f.on("afterrender", function() {
        a = new Ext.LoadMask(f.getEl(), Explore.i18n("Loading..."));
        if (!c) {
            a.show()
        } else {
            a.hide()
        }
        f.doLayout()
    });
    Explore.data.UserDataStore.getUsers(function(m) {
        if (m) {
            if (m.length > 0) {
                var n = {itemId:"usersCheckGroup",xtype:"checkboxgroup",allowBlank:false,autoScroll:true,columns:1,items:[]};
                for (var l = 0; l < m.length; l++) {
                    var k = m[l].FullNameLFM;
                    var h = m[l].Id;
                    var j = m[l].RoleId;
                    if (g.defaultSettings === true) {
                        n.items.push({boxLabel:k,tag:{userId:h,userName:k},checked:(h === currentUser.Id || h === 1) ? true : false})
                    } else {
                        n.items.push({boxLabel:k,tag:{userId:h,userName:k},checked:d(g.Users, h, j, g.Type, g.Id)})
                    }
                }
                f.add(n);
                f.setDisabled((g.Id == 1));
                b.forceLayoutOnTabs(b)
            } else {
                Ext.MessageBox.show({title:Explore.i18n("appTitle"),msg:Explore.i18n("NoUsersDefinedInTheSystem"),buttons:Ext.MessageBox.OK,icon:Ext.MessageBox.WARNING})
            }
        }
        c = true;
        if (a) {
            a.hide();
            f.setDisabled(f.disabled)
        }
    })
},forceLayoutOnTabs:function(c) {
    var b = c || this;
    var a = b.getByItemId("tabContainer");
    var d = a.getLayout();
    d.setActiveItem("topicsTab");
    d.setActiveItem("usersTab");
    d.setActiveItem("sourceTab")
},getAllDocTypes:function(c) {
    var a = this;
    var d = {itemId:"docTypeCheckGroup",xtype:"checkboxgroup",autoScroll:true,allowBlank:false,columns:1,items:a.getDocumentTypeOptions(c)};
    var b = a.getByItemId("docTypePanel");
    if (b) {
        b.add(d)
    }
},displayFilters:function(c) {
    var a = this;
    var d = this.editObject;

    function b(f, e) {
        return(f != null && f.indexOf(e) >= 0)
    }

    Explore.data.ProjectDataStore.getUserDefinedFilters(function(j) {
        if (j) {
            if (j.length > 0) {
                var k = {itemId:"filtersCheckGroup",xtype:"checkboxgroup",autoScroll:true,columns:1,items:[]};
                for (var h = 0; h < j.length; h++) {
                    var g = j[h].Name;
                    var f = j[h].FilterTag;
                    if (d.defaultSettings === true) {
                        k.items.push({boxLabel:g,tag:{filterTag:f,name:g},checked:true})
                    } else {
                        k.items.push({boxLabel:g,tag:{filterTag:f,name:g},checked:b(d.FilterTags, f)})
                    }
                }
                var e = a.getByItemId("filtersPanel");
                if (e) {
                    e.add(k);
                    a.forceLayoutOnTabs(a)
                }
            } else {
                Ext.MessageBox.show({title:Explore.i18n("appTitle"),msg:Explore.i18n("NoFiltersDefinedInTheSystem"),buttons:Ext.MessageBox.OK,icon:Ext.MessageBox.WARNING})
            }
        }
    })
},displayLanguage:function() {
    var b = this;
    var f = this.editObject;
    var a = Explore.data.IDOLDataStore.getAllLanguages();
    if (a != null) {
        var e = [
            {id:b.EMPTY_ITEM_ID,text:"(" + Explore.i18n("AnyLanguage") + ")"}
        ];
        for (var d = 0; d < a.length; d++) {
            e.push({id:a[d].Key,text:a[d].Value})
        }
        this.langDataStore.loadData(e);
        var c = b.getByItemId("lang-field");
        if (f.DefaultLanguage !== null && f.DefaultLanguage !== undefined && f.DefaultLanguage !== "") {
            c.setValue(f.DefaultLanguage)
        } else {
            c.setValue(b.EMPTY_ITEM_ID)
        }
        c.setVisible(false)
    }
},setAllSources:function(a) {
    if (a) {
        if (a.AllSources === true) {
            this.getByItemId("AllSources").setValue(true)
        } else {
            this.getByItemId("AllSources").setValue(false)
        }
    }
},setAllTopics:function(a) {
    if (a) {
        if (a.AllTopics === true) {
            this.getByItemId("AllTopics").setValue(true)
        } else {
            this.getByItemId("AllTopics").setValue(false)
        }
    }
},setAllUsers:function(a) {
    if (a) {
        if (a.AllUsers === true) {
            this.getByItemId("AllUsers").setValue(true)
        } else {
            this.getByItemId("AllUsers").setValue(false)
        }
    }
},setAllDocumentTypes:function(a) {
    if (a) {
        var b = this.getByItemId("AllDocumentTypes");
        if (b) {
            if (a.AllDocumentTypes !== false) {
                b.setValue(true)
            } else {
                b.setValue(false)
            }
        }
    }
},displayObject:function() {
    var a = this;
    a.displayUsers(a.editObject);
    a.displayLanguage();
    a.setAllSources(a.editObject);
    a.setAllTopics(a.editObject);
    Explore.view.ProjectDefinitionsDialog.superclass.displayObject.call(this)
},onSaveClick:function() {
    var b = this;
    if (!b.readOnly) {
        if (b.isValid(false)) {
            var a = function() {
                b.populateObject();
                b.saveAndClose()
            };
            if (Explore.presenter.ProjectsPresenter.getCurrentProjectId() === b.editObject.Id) {
                var d = Explore.i18n("Edit Current Project");
                var c = Explore.i18n("Editing the currently loaded project will refresh the application. Would you like to continue?");
                Explore.view.StatusBox.confirm(d, c, a)
            } else {
                a()
            }
        }
    }
},populateObject:function() {
    var j = this;
    var c = new Ext.LoadMask(j.body, {msg:"Loading Project..."});
    c.show();
    Explore.view.ProjectDefinitionsDialog.superclass.populateObject.call(this);
    var g = j.editObject;
    if (g.AllDocumentTypes !== true && g.AllDocumentTypes !== false) {
        g.AllDocumentTypes = true
    }
    var f = [];
    var b = j.getByItemId("usersCheckGroup").getValue();
    for (var e = 0; e < b.length; e++) {
        f.push(b[e].tag.userId)
    }
    g.Users = f;
    var h = j.getByItemId("sourcePicker");
    g.DataImports = h.getSelectedDataImports();
    g.Sources = h.getSelectedSources();
    g.Snapshots = h.getSelectedSnapshots();
    g.Topics = j.getByItemId("topicPicker").getSelectedTopicIds();
    var a = j.getByItemId("lang-field");
    var d = a.getValue();
    g.DefaultLanguage = (d !== j.EMPTY_ITEM_ID) ? d : null;
    c.hide()
},isDirty:function() {
    var m = this;
    var h = m.editObject;
    var n = Explore.view.ProjectDefinitionsDialog.superclass.isDirty.call(this);
    var c = m.getByItemId("sourcePicker").getSelectedDataImports();
    var a = m.getByItemId("sourcePicker").getSelectedSnapshots();
    var k = m.getByItemId("sourcePicker").getSelectedSources();
    var b = c.length + a.length + k.length;
    var d = m.getByItemId("AllSources").getValue();
    n |= !(Explore.areArraysSame(c, h.DataImports));
    n |= !(Explore.areArraysSame(k, h.Sources));
    n |= !(Explore.areArraysSame(a, h.Snapshots));
    n |= !(Explore.areArraysSame(m.getByItemId("topicPicker").getSelectedTopicIds(), h.Topics));
    n &= !(m.getByItemId("usersCheckGroup") == null || m.getByItemId("usersCheckGroup").getValue().length == 0);
    n &= !((m.getByItemId("sourcePicker") == null || b == 0) && !d);
    n &= (m.getByItemId("projectname").isValid() && m.getByItemId("projectname").getValue() !== "");
    var f = function(o) {
        try {
            if (Ext.isIE) {
                o.tabEl.childNodes[1].childNodes[0].firstChild.firstChild.className = ("x-tab-strip-text project")
            } else {
                if (Ext.isSafari) {
                    o.tabEl.childNodes[1].childNodes[0].firstChild.firstChild.className = ("x-tab-strip-text project")
                } else {
                    o.tabEl.getElementsByClassName("x-tab-strip-text")[0].classList.add("project")
                }
            }
        } catch(p) {
            log.error("ProjectDefinitionDialog.isDirty() - addColorToTab", p)
        }
    };
    var j = function(o) {
        try {
            if (Ext.isIE) {
                o.tabEl.childNodes[1].childNodes[0].firstChild.firstChild.className = ("x-tab-strip-text")
            } else {
                if (Ext.isSafari) {
                    o.tabEl.childNodes[1].childNodes[0].firstChild.firstChild.className = ("x-tab-strip-text")
                } else {
                    o.tabEl.getElementsByClassName("x-tab-strip-text")[0].classList.remove("project")
                }
            }
        } catch(p) {
            log.error("ProjectDefinitionDialog.isDirty() - removeColorFromTab", p)
        }
    };
    var g = m.getByItemId("sourceTab");
    var l = m.getByItemId("topicsTab");
    var e = m.getByItemId("usersTab");
    j(g);
    j(l);
    j(e);
    if ((b == 0)) {
        f(g)
    }
    if (m.getByItemId("usersCheckGroup") == null || m.getByItemId("usersCheckGroup").getValue().length == 0) {
        f(e)
    }
    return n
}});
Ext.reg("explore.view.projectdefinitiondialog", Explore.view.ProjectDefinitionsDialog);
Ext.ns("Explore.view");
Explore.view.ProjectSelectDialog = Ext.extend(Ext.Window, {prefs:null,store:null,initComponent:function() {
    var c = this;
    this.prefs = Explore.data.PreferenceDataStore.getPreferences();
    this.store = new Ext.data.JsonStore({fields:["Id","Name","Documents","Status",{name:"UserCount",convert:function(d, g) {
        var f,e = g;
        if (e.AllUsers) {
            f = Explore.formatNumber(c.totalUsers)
        } else {
            f = Explore.formatNumber(e.Users.length)
        }
        return f
    }},{name:"SourceCount",convert:function(d, g) {
        var f,e = g;
        if (e.AllSources) {
            f = Explore.formatNumber(c.totalSources)
        } else {
            f = Explore.formatNumber(e.Sources.length + e.Snapshots.length + e.DataImports.length)
        }
        return f
    }}]});
    var b = new Explore.view.DocCountColumn({header:Explore.i18n("Documents"),id:"Documents",dataIndex:"Documents"});
    var a = {title:Explore.i18n("SelectProject"),width:500,height:400,modal:true,layout:"fit",cls:"white-bg-dialog",padding:15,closable:!(this.prefs.SelectedProjectId === 0),keys:[
        {key:"r",fn:function() {
            c._refreshProjects()
        }},
        {key:Ext.EventObject.ESC,fn:function() {
            log.info("ProjectSelectDialog.Cancel");
            if (c.prefs.SelectedProjectId !== 0) {
                c.close()
            }
        }},
        {key:Ext.EventObject.ENTER,fn:function() {
            if (c.prefs.SelectedProjectId !== 0) {
                var d = c.fbar.getByItemId("Select");
                d.handler()
            }
        }},
        {key:Ext.EventObject.DELETE,fn:function() {
            var e = c.getByItemId("grid");
            var g = e.getSelectionModel();
            var d = g.getSelected();
            var f = d.json;
            if (((d.json).Type === -1)) {
                return
            }
            c._deleteAction(f)
        }}
    ],closeAction:"destroy",items:{xtype:"container",layout:{type:"vbox",align:"stretch"},items:[
        {xtype:"checkbox",itemId:"alwaysShowDialog",boxLabel:Explore.i18n("AlwaysShowThisWindowAfterLogin"),checked:!this.prefs.HideProjectSelectDialogAtLogin,height:25,listeners:{scope:this,check:function(d, e) {
            c.prefs.HideProjectSelectDialogAtLogin = !e;
            Explore.data.PreferenceDataStore.setHideProjectSelectDialogAtLogin(!e);
            Explore.data.PreferenceDataStore.save()
        }}},
        {xtype:"explore.view.common.gridselector",itemId:"grid",flex:1,border:true,store:this.store,autoExpandColumn:"Name",plugins:[b],columns:[
            {width:35,id:"Selected",sortable:false,renderer:{fn:c._selectedColRenderer,scope:this}},
            {header:Explore.i18n("ProjectName"),width:200,sortable:true,id:"Name",dataIndex:"Name"},
            {header:Explore.i18n("Users"),width:80,id:"Users",sortable:false,dataIndex:"UserCount"},
            {header:Explore.i18n("Sources"),width:80,id:"Sources",sortable:false,dataIndex:"SourceCount"},
            b,
            {header:Explore.i18n("Status"),width:80,sortable:true,id:"Status",hidden:true,dataIndex:"Status",renderer:c._statusColRenderer}
        ],menuItems:[
            {text:Explore.i18n("EditProject"),itemId:"editProject",iconCls:"edit-icon",hidden:!Explore.Security.isAuthorized("PROJECTS_UPDATE"),handler:this.editProject,scope:this},
            {text:Explore.i18n("DeleteProject"),itemId:"deleteProject",iconCls:"delete-icon",hidden:!Explore.Security.isAuthorized("PROJECTS_DELETE"),handler:this.deleteProject,scope:this}
        ],listeners:{beforeShowContextMenu:this.beforeShowContextMenu,scope:this,rowclick:this.gridRowClick}}
    ]},buttonAlign:"left",fbar:[
        {text:Explore.i18n("textCancel"),disabled:this.prefs.SelectedProjectId === 0,handler:function() {
            log.info("ProjectSelectDialog.Cancel");
            c.close()
        }},
        "->",
        {text:Explore.i18n("CreateProject"),hidden:!Explore.Security.isAuthorized("PROJECTS_CREATE"),handler:this.createProject,scope:this},
        {text:Explore.i18n("Select"),itemId:"Select",disabled:this.prefs.SelectedProjectId === 0,handler:function() {
            log.info("ProjectSelectDialog.Select");
            var d = c.getByItemId("grid");
            var g = d.getSelectionModel();
            var f = g.getSelected();
            if (f) {
                var e = f.json;
                c.fireEvent("openProject", e);
                c.hide()
            } else {
                Ext.MessageBox.show({title:Explore.i18n("appTitle"),msg:Explore.i18n("PleaseSelectAProjectToOpen"),buttons:Ext.MessageBox.OK,icon:Ext.MessageBox.WARNING})
            }
        }}
    ]};
    Ext.apply(this, a);
    Explore.view.ProjectSelectDialog.superclass.initComponent.apply(this, arguments);
    this.mon(Explore.data.ProjectDataStore, "projectModified", function(d) {
        c._refreshProjects()
    });
    this.mon(Explore.data.ProjectDataStore, "projectDeleted", function() {
        c._refreshProjects()
    });
    c.on("afterrender", function() {
        c._refreshProjects()
    })
},_selectedColRenderer:function(k, c, d, h, b, j) {
    var f = d.json.Id;
    var a = this.prefs.SelectedProjectId;
    var g = "";
    if (f === a) {
        var e = Explore.i18n("Selected");
        g = '<img src="../resources/images/icons/selected.png" alt="' + e + '" />'
    }
    return g
},_statusColRenderer:function(a, b, e, f, c, d) {
    return a === Explore.model.Status.Active ? Explore.i18n("Active") : Explore.i18n("Inactive")
},_deleteAction:function(c) {
    var a = this;
    if (c && c.Id && c.Name) {
        if (c.Id != a.prefs.SelectedProjectId) {
            var b = String.format(Explore.i18n("AreYouSureYouWantToDeleteTheProject_"), c.Name)
        } else {
            var b = String.format(Explore.i18n("AreYouSureYouWantToDeleteTheProject_"), c.Name) + Explore.i18n("RefreshApplication")
        }
        Explore.view.StatusBox.confirm(Explore.i18n("appTitle"), b, function() {
            a.showLoadMask(Explore.i18n("Deleting Project"));
            Explore.data.ProjectDataStore.deleteProject(c.Id, function(d) {
                if (c.Id != a.prefs.SelectedProjectId) {
                    a._refreshProjects();
                    a.hideLoadMask()
                } else {
                    a.hideLoadMask();
                    Explore.reload()
                }
            })
        })
    }
},_refreshProjects:function() {
    var b = this;
    if (!b.getByItemId("grid")) {
        return
    }
    var a = new Ext.LoadMask(b.getByItemId("grid").body, {msg:Explore.i18n("Loading...")});
    a.show();
    b.totalUsers = 0;
    b.totalSources = 0;
    Explore.data.ProjectDataStore.getUserSourceCounts(function(c) {
        if (c) {
            b.totalUsers = c.TotalUsers;
            b.totalSources = c.TotalSources
        }
    });
    Explore.data.ProjectDataStore.listMyProjects(function(c) {
        a.hide();
        if (c) {
            var e = b.getByItemId("grid");
            if (b.store && e) {
                var g = e.getSelectionModel();
                b.store.loadData(c);
                for (var d = 0; d < c.length; d++) {
                    var f = c[d];
                    if (f.Id === b.prefs.SelectedProjectId) {
                        g.selectRow(d)
                    }
                }
            }
        }
    })
},createProject:function() {
    log.info("ProjectSelectDialog.CreateProject");
    var b = new Explore.data.model.Project();
    var a = new Explore.view.ProjectDefinitionsDialog({editObject:b,readOnly:false,listeners:{save:function() {
        Explore.data.ProjectDataStore.save(b, function() {
        })
    }}});
    a.show()
},editProject:function(c) {
    log.info("ProjectSelectDialog Edit Project");
    var b = this;
    b.showLoadMask(Explore.i18n("Loading Project"));
    var a = c.parentMenu.contextRecord;
    Explore.data.ProjectDataStore.getProject(a.json.Id, function(e) {
        b.hideLoadMask();
        var d = new Explore.view.ProjectDefinitionsDialog({editObject:e,readOnly:false,listeners:{save:function() {
            Explore.data.ProjectDataStore.save(e, function() {
            })
        }}});
        d.show()
    })
},deleteProject:function(c) {
    log.info("ProjectSelectDialog Delete Project");
    var b = this;
    var a = c.parentMenu.contextRecord;
    var d = a.json;
    b._deleteAction(d)
},showLoadMask:function(a) {
    if (!this.loadMask) {
        this.loadMask = new Ext.LoadMask(this.body, {msg:a})
    }
    this.loadMask.show()
},hideLoadMask:function() {
    this.loadMask.hide()
},beforeShowContextMenu:function(c, b) {
    if (!Explore.Security.isAuthorized("ADMINISTER_APP")) {
        b.showMenu = false;
        return
    }
    var e = (b.record.json.Type === -1);
    var d = b.menu;
    var a = d.getByItemId("editProject");
    a.setText(e ? Explore.i18n("View Project") : Explore.i18n("EditProject"));
    a = d.getByItemId("deleteProject");
    a.setDisabled(e)
},gridRowClick:function(a, c, b) {
    this.getByItemId("Select").setDisabled(false)
}});
Ext.reg("explore.view.projectselectdialog", Explore.view.ProjectSelectDialog);
Ext.ns("Explore.view");
Explore.view.ProjectsToolbar = Ext.extend(Ext.Toolbar, {projects:null,getPrefs:function() {
    return Explore.data.PreferenceDataStore.getPreferences()
},initComponent:function() {
    var a = this;
    var b = {cls:"projectsToolbar",border:false,items:[
        {itemId:"allButton",text:Explore.i18n("Project"),handler:function() {
            a._showProjectModal()
        }}
    ]};
    this.on("afterrender", function() {
        this.refreshProjects();
        if ((!Explore.PreviouslyLoggedIn && this.getPrefs().HideProjectSelectDialogAtLogin === false) || (this.getPrefs().SelectedProjectId === 0)) {
            this._showProjectModal()
        }
    });
    Explore.data.ProjectDataStore.on("projectModified", function(c) {
        a.refreshProjects()
    });
    Explore.data.ProjectDataStore.on("projectDeleted", function() {
        a.refreshProjects()
    });
    Ext.apply(this, b);
    Explore.view.ProjectsToolbar.superclass.initComponent.apply(this, arguments)
},_setTitle:function(d) {
    var b = this.getByItemId("allButton");
    b.setText(Explore.i18n("Project") + " - " + d);
    if (Ext.isSafari || Ext.isChrome || Ext.isIE7) {
        var a = Ext.util.TextMetrics.createInstance(b.getEl());
        var c = a.getWidth(d) + 53;
        c += (Ext.isIE7) ? 5 : 0;
        this.setWidth(c)
    }
},_showProjectModal:function() {
    var a = this;
    var b = new Explore.view.ProjectSelectDialog({listeners:{scope:this,openProject:function(c) {
        a._setTitle(c.Name);
        if (this.getPrefs().SelectedProjectId !== c.Id) {
            this.getPrefs().SelectedProjectId = c.Id;
            Explore.addHash("ProjectId", c.Id);
            Explore.abortAllAjax();
            var d = new Ext.LoadMask(Ext.getBody(), {msg:Explore.i18n("ReloadingForProject") + ": " + c.Name});
            d.show();
            Explore.data.PreferenceDataStore.save(function(e) {
                Explore.reload()
            })
        }
    }}});
    b.show()
},refreshProjects:function() {
    var b = false;
    var a = this;
    Explore.data.ProjectDataStore.listMyProjects(function(c) {
        if (c != null) {
            projects = c;
            for (var d = 0; d < projects.length; d++) {
                var e = projects[d];
                if (e.Id === a.getPrefs().SelectedProjectId) {
                    a._setTitle(e.Name)
                }
            }
            a.doLayout()
        }
    })
}});
Ext.reg("explore.view.projectstoolbar", Explore.view.ProjectsToolbar);
Explore.view.ProjectsTree = Ext.extend(Explore.base.AdministrationTreePanel, {rootVisible:true,checkable:false,initComponent:function() {
    var b = this;
    b.loadFn = Explore.data.ProjectDataStore.getProject;
    b.saveFn = Explore.data.ProjectDataStore.save;
    b.deleteFn = Explore.data.ProjectDataStore.deleteProject;
    b.editDialogFn = Explore.view.ProjectDefinitionsDialog;
    b.viewDialogFn = Explore.view.ProjectDefinitionsDialog;
    b.docCountsFn = Explore.data.ProjectDataStore.getDocCountsByProjects;
    var e = ["editProject"];
    b.addEvents();
    b.enableBubble(e);
    new Ext.tree.TreeSorter(b, {folderSort:true,dir:"asc",property:"tag",sortType:function(f) {
        return parseInt(f.id, 10)
    }});
    var d = this.checkable ? false : undefined;
    var a = new Ext.tree.TreeNode({text:Explore.i18n("All Projects"),id:0,singleClickExpand:true,uiProvider:Ext.tree.TriStateNodeUI,checked:d,expanded:true,tag:{type:-1,id:0,isCustom:false}});
    var c = {itemDescription:Explore.i18n("Project"),loader:new Ext.tree.TreeLoader({preloadChildren:true,clearOnLoad:true,directFn:ProjectService.GetProjectNodes,baseAttrs:{uiProvider:Ext.tree.TriStateNodeUI,checked:d,singleClickExpand:true,expanded:this.checkable}}),root:a,listeners:{AfterContextMenuShow:function(g, f) {
        if (f.attributes.tag.id != 0) {
            g.getComponent("DeleteProject").show();
            g.getComponent("EditProject").show();
            if (f.attributes.tag.type < 0) {
                g.getComponent("DeleteProject").disable();
                g.getComponent("EditProject").setVisible(false);
                g.getComponent("EditProject").disable(true);
                g.getComponent("ViewProject").setVisible(true)
            } else {
                if (Explore.Security.isAuthorized("PROJECTS_DELETE")) {
                    g.getComponent("DeleteProject").enable()
                } else {
                    g.getComponent("DeleteProject").disable()
                }
                g.getComponent("ViewProject").setVisible(false);
                g.getComponent("EditProject").setVisible(true);
                if (Explore.Security.isAuthorized("PROJECTS_UPDATE")) {
                    g.getComponent("EditProject").enable()
                } else {
                    g.getComponent("EditProject").disable()
                }
            }
            if (Explore.Security.isAuthorized("PROJECTS_CREATE")) {
                g.getComponent("NewProject").enable()
            } else {
                g.getComponent("NewProject").disable()
            }
        } else {
            g.getComponent("DeleteProject").disable();
            g.getComponent("EditProject").disable()
        }
        g.doLayout()
    }}};
    Ext.apply(this, Ext.apply(this.initialConfig, c));
    Explore.view.ProjectsTree.superclass.initComponent.apply(this, arguments);
    Explore.data.ProjectDataStore.on("projectModified", function(f) {
        b.refreshAndSelectNode(null, f)
    });
    Explore.data.ProjectDataStore.on("projectDeleted", function() {
        b.refresh()
    });
    b.refresh()
},createObject:function() {
    var a = new Explore.data.model.Project();
    return a
}});
Ext.reg("explore.view.projectstree", Explore.view.ProjectsTree);
Ext.ns("Explore.view");
Explore.view.RecentSearches = Ext.extend(Ext.tree.TreePanel, {myEvents:["deleteSearch"],contextNode:null,initComponent:function() {
    var a = this;
    var c = new Ext.menu.Menu({items:[
        {itemid:"delete",iconCls:"delete-icon",text:Explore.i18n("DeleteRecentSearch"),disabled:!Explore.Security.isAuthorized("SEARCH_RECENT_VIEW"),handler:function() {
            a.deleteSearch(a.contextNode)
        }},
        {itemid:"deleteAll",disabled:!Explore.Security.isAuthorized("SEARCH_RECENT_VIEW"),text:Explore.i18n("DeleteAllSearchHistory"),handler:function() {
            a.deleteAllSearchHistory()
        }}
    ]});
    var b = {title:Explore.i18n("RecentSearches"),collapsible:false,useArrows:true,autoScroll:true,animate:true,enableDD:false,containerScroll:true,padding:"0 0 50 0",root:{id:"root",text:"Root",expanded:true},rootVisible:false,loader:new Ext.tree.TreeLoader({clearOnLoad:true,directFn:IDOLService.GetHistoryViews}),contextMenu:c};
    if (a.showTools) {
        a.initTools(b)
    }
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.RecentSearches.superclass.initComponent.apply(this, arguments);
    a.addEvents(a.myEvents);
    a.enableBubble(a.myEvents);
    if (a.showTools) {
        a.on("collapse", function() {
            this.toolDecorator.disableTools(["delete"])
        });
        a.on("expand", function() {
            a.enabledToolsIfNodeSelected()
        })
    }
    a.on("contextmenu", function(d, f) {
        d.select();
        var g = d.getOwnerTree().contextMenu;
        a.contextNode = d;
        g.showAt(f.getXY())
    });
    Explore.data.IDOLDataStore.on("searchHistoryAdded", function(g, h) {
        var f = new Ext.tree.TreeNode({id:h.Id,text:h.Name,tag:h.Id,iconCls:"no-icon"});
        var d = a.getRootNode();
        if (d && d !== null) {
            if (d.firstChild) {
                d.insertBefore(f, d.firstChild)
            } else {
                d.appendChild(f)
            }
        }
        if (d.childNodes) {
            for (var e = d.childNodes.length - 1;
                 e >= Explore.SearchHistoryLimit; e--) {
                d.removeChild(d.childNodes[e])
            }
        }
    });
    Explore.data.IDOLDataStore.on("searchHistoryDeleted", function(d, f) {
        if (f == "ALL") {
            a.getRootNode().removeAll()
        } else {
            var e = a.getNodeById(f);
            if (e != null) {
                e.remove()
            }
        }
    });
    a.getLoader().on("load", function(d) {
        if (a.intiallyLoaded) {
            a.intiallyLoaded = true;
            Explore.data.IDOLDataStore.on("newSearchCompleted", function(h, g, f, e) {
                a.refresh()
            })
        }
    })
},enabledToolsIfNodeSelected:function() {
    var a = this;
    var b = a.getSelectionModel().getSelectedNode();
    if (b) {
        a.toolDecorator.enableTools(["delete"])
    } else {
        a.toolDecorator.disableTools(["delete"])
    }
},deleteSearch:function(b) {
    var a = b.text;
    var c = b.attributes.tag;
    Ext.MessageBox.confirm(Explore.i18n("DeleteRecentSearch"), String.format(Explore.i18n("AreYouSureYouWantToDeleteTheRecentSearch_"), a), function(d) {
        if (d === "yes") {
            Explore.data.IDOLDataStore.deleteSearch(c, Explore.model.ASType.RecentSearch, function(e) {
                if (e.ErrorCode === 0) {
                } else {
                    log.warn("Error deleting recent search: ", e);
                    Explore.view.showError(Explore.i18n("ErrorDeletingSavedSearch"), Explore.i18n("ThereWasAnErrorDeletingTheSavedSearch"))
                }
            })
        }
    })
},deleteAllSearchHistory:function() {
    Ext.MessageBox.confirm(Explore.i18n("DeleteAllRecentSearches"), Explore.i18n("AreYouSureYouWantToDeleteAllRecentSearches_"), function(a) {
        if (a === "yes") {
            Explore.data.IDOLDataStore.deleteSearchHistory(function(b) {
                if (b.ErrorCode === 0) {
                } else {
                    log.warn("Error deleting recent search: ", b);
                    Explore.view.showError(Explore.i18n("ErrorDeletingSearchHistory"), Explore.i18n("ThereWasAnErrorDeletingYourSearchHistory_"))
                }
            })
        }
    })
},initTools:function(a) {
    var b = this;
    a.tools = [
        {id:"delete",disabled:true,qtip:Explore.i18n("DeleteRecentSearch"),handler:function(e, d, c) {
            if (!d.hasClass("disabled")) {
                var f = b.getSelectionModel().getSelectedNode();
                b.deleteSearch(f)
            }
        }}
    ];
    b.toolDecorator = new Explore.view.common.DisabledToolDecorator(b, a);
    b.getSelectionModel().on("selectionchange", function(c) {
        if (Explore.Security.isAuthorized("SEARCH_RECENT_VIEW")) {
            b.enabledToolsIfNodeSelected()
        }
    }, b)
}});
Ext.reg("explore.view.recentsearches", Explore.view.RecentSearches);
Ext.ns("Explore.view");
Explore.view.RoleDialog = Ext.extend(Explore.base.EditorDialog, {itemDescription:Explore.i18n("Role"),initComponent:function() {
    var b = this;
    var d = this.editObject;
    var a = (d.Id > 0) ? false : true;
    var c = (d.Id <= 2);
    b.formItems = [
        {name:"Name",allowBlank:false,width:120,maxLength:60,readOnly:b.readOnly || c},
        {xtype:b.readOnly ? "displayfield" : "textarea",name:"Description",allowBlank:true,height:40,maxLength:500,readOnly:b.readOnly || c},
        {xtype:"explore.view.permissionselector",name:"Permissions",hideLabel:true,margins:"0 10 10 10",readOnly:b.readOnly || c,anchor:"100% -90"}
    ];
    Explore.view.RoleDialog.superclass.initComponent.apply(this, arguments)
}});
Ext.ns("Explore.view");
Explore.view.RuleDialog = Ext.extend(Explore.base.EditorDialog, {itemDescription:Explore.i18n("AutomationRule"),layout:"form",autoScroll:true,maxBoxHeight:600,autoHeight:true,cls:"rule-dialog",initComponent:function() {
    var k = this;
    var c = this.editObject;
    var w = {name:"Name",allowBlank:false};
    var o = {xtype:k.readOnly ? "displayfield" : "textarea",name:"Description",allowBlank:true,height:40};
    var l = {xtype:"checkbox",hideLabel:true,name:"IsEnabled",boxLabel:Explore.i18n("RuleEnabled")};
    var g = {itemId:"searchcriteriasummarylink",xtype:"explore.view.searchcriteriasummarylink",fieldLabel:Explore.i18n("SearchCriteria_1"),searchCriteria:c.searchCriteria,readOnly:k.readOnly};
    var m = {xtype:"explore.view.automation.ruledialogactionitem",itemId:"snapshotAction",actions:[Explore.model.AutomationAction.AddToSnapshot,Explore.model.AutomationAction.RemoveFromSnapshot],primaryAttribute:"Snapshot",rule:c,text:Explore.i18n("snapshot_v2"),cls:"demoMode",hidden:!Explore.demoMode,targetJsonFn:Explore.data.SnapshotDataStore.getAllSnapshots};
    var b = {xtype:"explore.view.automation.ruledialogactionitem",itemId:"tagAction",actions:[Explore.model.AutomationAction.AddTag,Explore.model.AutomationAction.RemoveTag],primaryAttribute:"Tag",rule:c,text:Explore.i18n("tag_v2"),targetJsonFn:Explore.data.MetaDataStore.getTags,targetNameProperty:"TagName"};
    var t = {xtype:"explore.view.automation.ruledialogactionitem",itemId:"classifyAction",hidden:false,actions:[Explore.model.AutomationAction.AddClassification,Explore.model.AutomationAction.RemoveClassification],primaryAttribute:"Classification",rule:c,text:Explore.i18n("classification"),targetJsonFn:function(y) {
        var x = Explore.data.MetaDataStore.getRecordingClassificationNames();
        y(x)
    },targetNameProperty:"Name"};
    var p = {xtype:"explore.view.automation.ruledialogactionitem",itemId:"optimostAction",width:"100%",actions:[Explore.model.AutomationAction.StartOptimostExp],primaryAttribute:"OptimostExperiment",rule:c,text:Explore.i18n("ExecuteNewOptimostWorkflow"),cls:"demoMode",hidden:!Explore.demoMode,targetJsonFn:function(y) {
        var x = [
            {Id:1,Name:"1"},
            {Id:2,Name:"2"},
            {Id:3,Name:"3"},
            {Id:4,Name:"4"}
        ];
        y(x)
    }};
    var u = {xtype:"explore.view.automation.ruledialogactionitem",itemId:"notifyAction",width:"100%",actions:[Explore.model.AutomationAction.SendNotification],rule:c,text:Explore.i18n("SendANotificationEmailToSelectedUsersUsingTemplate"),primaryAttribute:"Template",showUsers:true};
    var a = {xtype:"explore.view.automation.ruledialogactionitem",itemId:"saveToFileSystemAction",width:"100%",actions:[Explore.model.AutomationAction.SaveToUNC],rule:c,text:Explore.i18n("SaveNotificationToFileSystemUsingTemplate"),primaryAttribute:"Template",showUnc:true};
    var n = {itemId:"executeonschedule",layout:{type:"hbox",align:"middle"},xtype:"container",height:50,width:"100%",items:[
        {xtype:"label",text:Explore.i18n("ExecuteRuleEvery")},
        {xtype:"numberfield",width:40,allowDecimals:false,allowNegative:false,minValue:1,itemId:"frequency",value:1,emptyText:1,margins:"0 8 0 8",allowBlank:false},
        {xtype:"selectboxfield",itemId:"intervalCombo",width:100,options:[
            [Explore.model.AutomationInterval.Minutes,Explore.i18n("Minute_s_")],
            [Explore.model.AutomationInterval.Hours,Explore.i18n("Hour_s_")],
            [Explore.model.AutomationInterval.Days,Explore.i18n("Day_s_")],
            [Explore.model.AutomationInterval.Week,Explore.i18n("Weeks_s_")]
        ],value:Explore.model.AutomationInterval.Hours},
        {xtype:"label",text:Explore.i18n("StartTime"),margins:"0 0 0 8"},
        {xtype:"timefield",itemId:"startTimeField",value:"12:00 AM",increment:30,width:90,margins:"0 8 0 8",allowBlank:false}
    ]};
    var q = {xtype:"explore.view.common.daterangepicker",itemId:"dateRangePicker",margins:"0 10 0 0",fieldLabel:Explore.i18n("Date"),width:380,horizontalLayout:true};
    var f = {xtype:"radio",name:"scheduleExecute",itemId:"scheduleExecute",checked:true,boxLabel:Explore.i18n("ExecuteOnSchedule"),listeners:{check:function(x, y) {
        if (y) {
            k.getByItemId("executeonschedule").show();
            k.getByItemId("dateRangePicker").show();
            k.getByItemId("radioscheduleonthreshold").setValue(false);
            k.doLayout()
        } else {
            k.getByItemId("executeonschedule").hide();
            k.getByItemId("dateRangePicker").hide();
            k.doLayout()
        }
    }}};
    var v = {xtype:"container",items:[f,n]};
    var d = {itemId:"executeonthreshold",layout:{type:"hbox",align:"middle"},xtype:"container",height:50,width:"100%",hidden:true,items:[
        {xtype:"label",text:Explore.i18n("ExecuteWhenTheNumberOfDocumentsExceed")},
        {xtype:"numberfield",width:40,allowDecimals:false,allowNegative:false,minValue:1,itemId:"executeonthresholddocumentcount",value:1,emptyText:1,margins:"0 8 0 8",allowBlank:false},
        {xtype:"label",text:Explore.i18n("_documents")}
    ]};
    var s = {itemId:"executeonthresholdintervalpanel",layout:{type:"hbox",align:"middle"},xtype:"container",height:50,width:"100%",hidden:true,items:[
        {xtype:"label",text:Explore.i18n("Within")},
        {xtype:"numberfield",width:40,allowDecimals:false,allowNegative:false,minValue:1,itemId:"executeonthresholdinterval",value:1,emptyText:1,margins:"0 8 0 8",allowBlank:false},
        {xtype:"selectboxfield",itemId:"executeonthresholdintervalCombo",width:100,options:[
            [Explore.model.AutomationInterval.Minutes,Explore.i18n("Minute_s_")],
            [Explore.model.AutomationInterval.Hours,Explore.i18n("Hour_s_")],
            [Explore.model.AutomationInterval.Days,Explore.i18n("Day_s_")],
            [Explore.model.AutomationInterval.Week,Explore.i18n("Weeks_s_")]
        ],value:Explore.model.AutomationInterval.Hours}
    ]};
    var r = {xtype:"radio",hidden:!Explore.demoMode,name:"radioscheduleonthreshold",itemId:"radioscheduleonthreshold",boxLabel:Explore.i18n("ExecuteOnThreshold"),listeners:{check:function(x, y) {
        if (y) {
            k.getByItemId("executeonthreshold").show();
            k.getByItemId("executeonthresholdintervalpanel").show();
            k.getByItemId("scheduleExecute").setValue(false)
        } else {
            k.getByItemId("executeonthreshold").hide();
            k.getByItemId("executeonthresholdintervalpanel").hide()
        }
    }}};
    var h = {xtype:"container",border:true,frame:true,items:[r,d,s]};
    var e = {xtype:"fieldset",autoWidth:true,autoScroll:true,title:Explore.demoMode ? Explore.i18n("ExecutionScheduleThreshold") : Explore.i18n("ExectionSchedule"),items:[v,q,h]};
    var j = {xtype:"fieldset",autoWidth:true,autoScroll:true,title:Explore.i18n("ActionOnRule"),items:[m,b,t,p,u,a]};
    k.formItems = [w,o,l,g,j,e];
    Explore.view.RuleDialog.superclass.initComponent.apply(this, arguments)
},getButtonsConfig:function() {
    var b = this;
    var a = {xtype:"button",text:Explore.i18n("PreviewSearchResults"),handler:function() {
        var e = null;
        var d = b.getByItemId("searchcriteriasummarylink").getValue();
        if (d) {
            e = new Explore.view.NotificationRuleResultsDialog({listeners:{},searchInfo:d});
            e.show()
        } else {
            Ext.MessageBox.show({title:Explore.i18n("appTitle"),msg:Explore.i18n("NoSearchCriteriaSetup"),buttons:Ext.MessageBox.OK,icon:Ext.MessageBox.WARNING})
        }
    }};
    var c = Explore.view.RuleDialog.superclass.getButtonsConfig.call(this);
    c.splice(0, 0, a);
    return c
},isDirty:function() {
    var a = Explore.view.RuleDialog.superclass.isDirty.call(this);
    a |= this.getByItemId("searchcriteriasummarylink").isDirty();
    a |= this.getByItemId("snapshotAction").isDirty();
    a |= this.getByItemId("tagAction").isDirty();
    a |= this.getByItemId("classifyAction").isDirty();
    a |= this.getByItemId("optimostAction").isDirty();
    a |= this.getByItemId("notifyAction").isDirty();
    a |= this.getByItemId("saveToFileSystemAction").isDirty();
    return a
},isValid:function(a) {
    var b = false;
    b |= this.getByItemId("snapshotAction").isValid(a);
    b |= this.getByItemId("tagAction").isValid(a);
    b |= this.getByItemId("classifyAction").isValid(a);
    b |= this.getByItemId("optimostAction").isValid(a);
    b |= this.getByItemId("notifyAction").isValid(a);
    b |= this.getByItemId("saveToFileSystemAction").isValid(a);
    b &= (this.getByItemId("searchcriteriasummarylink").getValue() != null);
    b &= Explore.view.RuleDialog.superclass.isValid.call(this, a);
    return b
},populateObject:function() {
    delete this.editObject.IsPerpetual;
    delete this.editObject.Frequency;
    delete this.editObject.Interval;
    delete this.editObject.StartDate;
    delete this.editObject.EndDate;
    var d = this.getForm();
    var l = d.items.items;
    for (var j = 0; j < l.length; j++) {
        var n = l[j];
        var b = n.getName();
        if (b && b.indexOf("ext-comp-") == -1 && b != "ruleAction") {
            var g = n.getValue();
            Explore.base.EditorUtil.setObjectProperty(this.editObject, b, g)
        }
    }
    this.editObject.SearchInfo = this.getByItemId("searchcriteriasummarylink").getValue();
    this.getByItemId("snapshotAction").populateObject(this.editObject);
    this.getByItemId("tagAction").populateObject(this.editObject);
    this.getByItemId("classifyAction").populateObject(this.editObject);
    this.getByItemId("optimostAction").populateObject(this.editObject);
    this.getByItemId("notifyAction").populateObject(this.editObject);
    this.getByItemId("saveToFileSystemAction").populateObject(this.editObject);
    var k = {};
    this.getByItemId("dateRangePicker").populateObject(k);
    var o;
    var a;
    var h = !this.getByItemId("scheduleExecute").checked;
    if (!h) {
        o = this.getByItemId("frequency");
        a = this.getByItemId("intervalCombo")
    } else {
        o = this.getByItemId("executeonthresholdinterval");
        a = this.getByItemId("executeonthresholdintervalCombo")
    }
    var m = this.getByItemId("startTimeField");
    this.editObject.Plan = {Frequency:o.getValue(),Interval:a.getValue(),PlanType:h ? 1 : 0,Threshold:h ? this.getByItemId("executeonthresholddocumentcount").getValue() : 0};
    this.editObject.Threshold = h ? this.getByItemId("executeonthresholddocumentcount").getValue() : 0;
    var f = m.getValue();

    function e(r, t) {
        var u = t.indexOf(":");
        var p = t.indexOf(" ");
        var q = parseInt(t.substring(0, u));
        var s = parseInt(t.substring(u + 1, p));
        if (t.substring(p + 1).toUpperCase() == "PM") {
            q += 12
        } else {
            if (q == 12) {
                q = 0
            }
        }
        r.setHours(q, s, 0, 0);
        return r
    }

    if (k.filterByDateType === Explore.model.FilterByDateType.Any) {
        this.editObject.Plan.IsPerpetual = true;
        var c = new Date();
        c.setHours(0, 0, 0, 0);
        this.editObject.Plan.StartDate = e(c, f)
    } else {
        this.editObject.Plan.IsPerpetual = false;
        this.editObject.Plan.StartDate = e(k.startDate, f);
        this.editObject.Plan.EndDate = k.endDate
    }
},displayObject:function() {
    Explore.view.RuleDialog.superclass.displayObject.call(this);
    var h = {};
    this.getByItemId("searchcriteriasummarylink").setValue(this.editObject.SearchInfo);
    if (this.editObject.Plan != null) {
        if (this.editObject.Plan.IsPerpetual) {
            h.filterByDateType = 0
        } else {
            h.filterByDateType = 3;
            h.startDate = Explore.parseSerializedDate(this.editObject.Plan.StartDate);
            h.endDate = Explore.parseSerializedDate(this.editObject.Plan.EndDate)
        }
        if (this.editObject.PlanType == 0) {
            this.getByItemId("dateRangePicker").populateUI(h);
            var e = this.getByItemId("frequency");
            var g = this.getByItemId("intervalCombo");
            var f = this.getByItemId("startTimeField");
            e.setValue(this.editObject.Plan.Frequency);
            g.setValue(this.editObject.Plan.Interval);
            var a = Explore.parseSerializedDate(this.editObject.Plan.StartDate);
            var b = a.getHours();
            var d = "AM";
            if (b === 0) {
                b = 12
            } else {
                if (b > 12) {
                    b -= 12;
                    d = "PM"
                }
            }
            var c = b + ":" + String.leftPad(a.getMinutes(), 2, "0") + " " + d;
            f.setValue(c)
        } else {
            this.getByItemId("radioscheduleonthreshold").setValue(true);
            this.getByItemId("executeonthresholddocumentcount").setValue(this.editObject.Plan.Threshold);
            this.getByItemId("executeonthresholdinterval").setValue(this.editObject.Plan.Frequency);
            this.getByItemId("executeonthresholdintervalCombo").setValue(this.editObject.Plan.Interval)
        }
    }
}});
Ext.reg("explore.view.ruledialog", Explore.view.RuleDialog);
Ext.ns("Explore.view");
Explore.view.RulesPanel = Ext.extend(Ext.Panel, {newAction:null,editAction:null,deleteAction:null,runRuleAction:null,store:null,projects:null,initComponent:function() {
    var a = this;
    Explore.data.RuleDataStore.on("ruleModified", function() {
        a.loadData()
    });
    a.initActions();
    a.initStore();
    var d = [
        {header:Explore.i18n("Name"),id:"name",width:200,sortable:true,dataIndex:"Name"},
        {header:Explore.i18n("Action"),id:"action",width:120,sortable:true,renderer:function e(m, f, k, l, o, n) {
            var p = "";
            var h = k.json.Actions;
            if (h != null) {
                for (var j = 0; j < h.length; j++) {
                    if (j > 0) {
                        p += ", "
                    }
                    var g = Explore.i18n("Action_" + Explore.model.AutomationAction.getName(h[j].Action));
                    p += g
                }
            }
            return p
        }},
        {header:Explore.i18n("CreatedBy"),id:"createdby",width:180,sortable:true,dataIndex:"CreatedBy"},
        {header:Explore.i18n("DateCreated"),id:"dateCreated",width:140,sortable:true,dataIndex:"DateCreated",renderer:function(k, f, h, l, j, g) {
            return Explore.formatDateByPref(k)
        }},
        {header:Explore.i18n("LastRun"),id:"lastProcessed",width:140,sortable:true,dataIndex:"LastProcessed",renderer:function(k, f, h, l, j, g) {
            if (k <= 0) {
                return Explore.i18n("not run yet")
            }
            return Explore.formatDateByPref(k)
        }},
        {header:Explore.i18n("Active"),id:"active",width:100,sortable:true,dataIndex:"IsEnabled",renderer:function e(k, g, f, l, j, h) {
            return k ? Explore.i18n("Enabled") : Explore.i18n("Disabled")
        }}
    ];
    var c = {xtype:"grid",itemId:"grid",store:a.store,autoExpandColumn:"action",hidden:!Explore.Security.isAuthorized("AUTOMATE_VIEW"),tbar:[a.runRuleAction,a.newAction,a.editAction,a.deleteAction],columns:d,listeners:{viewready:{scope:this,fn:this.loadData,single:true},rowclick:function() {
        var h = a.getSelectedRows();
        var f = (h.length == 0);
        var g = a.getByItemId("grid").topToolbar;
        a.runRuleAction.setDisabled(f || !Explore.Security.isAuthorized("AUTOMATE_CREATE"));
        a.newAction.setDisabled(f || !Explore.Security.isAuthorized("AUTOMATE_CREATE"));
        a.editAction.setDisabled(f || !Explore.Security.isAuthorized("AUTOMATE_UPDATE"));
        a.deleteAction.setDisabled(f || !Explore.Security.isAuthorized("AUTOMATE_DELETE"))
    },rowdblclick:function(g, j, h) {
        var f = g.getStore().getAt(j);
        if (Explore.Security.isAuthorized("AUTOMATE_UPDATE")) {
            a.editRule()
        }
    },rowcontextmenu:function(g, m, l) {
        l.stopEvent();
        var g = a.getByItemId("grid");
        var f = g.getSelectionModel();
        f.selectRow(m, false);
        var k = a.getSelectedRows();
        var h = (k.length == 0);
        var j = g.topToolbar;
        a.runRuleAction.setDisabled(h || !Explore.Security.isAuthorized("AUTOMATE_CREATE"));
        a.newAction.setDisabled(h || !Explore.Security.isAuthorized("AUTOMATE_CREATE"));
        a.editAction.setDisabled(h || !Explore.Security.isAuthorized("AUTOMATE_UPDATE"));
        a.deleteAction.setDisabled(h || !Explore.Security.isAuthorized("AUTOMATE_DELETE"));
        if (!a.contextMenu) {
            a.contextMenu = new Ext.menu.Menu({items:[a.newAction,a.editAction,a.deleteAction]})
        }
        a.contextMenu.showAt(l.getXY())
    }}};
    var b = {layout:"fit",padding:"10",items:[c]};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.RulesPanel.superclass.initComponent.apply(this, arguments)
},initActions:function() {
    var a = this;
    if (!a.newAction) {
        a.newAction = new Ext.Action({text:Explore.i18n("New"),handler:a.newRule,iconCls:"new-icon",tooltip:Explore.i18n("CreateANewRule"),disabled:!Explore.Security.isAuthorized("AUTOMATE_CREATE"),itemId:"newButton"})
    }
    if (!a.editAction) {
        a.editAction = new Ext.Action({itemId:"editButton",iconCls:"edit-icon",text:Explore.i18n("Edit"),tooltip:Explore.i18n("EditRule"),disabled:true || !Explore.Security.isAuthorized("AUTOMATE_UPDATE"),handler:function() {
            a.editRule(a)
        }})
    }
    if (!a.deleteAction) {
        a.deleteAction = new Ext.Action({itemId:"deleteButton",iconCls:"delete-icon",text:Explore.i18n("Delete"),tooltip:Explore.i18n("DeleteRule"),disabled:true || !Explore.Security.isAuthorized("AUTOMATE_DELETE"),handler:function() {
            a.deleteRule(a)
        }})
    }
    if (!a.runRuleAction) {
        a.runRuleAction = new Ext.Action({itemId:"runButton",iconCls:"run-icon",text:Explore.i18n("Run"),tooltip:Explore.i18n("RunRule"),disabled:true,hidden:true,handler:function() {
            a.runRule(a)
        }})
    }
},initStore:function() {
    this.store = new Ext.data.JsonStore({fields:[
        {name:"Id"},
        {name:"Name"},
        {name:"IsEnabled"},
        {name:"CreatedBy"},
        {name:"DateCreated"},
        {name:"LastProcessed"}
    ]})
},loadData:function() {
    var b = this,c = b.getByItemId("grid"),d = c.getEl(),a = new Ext.LoadMask(d, {msg:Explore.i18n("Loading Automation Rules")});
    a.show();
    Explore.data.RuleDataStore.getRulesByUser(function(e) {
        a.hide();
        if (e) {
            b.projects = e;
            b.store.loadData(e)
        }
    })
},getSelectedRows:function() {
    var a = this;
    var b = a.getByItemId("grid");
    return b.getSelectionModel().getSelections()
},runRule:function(c) {
    var a = c || this;
    log.info("Run rule");
    var e = a.getSelectedRows();
    if (e.length > 0) {
        var d = e[0].json;
        var b = d.Name;
        var f = d.Id
    }
},newRule:function() {
    var a = this;
    log.info("New rule");
    var b = new Explore.data.model.AutomationRule();
    Explore.view.RulesPanel.showRuleDialog(b)
},editRule:function(b) {
    var a = b || this;
    log.info("Edit rule");
    var d = a.getSelectedRows();
    if (d.length > 0) {
        var c = d[0].json;
        Explore.view.RulesPanel.showRuleDialog(c)
    }
},deleteRule:function(c) {
    var a = c || this;
    log.info("Delete rule");
    var e = a.getSelectedRows();
    if (e.length > 0) {
        var d = e[0].json;
        var b = d.Name;
        var g = d.Id;
        var f = String.format(Explore.i18n("AreYouSureYouWantToDeleteThe_"), Explore.i18n("Rule"), b);
        Explore.view.StatusBox.confirm(Explore.i18n("appTitle"), f, function() {
            Explore.data.RuleDataStore.deleteRule(g, function(h) {
                log.info("Delete rule result:", h)
            })
        })
    }
}});
Ext.reg("explore.view.rulespanel", Explore.view.RulesPanel);
Explore.view.RulesPanel.showRuleDialog = function(a) {
    var b = new Explore.view.automation.AutomationRuleDialog({editObject:a,readOnly:false,listeners:{save:function(c) {
        Explore.data.RuleDataStore.saveRule(a, function(d) {
            if (d.ErrorCode > 0) {
                if (d.ErrorCode === 70001) {
                    Explore.showConfigMissingMessage("errorMessageNoNotificationServerRuleDisabled")
                } else {
                    Explore.view.RulesPanel.showRuleDialog(d.Result);
                    Explore.view.StatusBox.showWarning(Explore.i18n("appTitle"), d.Message)
                }
            } else {
                log.info("Rule saved successfully")
            }
        })
    }}});
    b.show()
};
Ext.ns("Explore.view");
Explore.view.SaveChangesDialog = Ext.extend(Ext.Window, {resizable:false,constrain:true,constrainHeader:true,minimizable:false,maximizable:false,modal:true,shim:true,width:400,minHeight:80,plain:true,footer:true,closable:false,title:Explore.i18n("SaveChanges"),msg:Explore.i18n("RecentChangesHaveNotBeenSavedbrbrWouldYouLikeToSaveTheseChanges"),layout:"anchor",padding:10,cls:"x-window-dlg",fn:null,initComponent:function() {
    var a = this;
    var b = {items:{xtype:"box",autoEl:{tag:"div",html:'<div class="ext-mb-icon ext-mb-question"></div><div class="ext-mb-content"><span class="ext-mb-text">' + this.msg + "</span></div></div>"}},buttons:[
        {text:Explore.i18n("Save"),handler:function() {
            this.buttonHandler("save")
        },scope:this},
        {text:Explore.i18n("DontSave"),handler:function() {
            this.buttonHandler("dontsave")
        },scope:this},
        {text:Explore.i18n("textCancel"),handler:function() {
            this.buttonHandler("cancel")
        },scope:this}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.SaveChangesDialog.superclass.initComponent.apply(this, arguments)
},buttonHandler:function(a) {
    this.close();
    if (this.fn) {
        this.fn(a)
    }
}});
Ext.reg("explore.view.savechangesdialog", Explore.view.SaveChangesDialog);
Ext.ns("Explore.view");
Explore.view.SavedSearches = Ext.extend(Ext.tree.TreePanel, {myEvents:["editSearch","deleteSearch"],contextNode:null,initComponent:function() {
    var b = this;
    var e = {key:Ext.EventObject.DELETE,fn:function() {
        try {
            var f = b.getSelectionModel().getSelectedNode();
            if (f) {
                b.deleteSearch(f)
            }
        } catch(g) {
        }
    }};
    var d = new Ext.menu.Menu({items:[
        {itemId:"edit",iconCls:"edit-icon",text:Explore.i18n("EditSearch"),disabled:!Explore.Security.isAuthorized("SEARCH_SAVED_CREATE"),handler:function() {
            var f = b.getSelectionModel().selNode;
            var g = f.attributes.tag;
            b.editSearch(g)
        }},
        {itemId:"delete",iconCls:"delete-icon",disabled:!Explore.Security.isAuthorized("SEARCH_SAVED_CREATE"),text:Explore.i18n("DeleteSearch"),handler:function() {
            b.deleteSearch(contextNode)
        }},
        "-",
        {itemId:"saved-view-cluster",text:Explore.i18n("SubmitClusterJob"),hidden:true,handler:function() {
            contextNode = b.getSelectionModel().selNode;
            var g = contextNode.attributes.tag;
            var f = Explore.presenter.ProjectsPresenter.getCurrentProjectId();
            Explore.data.ClusterDataStore.submitClusterJobForSavedSearch(g, f)
        }},
        {itemId:"saved-view-spectrograph",text:Explore.i18n("SubmitSpectrographJob"),hidden:true,handler:function() {
            contextNode = b.getSelectionModel().selNode;
            var g = contextNode.attributes.tag;
            var f = Explore.presenter.ProjectsPresenter.getCurrentProjectId();
            Explore.data.ClusterDataStore.submitSpectrographJobForSavedSearch(g, f)
        }}
    ]});
    d.items.items[2].hide();
    var a = new Ext.tree.TreeLoader({directFn:IDOLService.GetSavedSearches});
    var c = {itemId:"savedSearches",title:Explore.i18n("SavedSearches"),collapsible:false,useArrows:true,autoScroll:true,forceLayout:true,animate:true,enableDD:false,containerScroll:true,root:{id:"root",text:"Root",expanded:true},keys:e,rootVisible:false,loader:a,contextMenu:d};
    if (b.showTools) {
        b.initTools(c)
    }
    Ext.apply(this, Ext.apply(this.initialConfig, c));
    Explore.view.SavedSearches.superclass.initComponent.apply(this, arguments);
    b.addEvents(b.myEvents);
    b.enableBubble(b.myEvents);
    Explore.data.IDOLDataStore.on("savedSearchChanged", function(g, f) {
        b.refresh()
    });
    Explore.data.IDOLDataStore.on("savedSearchDeleted", function(f, h) {
        var g = b.getNodeById(h);
        if (g != null) {
            g.remove()
        }
    });
    if (b.showTools) {
        b.on("collapse", function() {
            this.toolDecorator.disableTools(["edit","delete"])
        });
        b.on("expand", function() {
            b.enabledToolsIfNodeSelected()
        })
    }
},initTools:function(a) {
    var b = this;
    a.tools = [
        {id:"edit",qtip:Explore.i18n("EditSavedSearch"),disabled:true,handler:function(e, d, c) {
            if (!d.hasClass("disabled")) {
                var f = b.getSelectionModel().getSelectedNode();
                var g = f.attributes.tag;
                b.editSearch(g)
            }
        }},
        {id:"delete",qtip:Explore.i18n("DeleteSavedSearch"),disabled:true,handler:function(e, d, c) {
            if (!d.hasClass("disabled")) {
                var f = b.getSelectionModel().getSelectedNode();
                b.deleteSearch(f)
            }
        }}
    ];
    b.toolDecorator = new Explore.view.common.DisabledToolDecorator(b, a);
    b.getSelectionModel().on("selectionchange", function(c) {
        if (Explore.Security.isAuthorized("SEARCH_SAVED_CREATE")) {
            b.enabledToolsIfNodeSelected()
        }
    }, b)
},editSearch:function(a) {
    Explore.data.IDOLDataStore.getSearchCriteriaBySearchId(a, function(b) {
        var c = new Explore.view.AdvancedSearchCriteriaDialog({editObject:b});
        c.on("save", function() {
            Explore.data.IDOLDataStore.saveAdvancedSearchInfo(b, function(d) {
                if (d.ErrorCode == 0) {
                    log.info("saveSearch: ", a, d)
                } else {
                    log.warn("Saved Search Error", d);
                    Explore.view.StatusBox.showWarning(Explore.i18n("EditSearch"), d.Message)
                }
            })
        });
        c.show()
    })
},deleteSearch:function(b) {
    var a = b.text;
    var c = b.attributes.tag;
    Ext.MessageBox.confirm(Explore.i18n("DeleteSavedSearch"), Explore.i18n("AreYouSureYouWishToDeleteTheSavedSearch") + ':<br />"' + a + '"', function(d) {
        if (d === "yes") {
            Explore.data.IDOLDataStore.deleteSearch(c, Explore.model.ASType.SavedSearch, function(e) {
                if (e.ErrorCode === 0) {
                } else {
                    log.warn("Error deleting saved search: ", e);
                    Explore.view.showError(Explore.i18n("ErrorDeletingSavedSearch"), Explore.i18n("ThereWasAnErrorDeletingTheSavedSearch"))
                }
            })
        }
    })
},enabledToolsIfNodeSelected:function() {
    var a = this;
    var b = a.getSelectionModel().getSelectedNode();
    if (b) {
        a.toolDecorator.enableTools(["edit","delete"])
    } else {
        a.toolDecorator.disableTools(["edit","delete"])
    }
},reloadTree:function() {
    var a = this;
    a.getLoader().load(a.root)
}});
Ext.reg("explore.view.savedsearches", Explore.view.SavedSearches);
Ext.ns("Explore.view");
Explore.view.ScriptAdherencePanel = Ext.extend(Explore.base.AdministrationPanelBase, {hidden:!Explore.Security.isAuthorized("ANALYZE_SCRIPT_ADHERENCE_VIEW"),itemDescription:Explore.i18n("Script"),initComponent:function() {
    var a = this;
    a.permissions = {view:Explore.Security.isAuthorized("ANALYZE_SCRIPT_ADHERENCE_VIEW"),create:Explore.Security.isAuthorized("ANALYZE_SCRIPT_ADHERENCE_VIEW"),update:Explore.Security.isAuthorized("LEXICONS_UPDATE"),"delete":Explore.Security.isAuthorized("ANALYZE_SCRIPT_ADHERENCE_VIEW")};
    a.setTreeConfig({title:Explore.i18n("Scripts"),xtype:"explore.view.scriptadherencetree"});
    a.setDetailConfig({xtype:"explore.view.scriptadherencedetail"});
    Explore.view.ScriptAdherencePanel.superclass.initComponent.apply(this, arguments)
}});
Ext.reg("explore.view.scriptadherencepanel", Explore.view.ScriptAdherencePanel);
Explore.view.ScriptAdherenceTree = Ext.extend(Explore.base.AdministrationTreePanel, {itemDescription:Explore.i18n("Script"),initComponent:function() {
    var a = this;
    a.loadFn = Explore.data.ScriptAdherenceDataStore.getScriptDefinitionById;
    a.saveFn = Explore.data.ScriptAdherenceDataStore.addScriptDefinition;
    a.deleteFn = Explore.data.ScriptAdherenceDataStore.deleteScriptDefinition;
    a.editDialogFn = Explore.view.ScriptDefinitionDialog;
    Explore.data.ScriptAdherenceDataStore.on("scriptModified", function(c) {
        var b = a.getByItemId("tree");
        b.refresh(null, function() {
            var d = b.getNodeById(c);
            if (d) {
                d.ensureVisible();
                d.select()
            }
        })
    });
    this.loader = new Ext.tree.TreeLoader({directFn:ScriptAdherenceService.GetScriptNodes});
    Explore.view.ScriptAdherenceTree.superclass.initComponent.apply(this, arguments)
},createObject:function() {
    var a = {TargetScore:60,Speaker:Explore.model.SpeakerTypes.Either,Language:"englishUTF8",FromDate:new Date().add(Date.MONTH, -1),ToDate:new Date()};
    return a
},showEditDialog:function(c, b) {
    var a = this;
    var d = new a.editDialogFn({editObject:c,readOnly:(c.Id > 0)});
    d.on("save", function() {
        a.onSave(c)
    });
    d.show(a)
}});
Ext.reg("explore.view.scriptadherencetree", Explore.view.ScriptAdherenceTree);
Explore.view.ScriptAdherenceDetail = Ext.extend(Explore.base.AdministrationDetailPanelBase, {initComponent:function() {
    var a = this;
    a.formItems = [
        {name:"Name"},
        {xtype:"grid",itemId:"grid",anchor:"100% -100",tbar:[
            {xtype:"button",itemId:"playBtn",iconCls:"buttonOpen",disabled:true,text:Explore.i18n("Play"),tooltip:Explore.i18n("PlaySelectedRecording"),handler:function() {
                var c = a.getByItemId("grid");
                var d = c.getSelectionModel().getSelections();
                a.playSelectedFiles(d, c)
            }}
        ],store:new Ext.data.ArrayStore({storeId:"scriptResultStore",fields:["id","script_score","agent_name","group_name","date_time","duration","num_holds","ani","dnis","token"]}),colModel:new Ext.grid.ColumnModel({defaults:{sortable:true},columns:[
            {header:Explore.i18n("Score"),dataIndex:"script_score",width:75},
            {header:Explore.i18n("AgentName"),dataIndex:"agent_name",width:140},
            {header:Explore.i18n("GroupName"),dataIndex:"group_name",width:140},
            {header:Explore.i18n("DateTime"),dataIndex:"date_time",renderer:a.simpleDateColRenderer,width:150},
            {header:Explore.i18n("Duration"),dataIndex:"duration",width:65},
            {header:Explore.i18n("Holds"),dataIndex:"num_holds",width:65},
            {header:Explore.i18n("ANI"),dataIndex:"ani",width:70},
            {header:Explore.i18n("DNIS"),dataIndex:"dnis",width:70}
        ]})}
    ];
    Explore.view.ScriptAdherenceDetail.superclass.initComponent.apply(this, arguments);
    var b = a.getByItemId("grid");
    b.getSelectionModel().on("selectionchange", function() {
        var d = b.getSelectionModel().getSelections();
        var c = b.topToolbar.getByItemId("playBtn");
        if (d.length > 0) {
            c.enable()
        } else {
            c.disable()
        }
    }, this);
    b.on("rowdblclick", function(c, g, d) {
        var f = c.getStore().getAt(g);
        a.playSelectedFiles([f])
    })
},simpleDateColRenderer:function(f, b, a, g, d, c) {
    var e = Explore.formatDateByPref(f);
    return e
},convertRows:function(c) {
    var a = [];
    for (var b = 0; b < c.length; b++) {
        var d = c[b];
        a.push({id:d.data.id,type:"Recordings",token:d.data.token,matchTerms:null,fields:{title:Explore.i18n("ScriptAdherenceScore_") + d.data.script_score}})
    }
    return a
},playSelectedFiles:function(d) {
    var a = this;
    var b = a.getByItemId("grid");
    var c = b.getStore().getRange();
    var e = b.getStore().indexOf(d[0]);
    Explore.SearchResults.openSearchResults(a.convertRows(d), a.convertRows(c), e, null, null, true)
},displayObject:function(b) {
    Explore.view.ScriptAdherenceDetail.superclass.displayObject.call(this, b);
    var a = this;
    if (b && b.Id > 0) {
        Explore.data.ScriptAdherenceDataStore.getScriptResults(b.Id, function(c) {
            var d = a.getByItemId("grid");
            d.getStore().loadData(c)
        })
    }
},getButtonsConfig:function() {
    var a = this;
    var b = [
        {xtype:"button",itemId:"newButton",iconCls:"new-icon",text:Explore.i18n("New"),tooltip:String.format(Explore.i18n("CreateANew_"), this.itemDescription),handler:function() {
            a.fireEvent("newItem")
        }},
        {xtype:"button",itemId:"editButton",iconCls:"edit-icon",text:Explore.i18n("View"),tooltip:String.format(Explore.i18n("View_"), this.itemDescription),disabled:true,handler:function() {
            a.fireEvent("editItem", a.currentObject)
        }},
        {xtype:"button",itemId:"deleteButton",iconCls:"delete-icon",text:Explore.i18n("Delete"),tooltip:String.format(Explore.i18n("Delete_"), this.itemDescription),disabled:true,handler:function() {
            a.fireEvent("deleteItem", a.currentObject)
        }}
    ];
    return b
}});
Ext.reg("explore.view.scriptadherencedetail", Explore.view.ScriptAdherenceDetail);
Ext.ns("Explore.view");
Explore.view.ScriptDefinitionDialog = Ext.extend(Explore.base.EditorDialog, {itemDescription:Explore.i18n("Script"),height:550,width:750,initComponent:function() {
    var a = this;
    a.dateFormat = Explore.getDateFormatByPref({ignoreTime:true});
    a.formItems = [
        {name:"Name",allowBlank:false,width:550,maxLength:60},
        {xtype:a.readOnly ? "displayfield" : "textarea",label:Explore.i18n("ScriptText"),name:"ScriptText",allowBlank:false,width:550,height:80},
        {name:"TargetScore",xtype:a.readOnly ? "displayfield" : "selectboxfield",label:Explore.i18n("Quality"),width:120,allowBlank:false,valueField:"Id",displayField:"Name",store:new Ext.data.ArrayStore({fields:["Id","Name"],data:[
            [10,"10%"],
            [15,"15%"],
            [20,"20%"],
            [25,"25%"],
            [30,"30%"],
            [35,"35%"],
            [40,"40%"],
            [45,"45%"],
            [50,"50%"],
            [55,"55%"],
            [60,"60%"],
            [65,"65%"],
            [70,"70%"],
            [75,"75%"],
            [80,"80%"],
            [85,"85%"],
            [90,"90%"],
            [95,"95%"],
            [100,"100%"]
        ]})},
        {xtype:"container",layout:{type:"hbox",align:"stretch"},anchor:"100%",height:65,items:[
            {xtype:"container",layout:"form",flex:1,items:[
                {name:"FromDate",itemId:"FromDate",xtype:a.readOnly ? "displayfield" : "datefield",fieldLabel:Explore.i18n("ScriptStart"),width:160,format:a.dateFormat,altFormats:a.dateFormat},
                {name:"Language",xtype:a.readOnly ? "displayfield" : "selectboxfield",fieldLabel:Explore.i18n("Language"),width:120,allowBlank:false,valueField:"Key",displayField:"Value",store:new Ext.data.JsonStore({fields:["Key","Value"],data:[]}),listeners:{afterrender:function(b) {
                    var d = Explore.data.IDOLDataStore.getAllLanguages();
                    if (b.xtype === "selectboxfield") {
                        b.getStore().loadData(d);
                        b.setValue(b.getValue())
                    } else {
                        var e = b.getValue();
                        for (var c = 0; c < d.length;
                             c++) {
                            if (d[c].Key === e) {
                                b.setValue(d[c].Value);
                                break
                            }
                        }
                    }
                }}}
            ]},
            {xtype:"container",layout:"form",flex:1,items:[
                {name:"ToDate",itemId:"ToDate",xtype:a.readOnly ? "displayfield" : "datefield",fieldLabel:Explore.i18n("ScriptEnd"),width:160,format:a.dateFormat,altFormats:a.dateFormat},
                {name:"Speaker",xtype:a.readOnly ? "displayfield" : "selectboxfield",fieldLabel:Explore.i18n("Speaker"),width:120,allowBlank:false,valueField:"Id",displayField:"Name",store:new Ext.data.ArrayStore({fields:["Id","Name"],data:[
                    [Explore.model.SpeakerTypes.Either,Explore.i18n("Either")],
                    [Explore.model.SpeakerTypes.Agent,Explore.i18n("Agent")],
                    [Explore.model.SpeakerTypes.Caller,Explore.i18n("Caller")]
                ]}),listeners:{afterrender:function(b) {
                    if (b.xtype === "displayfield") {
                        var c = Explore.i18n(Explore.model.SpeakerTypes.getName(b.getValue()));
                        b.setValue(c)
                    }
                }}}
            ]}
        ]},
        {xtype:"panel",itemId:"additionalCriteriaPanel",border:true,layout:{type:"hbox",align:"stretch"},anchor:"100%",height:130,padding:10,tbar:{items:[
            {xtype:"label",html:Explore.i18n("ApplyToRecordingsMatching") + "&nbsp;"},
            this.getCombineComponent(),
            {xtype:"label",html:"&nbsp;" + Explore.i18n("ofTheFollowingCriteria")}
        ]},items:[
            {xtype:"container",layout:"form",flex:1,labelWidth:120,items:[
                {xtype:a.readOnly ? "displayfield" : "textfield",fieldLabel:Explore.i18n("AgentName"),name:"AgentName",width:150},
                {xtype:a.readOnly ? "displayfield" : "textfield",fieldLabel:Explore.i18n("Group"),name:"Group",width:150},
                {name:"TagId",xtype:a.readOnly ? "displayfield" : "selectboxfield",fieldLabel:Explore.i18n("Tag"),width:150,listWidth:200,valueField:"Id",displayField:"TagName",store:new Ext.data.JsonStore({fields:["Id","TagName"],data:[]}),listeners:{afterrender:function(b) {
                    Explore.data.MetaDataStore.getTags(function(c) {
                        if (b.xtype === "selectboxfield") {
                            b.getStore().loadData(c);
                            b.setValue(b.getValue())
                        } else {
                            var e = parseInt(b.getValue(), 10);
                            for (var d = 0; d < c.length; d++) {
                                if (c[d].Id === e) {
                                    b.setValue(c[d].TagName);
                                    break
                                }
                            }
                        }
                    })
                }}}
            ]},
            {xtype:"container",layout:"form",flex:1,labelWidth:120,items:[
                {xtype:a.readOnly ? "displayfield" : "textfield",fieldLabel:Explore.i18n("ANI"),name:"ANI",width:130},
                {xtype:a.readOnly ? "displayfield" : "textfield",fieldLabel:Explore.i18n("DNIS"),name:"DNIS",width:130}
            ]}
        ]}
    ];
    Explore.view.ScriptDefinitionDialog.superclass.initComponent.apply(this, arguments)
},getCombineComponent:function() {
    var b = this;
    var a;
    if (!b.readOnly) {
        a = {xtype:"selectboxfield",name:"CriteriaCombine",itemId:"CriteriaCombine",width:50,allowBlank:false,valueField:"Id",displayField:"Name",value:0,store:new Ext.data.ArrayStore({fields:["Id","Name"],data:[
            [Explore.model.CriteriaCombine.All,Explore.i18n("all")],
            [Explore.model.CriteriaCombine.Any,Explore.i18n("any")]
        ]})}
    } else {
        a = {xtype:"label",text:Explore.i18n(Explore.model.CriteriaCombine.getName(b.editObject.CriteriaCombine)).toLocaleUpperCase()}
    }
    return a
},displayObject:function() {
    Explore.view.ScriptDefinitionDialog.superclass.displayObject.call(this);
    var b = this.getByItemId("FromDate");
    var a = this.getByItemId("ToDate");
    b.setValue(Explore.formatDate(this.editObject.FromDate, this.dateFormat));
    a.setValue(Explore.formatDate(this.editObject.ToDate, this.dateFormat))
},populateObject:function() {
    Explore.view.ScriptDefinitionDialog.superclass.populateObject.call(this);
    var a = this.getByItemId("additionalCriteriaPanel");
    this.editObject.CriteriaCombine = a.topToolbar.getByItemId("CriteriaCombine").getValue()
}});
Ext.ns("Explore.view");
Explore.view.SearchCollections = Ext.extend(Ext.Panel, {hideTopics:false,hideRecentSearch:false,saveDimensionState:true,initComponent:function() {
    var c = ["searchClick","contextMenuChange"];
    var a = this;
    a.addEvents(c);
    a.enableBubble(c);
    var d = [];
    if (!a.hideTopics) {
        d.push({xtype:"explore.view.topicpicker",itemId:"topics",title:Explore.i18n("Topics"),checkable:false,showTools:Explore.Security.isAuthorized("TOPICS_MY_CREATE"),margins:"0",border:false,listeners:{click:function(e) {
            if (e.attributes.tag.type == "TOPIC") {
                a.fireEvent("topicClick", e.id, e.text)
            }
        }}})
    }
    d.push({xtype:"explore.view.savedsearches",itemId:"savedSearches",margins:"0",border:false,showTools:true,listeners:{click:function(e) {
        a.clearSelectedSearches();
        a.fireEvent("searchClick", e.attributes.tag, e.text, Explore.model.ASType.SavedSearch)
    },contextmenu:function(f, g) {
        a.fireEvent("contextMenuChange", f.getOwnerTree().contextMenu);
        f.select();
        var h = f.getOwnerTree().contextMenu;
        contextNode = f;
        h.showAt(g.getXY())
    }}});
    if (!a.hideRecentSearch) {
        d.push({xtype:"explore.view.recentsearches",itemId:"recentSearches",margins:"0",border:false,showTools:true,listeners:{click:function(e) {
            a.clearSelectedSearches();
            a.fireEvent("searchClick", e.attributes.tag, e.text, Explore.model.ASType.RecentSearch)
        }}})
    }
    var b = {title:Explore.i18n("SearchCollections"),split:true,width:200,minSize:175,maxSize:400,collapsible:true,margins:"0 0 0 5",xtype:"container",layout:{type:"accordion",animate:true},defaults:{baseCls:"x-sidepanel"},items:d};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.SearchCollections.superclass.initComponent.apply(this, arguments)
},clearSelectedSearches:function() {
    var c = this.getByItemId("topics");
    if (c) {
        c.getSelectionModel().clearSelections()
    }
    var b = this.getByItemId("savedSearches");
    if (b) {
        b.getSelectionModel().clearSelections()
    }
    var a = this.getByItemId("recentSearches");
    if (a) {
        a.getSelectionModel().clearSelections()
    }
}});
Ext.reg("explore.view.searchcollections", Explore.view.SearchCollections);
Ext.ns("Explore.view");
Explore.view.SearchCriteriaSummaryLink = Ext.extend(Ext.BoxComponent, {readOnly:true,searchCriteria:null,initComponent:function() {
    var a = this;
    var c = Ext.apply({saveButtonText:Explore.i18n("Ok"),bypassDirtyCheck:true,showName:false,showSearchTerms:true,readOnly:a.readOnly}, this.searchDialogConfig);
    var b = {autoEl:{tag:a.readOnly ? "div" : "a",href:"#"}};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.SearchCriteriaSummaryLink.superclass.initComponent.apply(this, arguments);
    a.on("afterrender", function(d) {
        a.linkEl = d.getEl();
        if (!a.readOnly) {
            a.linkEl.on("click", function() {
                log.info("search criteria link clicked.");
                var f = a.searchCriteria || {};
                c.editObject = f;
                var e = new Explore.view.AdvancedSearchCriteriaDialog(c);
                e.on("save", function() {
                    a.dirty = true;
                    a.searchCriteria = f;
                    a.updateLinkText()
                });
                e.show();
                return false
            })
        }
        a.updateLinkText()
    })
},updateLinkText:function() {
    var a = Explore.utils.SearchCriteriaUtil.getSearchCriteriaDescription(this.searchCriteria);
    if (a == null) {
        if (!this.readOnly) {
            a = Explore.i18n("ClickToSetupSearchCriteria")
        } else {
            a = Explore.i18n("noSearchCriteria")
        }
    }
    if (this.linkEl !== undefined) {
        this.linkEl.update(a);
        if (this.ownerCt) {
            this.ownerCt.doLayout()
        }
    }
},isDirty:function() {
    return this.dirty ? true : false
},getValue:function() {
    return this.searchCriteria
},setValue:function(a) {
    this.searchCriteria = a;
    this.updateLinkText()
}});
Ext.reg("explore.view.searchcriteriasummarylink", Explore.view.SearchCriteriaSummaryLink);
Ext.ns("Explore.view");
Explore.view.SearchExpressionDialog = Ext.extend(Explore.base.EditorDialog, {itemDescription:"",readOnly:false,saveButtonText:Explore.i18n("Create Expression"),height:300,width:600,labelWidth:230,stateful:true,stateId:"searchExpressionDialog",initComponent:function() {
    var a = this;
    a.formItems = [
        {xtype:"textfield",itemId:"anySearchTerms",fieldLabel:Explore.i18n("With <b>AT LEAST ONE</b> of the terms:")},
        {xtype:"textfield",itemId:"allSearchTerms",fieldLabel:Explore.i18n("With <b>ALL</b> the terms:")},
        {xtype:"textfield",itemId:"exactSearchTerms",fieldLabel:Explore.i18n("With the <b>EXACT PHRASE</b>:")},
        {xtype:"textfield",itemId:"notSearchTerms",fieldLabel:Explore.i18n("<b>WITHOUT ALL</b> the terms:")}
    ];
    Explore.view.SearchExpressionDialog.superclass.initComponent.apply(this, arguments)
},constructSearchTerms:function() {
    var b = this;
    var a = {all:b.getByItemId("allSearchTerms").getValue().trim(),exact:b.getByItemId("exactSearchTerms").getValue().replace(/"/gi, "").trim(),any:b.getByItemId("anySearchTerms").getValue().trim(),not:b.getByItemId("notSearchTerms").getValue().trim()};
    var c = Explore.utils.SearchTermParser.reduceSearchTerms(a);
    return c
},getTitle:function() {
    return Explore.i18n("Search Expression Wizard")
},isValid:function() {
    var a = true;
    return a
},displayObject:function() {
    var a = this;
    var c = this.editObject;
    log.debug("Displaying search wizard", c);
    if (c) {
        var b = Explore.utils.SearchTermParser.explodeSearchTerms(c);
        a.getByItemId("allSearchTerms").setValue(b.all);
        a.getByItemId("exactSearchTerms").setValue(b.exact);
        a.getByItemId("anySearchTerms").setValue(b.any);
        a.getByItemId("notSearchTerms").setValue(b.not)
    }
},populateObject:function() {
    var a = this;
    this.editObject = this.constructSearchTerms()
}});
Ext.ns("Explore.view");
Explore.view.SearchHeader = Ext.extend(Ext.Container, {initComponent:function() {
    var b = this;
    var g = {itemId:"searchText",margins:"0 5 2 0",xtype:"textfield",height:20,border:false,emptyText:"(" + Explore.i18n("enterSearchText") + ")",enableKeyEvents:true,flex:1,vtype:"searchTerms",listeners:{keypress:function(j, k) {
        if (k.getKey() == k.RETURN || k.getKey() == k.ENTER) {
            k.stopEvent()
        }
    },keyup:function(j, k) {
        var m = j.getValue();
        var l = (m === "");
        b.getByItemId("searchHeaderSearchButton").setDisabled(l);
        b.getByItemId("searchHeaderBroadCastButton").setDisabled(l);
        if (k.getKey() == k.RETURN || k.getKey() == k.ENTER) {
            if (!l && j.isValid()) {
                b.fireEvent("doTextSearch")
            }
        }
    }}};
    var h = {itemId:"searchHeaderSearchButton",border:false,xtype:"button",iconCls:"buttonSearch",disabled:true,tooltip:Explore.i18n("linkTooltipSearchResultsIcon"),handler:function() {
        if (b.getByItemId("searchText").isValid()) {
            b.fireEvent("doTextSearch")
        }
    }};
    var d = {itemId:"searchHeaderBroadCastButton",border:false,xtype:"button",iconCls:"buttonBroadCast",disabled:true,hidden:!Explore.demoMode,tooltip:Explore.i18n("linkTooltipSearchBroadCastTerm"),handler:function() {
        b.fireEvent("broadCastAnalysis")
    }};
    var f = {itemId:"searchHeaderAddButton",border:false,xtype:"button",iconCls:"buttonSearchAdd",disabled:true,tooltip:Explore.i18n("linkTooltipSearchAddTerm"),handler:function() {
        b.fireEvent("addSearchTerm")
    }};
    var e = {itemId:"searchHeaderClearButton",border:false,xtype:"button",iconCls:"buttonSearchClear",disabled:true,tooltip:Explore.i18n("linkTooltipAdvancedSearchClear"),handler:function() {
        b.fireEvent("clearSearch")
    }};
    var a = {border:false,xtype:"button",iconCls:"buttonAdvancedSearch",tooltip:Explore.i18n("linkTooltipAdvancedSearch"),handler:function() {
        b.fireEvent("linkAdvancedSearchClick")
    }};
    var c = {style:{padding:"5px"},layout:{type:"hbox",pack:"start",align:"middle"},height:33,defaults:{margins:"0 5 0 0",height:20},items:[g,h,d,f,e,a]};
    Ext.apply(this, Ext.apply(this.initialConfig, c));
    Explore.view.SearchHeader.superclass.initComponent.apply(this, arguments)
},getSearchTerms:function() {
    var a = this.getByItemId("searchText");
    return a.getValue()
},setSearchTerms:function(b) {
    var a = this.getByItemId("searchText");
    a.setValue(b);
    this.getByItemId("searchHeaderSearchButton").setDisabled(b == "");
    this.getByItemId("searchHeaderBroadCastButton").setDisabled(b == "")
},setAddButtonEnabled:function(a) {
    var b = this.getByItemId("searchHeaderAddButton");
    b.setDisabled(!a)
},setClearButtonEnabled:function(a) {
    var b = this.getByItemId("searchHeaderClearButton");
    b.setDisabled(!a)
}});
Ext.reg("explore.view.searchheader", Explore.view.SearchHeader);
Ext.ns("Explore.view");
Explore.view.SearchOnSimilarArticlesDialog = Ext.extend(Explore.base.EditorDialog, {editObject:{},readOnly:false,saveButtonText:Explore.i18n("Ok"),height:400,width:300,initComponent:function() {
    var a = this;
    a.formItems = [];
    a.formItems.push({xtype:"container",layout:"fit",width:"100%",height:310,items:[
        {xtype:"explore.view.filetypepanel",layout:"fit",name:"DocTypes",itemId:"docTypePanel",flex:1,margins:"0 0 20 0",docTypes:this.editObject,checkall:true}
    ]});
    Explore.view.SearchOnSimilarArticlesDialog.superclass.initComponent.apply(this, arguments)
},displayObject:function() {
    Explore.view.SearchOnSimilarArticlesDialog.superclass.displayObject.call(this);
    var a = this
},populateObject:function() {
    Explore.view.SearchOnSimilarArticlesDialog.superclass.populateObject.call(this);
    var a = this;
    var b = a.getByItemId("fileTypeChecks");
    if (b) {
        this.editObject = b.getValue()
    }
}});
Ext.ns("Explore.view");
Explore.view.SearchPanel = Ext.extend(Ext.Panel, {layout:"border",border:false,flex:1,initComponent:function() {
    var b = this;
    var c = b.searchPresenter = new Explore.presenter.SearchPresenter(b);
    this.gridType = Explore.data.PreferenceDataStore.getGridType();
    this.hidden = !Explore.Security.isAuthorized("SEARCH");
    this.items = [
        {region:"north",itemId:"searchHeader",xtype:"explore.view.searchheader",border:false,listeners:{linkAdvancedSearchClick:function() {
            c.onAdvancedSearchClick()
        },doTextSearch:function() {
            var f = b.getByItemId("searchHeader");
            var e = f.getByItemId("searchText");
            var d = e.getValue();
            c.searchByText(d)
        },addSearchTerm:function() {
            Ext.MessageBox.prompt(Explore.i18n("AddSearchTerm"), Explore.i18n("Term"), function(d, e) {
                if (d === "ok" && e !== "") {
                    c.quickSearch(e)
                }
            })
        },clearSearch:function() {
            c.onClearSearch()
        },broadCastAnalysis:function() {
            var f = b.getByItemId("searchHeader");
            var e = f.getByItemId("searchText");
            var d = e.getValue();
            c.onBroadCastAnalysis(d)
        }}},
        {region:"west",itemId:"searchCollections",xtype:"explore.view.searchcollections",stateful:true,stateId:"search-searchCollections",saveDimensionState:true,listeners:{searchClick:function(f, d, e) {
            b.searchPresenter.searchById(f, d, e)
        },topicClick:function(e, d) {
            b.searchPresenter.searchByTopic(e, d)
        }}},
        {region:"east",title:Explore.i18n("ResultsTools"),itemId:"resultsTools",stateful:true,stateId:"search-resultsTools",saveDimensionState:true,hidden:true,collapsible:true,split:true,width:225,minSize:175,maxSize:400,margins:"0 5 0 0",layout:"border",items:[
            {xtype:"explore.view.common.relatedconceptviews",itemId:"relatedConceptsViews",autoScroll:true,region:"north",height:160,minSize:10,maxSize:400,split:true,border:false,relatedTermsAction:Explore.data.PreferenceDataStore.getRelatedTermsAction(),listeners:{relatedConceptClick:function(d) {
                c.onRelatedConcept(d)
            },cloudItemClick:function(d) {
                c.onRelatedConcept([d.term])
            }}},
            {xtype:"explore.view.filteroptions",itemId:"filterOptions",region:"center",title:Explore.i18n("Filter"),border:false,autoScroll:true,listeners:{filterDateClick:function(d) {
                b.searchPresenter.addResultsDateFilter(d.fromDate, d.toDate, d.allowDrill)
            },searchFilterChange:function(e) {
                for (var d = 0; d < e.length; ++d) {
                    c.onSearchFilterChange(e[d], d < (e.length - 1))
                }
            }}}
        ]},
        {region:"center",layout:{type:"vbox",align:"stretch"},border:true,items:[
            {itemId:"searchToolbarPanel",xtype:"explore.view.searchtoolbarpanel",gridType:this.gridType,listeners:{toggleGridType:function(f) {
                var e = b.getByItemId("conciseSearchGrid");
                var d = (e.getGridType() == Explore.model.GridType.Concise) ? Explore.model.GridType.Compact : Explore.model.GridType.Concise;
                e.setGridType(d);
                b.getByItemId("searchToolbarPanel").setGridTypeButton(d);
                Explore.data.PreferenceDataStore.setGridType(d);
                Explore.data.PreferenceDataStore.save()
            },searchFilterChange:function(d) {
                c.onSearchFilterChange(d)
            },searchFilterPinToggle:function(d) {
                c.onSearchFilterPinToggle(d.filter)
            },searchFilterRemove:function(d) {
                c.onSearchFilterRemove(d.filter)
            },toolbarOpen:function() {
                c.onGridOpenRows()
            },toolbarFavorite:function() {
                c.onAddFavorite()
            },toolbarTag:function() {
                c.onAddTag()
            },toolbarClassify:function() {
                c.onClassify()
            },analyze:function(d) {
                c.analyze(d)
            },topTerms:function() {
                var d = new Explore.view.TopTermsDialog({searchCriteria:c.getCurrentSearchCriteria()});
                d.show()
            },toolbarReport:function(d) {
                c.onReport(null, d ? d.reportSettings : null)
            },toolbarExportResults:function() {
                var d = new Explore.view.SearchResultExportDialog({listeners:{download:function(e, f, g) {
                    c.onExportResults(e, f, g)
                }}});
                d.show()
            },toolbarTakeSnapshot:function() {
                var d = new Explore.view.SnapshotEditDialog({editObject:{},listeners:{save:function(f, g) {
                    c.onTakeSnapshot(f, g.Name, g.Description)
                }}});
                d.show()
            },toolbarAutomation:function() {
                c.onCreateAutomationRule()
            },toolbarShowHide:function() {
                b.hideResults()
            },toolbarSave:function() {
                c.saveSearch()
            }}},
            {itemId:"conciseSearchGrid",xtype:"explore.view.conciseSearchGrid",flex:1,pageSize:c.pageSize,gridType:this.gridType,listeners:{rowSelected:function(d) {
                c.onRowSelected(d)
            },gridContextOpen:function() {
                c.onGridOpenRows()
            },rowDoubleClick:function(e, d) {
                c.onGridRowDoubleClick(e, d)
            },storeBeforeLoad:function(d, e) {
                c.gridStoreBeforeLoad(d, e)
            },gridContextFavorite:function() {
                c.onAddFavorite()
            },gridContextTag:function() {
                c.onAddTag()
            },gridContextClassify:function() {
                c.onClassify()
            },gridContextEditSentiment:function() {
                var d = b.getSelectedRowObjects();
                var f = new Explore.view.SentimentOptionsDialog({});
                var e = null;
                if (d && d.length === 1 && d[0].fields) {
                    e = (d[0].fields.sentiment) ? d[0].fields.sentiment : null
                }
                f.setCurrentSentiment(e);
                f.setSelectedRowObjects(d);
                f.show()
            },gridContextHideResults:function() {
                b.hideResults()
            },gridContextWorkflow:function() {
            }}}
        ]}
    ];
    Explore.view.SearchPanel.superclass.initComponent.call(this, arguments);
    var a;
    b.getSearchPresenter().on("newSearchCompleted", function(g, f) {
        b.getLastRefreshLabel().setText(Explore.formatDateByPref(new Date()));
        var e = Explore.data.PreferenceDataStore.getSearchAutoRefreshIntervalPreference();
        if (e) {
            var h = b.getSearchPresenter();
            var d = new Ext.util.DelayedTask(function() {
                if (Ext.getCmp("mainTabPanel").layout.activeItem.id === "app-search") {
                    h.searchByCriteria(g, f)
                } else {
                    b.on("afterlayout", function() {
                        h.searchByCriteria(g, f)
                    }, b, {single:true})
                }
            });
            if (a) {
                a.cancel()
            }
            a = d;
            d.delay(1000 * 60 * e)
        }
    });
    b.getSearchPresenter().on("searchCleared", function() {
        if (a) {
            a.cancel()
        }
        b.getLastRefreshLabel().setText("N/A")
    })
},getLastRefreshLabel:function() {
    var a = this.getByItemId("conciseSearchGrid"),c = a._pagingToolbar,b = c.getByItemId("lastRefreshed");
    return b
},hideResults:function() {
    var c = this.getByItemId("conciseSearchGrid");
    var d = c.getSelectedRows();
    var a = new Array();
    for (var b = 0; b < d.length; b++) {
        Explore.data.HiddenResultsDataStore.addToHiddenList(d[b].id);
        a.push(d[b].id)
    }
    Explore.data.IDOLDataStore.setDocumentVisibility(true, a);
    this.searchPresenter.refreshGrid()
},getSearchTerms:function() {
    var a = this.getByItemId("searchHeader");
    return a.getSearchTerms()
},setSearchTerms:function(b) {
    var a = this.getByItemId("searchHeader");
    a.setSearchTerms(b)
},setRefineResults:function(b) {
    var a = Ext.get("refineResults");
    if (a) {
        a.setValue(b)
    }
},setHeaderAddButtonEnabled:function(a) {
    var b = this.getByItemId("searchHeader");
    b.setAddButtonEnabled(a)
},setHeaderClearButtonEnabled:function(a) {
    var b = this.getByItemId("searchHeader");
    b.setClearButtonEnabled(a)
},setTopToolbarVisible:function(b) {
    var a = this.getByItemId("searchToolbarPanel");
    a.setTopToolbarVisible(b)
},setCountsByTypes:function(d) {
    if (!d) {
        return
    }
    var e = this.getByItemId("searchToolbarPanel");
    var b = this;
    e.disable();
    var f = b.getByItemId("filterOptions");
    var a = null;
    var c = f.getEl();
    if (c) {
        a = new Ext.LoadMask(c, {msg:"Loading filter types"});
        a.show()
    }
    e.removeTip();
    e.getByItemId("searchToolbarResultsLabel").setText("Loading...");
    Explore.data.ProjectDataStore.getProject(d.searchInfo.projectId, function(g) {
        e.removeTip();
        if (a) {
            a.hide()
        }
        e.enable();
        var h = (g != null) ? g.Documents : 0;
        d.projectDocumentsCount = h;
        e.setCountsByTypes(d);
        f.loadFilterOptionsDocCounts(d)
    })
},setToolbarRowButtonsEnabled:function(a, b) {
    var c = this.getByItemId("searchToolbarPanel");
    c.setRowButtonsEnabled(a, b)
},loadData:function(a) {
    var b = this.getByItemId("conciseSearchGrid");
    b.showData(a)
},showResultsTools:function(a) {
    var b = this.getByItemId("resultsTools");
    b.setVisible(a);
    this.doLayout()
},getSelectedRowObjects:function() {
    var a = this.getSelectedRows();
    return Explore.SearchResults.getObjectsFromRows(a)
},getSelectedRows:function() {
    var a = this.getByItemId("conciseSearchGrid");
    return a.getSelectedRows()
},getAllRows:function() {
    var a = this.getByItemId("conciseSearchGrid");
    return a.getAllRows()
},getIndexOfRow:function(b) {
    var a = this.getByItemId("conciseSearchGrid");
    return a.getIndexOfRow(b)
},clearSearch:function() {
    var b = this.getByItemId("conciseSearchGrid");
    b.clearSearch();
    var a = this.getByItemId("searchCollections");
    a.clearSelectedSearches()
},setSearchFilters:function(a) {
    var b = this.getByItemId("searchToolbarPanel");
    b.setSearchFilters(a)
},showAdvancedSearchDialog:function(a, c) {
    var b = new Explore.view.AdvancedSearchCriteriaDialog({title:Explore.i18n("AdvancedSearch"),saveButtonText:Explore.i18n("Ok"),bypassDirtyCheck:true,showName:false,showSearchTerms:true,editObject:a});
    b.on("save", function() {
        if (c) {
            c()
        }
    });
    b.show()
},getSearchPresenter:function() {
    return this.searchPresenter
},clearRelatedConcepts:function() {
    var a = this.getByItemId("relatedConceptsViews");
    if (a !== null) {
        a.clearConcepts()
    }
},showRelatedConcepts:function(c, b) {
    var a = this.getByItemId("relatedConceptsViews");
    if (a !== null) {
        a.showConcepts(c, b)
    }
},showCloudData:function(b) {
    var a = this.getByItemId("relatedConceptsViews");
    if (a !== null) {
        a.setDataItems(b)
    }
},exportResults:function(a) {
    Explore.utils.Exporter.exportToXml(a)
}});
Ext.reg("explore.view.searchpanel", Explore.view.SearchPanel);
Ext.ns("Explore.view");
Explore.view.SearchResultDetailDialog = Ext.extend(Ext.Window, {stateful:true,stateId:"SearchResultDetailDialog",startIndex:0,results:null,pagingInfo:null,searchCriteria:null,getDocumentBodyFn:null,template:new Ext.XTemplate('<div class="search-result">', "{image}", '<div class="sentiment-{sentiment}">{sentiment} {this.strings.sentiment}</div>', '<tpl if="isFacebook">', '<div class="msg_type-{msg_type}">{this.strings.postType} {msg_type}</div>', "</tpl>", '<tpl if="tag != \'\'"><div class="search-result-hdr">{this.strings.taggedWith} <span class="tags">{tag}</span></div></tpl>', "<h1>{headerHtml}</h1>", '<div class="search-result-hdr"><tpl if="from != \'\'">{this.strings.by} <span class="author">{from}</span> </tpl>', '(<span class="type">{type}</span> <img src="../resources/images/icons/icn_multichannel_{type}_16.png" alt="{type}" style="vertical-align: middle" />) ', "{this.strings.on} {date} {this.strings.at} {time}</div><br/>", '<div class="search-result-clear"></div>', '<tpl if="isMicromedia">', '<div class="search-result-followers"><span><b>{following}</b> {this.strings.following}</span><span><b>{followers}</b> {this.strings.followers}</span><span><b>{updates}</b> {this.strings.updates}</span></div><br/>', "</tpl>", '<tpl if="isFacebook">', '<div class="search-result-facebook"><span></span></div>', "</tpl>", '<tpl if="detailFields.length != 0">', '<div class="search-result-details">', '<tpl for="detailFields"><span><b>{Name}:</b> {Value}</span><br /></tpl>', "</div>", "</tpl>", '<div class="search-result-body">{bodyHtml}</div>', '<tpl if="articleUrl"><div class="search-result-link"><a href="{articleUrl}" target="_blank">{this.strings.viewSource}</a></div></tpl>', '<div class="search-result-hyperlinking-hdr" style="display:none"><b>{this.strings.similarArticles}</b>&nbsp; {this.strings.followingArticles} &nbsp; <br/> <a class="searchcriteria" href="#"> <font size="2">Choose Document Types</font> </a> </div>', '<div class="search-result-hyperlinking-body" style="display:none"></div>', "</div>", {strings:{sentiment:Explore.i18n("Sentiment").toUpperCase(),taggedWith:Explore.i18n("taggedWith"),by:Explore.i18n("by"),on:Explore.i18n("on"),at:Explore.i18n("at"),following:Explore.i18n("Following"),followers:Explore.i18n("Followers"),updates:Explore.i18n("Updates"),viewSource:Explore.i18n("viewSource"),similarArticles:Explore.i18n("similarArticles"),followingArticles:Explore.i18n("followingArticles"),postType:Explore.i18n("PostType")}}),initComponent:function() {
    var b = this;
    this.currentIndex = this.startIndex;
    this.history = [];
    this.docTypeConfigs = Explore.data.IDOLDataStore.getDocumentTypeConfigs();
    this.docTypesForRelatedItems = [];
    this.updateCounts();
    var a = 650;
    var g = Ext.getBody().getHeight();
    a = Math.min(a, g);
    var d = 900;
    var f = Ext.getBody().getWidth();
    d = Math.min(d, f);
    this.showSentiment = Explore.data.PreferenceDataStore.getShowSentimentPreference();
    if (this.showSentiment) {
        this.template.strings.sentiment = Explore.i18n("Sentiment").toUpperCase()
    } else {
        this.template.strings.sentiment = ""
    }
    var e = [
        {key:Ext.EventObject.F2,ctrl:true,fn:function() {
            b.getAdvancedSearchResultExport()
        }}
    ];
    var c = {layout:"card",height:a,width:d,modal:true,constrain:true,title:b.getTitleForCurrentResult(),keys:[
        {key:Ext.EventObject.F2,fn:function() {
            b.getAdvancedSearchResultExport()
        }}
    ],cls:"white-bg-dialog",items:[
        {itemId:"mainPanel",xtype:"box",cls:"search-result-window-box-autoscroll",listeners:{afterrender:function(h) {
            b.updatePanelHtml()
        }}},
        {itemId:"recordingPanel",xtype:"box",autoEl:{tag:"iframe",cls:"recording-iframe",frameborder:"0"},listeners:{afterrender:function(h) {
            b.displayRecording()
        }}},
        {itemId:"twitterMediaPanel",xtype:"explore.view.searchresultdetail.twitterdetailresultpanel",getDocumentBodyFn:this.getDocumentBodyFn,listeners:{doneretrievingdocuments:function(j) {
            var h = b.getByItemId("twitterMediaPanel");
            if (h) {
                h.doLayout()
            }
        },afterrender:function(h) {
            b.displayTwitterMedia()
        },relateddocumentclicked:function(j, k, h) {
            b.saveHistory();
            b.results = k;
            b.pagingInfo = null;
            b.currentIndex = h;
            b.updateCounts();
            b.updateUI()
        }}}
    ],buttonAlign:"left",fbar:[
        {itemId:"buttonWorkflow",hidden:!Explore.demoMode,xtype:"button",text:Explore.i18n("Workflow"),tooltip:Explore.i18n("OpenTeamSiteWorkflow"),handler:function() {
            var h = new Explore.view.SearchResultWorkflowDialog({currentSelectedRow:b.getCurrentRow()});
            h.show()
        }},
        {xtype:"button",itemId:"idButtonSentiment",hidden:false,text:Explore.i18n("Sentiment") + "...",iconCls:"",disabled:this.disableSentiment(),tooltip:Explore.i18n("EditTheSentimentOfThisResult"),handler:function() {
            log.info("SearchResultDetailDialog.Sentiment: currentIndex ", b.currentIndex);
            var k = b.getCurrentRow();
            var h = (k && k.fields) ? k.fields.sentiment : null;
            var j = new Explore.view.SentimentOptionsDialog({listeners:{close:function() {
                if (!b.isRecording()) {
                    b.navigate(0)
                }
            }}});
            j.setCurrentSentiment(h);
            j.setSelectedRowObjects([k]);
            j.show()
        }},
        {itemId:"buttonTag",xtype:"button",iconCls:"iconTag",text:Explore.i18n("Tag_dots"),tooltip:Explore.i18n("AddAndRemoveTagsToThisResult"),disabled:!Explore.Security.isAuthorized("SEARCH_TAG"),handler:function() {
            log.info("SearchResultDetailDialog.TagResult: currentIndex ", b.currentIndex);
            var h = new Explore.view.TagsDialog({rowObjects:[b.getCurrentRow()],listeners:{close:function() {
                if (!b.isRecording()) {
                    b.navigate(0)
                }
            }}});
            h.show()
        }},
        {itemId:"buttonClassify",xtype:"button",iconCls:"iconTag",text:Explore.i18n("Classify_dots"),tooltip:Explore.i18n("AddAndRemoveClassificationsToThisResult"),disabled:!this.canClassifyRecording(),handler:function() {
            log.info("SearchResultDetailDialog.ClassifyResult: currentIndex ", b.currentIndex);
            var h = new Explore.view.ClassifyDialog({rowObjects:[b.getCurrentRow()],listeners:{close:function() {
            }}});
            h.show()
        }},
        {xtype:"button",itemId:"hideButton",iconCls:"iconHide",hidden:!Explore.enableHide,text:Explore.i18n("Hide"),tooltip:Explore.i18n("HideSelectedResultFromThisAndAllFutureSearchResults"),handler:function(j) {
            log.info("SearchResultDetailDialog.Hide: currentIndex ", b.currentIndex);
            var h = b.getCurrentRow().id;
            Explore.data.HiddenResultsDataStore.addToHiddenList(h);
            Explore.data.IDOLDataStore.setDocumentVisibility(true, [h]);
            b.navigate(1);
            b.fireEvent("hidden")
        }},
        "->",
        {itemId:"prevButton",iconCls:"x-tbar-page-prev",tooltip:Explore.i18n("PreviousResult"),disabled:b.isPrevDisabled(),handler:function() {
            b.navigate(-1)
        }},
        {itemId:"resultIndexLabel",xtype:"label",text:b.getResultIndexLabelText()},
        {itemId:"nextButton",iconCls:"x-tbar-page-next",tooltip:Explore.i18n("NextResult"),disabled:this.isNextDisabled(),handler:function() {
            b.navigate(1)
        }},
        {itemId:"closeButton",text:Explore.i18n("Close"),handler:function() {
            b.close()
        }}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, c));
    Explore.view.SearchResultDetailDialog.superclass.initComponent.apply(this, arguments)
},getAdvancedSearchResultExport:function() {
    var e = {PageNumber:1,PageSize:1,SortDirection:Explore.model.SortDirection.Descending,SortProperty:Explore.model.SortProperty.Weight};
    var c = {};
    c = Ext.apply(c, e);
    var d = {targetDocuments:[this.getCurrentRow().id],printOptions:Explore.model.PrintOptions.PrintAll};
    var b = {};
    b = Ext.apply(b, d);
    var a = {BypassDocCounts:true};
    Explore.data.IDOLDataStore.getAdvancedSearchResultsForExport(b, c, a, function(f) {
        Explore.utils.Exporter.exportTextToXml("text/xml", "Results.xml", f.XmlPayloadToString)
    })
},disableSentiment:function() {
    if (!(Explore.data.PreferenceDataStore.getShowSentimentPreference())) {
        return true
    } else {
        return !Explore.Security.isAuthorized("SEARCH_EDIT_SENTIMENT")
    }
},updateCounts:function() {
    var a = this;
    if (a.pagingInfo) {
        a.totalCount = a.pagingInfo.TotalCount;
        a.pageSize = a.pagingInfo.PageSize || 50;
        a.pageNumber = a.pagingInfo.PageNumber
    } else {
        a.totalCount = a.results.length;
        a.pageSize = a.results.length;
        a.pageNumber = 1
    }
},getCurrentRow:function() {
    return this.results[this.currentIndex]
},isRecording:function() {
    var a = this.getCurrentRow();
    return(a.type === "Recordings")
},isMicroMedia:function() {
    var a = this.getCurrentRow();
    return(a.type === "Micro Media")
},canClassifyRecording:function() {
    var a = this;
    if (a.isRecording()) {
        return Explore.Security.isAuthorized("SEARCH_CLASSIFY")
    } else {
        return false
    }
},displayTwitterMedia:function() {
    var a = this;
    var b = this.getCurrentRow();
    if (a.isMicroMedia()) {
        var c = a.getByItemId("twitterMediaPanel");
        a.getLayout().setActiveItem(c);
        c.processTwitterContent(b);
        a.fbar.getByItemId("idButtonSentiment").setVisible(!a.isMicroMedia());
        a.fbar.getByItemId("buttonTag").setVisible(!a.isMicroMedia());
        a.fbar.getByItemId("buttonClassify").setVisible(!a.isMicroMedia())
    }
},displayRecording:function() {
    var b = this;
    var c = this.getCurrentRow();
    if (b.isRecording()) {
        b.getLayout().setActiveItem(1);
        var a = new Ext.LoadMask(b.body);
        a.show();
        Explore.SearchResults.getPlayerUrl(c.token, c.matchTerms, function(d) {
            var e = b.getByItemId("recordingPanel").getEl().dom;
            if (d != null) {
                e.src = d
            } else {
                e.src = "Blank.htm"
            }
            a.hide()
        })
    }
},updatePanelHtml:function() {
    var a = this;
    var d = this.getCurrentRow();
    var f = this.displayObject = {};
    if (a.isRecording() || a.isMicroMedia()) {
        return
    }
    a.getLayout().setActiveItem(0);
    var c = a.getByItemId("mainPanel").el;
    var e = Explore.SearchResults.getBodyFieldsByType(d.type);
    var b = Explore.data.PreferenceDataStore.getSelectedHighlightingOption();
    a.docTypesForRelatedItems = [];
    function g(m) {
        if (m) {
            var p = m;
            f.type = d.type;
            f.date = Explore.formatDateByPref(d.date, {ignoreTime:true});
            f.time = Explore.formatTimeByPref(d.date);
            f.source = d.source;
            f.tag = d.tag;
            f.matchTerms = d.matchTerms;
            f.headerHtml = a.getTitleForCurrentResult();
            f.bodyHtml = "";
            f.from = p.author || p.teamMember || p.from || p.MAPISENDERNAME || "";
            f.sentiment = a.showSentiment ? p.sentiment : "";
            f.articleUrl = p.articleUrl;
            f.image = "";
            f.detailFields = [];
            f.isMicromedia = (d.type.toLowerCase() === "micro media");
            f.showReplyMicroMedia = f.isMicromedia;
            f.isFaceBook = (d.type.toLowerCase() === "facebook");
            var j = "<b>{0}</b>";
            if (f.isMicromedia) {
                if (p.followers && p.following && p.updates) {
                    f.isMicromedia = true;
                    f.isFacebook = false;
                    f.followers = p.followers || "N/A";
                    f.following = p.following || "N/A";
                    f.updates = p.updates;
                    f.image = '<img src="' + p.profileimage + '"style="display:none; padding-right:10px; max-height:64px; max-width:64px; float:left;" alt="' + p.author + '" onload="Explore.showLoadedImage(this)" />'
                } else {
                    f.isMicromedia = false;
                    f.isFacebook = false
                }
            } else {
                if (f.isFaceBook) {
                    f.isMicromedia = false;
                    f.isFacebook = true;
                    f.msg_type = p.msg_type || "undefined";
                    f.updates = p.updates;
                    f.date = String.format(j, f.date);
                    f.time = String.format(j, f.time);
                    var l = p.profileimage || "../resources/images/fbicon64x64.jpg";
                    f.image = '<img src="' + l + '"style="display:none; padding-right:10px; max-height:64px; max-width:64px; float:left;" alt="' + p.author + '" onload="Explore.showLoadedImage(this)" />'
                } else {
                    f.isMicromedia = false;
                    f.isFacebook = false
                }
            }
            var n;
            var q = a.docTypeConfigs[f.type];
            if (q != null && q.DetailFields != null) {
                for (n = 0;
                     n < q.DetailFields.length; n++) {
                    var h = q.DetailFields[n];
                    var o = {Name:h.Name,Value:p[h.Tag]};
                    if (o.Name !== null && o.Value !== undefined && o.Value !== null) {
                        f.detailFields.push(o)
                    }
                }
            }
            for (n = 0; n < e.length; n++) {
                var r = m[e[n]];
                if (r === null || r === undefined) {
                    r = ""
                }
                r = r.replace(/\n/g, "<br />");
                if (b === "HighlightTermsOnly" || b === "HilighTermAndMatchTerms") {
                    r = r.replace(/<explore_highlight>(.*?)<\/explore_highlight>/g, "<span class='highlight'>$1</span>")
                }
                r = Explore.SearchResults.createLinks(r);
                f.bodyHtml += (r + "<br />")
            }
        }
        a.template.overwrite(c, f);
        Explore.view.StatusBox.close();
        a.addSearchBasedOnDocType(c.query("a.searchcriteria")[0]);
        var k = [d.id];
        Explore.data.IDOLDataStore.getRelatedDocuments(k, null, null, function(t) {
            if (t.rows.length > 0) {
                var v = c.query(".search-result-hyperlinking-hdr")[0];
                var w = c.query(".search-result-hyperlinking-body")[0];
                if (!v || !w) {
                    return
                }
                v.style.display = "";
                w.style.display = "";
                var u = new Ext.XTemplate('<tpl for="rows"><div class="hyperlink-result">', '<img src="../resources/images/icons/icn_multichannel_{type}_16.png" alt="{type}" style="vertical-align: middle" />&nbsp;', '<a class="title" href="#">{[Explore.SearchResults.getTitleForRecord(values)]}</a>', "<br />&nbsp;{[Explore.SearchResults.getRelativeTime(values)]}</div></tpl>");
                u.overwrite(w, t);
                var s = c.query("a.title");
                for (n = 0; n < s.length; n++) {
                    a.addHyperlinkHandler(s[n], t.rows, n)
                }
            }
        })
    }

    if (d.fields.body) {
        g(d.fields)
    } else {
        if (typeof(this.getDocumentBodyFn) === "function") {
            Explore.view.StatusBox.showBusy(Explore.i18n("loadingDocument"), function() {
                log.info("SearchPresnter action canceled");
                options.isCanceled = true
            });
            this.getDocumentBodyFn(d.id, function(h) {
                g(h.rows[0].fields)
            })
        }
    }
},addSearchBasedOnDocType:function(b) {
    var a = this;
    Ext.fly(b).on("click", function(c) {
        var d = new Explore.view.SearchOnSimilarArticlesDialog({itemId:"_doctypes",title:Explore.i18n("ChooseDocumentTypes"),editObject:a.docTypesForRelatedItems});
        d.on("save", function(f, g) {
            a.docTypesForRelatedItems = g;
            var e = new Ext.LoadMask(a.body, {msg:"Loading..."});
            e.show();
            d.hide();
            a.applySearchBasedOnDocType(a.docTypesForRelatedItems);
            e.hide()
        });
        d.show()
    })
},applySearchBasedOnDocType:function(b) {
    var a = this;
    var d = a.getByItemId("mainPanel").el;
    var e = a.getCurrentRow();
    var c = new Ext.XTemplate('<tpl for="rows"><div class="hyperlink-result">', '<img src="../resources/images/icons/icn_multichannel_{type}_16.png" alt="{type}" style="vertical-align: middle" />&nbsp;', '<a class="title" href="#">{[Explore.SearchResults.getTitleForRecord(values)]}</a>', "<br />{[Explore.SearchResults.getRelativeTime(values)]}</div></tpl>");
    var f = [e.id];
    Explore.data.IDOLDataStore.getRelatedDocuments(f, b, function(j) {
        if (j.rows.length > 0) {
            var l = d.query(".search-result-hyperlinking-hdr")[0];
            var m = d.query(".search-result-hyperlinking-body")[0];
            if (!l || !m) {
                return
            }
            l.style.display = "";
            m.style.display = "";
            c.overwrite(m, j);
            var g = d.query("a.title");
            for (var k = 0; k < g.length; k++) {
                a.addHyperlinkHandler(g[k], j.rows, k)
            }
        } else {
            var h = d.query(".search-result-hyperlinking-body")[0];
            h.innerHTML = "No Similar Document(s) Found"
        }
    })
},addHyperlinkHandler:function(c, d, b) {
    var a = this;
    Ext.fly(c).on("click", function(f) {
        a.saveHistory();
        a.results = d;
        a.pagingInfo = null;
        a.currentIndex = b;
        a.updateCounts();
        a.updateUI();
        return false
    })
},getTitleForCurrentResult:function() {
    var a = this.getCurrentRow();
    var b = Explore.SearchResults.getTitleForRecord(a);
    return b
},getAbsoluteIndex:function() {
    var a = this;
    var b = ((a.pageNumber - 1) * a.pageSize) + a.currentIndex;
    return b
},getResultIndexLabelText:function() {
    return String.format(Explore.i18n("Result_Of_"), this.getAbsoluteIndex() + 1, this.totalCount)
},isPrevDisabled:function() {
    return(this.getAbsoluteIndex() == 0)
},isNextDisabled:function() {
    return(this.getAbsoluteIndex() + 1 >= this.totalCount)
},scrollToTop:function() {
    var a = Ext.query(".search-result-window-box-autoscroll")[0];
    a.scrollTop = 0
},saveHistory:function() {
    var a = this;
    a.history.push({results:a.results,currentIndex:a.currentIndex,pagingInfo:a.pagingInfo})
},updateUI:function() {
    var b = this;
    var c = b.fbar;
    if (b.isRecording()) {
        b.displayRecording()
    } else {
        if (b.isMicroMedia()) {
            b.displayTwitterMedia()
        } else {
            b.updatePanelHtml()
        }
    }
    var a = c.getByItemId("resultIndexLabel");
    a.setText(b.getResultIndexLabelText());
    c.getByItemId("prevButton").setDisabled(b.isPrevDisabled());
    c.getByItemId("nextButton").setDisabled(b.isNextDisabled());
    c.getByItemId("idButtonSentiment").setVisible(!b.isMicroMedia());
    c.getByItemId("buttonTag").setVisible(!b.isMicroMedia());
    c.getByItemId("buttonClassify").setVisible(!b.isMicroMedia());
    b.setTitle(b.getTitleForCurrentResult());
    b.scrollToTop()
},navigate:function(b) {
    var a = this;
    a.saveHistory();
    a.currentIndex += b;
    if (a.currentIndex < 0) {
        a.loadResults(-1)
    } else {
        if (a.currentIndex >= a.pageSize) {
            a.loadResults(+1)
        } else {
            a.updateUI()
        }
    }
},navigateBack:function() {
    var a = this;
    var b = a.history.pop();
    if (b) {
        a.results = b.results;
        a.currentIndex = b.currentIndex;
        a.pagingInfo = b.pagingInfo;
        a.updateCounts();
        a.updateUI()
    }
},loadResults:function(d) {
    var c = this;
    var a = false;
    var g = c.pageNumber + d;
    var f = c.currentIndex - (c.pageSize * d);
    c.pagingInfo.PageNumber = g;
    log.info("loadResults searchCriteria= ", c.searchCriteria, " _pagingCriteria=", c.pagingInfo);
    Explore.view.StatusBox.showBusy(Explore.i18n("LoadingResults"), function() {
        a = true
    });
    var e = {BypassDocCounts:true};
    var b = {PageNumber:g,PageSize:50,SortDirection:-1,SortProperty:12};
    Explore.data.IDOLDataStore.getAdvancedSearchResults(c.searchCriteria, b, e, function(h) {
        log.debug("retrieveSearchResults returned");
        if (!a) {
            c.pageNumber = g;
            c.currentIndex = f;
            c.results = h.rows;
            c.updateUI();
            Explore.view.StatusBox.close()
        }
    })
}});
Ext.ns("Explore.view");
Explore.view.SearchResultExportDialog = Ext.extend(Ext.Window, {initComponent:function() {
    var d = this;
    var f = {xtype:"selectboxfield",fieldLabel:Explore.i18n("ExportFormat"),name:"ExportFormat",width:345,itemId:"exportFormat",allowBlank:false,valueField:"Id",displayField:"Name",value:0,options:[
        [0,Explore.i18n("ExportFormatTypeXMLSummary")],
        [1,Explore.i18n("ExportFormatTypeXMLDetailed")]
    ],listeners:{select:function(j, g, h) {
        d.enableDownload()
    }}},b = {xtype:"selectboxfield",fieldLabel:Explore.i18n("NumberOfItems"),name:"NumberOfItems",width:345,itemId:"exportCount",allowBlank:false,valueField:"Id",displayField:"Name",value:100,options:[
        [0,Explore.i18n("Current Page Only")],
        [10,Explore.i18n("Top 10")],
        [100,Explore.i18n("Top 100")],
        [500,Explore.i18n("Top 500")],
        [1000,Explore.i18n("Top 1000")],
        [5000,Explore.i18n("Top 5000")]
    ],listeners:{select:function(j, g, h) {
        d.enableDownload()
    }}},a = {xtype:"selectboxfield",fieldLabel:Explore.i18n("Via"),name:"Via",width:345,itemId:"exportMethod",allowBlank:false,valueField:"Id",displayField:"Name",hidden:true,value:Explore.model.SearchResultsExportMethod.DirectDownload,store:new Ext.data.JsonStore({fields:["Id","Name"],data:[
        {Id:Explore.model.SearchResultsExportMethod.DirectDownload,Name:Explore.i18n("ExportSearchResultsDirectDownload")}
    ]}),listeners:{select:function(j, g, h) {
        d.enableDownload()
    }}},e = {xtype:"selectboxfield",fieldLabel:Explore.i18n("ExportIncludeEngagement"),name:"IncludeEngagement",width:345,itemId:"exportIncludeEngagement",allowBlank:false,valueField:"Id",displayField:"Name",options:[
        [0,Explore.i18n("No")],
        [1,Explore.i18n("Yes")]
    ],listeners:{select:function(j, g, h) {
        d.enableDownload()
    }}};
    var c = {title:Explore.i18n("ExportSearchResults"),width:520,autoHeight:true,maxHeight:500,constrain:true,constrainHeader:true,cls:"white-bg-dialog",defaults:{padding:"10"},border:false,modal:true,items:[
        {xtype:"form",labelWidth:135,padding:10,items:[f,b,a]}
    ],fbar:[
        {xtype:"button",disabled:true,itemId:"searchResultExportDownloadButton",text:Explore.i18n("Download"),handler:function() {
            var h = d.getByItemId("exportCount").getValue(),k = d.getByItemId("exportMethod").getValue(),j = d.getByItemId("exportFormat").getValue(),g = new Ext.LoadMask(d.getEl() || Ext.getBody(), {msg:"downloading"});
            g.show();
            d.fireEvent("download", h, j, function() {
                g.hide()
            })
        }},
        {xtype:"button",text:Explore.i18n("Cancel"),handler:function() {
            d.close()
        }}
    ]};
    Ext.apply(this, c);
    Explore.view.ProjectSelectDialog.superclass.initComponent.apply(this, arguments);
    d.on("afterrender", function() {
        d.enableDownload()
    })
},enableDownload:function() {
    var a = this;
    if ((a.getByItemId("exportCount").getValue() !== "") && (a.getByItemId("exportFormat").getValue() <= 1)) {
        a.fbar.getByItemId("searchResultExportDownloadButton").enable()
    } else {
        a.fbar.getByItemId("searchResultExportDownloadButton").disable()
    }
}});
Ext.reg("explore.view.SearchResultExportDialog", Explore.view.SearchResultExportDialog);
Ext.ns("Explore.view");
Explore.view.SearchResultWorkflowDialog = Ext.extend(Ext.Window, {currentSelectedRow:null,title:Explore.i18n("WorkflowOptions"),width:300,height:200,closeAction:"close",modal:true,initComponent:function() {
    var a = this;
    var b = {itemId:"searchDetailsOptions-dialog",layout:"fit",items:{xtype:"panel",itemId:"mainPanel",autoScroll:true,border:false,padding:"10",items:[
        {xtype:"label",cls:"header-directions",text:Explore.i18n("SelectAnOptionBelow"),margins:"0 0 7 0"},
        {xtype:"panel",itemId:"contentPanel",border:false}
    ]},buttons:[
        {text:Explore.i18n("Close"),handler:function() {
            a.close()
        }}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.SearchResultWorkflowDialog.superclass.initComponent.apply(this, arguments);
    a.on("beforerender", function() {
        var g = a.getByItemId("contentPanel");
        var f = Explore.data.Configuration.getWorkflowItems();
        var d = "";
        for (var e = 0; e < f.length; e++) {
            d += '<img src="../resources/images/icons/expand.gif" alt="Link:" />&nbsp';
            d += '<a id="' + e + '" href="' + f[e].Url + '" target="_blank">' + f[e].Name + "</a><br>"
        }
        var c = escape(this.currentSelectedRow.fields.articleUrl);
        d += '<img src="../resources/images/icons/expand.gif" alt="Link:" />&nbsp';
        d += '<a href="mailto:&body= ' + c + '" >Forward via email</a><br>';
        d += '<img src="../resources/images/icons/expand.gif" alt="Link:" />&nbsp';
        d += '<a href="mailto:&body=  &subject=Thanks for your input!" >Respond via e-mail</a><br>';
        g.html = d
    })
}});
Ext.ns("Explore.view");
Explore.view.SearchToolbarFilter = Ext.extend(Ext.Panel, {filter:null,initComponent:function() {
    var h = this;
    var j = h.getFriendly(", ");
    var g = h.getFriendly("<br />");
    var e = Explore.Globalization.getString(h.filter.type, h.filter.friendlyType);
    var f = e + ': <span class="self.filter-value">' + Ext.util.Format.ellipsis(j, 50) + "</span>";
    var a = e + "<br />" + g;
    var d = h.filter.pin ? "pin" : "unpin";
    var b = ["searchFilterPinToggle","searchFilterRemove"];
    h.addEvents(b);
    h.enableBubble(b);
    var c = {height:25,autoWidth:true,title:f,closeable:true,border:false,cls:"SearchToolbarFilter",tools:[
        {id:d,qtip:Explore.i18n("linkTooltip" + d),handler:function(m, l, k) {
            h.fireEvent("searchFilterPinToggle", {filter:h.filter})
        }},
        {id:"close",qtip:Explore.i18n("linkTooltipRemoveFilter"),handler:function(m, l, k) {
            h.fireEvent("searchFilterRemove", {filter:h.filter})
        }}
    ]};
    if (Ext.isIE) {
        c.autoWidth = false;
        c.width = 250
    }
    Ext.apply(this, Ext.apply(this.initialConfig, c));
    Explore.view.SearchToolbarFilter.superclass.initComponent.apply(this, arguments);
    h.on("render", function(k) {
        var l = h.header.query(".x-panel-header-text");
        Ext.QuickTips.register({target:l,text:a})
    });
    if (Ext.isIE) {
        h.on("afterrender", function() {
            var k = Ext.util.TextMetrics.createInstance(h.header);
            var l = k.getWidth(f);
            var m = 50;
            h.setWidth(l + m)
        })
    }
},getFriendly:function(b) {
    var c = this;
    var a = c.filter.friendlyValue;
    if (a === null || a === undefined) {
        if (c.filter.friendlyValues != null) {
            a = c.filter.friendlyValues.join(b)
        } else {
            if (c.filter.values != null) {
                a = c.filter.values.join(b)
            }
        }
    }
    return a
}});
Ext.reg("explore.view.searchtoolbarfilter", Explore.view.SearchToolbarFilter);
Ext.ns("Explore.view");
Explore.view.SearchToolbarPanel = Ext.extend(Ext.Container, {currentHeight:0,requiredLabelWidth:null,typeTooltip:null,labelText:"",initComponent:function() {
    var n = this;
    var a = {itemId:"searchToolbarResultsLabel",xtype:"label"};
    var j = {itemId:"buttonGridType",xtype:"button",iconCls:"buttonConciseGrid",enableToggle:true,tooltip:Explore.i18n("DisplayResultsInCompactView"),handler:function(o) {
        n.fireEvent("toggleGridType")
    },listeners:{beforerender:function() {
        n.setGridTypeButton(b.gridType)
    }}};
    var m = {itemId:"selectedRowButtonGroup",xtype:"buttongroup",disabled:false,frame:false,items:[
        {xtype:"button",iconCls:"buttonOpen",disabled:true,tooltip:Explore.i18n("OpenSelectedResult"),handler:function() {
            n.fireEvent("toolbarOpen")
        }},
        {itemId:"buttonSearchFavorite",xtype:"button",iconCls:"buttonFavorite",hidden:!Explore.demoMode || !Explore.Security.isAuthorized("SEARCH_SAVE_FAVORITE"),disabled:true,tooltip:Explore.i18n("AddSelectedResultToFavorites"),handler:function() {
            n.fireEvent("toolbarFavorite")
        }},
        {itemId:"buttonSearchTag",xtype:"button",iconCls:"iconTag",disabled:true,hidden:!Explore.Security.isAuthorized("SEARCH_TAG"),tooltip:Explore.i18n("AddAndRemoveTagsToSelectedResult"),handler:function() {
            n.fireEvent("toolbarTag")
        }},
        {itemId:"buttonSearchClassify",xtype:"button",iconCls:"iconClassify",disabled:true,hidden:!Explore.Security.isAuthorized("SEARCH_CLASSIFY"),tooltip:Explore.i18n("AddAndRemoveClassificationsToSelectedResult"),handler:function() {
            n.fireEvent("toolbarClassify")
        }},
        {xtype:"button",iconCls:"buttonSearchShowHide",disabled:true,hidden:!Explore.enableHide,tooltip:Explore.i18n("HideSelectedResultFromThisAndAllFutureSearchResults"),handler:function() {
            n.fireEvent("toolbarShowHide")
        }}
    ]};
    var g = {xtype:"button",iconCls:"buttonSearchAnalytics",tooltip:Explore.i18n("Widgets"),menu:{items:n.createAnalyzeMenu()}};
    var k = {xtype:"button",iconCls:"buttonExport",disabled:!Explore.Security.isAuthorized("SEARCH_EXPORT"),tooltip:Explore.i18n("ExportTheseResults"),handler:function() {
        n.fireEvent("toolbarExportResults")
    }};
    var h = {xtype:"button",iconCls:"buttonSearchTopic",cls:"demoMode",hidden:!Explore.demoMode,tooltip:Explore.i18n("AddSearchResultsCriteriaToTopics"),handler:function() {
        n.fireEvent("toolbarAddToTopic")
    }};
    var e = {xtype:"button",iconCls:"buttonSearchSnapshot",tooltip:Explore.i18n("TakeASnapshotOfTheseParticularResults"),disabled:!Explore.Security.isAuthorized("SNAPSHOTS_CREATE"),handler:function() {
        n.fireEvent("toolbarTakeSnapshot")
    }};
    var l = {xtype:"button",iconCls:"buttonAutomation",tooltip:Explore.i18n("CreateAutomationRuleFromThisSearchCriteria"),disabled:!Explore.Security.isAuthorized("AUTOMATE_CREATE"),handler:function() {
        n.fireEvent("toolbarAutomation")
    }};
    var d = {xtype:"button",iconCls:"buttonSearchSave",disabled:!Explore.Security.isAuthorized("SEARCH_SAVED_CREATE"),tooltip:Explore.i18n("SaveSearchResultsCriteriaForFutureUse"),handler:function() {
        n.fireEvent("toolbarSave")
    }};
    var a = {itemId:"searchToolbarResultsLabel",xtype:"label"};
    var f = {itemId:"searchToolbar",xtype:"toolbar",cls:"search-toolbar",border:false,height:31,hidden:true,items:[a,"->",j,"-",m,"-",g,k,h,e,l,d]};
    var c = {itemId:"searchToolbarFilters",xtype:"container",border:false,autoHeight:true,hidden:true,padding:"2 2 2 2",cls:"white-background"};
    var b = {border:false,items:[f,c]};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.SearchToolbarPanel.superclass.initComponent.apply(this, arguments)
},createAnalyzeMenu:function() {
    var a = this;
    var c = [
        {text:Explore.i18n("Analyze") + " - " + Explore.i18n("Terms"),tooltip:Explore.i18n("SeeTermsForTheseResults"),handler:function(g) {
            g.parentMenu.hide();
            a.fireEvent("analyze", "analytics-terms")
        }},
        {text:Explore.i18n("Analyze") + " - " + Explore.i18n("Sentiment"),tooltip:Explore.i18n("SeeSentimentForTheseResults"),handler:function(g) {
            g.parentMenu.hide();
            a.fireEvent("analyze", "analytics-sentiment")
        }},
        {text:Explore.i18n("Analyze") + " - " + Explore.i18n("Influencer"),tooltip:Explore.i18n("SeeSentimentForTheseResults"),handler:function(g) {
            g.parentMenu.hide();
            a.fireEvent("analyze", "analytics-influencer")
        }},
        "-"
    ];
    if (Explore.demoMode) {
        var e = {text:Explore.i18n("Analyze") + " - " + Explore.i18n("Trends"),tooltip:Explore.i18n("SeeTrendsForTheseResults"),handler:function(g) {
            g.parentMenu.hide();
            a.fireEvent("analyze", "analytics-trends")
        }};
        c.splice(2, 0, e)
    }
    var f = Explore.Globalization.globalizeAndSortArray(Explore.data.IDOLDataStore.getActiveSearchResultReportTypeValues(), "name", "SearchResultReportType");
    for (var b = 0; b < f.length; b++) {
        var d = (function(g) {
            return{text:f[b].name,tooltip:f[b].name,handler:function(h) {
                h.parentMenu.hide();
                var j = {reportSettings:{reportType:g}};
                a.fireEvent("toolbarReport", j)
            }}
        }(f[b].value));
        c.push(d)
    }
    return c
},adjustHeight:function() {
    var a = 1;
    var b = this;
    if (b.topVisible) {
        a += b.getByItemId("searchToolbar").getHeight()
    }
    if (b.hasFilters) {
        a += b.getByItemId("searchToolbarFilters").getHeight()
    }
    if (this.currentHeight != a) {
        this.currentHeight = a;
        b.setHeight(a);
        b.ownerCt.doLayout()
    }
},setTopToolbarVisible:function(b) {
    this.topVisible = b;
    var a = this.getByItemId("searchToolbar");
    a.setVisible(b);
    this.adjustHeight()
},setSearchFilters:function(g) {
    var e = this.getByItemId("searchToolbarFilters");
    var d = e.items.items;
    var f = function(k, l) {
        if (k.values.length != l.values.length) {
            return false
        }
        for (var j = 0; j < k.values.length; j++) {
            if (k.values[j] != l.values[j]) {
                return false
            }
        }
        return true
    };
    var h = function(k) {
        for (var j = 0; j < d.length; j++) {
            if (f(k, d[j].filter)) {
                k.friendlyValues = d[j].filter.friendlyValues;
                return k
            }
        }
        return k
    };
    if (g === null || g.length === 0) {
        e.removeAll();
        this.hasFilters = false;
        e.setVisible(false)
    } else {
        this.hasFilters = true;
        var a = [];
        for (var b = 0; b < g.length; b++) {
            var c = h(g[b]);
            a.push({xtype:"explore.view.searchtoolbarfilter",filter:c})
        }
        e.removeAll();
        for (var b = 0; b < a.length; b++) {
            e.add(a[b])
        }
        e.setVisible(true);
        e.doLayout()
    }
    this.adjustHeight()
},removeTip:function() {
    if (this.typeTooltip != null) {
        this.typeTooltip.hide();
        this.typeTooltip.destroy();
        this.typeTooltip = null
    }
},setCountsByTypes:function(h) {
    var m = this;
    var k = this.getByItemId("searchToolbarResultsLabel");
    this.removeTip();
    if (!h || !h.countsByType) {
        k.setText("")
    } else {
        var e = h.countsByType;
        labelText = String.format(Explore.i18n("_SearchResultsbr"), Explore.formatNumber(h.results));
        var p = [];
        for (var f in e) {
            if (e.hasOwnProperty(f)) {
                var d = Explore.formatNumber(e[f]);
                var b = "docType" + f.replace(" ", "");
                var j = Explore.i18n(b);
                if (j === b) {
                    j = f
                }
                p.push({docType:f,friendlyName:j,count:d})
            }
        }
        p.sort(function o(r, q) {
            if (!q) {
                return 1
            } else {
                if (!r) {
                    return -1
                }
            }
            return(r.friendlyName === q.friendlyName) ? 0 : (r.friendlyName > q.friendlyName) ? 1 : -1
        });
        var c = "";
        var n = '<a href="#" class="searchToolbarType" resultType="{0}">{1} {2}</a><br />';
        for (var a = 0; a < p.length; a++) {
            var g = p[a];
            c += String.format(n, g.docType, g.count, g.friendlyName)
        }
        k.setText(labelText, false);
        function l() {
            m.typeTooltip = new Ext.ToolTip({target:k.el.id,html:c,anchor:"top",autoHide:false,listeners:{afterrender:function(r) {
                var q = Ext.select("a.searchToolbarType");
                q.on("click", function(u, t) {
                    var s = {type:"Type",values:[t.attributes.resultType.value]};
                    m.typeTooltip.hide();
                    m.fireEvent("searchFilterChange", s);
                    return false
                })
            }}})
        }

        if (k.rendered) {
            if (c.length > 0) {
                l()
            }
        } else {
            log.warn("label not rendered. Exiting setCountsByTypes in SearchToolbarPanel");
            k.on("render", l)
        }
    }
},setRowButtonsEnabled:function(a, e) {
    var d = this.getByItemId("selectedRowButtonGroup");
    var f = d.findByType("button");
    for (var c = 0; c < f.length; c++) {
        var b = f[c];
        b.setDisabled(!a)
    }
    this.getByItemId("buttonSearchClassify").setDisabled(!e)
},setGridTypeButton:function(b) {
    var a = this.getByItemId("buttonGridType");
    if (b === Explore.model.GridType.Compact) {
        a.setTooltip(Explore.i18n("DisplayResultsInConciseView"));
        a.setIconClass("buttonConciseGrid");
        a.toggle(true)
    } else {
        a.setTooltip(Explore.i18n("DisplayResultsInCompactView"));
        a.setIconClass("buttonCompactGrid");
        a.toggle(false)
    }
}});
Ext.reg("explore.view.searchtoolbarpanel", Explore.view.SearchToolbarPanel);
Ext.ns("Explore.view");
Explore.view.SentimentOptionsDialog = Ext.extend(Ext.Window, {title:Explore.i18n("SentimentOptions"),selectedRowObjects:[],selectedSentiment:"NEUTRAL",initComponent:function() {
    var a = this;
    var b = {layout:"fit",defaultType:"textfield",defaults:{padding:"0 0 0 5"},width:350,height:165,items:[
        {xtype:"panel",itemId:"sentimentOptions-top-panel",layout:"form",border:false,defaultType:"textfield",items:[
            {itemId:"sentimentRadioGroup",xtype:"radiogroup",fieldLabel:Explore.i18n("Sentiment"),columns:1,items:[
                {boxLabel:Explore.i18n("sentimentPOSITIVE"),name:"rb-col",value:"POSITIVE",inputValue:"POSITIVE"},
                {boxLabel:Explore.i18n("sentimentNEGATIVE"),name:"rb-col",value:"NEGATIVE",inputValue:"NEGATIVE"},
                {boxLabel:Explore.i18n("sentimentNEUTRAL"),name:"rb-col",value:"NEUTRAL",inputValue:"NEUTRAL"}
            ],listeners:{change:function(c, d) {
                a.selectedSentiment = d.value
            }}}
        ]}
    ],buttons:[
        {text:Explore.i18n("Save"),handler:this.save,scope:this},
        {text:Explore.i18n("textCancel"),handler:function() {
            a.close()
        }}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.SentimentOptionsDialog.superclass.initComponent.apply(this, arguments)
},setSelectedRowObjects:function(a) {
    this.selectedRowObjects = a
},setCurrentSentiment:function(b) {
    this.selectedSentiment = b;
    var a = this.getByItemId("sentimentRadioGroup");
    if (a) {
        a.setValue(b)
    }
},save:function() {
    var a = this;
    var b = Ext.getCmp("searchPanel");
    var c = b.getSearchPresenter();
    c.onEditSentiment(a.selectedRowObjects, a.selectedSentiment);
    a.close()
}});
Ext.ns("Explore.view");
Explore.view.SignupWindow = Ext.extend(Ext.Window, {lMask:null,initComponent:function() {
    var a = this;
    var b = {title:"Sign Up",width:480,height:270,buttons:[
        {text:"Save",itemId:"savebutton",handler:function() {
            var d = a.getByItemId("signupform").getForm();
            if (d.isValid()) {
                var c = d.getValues();
                lMask = new Ext.LoadMask(a.getEl(), {msg:"Loading. Please wait..."});
                lMask.show();
                Ext.Ajax.request({method:"POST",url:"Handlers/SignupUserHandler.ashx",params:c,success:a.SuccessCall,failure:a.FailureCall,scope:this})
            }
        }},
        {text:"Cancel",handler:function() {
            a.close()
        }}
    ],items:[
        {xtype:"form",itemId:"signupform",height:420,padding:16,labelWidth:150,defaults:{anchor:Ext.isIE ? "100%" : "95%",xtype:"textfield",bodyStyle:"padding-left:15px;"},items:[
            {fieldLabel:'Name<span class="red"><b>*</b></span>',id:"customerName",allowBlank:false},
            {fieldLabel:'Company<span class="red"><b>*</b></span>',id:"companyName",allowBlank:false},
            {fieldLabel:'Email<span class="red"><b>*</b></span>',vtype:"email",id:"customerEmail",allowBlank:false},
            {fieldLabel:"Contact Phone",id:"contactPhone"},
            {xtype:"textarea",fieldLabel:"Comments",id:"comments"}
        ]}
    ]};
    Ext.apply(this, b);
    Explore.view.SignupWindow.superclass.initComponent.apply(this, arguments)
},SuccessCall:function(b, c) {
    var a = this;
    lMask.hide();
    Ext.MessageBox.show({scope:this,buttons:Ext.MessageBox.OK,title:"Success",width:300,msg:"Thank you for signing up. We will contact you soon.",icon:Ext.MessageBox.INFO});
    a.findParentByType("window").close()
},FailureCall:function(b, c) {
    var a = this;
    lMask.hide();
    Ext.MessageBox.show({buttons:Ext.MessageBox.OK,width:300,msg:"An error occured during sign up. We have notified the administrator about this issue.",title:"Error",icon:Ext.MessageBox.ERROR});
    a.findParentByType("window").close()
}});
Ext.reg("explore.view.signupwindow", Explore.view.SignupWindow);
Ext.ns("Explore.view");
Explore.view.SnapshotEditDialog = Ext.extend(Explore.base.EditorDialog, {itemDescription:Explore.i18n("SnapshotDetails"),readOnly:false,labelWidth:130,width:400,height:220,initComponent:function() {
    var a = this;
    this.editObject = Ext.apply({Name:"",Description:""}, this.editObject);
    a.formItems = [
        {xtype:"textfield",name:"Name",fieldLabel:Explore.i18n("SnapshotName"),width:220,value:"",vtype:"usersyntaxName"},
        {xtype:"textarea",height:70,name:"Description",fieldLabel:Explore.i18n("Description_optional_"),width:220,value:""}
    ];
    Explore.view.SnapshotEditDialog.superclass.initComponent.apply(this, arguments)
},getTitle:function() {
    return Explore.i18n("SnapshotDetails")
},isDirty:function() {
    var a = Explore.view.SnapshotEditDialog.superclass.isDirty.call(this);
    return a
},saveAndClose:function() {
    var a = this;
    a.fireEvent("save", a, a.editObject);
    a.bypassDirtyCheck = true
}});
Ext.ns("Explore.view");
Explore.view.SnapshotResultsDialog = Ext.extend(Ext.Window, {snapshot:null,pageSize:50,gridType:Explore.model.GridType.Concise,width:600,height:500,modal:true,initComponent:function() {
    var a = this;
    a.pagingCriteria = {PageNumber:a.page,PageSize:a.pageSize,SortDirection:Explore.model.SortDirection.Descending,SortProperty:Explore.model.SortProperty.Weight};
    var b = {layout:{type:"vbox",align:"stretch"},title:Explore.i18n("Snapshot") + ": " + a.snapshot.Name,defaults:{padding:10},items:[
        {xtype:"panel",height:30,border:false,html:Explore.i18n("SnapshotTaken") + Explore.formatDateByPref(a.snapshot.DateCreated)},
        {xtype:"explore.view.conciseSearchGrid",showGridMask:true,itemId:"conciseSearchGrid",disableRefineResults:true,noSearchText:" ",border:false,flex:1,pageSize:a.pageSize,gridType:a.gridType,listeners:{storeBeforeLoad:function(c, d) {
            a.loadPageData(c, d)
        },gridContextOpen:function() {
            a.getSearchPresenter().onGridOpenRows()
        },rowDoubleClick:function(d, c) {
            a.getSearchPresenter().onGridOpenRows()
        },gridContextFavorite:function() {
            a.getSearchPresenter().onAddFavorite()
        },gridContextTag:function() {
            a.getSearchPresenter().onAddTag()
        },gridContextEditSentiment:function() {
            var c = Explore.SearchResults.getObjectsFromRows(this.getSelectedRows());
            var e = (c && c.length === 1 && c[0].fields) ? {explore:{sentiment:c[0].fields.sentiment}} : null;
            var f = new Explore.view.SentimentOptionsDialog(e);
            var d;
            if (c && c.length === 1 && c[0].fields) {
                d = (c[0].fields.sentiment) ? c[0].fields.sentiment : null
            }
            f.setCurrentSentiment(d);
            f.setSelectedRowObjects(c);
            f.show()
        }}}
    ],buttons:[
        {text:Explore.i18n("Reports"),handler:function() {
            var c = a.getSearchPresenter();
            c.onReport({searchTerms:"SNAPSHOT::(" + a.snapshot.Name + ")"})
        }},
        {text:Explore.i18n("Download"),handler:function() {
            var d = a.getConciseGrid();
            var c = d.getAllRows();
            Explore.utils.Exporter.exportToXml(c)
        }},
        {text:Explore.i18n("Close"),handler:function() {
            a.close()
        }}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.SnapshotResultsDialog.superclass.initComponent.apply(this, arguments);
    this.on("show", this.loadData, this)
},getConciseGrid:function() {
    var a = this.getByItemId("conciseSearchGrid");
    return a
},loadData:function() {
    var b = this;
    var a = false;
    Explore.view.StatusBox.showBusy(Explore.i18n("LoadingSnapshot"), function() {
        a = true;
        b.close()
    });
    var c = {};
    Explore.data.SnapshotDataStore.getSnapshotResultsForCurrentUser(b.snapshot.Id, b.pagingCriteria, c, function(d) {
        if (!a) {
            if (d) {
                log.info("retrieveSearchResults returned:" + d.results);
                var f = b.getConciseGrid();
                f.showData(d)
            } else {
                log.error("No search results were returned in call to retrieveSearchResults")
            }
            var e = b.getSearchPresenter();
            e.currentResultsJsonData = d;
            Explore.view.StatusBox.close()
        }
    })
},loadPageData:function(c, d) {
    var b = this;
    var g = c.lastOptions.params;
    var h = g.start;
    var a = g.limit;
    if (h !== undefined && a !== undefined) {
        var f = (h / a) + 1;
        b.pagingCriteria.PageNumber = f
    }
    var e = {};
    Explore.data.SnapshotDataStore.getSnapshotResultsForCurrentUser(b.snapshot.Id, b.pagingCriteria, e, function(j) {
        j.results = c.reader.jsonData.results;
        var k = c.reader.readRecords(j);
        c.loadRecords(k, d, true)
    })
},getSearchPresenter:function() {
    if (!this.searchPresenter) {
        var b = this.getByItemId("conciseSearchGrid");
        var a = new Explore.presenter.SearchPresenter(b);
        this.searchPresenter = a;
        this.searchPresenter.getFilteredSearchCriteria = function() {
            return a.currentResultsJsonData.searchInfo
        };
        this.searchPresenter.getSelectedRowObjects = function() {
            return Explore.SearchResults.getObjectsFromRows(b.getSelectedRows())
        }
    }
    return this.searchPresenter
}});
Ext.ns("Explore.view");
Explore.view.SnapshotSearchWindow = Ext.extend(Ext.Window, {initComponent:function(c) {
    var b = this;
    this.minHeight = 600;
    this.minWidth = 1000;
    this.height = this.height || this.minHeight;
    this.width = this.width || this.minWidth;
    var c = {autoShow:true,autoScroll:true,title:Explore.i18n("SnapshotCreation"),closable:true,constrain:true,itemId:"SnapshotSearchWindow",layout:"border",hidden:!Explore.Security.isAuthorized("SNAPSHOTS_VIEW"),maximizable:true,minHeight:this.minHeight,minWidth:this.minWidth,modal:true,resizable:true,renderTo:Ext.getBody(),items:[
        {region:"north",height:43,labelAlign:"top",xtype:"form",hideBorders:true,border:false,frame:false,bodyStyle:"background-color: #ECF1F5;",margins:"5 5 5 5",items:[
            {layout:"column",cls:"snapshotSearchWindow",items:[
                {columnWidth:0.4,layout:"form",border:false,frame:false,items:[
                    {xtype:"textfield",fieldLabel:Explore.i18n("Name"),border:false,frame:false,regex:new RegExp("[^ ]"),regexText:Explore.i18n("PleaseEnterANon_blankName"),itemId:"namefield",allowBlank:false,name:"name",anchor:"95%"}
                ]},
                {columnWidth:0.6,layout:"form",border:false,frame:false,items:[
                    {xtype:"textfield",fieldLabel:Explore.i18n("Description"),border:false,frame:false,itemId:"descriptionfield",name:"description",anchor:"95%"}
                ]}
            ]}
        ]},
        {region:"center",id:"searchPanel",itemId:"SearchPanel",xtype:"explore.view.searchpanel",listeners:{afterlayout:function() {
            var g = b.getByItemId("SearchPanel").getByItemId("searchToolbarPanel");
            g.getByItemId("searchToolbarFilters").setVisible(true)
        }}}
    ],fbar:[
        {xtype:"button",itemId:"saveButton",text:Explore.i18n("Save"),disabled:true,handler:this.btnSaveAction,scope:this},
        {xtype:"button",itemId:"cancelButton",text:Explore.i18n("Cancel"),handler:this.btnCancelAction,scope:this}
    ]};
    Ext.apply(this, Ext.apply(c, this.initialConfig));
    Explore.view.SnapshotSearchWindow.superclass.initComponent.apply(this, arguments);
    var a = this.getByItemId("SearchPanel");
    var d = a.searchPresenter;
    var f = this.fbar.getByItemId("saveButton");
    var e = this.getByItemId("namefield");
    e.on("invalid", function() {
        f.disable()
    });
    e.on("valid", function() {
        var g = b.getByItemId("SearchPanel").searchPresenter;
        if (g.searchCriteria !== null) {
            f.enable()
        }
        g = null
    });
    d.on("searchCleared", function() {
        f.disable()
    });
    d.on("newSearchCompleted", function() {
        b.getByItemId("SearchPanel").getByItemId("searchToolbarPanel").getByItemId("searchToolbar").setVisible(false);
        b.getByItemId("SearchPanel").getByItemId("searchToolbarPanel").adjustHeight();
        if (e.isValid()) {
            f.enable()
        }
    })
},btnCancelAction:function() {
    this.close()
},btnSaveAction:function() {
    var b = this.getName();
    var d = this.getDescription();
    var a = this.getByItemId("SearchPanel");
    var c = a.searchPresenter;
    c.onTakeSnapshot(this, b, d)
},getName:function() {
    var a = this.getByItemId("namefield");
    return a.getValue()
},getDescription:function() {
    var a = this.getByItemId("descriptionfield");
    return a.getValue()
}});
Ext.ns("Explore.view");
Explore.view.SourceFeedList = Ext.extend(Ext.Panel, {initComponent:function() {
    var b = this;
    b.pageSize = 25;
    b.dataSourceId = -1;
    Explore.data.SourceDataStore.getAutomationServerUrl(function(d) {
        b.automationServerUrl = d
    });
    var a = new Ext.data.JsonReader({totalProperty:"totalFeeds",root:"feeds",fields:[
        {name:"JobLink",mapping:"PropertiesDict.jobGuid"},
        {name:"Recurring",mapping:"PropertiesDict.recurring"},
        {name:"LastRun",mapping:"PropertiesDict.dateRunStarted"},
        {name:"Status",mapping:"PropertiesDict.success"},
        {name:"CreatedBy",mapping:"PropertiesDict.creator"},
        {name:"MASDocs",mapping:"PropertiesDict.numQueryDocs"},
        {name:"ExploreDocs",mapping:"PropertiesDict.numExportDocs"},
        {name:"MASQuery",mapping:"PropertiesDict.idolQueryText"},
        {name:"FieldText",mapping:"PropertiesDict.idolQueryFieldtext"},
        {name:"Description",mapping:"PropertiesDict.jobDescription"}
    ]});
    b.store = new Ext.data.Store({reader:a,sortInfo:{field:"LastRun",direction:"DESC"},listeners:{beforeload:function(d, e) {
        Explore.data.SourceDataStore.getFeeds(b.dataSourceId, e.params.start, e.params.limit, function(f) {
            if (f) {
                var g = d.reader.readRecords(f);
                d.loadRecords(g, e, true)
            }
        });
        return false
    }}});
    var c = {frame:true,layout:"fit",items:{xtype:"grid",itemId:"grid",region:"center",border:false,store:b.store,autoExpandColumn:"sourcefeedlist-grid-name",selModel:new Ext.grid.RowSelectionModel({singleSelect:true}),listeners:{rowdblclick:function(d, g, f) {
    },rowclick:function() {
    }},columns:[
        {header:Explore.i18n("JobLink"),width:100,sortable:false,renderer:b.jobLinkColRenderer,id:"sourcefeedlist-grid-name"},
        {header:Explore.i18n("Recurring"),width:75,sortable:false,align:"center",renderer:b.recurringColRenderer},
        {header:Explore.i18n("LastRun"),width:175,sortable:false,renderer:b.epochDateColRenderer},
        {header:Explore.i18n("Status"),width:75,sortable:false,renderer:b.statusColRenderer,align:"center"},
        {header:Explore.i18n("CreatedBy"),width:150,sortable:false},
        {header:Explore.i18n("MASDocs"),width:100,sortable:false},
        {header:Explore.i18n("ExploreDocs"),width:100,sortable:false},
        {header:Explore.i18n("MASQuery"),width:200,sortable:false},
        {header:Explore.i18n("FieldText"),width:200,sortable:false},
        {header:Explore.i18n("Description"),width:200,sortable:false,renderer:simpleTooltopColRenderer,id:"sourcefeedlist-grid-description"}
    ],viewConfig:{forceFit:true},bbar:new Ext.PagingToolbar({pageSize:b.pageSize,store:b.store,buttonAlign:"right"})}};
    Ext.apply(this, Ext.apply(this.initialConfig, c));
    Explore.view.SourceFeedList.superclass.initComponent.apply(this, arguments)
},epochDateColRenderer:function(f, b, a, g, e, c) {
    var d = new Date();
    d.setTime(f);
    return Explore.formatDateByPref(d)
},statusColRenderer:function(f, b, a, g, e, c) {
    var d = "";
    if (f === "true") {
        b.attr = 'ext:qtip="' + Explore.i18n("Succeeded") + '"';
        d = '<img src="../resources/images/icons/selected.png" alt="Hidden" />'
    } else {
        b.attr = 'ext:qtip="' + Explore.i18n("Failed") + ": " + a.json.PropertiesDict.errorMessage + '"';
        d = '<img src="../resources/images/icons/delete.gif" alt="Hidden" />'
    }
    return d
},recurringColRenderer:function(f, b, a, g, e, c) {
    var d = "";
    if (f === "true") {
        b.attr = 'ext:qtip="' + Explore.i18n("Recurring") + '"';
        d = '<img src="../resources/images/icons/green_dot.png" alt="Hidden" />'
    } else {
        b.attr = 'ext:qtip="' + Explore.i18n("ScheduledOnce") + '"';
        d = '<img src="../resources/images/icons/red_dot.png" alt="Hidden" />'
    }
    return d
},jobLinkColRenderer:function(f, b, a, h, e, c) {
    var d = this.automationServerUrl + "?tab=Jobs&Jobs.search=guid:" + f;
    var g = '<a href="' + d + '" target="_blank">' + a.json.PropertiesDict.jobName + "</a>";
    b.attr = 'ext:qtip="' + Explore.i18n("JobLink") + ": " + a.json.PropertiesDict.jobName + "</br>" + Explore.i18n("clickToViewDetails") + '"';
    return g
},loadData:function(b) {
    var a = this;
    a.dataSourceId = b;
    Explore.data.SourceDataStore.getFeeds(b, 0, a.pageSize, function(c) {
        if (c) {
            a.store.loadData(c)
        }
    })
},clearData:function() {
    var a = this;
    a.store.loadData({totalFeeds:0,feeds:[]})
}});
Ext.reg("explore.view.sourcefeedlist", Explore.view.SourceFeedList);
Ext.ns("Explore.view");
Explore.view.SourceList = Ext.extend(Ext.Panel, {initComponent:function() {
    var c = this;
    c.dataSourceId = -1;
    var a = new Ext.data.JsonReader({root:"",fields:[
        {name:"Id",mapping:"Id"},
        {name:"Name",mapping:"Name"},
        {name:"Description",mapping:"Description"},
        {name:"Projects",convert:c.projectsConverter},
        {name:"LastRefreshed",convert:c.lastRefreshedDate},
        {name:"RefreshSourceNextTime",convert:c.refreshSourceNextTime}
    ]});
    c.store = new Ext.data.Store({reader:a,sortInfo:{field:"Name",direction:"ASC"},listeners:{beforeload:function(f, g) {
        var e = c.getMask();
        e.show();
        Explore.data.SourceDataStore.getDataSourcesListByGroup(c.dataSourceId, function(h) {
            if (h && h.Result) {
                var j = f.reader.readRecords(h.Result.Value);
                j.totalRecords = h.Result.Key;
                f.loadRecords(j, g, true)
            }
            e.hide();
            c.doLayout()
        });
        return false
    }}});
    var b = new Explore.view.DocCountColumn({header:Explore.i18n("MASDocs"),width:200,defaultType:"DATA_SOURCE"});
    var d = {frame:false,layout:"fit",items:{xtype:"grid",itemId:"grid",region:"center",border:false,store:c.store,autoExpandColumn:"sourcelist-grid-name",disableSelection:true,plugins:[b],columns:[
        {header:Explore.i18n("Name"),dataIndex:"Name",width:100,sortable:false,id:"sourcelist-grid-name"},
        {header:Explore.i18n("Description"),dataIndex:"Description",width:200,sortable:false,id:"sourcelist-grid-description"},
        {header:Explore.i18n("Projects"),dataIndex:"Projects",width:200,sortable:false,align:"center"},
        {header:Explore.i18n("LastRefreshed"),dataIndex:"LastRefreshed",width:175,sortable:false},
        {header:Explore.i18n("RefreshSource"),dataIndex:"RefreshSourceNextTime",width:200,sortable:false},
        b
    ],viewConfig:{forceFit:true}}};
    Ext.apply(this, Ext.apply(this.initialConfig, d));
    Explore.view.SourceList.superclass.initComponent.apply(this, arguments)
},projectsConverter:function(b, a) {
    var d = "";
    if (a.Projects != null) {
        if (a.Projects.length > 0) {
            for (var c = 0; c < a.Projects.length - 1; c++) {
                d += a.Projects[c].Value + ", "
            }
            d += a.Projects[a.Projects.length - 1].Value
        }
    }
    return d
},lastRefreshedDate:function(b, a) {
    return Explore.base.getLastRefreshedValue(a)
},refreshSourceNextTime:function(b, a) {
    return Explore.base.getRefreshSourceValue(a)
},loadData:function(c) {
    var b = this;
    var a = false;
    Explore.view.StatusBox.showBusy(Explore.i18n("Loading...") + "...", function() {
        a = true;
        b.close()
    });
    b.dataSourceId = c;
    if (!a) {
        b.store.load({params:{start:0,limit:b.pageSize}});
        Explore.view.StatusBox.close()
    }
},clearData:function() {
    this.store.loadData({totalFeeds:0,feeds:[]})
},getMask:function() {
    return new Ext.LoadMask(this.getEl() || Ext.getBody(), {msg:Explore.i18n("Loading_")})
}});
Ext.reg("explore.view.sourcelist", Explore.view.SourceList);
Ext.ns("Explore.view");
Explore.view.StateProvider = Ext.extend(Ext.state.Provider, {constructor:function(a) {
    Explore.view.StateProvider.superclass.constructor.call(this);
    this._saveTask = null
},set:function(c, d) {
    var a = Explore.data.PreferenceDataStore.getPreferences();
    if (a.ExtState == null) {
        a.ExtState = {}
    }
    var b = a.ExtState;
    b[c] = d;
    if (!this._saveTask) {
        this._saveTask = new Ext.util.DelayedTask(function() {
            Explore.data.PreferenceDataStore.save()
        })
    }
    this._saveTask.delay(500)
},clear:function(c) {
    var a = Explore.data.PreferenceDataStore.getPreferences();
    if (a.ExtState == null) {
        return
    }
    var b = a.ExtState;
    delete b[c];
    Explore.data.PreferenceDataStore.save()
},get:function(d, a) {
    var b = Explore.data.PreferenceDataStore.getPreferences();
    if (b.ExtState == null) {
        b.ExtState = {}
    }
    var c = b.ExtState;
    return c[d] || a
}});
Ext.ns("Explore.view");
Explore.view.StatusBox = {close:function() {
    Ext.MessageBox.hide()
},showBusy:function(c, a) {
    var b = {msg:c,closable:false,width:300,icon:"ext-mb-loading"};
    if (typeof a == "function") {
        b.buttons = Ext.MessageBox.CANCEL;
        b.fn = function(d, e) {
            if (d === "cancel") {
                Ext.MessageBox.hide();
                a()
            }
        }
    }
    Ext.MessageBox.show(b)
},showInfo:function(b, a) {
    Ext.MessageBox.show({title:b,msg:a,buttons:Ext.MessageBox.OK,icon:Ext.MessageBox.INFO})
},showInformation:function(b, a, c) {
    Ext.MessageBox.show({title:b,msg:a,buttons:Ext.MessageBox.OK,fn:c,icon:Ext.MessageBox.INFO})
},showQuestion:function(b, a, c) {
    Ext.MessageBox.show({title:b,msg:a,buttons:Ext.MessageBox.OK,fn:c,icon:Ext.MessageBox.QUESTION})
},showWarning:function(b, a, c) {
    Ext.MessageBox.show({title:b,msg:a,buttons:Ext.MessageBox.OK,fn:c,icon:Ext.MessageBox.WARNING})
},showError:function(b, a, c) {
    Ext.MessageBox.show({title:b,msg:a,buttons:Ext.MessageBox.OK,fn:c,icon:Ext.MessageBox.ERROR})
},prompt:function(f, e, b, g, d, c) {
    var a = e;
    if (c) {
        a += "<br />" + c
    }
    Ext.MessageBox.prompt(f, a, function(j, m) {
        if (j === "ok") {
            var k = true;
            var h = Ext.form.VTypes[d];
            if (h) {
                if (!h(m)) {
                    k = false;
                    var l = Ext.form.VTypes[d + "Text"];
                    Explore.view.StatusBox.prompt(f, e, m, g, d, l)
                }
            }
            if (k) {
                if (g) {
                    g(m)
                }
            }
        }
    }, null, null, b || "")
},confirm:function(b, a, c) {
    Ext.MessageBox.confirm(b, a, function(d) {
        if (d === "yes") {
            if (c) {
                c()
            }
        }
    })
}};
Ext.ns("Explore.view");
Explore.view.TagAdminDialog = Ext.extend(Explore.base.EditorDialog, {readOnly:false,itemDescription:Explore.i18n("Tags"),initComponent:function() {
    var a = this;
    a.formItems = [
        {xtype:"explore.view.tagspanel",itemId:"tagsPanel",anchor:"100% 100%",hideLabel:true}
    ];
    Explore.view.TagAdminDialog.superclass.initComponent.apply(this, arguments)
},getTitle:function() {
    return Explore.i18n("CreateDeleteTags")
},isDirty:function() {
    return this.getByItemId("tagsPanel").isDirty()
},saveAndClose:function() {
    var a = this;
    a.getByItemId("tagsPanel").saveTags(function(b) {
        a.fireEvent("save", a, b);
        a.bypassDirtyCheck = true;
        a.close()
    })
}});
Ext.ns("Explore.view");
Explore.view.TagsDialog = Ext.extend(Ext.Window, {rowObjects:null,width:400,height:400,closeAction:"close",modal:true,initComponent:function() {
    var a = this;
    a.tagsCheckedInitial = null;
    if (a.rowObjects.length === 1) {
        if (a.rowObjects[0].tag != null) {
            a.tagsCheckedInitial = a.rowObjects[0].tag.split(Explore.TAG_SEPARATOR)
        }
    }
    var b = {itemId:"tags-dialog",cls:"tags-dialog",title:Explore.i18n("AddAndRemoveTagsToSelectedResult"),layout:"fit",items:{xtype:"panel",itemId:"mainPanel",autoScroll:true,border:false,padding:"10",items:[
        {xtype:"label",cls:"header-directions",text:Explore.i18n("CheckTheTagsToApplyToTheSelectedResult"),margins:"0 0 7 0"}
    ]},buttons:[
        {text:Explore.i18n("CreateDeleteTags"),hidden:false,disabled:!Explore.Security.isAuthorized("CREATE_DELETE_TAGS"),handler:function() {
            var c = new Explore.view.TagAdminDialog({listeners:{save:function(e, d) {
                a.populateTags()
            }}});
            c.show()
        }},
        {text:Explore.i18n("Ok"),handler:a.saveTags,scope:this},
        {text:Explore.i18n("textCancel"),handler:function() {
            a.close()
        }}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.TagsDialog.superclass.initComponent.apply(this, arguments);
    a.on("afterrender", function() {
        a.populateTags()
    })
},populateTags:function() {
    log.debug("populateTags ()");
    var a = this;
    Explore.data.MetaDataStore.getTags(function(b) {
        log.debug("TagsDialog adding tags");
        if (b && b.length) {
            var h = a.getByItemId("tagsCheckGroup");
            if (h != null) {
                h.ownerCt.remove(h)
            }
            var g = {itemId:"tagsCheckGroup",xtype:"checkboxgroup",columns:1,items:[]};
            for (var d = 0; d < b.length; d++) {
                var c = b[d].TagName;
                var e = b[d].Id;
                g.items.push({boxLabel:c,tag:{Id:e,TagName:c},checked:a.isChecked(c)})
            }
            var f = a.getByItemId("mainPanel");
            f.add(g);
            f.doLayout()
        }
    })
},updateOriginalRows:function(a) {
    var b = this;
    for (var e = 0; e < b.rowObjects.length;
         e++) {
        var f = b.rowObjects[e];
        f.tag = a
    }
    var c = Ext.getCmp("searchPanel");
    var d = c.getSearchPresenter();
    d.refreshGrid()
},saveTags:function() {
    var b = this;
    var a = [];
    for (var f = 0; f < b.rowObjects.length; f++) {
        var g = b.rowObjects[f];
        a.push({id:g.id,type:g.type})
    }
    var e = [];
    var d = [];
    var c = b.getByItemId("tagsCheckGroup").getValue();
    for (var f = 0; f < c.length; f++) {
        e.push(c[f].tag);
        d.push(c[f].tag.TagName)
    }
    Explore.data.MetaDataStore.assignTags(a, e, function(j) {
        if (j) {
            var h = d.join(Explore.TAG_SEPARATOR);
            b.updateOriginalRows(h);
            b.close()
        } else {
            log.warn("Error saving tags")
        }
    })
},isChecked:function(c) {
    var a = this;
    if (a.tagsCheckedInitial !== null) {
        for (var b = 0;
             b < a.tagsCheckedInitial.length; b++) {
            if (a.tagsCheckedInitial[b] == c) {
                return true
            }
        }
    }
    return false
}});
Ext.ns("Explore.view");
Explore.view.TagsPanel = Ext.extend(Ext.Container, {_isDirty:false,initComponent:function() {
    var a = this;
    a.tagsToRemove = [];
    var c = {layout:{type:"hbox",align:"middle"},border:false,margins:"0 0 10 0",defaults:{margins:"0 5 0 0"},items:[
        {xtype:"label",text:Explore.i18n("AddTag")},
        {xtype:"textfield",itemId:"add-text-field",width:300,emptyText:"(enter tag name)",enableKeyEvents:true,listeners:{keyup:function(d, f) {
            var g = (d.getRawValue().trim() === "");
            a.getByItemId("add-tag-button").setDisabled(g);
            if (!g) {
                if (f.getKey() == f.RETURN || f.getKey() == f.ENTER) {
                    a.addTagToGrid()
                }
            }
        },select:function(d, f) {
            var g = (d.getValue().trim() === "");
            a.getByItemId("add-tag-button").setDisabled(g)
        }}},
        {xtype:"button",itemId:"add-tag-button",text:Explore.i18n("Add"),disabled:true,handler:a.addTagToGrid,scope:this}
    ]};
    var b = {layout:{type:"vbox",align:"stretch"},items:[c,this.createGrid()]};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.TagsPanel.superclass.initComponent.apply(this, arguments);
    a.on("afterrender", function() {
        Explore.data.MetaDataStore.getTags(function(d) {
            a.updateGridEmptyText();
            a._grid.getStore().loadData(d)
        })
    })
},isDirty:function() {
    return this._isDirty
},removeTag:function(c) {
    var a = c.get("isNew") === true;
    if (!a) {
        var b = c.json.Id;
        this.tagsToRemove.push(c.json)
    }
},saveTags:function(h) {
    var j = this;
    var d,l;
    var b = j._grid.getStore().getRange();
    var g = [];
    for (var d = 0; d < b.length; d++) {
        var c = b[d];
        var l = c.get("TagName");
        var e = c.get("isNew") === true;
        var f = c.dirty;
        var a = c.get("Id");
        if (!e && f) {
            g.push({Id:a,TagName:l})
        }
        if (e) {
            g.push({Id:0,TagName:l})
        }
    }
    for (d = 0; d < j.tagsToRemove.length; d++) {
        a = j.tagsToRemove[d].Id;
        l = j.tagsToRemove[d].TagName;
        g.push({Id:a,TagName:l,Delete:true})
    }
    if (g.length > 0) {
        Explore.data.MetaDataStore.saveTags(g, function(m) {
            if (m.ErrorCode == 0) {
                var n = m.Result;
                if (h) {
                    h(n)
                }
            } else {
                Explore.view.StatusBox.showError(Explore.i18n("appTitle"), Explore.i18n("ThereWasAnErrorSavingTheTags"))
            }
        })
    } else {
        var k = Explore.data.MetaDataStore.getTags2();
        if (h) {
            h(k)
        }
    }
},addTagToGrid:function() {
    log.info("Add tag to grid");
    var d = this;
    var b = d.getByItemId("add-text-field");
    var c = d._grid.getStore();
    var f = b.getValue().trim();
    if (f != "") {
        var e = new c.recordType({TagName:f,isNew:true});
        d._grid.stopEditing();
        c.add(e);
        var a = c.getSortState();
        c.sort(a.field, a.direction);
        d.setEditButtonDisabled(true);
        b.setValue("");
        b.focus();
        d._isDirty = true
    }
},setEditButtonDisabled:function(b) {
    var a = this._grid.fbar.getByItemId("delete-tag-button");
    a.setDisabled(b)
},updateGridEmptyText:function() {
    var a = this._grid.getView();
    a.emptyText = "(" + Explore.i18n("notagsdefined") + ")"
},createGrid:function() {
    var a = this;
    a._grid = new Ext.grid.EditorGridPanel({itemId:"topicsEditGrid",flex:1,autoExpandColumn:"Tag",enableColumnHide:false,enableColumnMove:false,enableColumnResize:false,columns:[
        {header:Explore.i18n("Id"),sortable:true,dataIndex:"Id",editable:false,hidden:true,id:"TagId"},
        {header:Explore.i18n("Tags"),sortable:true,dataIndex:"TagName",editable:true,editor:new Ext.form.TextField({allowBlank:false}),id:"Tag"}
    ],store:new Ext.data.JsonStore({storeId:"gridStore",fields:[
        {name:"Id"},
        {name:"TagName"},
        {name:"isNew"}
    ],data:[],sortInfo:{field:"TagName",direction:"ASC"},listeners:{update:function(d, b, c) {
        a._isDirty = true
    }}}),buttonAlign:"left",viewConfig:{emptyText:"(" + Explore.i18n("loadingTags") + ")",deferEmptyText:false},fbar:[
        {xtype:"button",itemId:"delete-tag-button",text:Explore.i18n("Delete"),tooltip:Explore.i18n("DeleteTheSelectedTag"),disabled:true,handler:function() {
            var d = a._grid;
            var b = d.getSelectionModel().getSelectedCell();
            if (b) {
                var c = d.getStore().getAt(b[0]);
                a.removeTag(c);
                d.getStore().removeAt(b[0]);
                a.setEditButtonDisabled(true);
                a._isDirty = true
            }
        }}
    ]});
    a._grid.getSelectionModel().on("selectionchange", function(b, c) {
        if (c) {
            a.setEditButtonDisabled(false)
        } else {
            a.setEditButtonDisabled(true)
        }
    });
    return a._grid
}});
Ext.reg("explore.view.tagspanel", Explore.view.TagsPanel);
Ext.ns("Explore.view");
Explore.view.Ticker = Ext.extend(Ext.BoxComponent, {border:false,initComponent:function() {
    var a = this;
    a.myTicker = null;
    var b = {autoEl:{tag:"div",html:'<ul id="recentTickerList" style="visibility:hidden"></ul>'}};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.Ticker.superclass.initComponent.apply(this, arguments);
    a.on("afterrender", function(c) {
        Explore.data.IDOLDataStore.getTickerString(function(d) {
            Ext.get("recentTickerList").update("<li>" + d + "</li>");
            window.setTimeout(function() {
                a.myTicker = new a.TickerAnimator("recentTickerList")
            }, 1000)
        })
    })
},TickerAnimator:function(b, e) {
    e = Ext.apply({moveAmount:4,delay:60}, e);
    var j = this;
    var d = null;
    var k = Ext.get(b);
    k.addClass("ticker");
    k.setStyle("visibility", "visible");
    var o = k.wrap({tag:"div",cls:"mask"});
    var f = o.wrap({tag:"div",cls:"ticker-container"});
    var l = f.getWidth();
    log.debug("ticker containerWidth=" + l);
    var n = 50;
    var h = l + n;
    k.setLeft(h);
    var c = 0;
    var a = k.select("li");
    a.each(function(p) {
        c += p.getWidth()
    });
    k.setWidth(c);
    var m = c + l;
    k.on({mouseover:function() {
        j.stopTicker()
    },mouseout:function() {
        j.startTicker()
    }});
    function g() {
        h -= e.moveAmount;
        if (h < -c) {
            h = l + n
        }
        k.setLeft(h)
    }

    this.stopTicker = function() {
        if (d !== null) {
            window.clearInterval(d);
            d = null
        }
    };
    this.startTicker = function() {
        if (d === null) {
            d = window.setInterval(g, e.delay)
        }
    };
    this.startTicker()
},stopTicker:function() {
    if (this.myTicker) {
        this.myTicker.stopTicker()
    }
},startTicker:function() {
    if (this.myTicker) {
        this.myTicker.startTicker()
    }
}});
Ext.reg("explore.view.ticker", Explore.view.Ticker);
Ext.ns("Explore.view");
Explore.view.TopicDialog = Ext.extend(Explore.base.EditorDialog, {itemDescription:Explore.i18n("Topic"),newTerms:null,readOnly:true,height:550,newTermsAdded:false,initComponent:function() {
    this.addTermsToTopic();
    this.formItems = this.getFormItems();
    Explore.view.TopicDialog.superclass.initComponent.apply(this, arguments)
},addTermsToTopic:function() {
    var c = this.newTerms;
    var a = this.editObject;
    if (c !== null && c !== undefined) {
        if (!a.Phrases) {
            a.Phrases = []
        }
        for (var b = c.length - 1; b > -1; --b) {
            if (!this.phrasesContains(a.Phrases, c[b])) {
                a.Phrases.push({Weight:100,Phrase:c[b]});
                this.newTermsAdded = true
            }
        }
    }
},phrasesContains:function(a, c) {
    for (var b = 0; b < a.length; b++) {
        if (a[b].Phrase === c) {
            return true
        }
    }
    return false
},getFormItems:function() {
    var b = this;
    var a = [
        {name:"Name",allowBlank:false,maxLength:60,vtype:"usersyntaxName"},
        {xtype:b.readOnly ? "displayfield" : "textarea",name:"Description",allowBlank:true,height:40,maxLength:500},
        {xtype:"container",border:false,layout:{type:"hbox",align:"middle"},fieldLabel:Explore.i18n("TargetValue"),items:[
            {xtype:b.readOnly ? "displayfield" : "spinnerfield",minValue:1,name:"Target",itemId:"target-per-day",format:"0",width:b.readOnly ? undefined : 60,allowBlank:false},
            {xtype:"panel",margins:"0 0 0 5",html:Explore.i18n("perDay"),border:false}
        ]}
    ];
    if (!b.readOnly) {
        a.push({xtype:"checkbox",itemId:"use-in-root-cause-analysis",name:"EnableRootCauseAnalysis",hideLabel:true,boxLabel:Explore.i18n("EnableRootCauseAnalysis"),margins:"10 0 0 0"});
        a.push({xtype:"combo",itemId:"root-cause-analysis-associated-topic-group",name:"AssociatedTopicGroup",width:"90%",labelStyle:"width:290px",lazyInit:false,lazyRender:false,mode:"remote",valueField:"Id",value:null,displayField:"Name",triggerAction:"all",lazyRender:false,selectOnFocus:true,emptyText:"(" + Explore.i18n("SelectTopicGroup") + ")",valueNotFoundText:"(" + Explore.i18n("SelectTopicGroup") + ")",store:new Ext.data.DirectStore({storeId:"topiSectionsDataStore",idProperty:"Id",autoLoad:true,directFn:TopicService.GetTopicSections,fields:["Id","Name"],listeners:{load:function(d, c, e) {
            var f = b.getByItemId("root-cause-analysis-associated-topic-group");
            if (b.editObject && b.editObject.AssociatedTopicGroup && f) {
                f.setValue(b.editObject.AssociatedTopicGroup)
            }
        }}})})
    }
    a.push({xtype:"explore.view.phraseweights",name:"Phrases",hideLabel:true,margins:"0 10 10 10",readOnly:b.readOnly,allowLexicons:true,anchor:"100% -220"});
    a.push({itemId:"searchcriteriasummarylink",xtype:"explore.view.searchcriteriasummarylink",readOnly:b.readOnly,fieldLabel:Explore.i18n("SearchCriteria"),searchDialogConfig:{showSearchTerms:false}});
    return a
},isDirty:function() {
    var a = Explore.view.TopicDialog.superclass.isDirty.call(this);
    a |= this.getByItemId("searchcriteriasummarylink").isDirty();
    if (this.newTermsAdded === true) {
        a = true
    }
    return a
},isValid:function(a) {
    var b = Explore.view.TopicDialog.superclass.isValid.call(this, a);
    return b
},displayObject:function() {
    Explore.view.TopicDialog.superclass.displayObject.call(this);
    this.getByItemId("searchcriteriasummarylink").setValue(this.editObject.SearchInfo)
},populateObject:function() {
    Explore.view.TopicDialog.superclass.populateObject.call(this);
    this.editObject.SearchInfo = this.getByItemId("searchcriteriasummarylink").getValue()
}});
Ext.reg("explore.view.topicdialog", Explore.view.TopicDialog);
Ext.ns("Explore.view");
Explore.view.TopicManagerDialog = Ext.extend(Ext.Window, {modal:true,terms:null,width:600,height:350,initComponent:function() {
    var a = this;
    this.topicPicker = new Explore.view.TopicPicker({height:250,border:false,checkable:false,fieldLabel:Explore.i18n("ForTopics"),listeners:{selectionchange:this.topicPickerSelectionChange,scope:this}});
    var b = {title:Explore.i18n("AddToCreateTopic"),layout:"fit",items:[a.topicPicker],buttons:[
        {xtype:"button",itemId:"editTopicButton",text:Explore.i18n("EditTopic"),disabled:true,handler:function() {
            a.topicPicker.editTopic({newTerms:a.terms})
        }},
        {xtype:"button",text:Explore.i18n("CreateTopic"),itemId:"createTopicButton",disabled:!Explore.Security.isAuthorized("TOPICS_MY_CREATE"),handler:function() {
            a.topicPicker.createCustomTopic({newTerms:a.terms})
        }},
        {xtype:"button",text:Explore.i18n("Close"),handler:function() {
            a.close()
        }}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.TopicManagerDialog.superclass.initComponent.apply(this, arguments);
    this.on("event", this.myfunc, this)
},topicPickerSelectionChange:function(b, c) {
    var a = b.getItemPermissionDisabled("TOPICS_UPDATE");
    this.getByItemId("editTopicButton").setDisabled(a)
}});
Ext.ns("Explore.view");
Explore.view.TopicPicker = Ext.extend(Ext.tree.TreePanel, {checkable:false,rootCause:false,includeMyTopics:true,includeAllProjects:false,showImportExport:false,enableDrag:true,enableDrop:true,contextMenuNode:null,padding:"0 0 10 0",containerScroll:true,showTools:false,showExpandCollapseAll:false,enableDD:false,cls:"topic-picker-tree hierarchy-tree",collapsible:false,useArrows:true,autoScroll:true,animate:true,disabled:true,maskDisabled:true,initComponent:function() {
    var e = this;
    this.refreshTimestamp = new Date();
    var d = new Ext.tree.TreeNode({nodeType:"node",text:"root",id:"SECTION:0",expanded:true,tag:{type:"SECTION",readOnly:true,id:0,isCustom:false}});
    var g = e.checkable ? false : undefined;
    var a = new Ext.tree.TreeLoader({preloadChildren:true,clearOnLoad:true,directFn:TopicService.GetTopicHierarchyNodes,paramOrder:"node rootCause includeAllProjects includeMyTopics",baseParams:{rootCause:e.rootCause,includeAllProjects:e.includeAllProjects,includeMyTopics:e.includeMyTopics},baseAttrs:{uiProvider:Ext.tree.TriStateNodeUI,checked:g,allowDrop:true,singleClickExpand:true,expanded:e.checkable}});
    var f = {root:d,rootVisible:false,loader:a,keys:[
        {key:Ext.EventObject.DELETE,fn:function() {
            if (Explore.Security.isAuthorized("TOPICS_DELETE")) {
                try {
                    var j = e.getSelectionModel().getSelectedNode();
                    if (j) {
                        var h = j.attributes.tag.type;
                        if (h === "SECTION") {
                            e.deleteSection(j)
                        } else {
                            e.deleteTopic(j)
                        }
                    }
                } catch(k) {
                }
            }
        },scope:e},
        {key:"r",fn:function() {
            e.refresh(null, function() {
                e.expandTopNodes();
                var h = e.getRootNode().firstChild;
                h.select()
            })
        }},
        {key:Ext.EventObject.F2,fn:function() {
            try {
                var j = e.getSelectionModel().getSelectedNode();
                if (j) {
                    var h = j.attributes.tag.type;
                    if (h === "SECTION") {
                        e.renameTopicSection({}, j)
                    } else {
                        e.renameTopic({}, j)
                    }
                }
            } catch(k) {
            }
        }}
    ]};
    e.initTools(f);
    Ext.apply(this, Ext.apply(this.initialConfig, f));
    Explore.view.TopicPicker.superclass.initComponent.apply(this, arguments);
    e.refresh(null, function() {
        e.expandTopNodes();
        Explore.view.TopicPicker.lastRefresh = new Date()
    });
    e.getSelectionModel().on("selectionchange", function() {
        var h = e.getSelectionModel().getSelectedNode();
        e.fireEvent("selectionchange", e, h)
    });
    e.on("contextmenu", e.onTopicContextMenu, e);
    e.on("beforenodedrop", e.onTopicPanelNodeDrop, e);
    e.on("nodeDragOver", e.onTopicNodeDragOver, e);
    var c = Ext.ComponentMgr.get("explore-app");
    if (c) {
        var b = e.getMask();
        e.on("afterlayout", function() {
            if (!e.initiallyLoaded) {
                if (b) {
                    b.hide()
                }
                b = e.getMask();
                if (e.disabled) {
                    b.show()
                }
            }
        });
        e.on("show", function() {
            e.refreshDirty()
        });
        Explore.data.TopicDataStore.on("topicSaved", function(h) {
            e.requiresRefresh()
        });
        Explore.data.TopicDataStore.on("deletetopic", function(h) {
            e.requiresRefresh()
        });
        Explore.data.TopicDataStore.on("deletetopicsection", function(h) {
            e.requiresRefresh()
        });
        e.getLoader().on("beforeload", function(h) {
            e.disable();
            b.show()
        });
        e.getLoader().on("load", function(k) {
            var h = e.getRootNode();
            e.enable();
            var j = e.getSelectionModel();
            var l = j.getSelectedNode();
            if (!l && h && h.firstChild) {
                h.firstChild.ensureVisible(h.firstChild.select)
            }
            b.hide();
            e.fireEvent("checkAllTopics", e);
            if (!e.initiallyLoaded) {
                e.initiallyLoaded = true;
                e.fireEvent("treeloaded", e)
            }
        });
        e.getLoader().on("loadexception", function(h, k, j) {
            b.hide()
        })
    }
    if (this.showTools) {
        e.on("collapse", function() {
            e.toolDecorator.disableTools(["edit","delete"])
        });
        e.on("expand", function() {
            e.enabledToolsIfNodeSelected()
        })
    }
},getMask:function() {
    return new Ext.LoadMask(this.getEl() || Ext.getBody(), Explore.i18n("Loading..."))
},expandTopNodes:function() {
    var a = this.getRootNode().childNodes;
    for (var b = 0; b < a.length; b++) {
        if (a[b].rendered) {
            a[b].expand()
        } else {
            a[b].expanded = true
        }
    }
},initTools:function(b) {
    var a = this;
    if (this.showTools) {
        if (!b.tools) {
            b.tools = []
        }
        b.tools.push({id:"edit",qtip:Explore.i18n("EditTopic"),disabled:true,handler:function(f, e, d) {
            if (!e.hasClass("disabled")) {
                var g = a.getSelectionModel().getSelectedNode();
                if (g) {
                    var c = g.attributes.tag.type;
                    if (c === "TOPIC") {
                        a.editTopic({}, g)
                    } else {
                    }
                }
            }
        }});
        b.tools.push({id:"delete",qtip:Explore.i18n("DeleteTopic"),disabled:true,handler:function(f, e, d) {
            if (!e.hasClass("disabled")) {
                var g = a.getSelectionModel().getSelectedNode();
                if (g) {
                    var c = g.attributes.tag.type;
                    if (c === "TOPIC") {
                        a.deleteTopic(g)
                    } else {
                        a.deleteSection(g)
                    }
                }
            }
        }});
        a.toolDecorator = new Explore.view.common.DisabledToolDecorator(a, b);
        a.getSelectionModel().on("selectionchange", a.enabledToolsIfNodeSelected, a)
    }
    if (this.showExpandCollapseAll) {
        if (!b.tools) {
            b.tools = []
        }
        b.tools.push({id:"plus",qtip:Explore.i18n("ExpandAll"),handler:function() {
            a.expandAll()
        }});
        b.tools.push({id:"minus",qtip:Explore.i18n("CollapseAll"),handler:function() {
            a.collapseAll()
        }});
        b.tools.push({id:"refresh",qtip:Explore.i18n("refresh"),handler:function() {
            a.refresh(null, function() {
                var c = a.getRootNode().firstChild;
                if (c) {
                    c.select()
                }
                a.expandTopNodes()
            })
        }})
    }
},getSelectedTopicIds:function() {
    var c = this.getChecked();
    var d = [];
    if (c) {
        for (var a = 0;
             a < c.length; a++) {
            var b = c[a];
            if (b.isLeaf()) {
                d.push(b.attributes.tag.id)
            }
        }
    }
    return d
},getSelectedTopicNames:function() {
    var c = this.getChecked();
    var d = [];
    if (c) {
        for (var a = 0; a < c.length; a++) {
            var b = c[a];
            if (b.isLeaf()) {
                d.push(b.text)
            }
        }
    }
    return d
},getItemPermissionDisabled:function(a, b) {
    if (b == null) {
        b = this.getSelectionModel().getSelectedNode()
    }
    if (b) {
        if (b.attributes.tag.isCustom) {
            return !Explore.Security.isAuthorized("TOPICS_MY_CREATE")
        } else {
            return !Explore.Security.isAuthorized(a)
        }
    } else {
        return true
    }
},enabledToolsIfNodeSelected:function() {
    var b = this;
    var c = b.getSelectionModel().getSelectedNode();
    if (c) {
        var a = c.attributes.tag.type;
        if (a === "TOPIC") {
            if (this.getItemPermissionDisabled("TOPICS_UPDATE", c)) {
                b.toolDecorator.disableTools(["edit"])
            } else {
                b.toolDecorator.enableTools(["edit"])
            }
            if (this.getItemPermissionDisabled("TOPICS_DELETE", c)) {
                b.toolDecorator.disableTools(["delete"])
            } else {
                b.toolDecorator.enableTools(["delete"])
            }
        } else {
            b.toolDecorator.disableTools(["edit","delete"])
        }
    } else {
        b.toolDecorator.disableTools(["edit","delete"])
    }
},onTopicNodeDragOver:function(d) {
    var c = d.target,a = d.dropNode.parentNode,b = (c === a);
    if (b) {
        d.cancel = true
    }
},onTopicPanelNodeDrop:function(d) {
    var c = this,b = d.target,a = b.attributes.tag;
    dropTargetNodeType = a.type,dropTargetNodeId = a.id,dropTargetNodeIsCustom = a.isCustom,dropNode = d.dropNode,dropNodeTag = dropNode.attributes.tag,dropNodeType = dropNodeTag.type,dropNodeId = a.id,dropNodeIsCustom = dropNodeTag.isCustom,mask = c.getMask();
    d.cancel = true;
    if (this.isSharedTopic(dropNode) && !this.isSharedTopic(b)) {
        if (dropNodeType === "TOPIC") {
            if (!Explore.Security.isAuthorized("TOPICS_MY_CREATE")) {
                Explore.view.StatusBox.showWarning(Explore.i18n("Topic Move"), Explore.i18n("You don't have necessary permission to complete this operation"))
            } else {
                Explore.view.StatusBox.confirm(Explore.i18n("Move Topic"), Explore.i18n("<i>Shared Topics</i> cannot be moved into <i>My Topics</i>.  Would you like to copy the Topic instead?"), function() {
                    mask.show();
                    c.copyTopicToTargetNode(dropNode, b, function() {
                        mask.hide()
                    })
                })
            }
        } else {
            if (!Explore.Security.isAuthorized("TOPICS_MY_CREATE")) {
                Explore.view.StatusBox.showWarning(Explore.i18n("Topic Move"), Explore.i18n("You don't have necessary permission to complete this operation"))
            } else {
                Explore.view.StatusBox.confirm(Explore.i18n("Move Topic Section"), Explore.i18n("<i>Shared Topics</i> cannot be moved into <i>My Topics</i>.  Would you like to copy the Topic Section instead?"), function() {
                    mask.show();
                    c.copyTopicSectionToTargetNode(dropNode, b, function() {
                        mask.hide()
                    })
                })
            }
        }
    } else {
        if (!Explore.Security.isAuthorized("TOPICS_CREATE")) {
            Explore.view.StatusBox.showWarning(Explore.i18n("Topic Move"), Explore.i18n("You don't have necessary permission to complete this operation"))
        } else {
            mask.show();
            if (dropNodeType === "TOPIC") {
                this.moveTopicToTargetNode(dropNode, b, function() {
                    mask.hide()
                })
            } else {
                this.moveTopicSectionToTargetNode(dropNode, b, function() {
                    mask.hide()
                })
            }
        }
    }
},moveTopicToTargetNode:function(c, a, g) {
    var b = this,d = c.attributes.tag.id,e = (a.attributes.tag.type === "SECTION") ? a : a.parentNode,f = e.attributes.tag.id;
    Explore.data.TopicDataStore.moveTopic(f, d, function(h) {
        if (!h || h.ErrorCode) {
            var k = Explore.i18n("Unexpected Error"),j = (h && h.Message) ? h.Message : Explore.i18n("Unexpected Error");
            Explore.view.StatusBox.showError(k, j)
        }
        b.requiresRefresh();
        b.refreshDirty(null, g)
    })
},moveTopicSectionToTargetNode:function(c, a, g) {
    var b = this,d = c.attributes.tag.id,e = (a.attributes.tag.type === "SECTION") ? a : a.parentNode,f = e.attributes.tag.id;
    Explore.data.TopicDataStore.moveTopicSection(f, d, function(h) {
        if (!h || h.ErrorCode) {
            var k = Explore.i18n("Unexpected Error"),j = (h && h.Message) ? h.Message : Explore.i18n("Unexpected Error");
            Explore.view.StatusBox.showError(k, j)
        }
        b.requiresRefresh();
        b.refreshDirty(null, g)
    })
},copyTopicToTargetNode:function(c, a, g) {
    var b = this,d = c.attributes.tag.id,e = (a.attributes.tag.type === "SECTION") ? a : a.parentNode,f = e.attributes.tag.id;
    Explore.data.TopicDataStore.copyTopic(f, d, function(h) {
        if (!h || h.ErrorCode) {
            var k = Explore.i18n("Unexpected Error"),j = (h && h.Message) ? h.Message : Explore.i18n("Unexpected Error");
            Explore.view.StatusBox.showError(k, j)
        }
        b.requiresRefresh();
        b.refreshDirty(null, g)
    })
},copyTopicSectionToTargetNode:function(c, a, g) {
    var b = this,d = c.attributes.tag.id,e = (a.attributes.tag.type === "SECTION") ? a : a.parentNode,f = e.attributes.tag.id;
    Explore.data.TopicDataStore.copyTopicSection(f, d, function(h) {
        if (!h || h.ErrorCode) {
            var k = Explore.i18n("Unexpected Error"),j = (h && h.Message) ? h.Message : Explore.i18n("Unexpected Error");
            Explore.view.StatusBox.showError(k, j)
        }
        b.requiresRefresh();
        b.refreshDirty(null, g)
    })
},isSharedTopic:function(a) {
    if (!a.parentNode || a.parentNode.attributes.tag.id === 2 || a.attributes.tag.id === 2) {
        return false
    } else {
        if (a.parentNode.attributes.tag.id === 0) {
            return true
        } else {
            return this.isSharedTopic(a.parentNode)
        }
    }
},_updateMenuItemPerm:function(f, d, e, c, a) {
    var b = f.getByItemId(e);
    if (a !== true) {
        a = this.getItemPermissionDisabled(c, d)
    }
    b.setDisabled(a)
},getTopicSectionContextMenu:function(b) {
    var a = this;
    if (!this._topicSectionContextMenu) {
        this._topicSectionContextMenu = new Ext.menu.Menu({items:[
            {text:Explore.i18n("AddTopic"),itemId:"addTopic",handler:function() {
                var d = parseInt(a.contextMenuNode.attributes.tag.id, 10);
                log.info("AdministrationTopicsPanel - Add Topic parentTopicSectionId=", d);
                a.createTopicInSection({}, a.contextMenuNode)
            }},
            {text:Explore.i18n("AddSection"),itemId:"addSection",handler:function() {
                a.createTopicSection({}, a.contextMenuNode)
            }},
            {text:Explore.i18n("EditGroup"),itemId:"edit",handler:function() {
                a.renameTopicSection({}, a.contextMenuNode)
            }},
            {text:Explore.i18n("Delete"),itemId:"delete",iconCls:"delete-icon",handler:function() {
                a.deleteSection(a.contextMenuNode)
            }},
            {xtype:"menuseparator",hidden:!a.showImportExport},
            {text:Explore.i18n("Import"),itemId:"tImport",iconCls:"import-icon",hidden:!a.showImportExport,disabled:!Explore.Security.isAuthorized("TOPICS_IMPORT_EXPORT"),handler:function() {
                var d = new Explore.view.ImportTopicWindow({nodeId:a.contextMenuNode.attributes.tag.id,isCustom:a.contextMenuNode.attributes.tag.isCustom});
                d.on("close", function() {
                    a.refresh(a.contextMenuNode)
                });
                d.start()
            }},
            {text:Explore.i18n("Export"),itemId:"tExport",iconCls:"export-icon",hidden:!a.showImportExport,disabled:!Explore.Security.isAuthorized("TOPICS_IMPORT_EXPORT"),handler:function() {
                if (a.contextMenuNode) {
                    if (a.contextMenuNode.attributes.leaf) {
                        a.exportTopic(a.contextMenuNode)
                    } else {
                        a.exportTopicSection(a.contextMenuNode)
                    }
                }
            }}
        ]})
    }
    var c = this._topicSectionContextMenu;
    this._updateMenuItemPerm(c, b, "addTopic", "TOPICS_CREATE");
    this._updateMenuItemPerm(c, b, "addSection", "TOPICS_CREATE");
    this._updateMenuItemPerm(c, b, "edit", "TOPICS_UPDATE", b.attributes.tag.readOnly);
    this._updateMenuItemPerm(c, b, "delete", "TOPICS_DELETE", b.attributes.tag.readOnly);
    return c
},getTopicContextMenu:function(b) {
    var a = this;
    if (!this._topicContextMenu) {
        this._topicContextMenu = new Ext.menu.Menu({items:[
            {itemId:"edit",text:Explore.i18n("Edit"),iconCls:"edit-icon",handler:function() {
                a.contextMenuNode.select();
                a.editTopic({}, a.contextMenuNode)
            }},
            {itemId:"delete",text:Explore.i18n("Delete"),iconCls:"delete-icon",handler:function() {
                a.deleteTopic(a.contextMenuNode)
            }},
            {xtype:"menuseparator",hidden:!a.showImportExport},
            {text:Explore.i18n("Export"),iconCls:"export-icon",disabled:!Explore.Security.isAuthorized("TOPICS_IMPORT_EXPORT"),hidden:!a.showImportExport,handler:function() {
                a.exportTopic(a.contextMenuNode)
            }}
        ]})
    }
    var c = this._topicContextMenu;
    this._updateMenuItemPerm(c, b, "edit", "TOPICS_UPDATE");
    this._updateMenuItemPerm(c, b, "delete", "TOPICS_DELETE");
    return c
},onTopicContextMenu:function(d, f) {
    var a = this;
    if (d && d.attributes && d.attributes.tag) {
        f.stopEvent();
        var c = d.attributes.tag.type;
        var h = d.attributes.tag.id;
        var g = d.attributes.tag.readOnly;
        var b = null;
        if (c === "SECTION") {
            b = a.getTopicSectionContextMenu(d)
        } else {
            if (c === "TOPIC") {
                b = a.getTopicContextMenu(d)
            }
        }
        if (b) {
            d.select();
            a.contextMenuNode = d;
            b.showAt(f.getXY())
        }
    }
},exportTopic:function(c) {
    var a = this;
    var c = c || a.getSelectionModel().getSelectedNode();
    if (!c) {
        Explore.view.StatusBox.showWarning(Explore.i18n("SelectATopic"), Explore.i18n("FirstSelectATopicToExport"))
    } else {
        var b = c.attributes.tag.id;
        Explore.data.TopicDataStore.exportTopic(b, function(d) {
            Explore.utils.Exporter.exportTextToXml("text/xml", "topics.xml", d.XmlPayloadToString)
        })
    }
},exportTopicSection:function(c) {
    var a = this;
    var c = c || a.getSelectionModel().getSelectedNode();
    if (!c) {
        Explore.view.StatusBox.showWarning(Explore.i18n("appTitle"), Explore.i18n("FirstSelectATopicSectionToExport"))
    } else {
        var b = c.attributes.tag.id;
        Explore.data.TopicDataStore.exportTopicHierarchyBySectionId(b, function(d) {
            if (d !== null) {
                Explore.utils.Exporter.exportTextToXml("text/xml", "TopicSection.xml", d.XmlPayloadToString)
            }
        })
    }
},editTopic:function(b, e) {
    var a = this;
    var e = e || a.getSelectionModel().getSelectedNode();
    if (!e) {
        Explore.view.StatusBox.showWarning(Explore.i18n("SelectATopic"), Explore.i18n("FirstSelectATopicToEditATopic"))
    } else {
        var d = e.parentNode.attributes.tag.id;
        var c = e.attributes.tag.id;
        Explore.data.TopicDataStore.getTopic(c, function(f) {
            if (f !== null) {
                b = Ext.apply({editObject:f,readOnly:false,title:Explore.i18n("EditTopic")}, b);
                log.debug("Open topic dialog for topic: ", c, " config: ", b);
                a.showTopicDialog(d, b, e)
            }
        })
    }
},showTopicDialog:function(d, b, c) {
    var a = this;
    var e = new Explore.view.TopicDialog(b);
    e.show(a);
    e.on("save", function(g, f) {
        log.info("TopicPicker.saveTopic sectionId=", d, f);
        Explore.data.TopicDataStore.saveTopic(d, f, function(h) {
            log.info("TopicPicker: Topic saved", h.ErrorCode);
            if (h.ErrorCode > 0) {
                b.editObject = h.Result;
                a.showTopicDialog(d, b, c);
                Explore.view.StatusBox.showWarning(Explore.i18n("appTitle"), h.Message)
            } else {
                if (c) {
                    if (c.attributes.tag.type === "TOPIC") {
                        c.setText(h.Result.Name)
                    } else {
                        if (c.attributes.tag.type === "SECTION") {
                            a.refresh(c, function() {
                                var j = a.getNodeById(h.Result.Id);
                                if (j) {
                                    if (a.checkable) {
                                        j.getUI().toggleCheck(true)
                                    }
                                    j.ensureVisible();
                                    j.select()
                                }
                            })
                        }
                    }
                } else {
                    a.refresh()
                }
                a.requiresRefresh();
                a.fireEvent("topicSaved", d, f)
            }
        })
    })
},deleteSection:function(d) {
    var m = this;
    var h = (d.attributes.readOnly === true);
    if (h) {
        Ext.Msg.alert(Explore.i18n("Warning"), Explore.i18n("The root section cannot be deleted."));
        return
    }
    d.expand(true);
    log.info("TopicPicker.deleteSection", d);
    var j = d.parentNode;
    var b = d.attributes.tag.id;
    var a = Explore.data.TopicDataStore.deleteTopicSection;
    var g = Explore.data.TopicDataStore.deleteTopic;
    var l = function(n) {
    };
    var k = function() {
        j.select();
        m.refresh(j)
    };
    var f = [];
    var e = {name:d.attributes.text,Id:d.attributes.tag.id,leaf:d.attributes.leaf};
    f.push(e);
    var c = String.format(Explore.i18n("AreYouSureYouWantToDeleteThe_"), Explore.i18n("Topic") + " " + Explore.i18n("Group"), d.text);
    Explore.view.StatusBox.confirm(Explore.i18n("appTitle"), c, function() {
        var n = false,o = true;
        Explore.data.TopicDataStore.getTopicHierarchyBySectionId(b, n, o, function(p) {
            var r = function(u) {
                for (var w = 0;
                     w < u.length; w++) {
                    var z = u[w];
                    var A = z.Name;
                    var y = z.Id;
                    var v = true;
                    var x = {name:A,Id:y,leaf:v};
                    f.push(x)
                }
            };
            var t = function(u) {
                for (var w = 0;
                     w < u.length; w++) {
                    var z = u[w];
                    var A = z.Name;
                    var y = z.Id;
                    var v = false;
                    var x = {name:A,Id:y,leaf:v};
                    f.push(x);
                    r(z.Topics);
                    t(z.Sections)
                }
            };
            r(p.Topics);
            t(p.Sections);
            var q = {mytype:"Topic",results:f,deleteFn:g,deleteGroupFn:a,groupDelCallback:l,callback:l,cancelFn:k,doneFn:k};
            var s = new Explore.view.RecursiveDeleteWindow(q);
            s.start()
        })
    })
},deleteTopic:function(c) {
    var a = this;
    log.info("TopicPicker.deleteTopic");
    var c = c || a.getSelectionModel().getSelectedNode();
    if (!c) {
        Explore.view.StatusBox.showWarning(Explore.i18n("SelectATopic"), Explore.i18n("FirstSelectATopicToDelete"))
    } else {
        var b = c.attributes.tag.id;
        var e = function(f) {
            if (c.parentNode) {
                a.refresh(c.parentNode);
                a.requiresRefresh()
            }
            a.fireEvent("topicDeleted", b)
        };
        var d = String.format(Explore.i18n("AreYouSureYouWantToDeleteTheTopic_"), c.text);
        Explore.view.StatusBox.confirm(Explore.i18n("appTitle"), d, function() {
            var f = new Explore.view.DeleteConfirmationWindow({mytype:"Topic",deleteFn:Explore.data.TopicDataStore.deleteTopic,myId:b,callback:e});
            f.start()
        })
    }
},getDefaultTopic:function(c) {
    var a = 10;
    var b = Explore.model.Sentiment.Neutral;
    return{id:-1,IsCustom:c,Phrases:[],Target:a,Sentiment:b,Visible:true}
},getCustomSectionNode:function() {
    var b = this;
    var a = b.getRootNode().childNodes;
    for (var c = 0; c < a.length; c++) {
        var d = a[c];
        if (d.attributes.tag.isCustom) {
            return d
        }
    }
    return
},createCustomTopic:function(b) {
    var a = this;
    b = Ext.apply({editObject:a.getDefaultTopic(true),title:Explore.i18n("CreateCustomTopic"),readOnly:false}, b);
    var d = a.getCustomSectionNode();
    var c = -1;
    a.showTopicDialog(c, b, d)
},renameTopic:function(c, d) {
    var b = this;
    if (d == null) {
        d = b.getSelectionModel().getSelectedNode()
    }
    var a = d.text;
    Explore.view.StatusBox.prompt(Explore.i18n("appTitle"), Explore.i18n("Enter Topic Name"), a, function(f) {
        var e = b.getMask();
        e.show();
        Explore.data.TopicDataStore.RenameTopic(d.attributes.tag.id, f, function() {
            b.requiresRefresh();
            b.refreshDirty(null, function() {
                e.hide()
            })
        })
    })
},renameTopicSection:function(c, d) {
    var b = this;
    if (d == null) {
        d = b.getSelectionModel().getSelectedNode()
    }
    var a = d.text;
    Explore.view.StatusBox.prompt(Explore.i18n("appTitle"), Explore.i18n("EnterSectionName"), a, function(e) {
        if (e && a !== e) {
            var f = parseInt(d.attributes.tag.id, 10);
            Explore.data.TopicDataStore.renameTopicSection(f, e, function(g) {
                if (g.ErrorCode > 0) {
                    Explore.view.StatusBox.showWarning(Explore.i18n("appTitle"), g.Message)
                } else {
                    d.setText(g.Result)
                }
            })
        }
    })
},createTopicSection:function(b, c) {
    var a = this;
    if (c == null) {
        c = a.getSelectionModel().getSelectedNode()
    }
    Explore.view.StatusBox.prompt(Explore.i18n("appTitle"), Explore.i18n("EnterSectionName"), "", function(d) {
        if (d) {
            var f = parseInt(c.attributes.tag.id, 10);
            var e = c.attributes.tag.isCustom;
            Explore.data.TopicDataStore.addTopicSection(f, d, e, function(g) {
                if (g.ErrorCode == 0) {
                    var h = null;
                    if (a.checkable) {
                        h = a.getSelectedTopicIds();
                        h.push(g.Result.Id)
                    }
                    a.requiresRefresh();
                    a.refreshDirty(c, function() {
                        var j = a.getNodeById("SECTION:" + g.Result.Id);
                        if (j) {
                            j.ensureVisible();
                            j.select()
                        }
                    })
                } else {
                    Explore.view.StatusBox.showError(Explore.i18n("appTitle"), g.Message)
                }
            })
        }
    })
},createTopicInSection:function(b, d) {
    var a = this;
    var d = d || a.getSelectionModel().getSelectedNode();
    if (!d) {
        Explore.view.StatusBox.showWarning(Explore.i18n("appTitle"), Explore.i18n("FirstSelectATopicSectionInWhichToAddANewTopic"));
        return
    }
    if (d.attributes.tag.type === "TOPIC") {
        d = d.parentNode
    }
    var c = d.attributes.tag.id;
    b = Ext.apply({editObject:a.getDefaultTopic(d.attributes.tag.isCustom),title:Explore.i18n("CreateTopic"),readOnly:false}, b);
    a.showTopicDialog(c, b, d)
},setRootCause:function(d, e) {
    var c = this;
    if (c.rootCause !== d) {
        c.rootCause = d;
        var a = c.getLoader(),b = c.root;
        a.baseParams.rootCause = d;
        TopicService.GetTopicHierarchyNodes(b.id, a.baseParams.rootCause, a.baseParams.includeAllProjects, a.baseParams.includeMyTopics, function(f) {
            c.requiresRefresh();
            b.removeAll(true);
            b.appendChild(f);
            if (e) {
                e()
            }
        })
    }
},requiresRefresh:function() {
    Explore.view.TopicPicker.lastRefresh = new Date()
},refreshDirty:function(b, c) {
    var a = this;
    if (a.refreshTimestamp < Explore.view.TopicPicker.lastRefresh) {
        a.refreshTimestamp = new Date();
        a.refresh(b, c)
    } else {
        if (c) {
            c()
        }
    }
}});
Ext.reg("explore.view.topicpicker", Explore.view.TopicPicker);
Ext.ns("Explore.view");
Explore.view.TopicSectionSelectorDialog = Ext.extend(Ext.Window, {modal:true,constrain:true,constrainHeader:true,cls:"white-bg-dialog",defaults:{padding:"10"},plain:true,layout:"fit",bodyBorder:false,labelWidth:130,height:500,width:600,title:Explore.i18n("Please Select a  target TopicSection"),initComponent:function() {
    var b = this;
    var a = {fbar:[
        {xtype:"button",itemId:"saveButton",text:Explore.i18n("Select"),handler:function() {
            var c = b.getTopicTree(),d = c.getSelectionModel(),g = d.getSelectedNode(),f = g.attributes.tag.id,e = !!g.attributes.tag.isCustom;
            b.fireEvent("topicsectionselected", f, e);
            b.close()
        }},
        {xtype:"button",itemId:"cancelButton",text:Explore.i18n("Cancel"),handler:function() {
            b.close()
        }}
    ],items:[this.getTopicTree()]};
    Ext.apply(this, a);
    Explore.view.TopicSectionSelectorDialog.superclass.initComponent.apply(this, arguments)
},getTopicTree:function() {
    if (!this._topicTree) {
        var a = this;
        this._topicTree = new Explore.view.TopicPicker();
        this._topicTree.getLoader().on("load", function() {
            a._topicTree.expandAll();
            a._topicTree.root.cascade(function() {
                if (this.leaf) {
                    this.getUI().hide()
                }
            })
        });
        this._topicTree.on("treeloaded", function() {
            a._topicTree.expandAll();
            a._topicTree.root.cascade(function() {
                if (this.leaf) {
                    this.getUI().hide()
                }
            })
        })
    }
    return this._topicTree
}});
Ext.ns("Explore.view");
Explore.view.URLDDialog = Ext.extend(Ext.Window, {resizable:true,constrain:false,constrainHeader:true,minimizable:false,maximizable:true,modal:true,shim:true,width:950,height:650,plain:true,footer:true,closable:true,title:"",URL:"",msg:"",layout:"anchor",padding:10,cls:"x-window-dlg",fn:null,initComponent:function() {
    var a = this;
    var b = {items:{itemId:"iframePanel",xtype:"box",autoEl:{tag:"iframe",cls:"recording-iframe",frameborder:"0",width:"100%",height:"100%"},listeners:{afterrender:function(c) {
        a.displayURL()
    }}},buttons:[
        {text:Explore.i18n("OK"),handler:function() {
            this.buttonHandler("ok")
        },scope:this}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.URLDDialog.superclass.initComponent.apply(this, arguments)
},displayURL:function() {
    var a = this;
    var b = a.getByItemId("iframePanel").getEl().dom;
    b.src = this.URL
},buttonHandler:function(a) {
    this.close();
    if (this.fn) {
        this.fn(a)
    }
}});
Ext.reg("explore.view.urlddialog", Explore.view.URLDDialog);
Ext.ns("Explore.view");
Explore.view.UserControlPanel = Ext.extend(Ext.Toolbar, {demoCssNode:null,initComponent:function() {
    var a = this;
    var b = {listeners:{afterrender:function() {
        if (Ext.isSafari || Ext.isChrome || Ext.isIE7) {
            var e = a;
            var d = e.getByItemId("welcomelbl");
            e.setWidth(10);
            if (d && d.el) {
                var c = d.el.dom.clientWidth + 150;
                c += (Ext.isIE7) ? 170 : 0;
                e.setWidth(c)
            }
        }
    }},items:[
        {xtype:"button",id:"channelIcon",itemId:"multiChannelIcon",listeners:{afterrender:function() {
            a._setupTooltip()
        },mouseover:function() {
        }},iconCls:(Explore.getNumberSocialMediaAccounts() > 1) ? "buttonMultiChannelUser" : "buttonChannelUser"},
        {xtype:"tbtext",itemId:"welcomelbl",text:Explore.i18n("Welcome") + " " + currentUser.FullNameFML},
        {xtype:"tbseparator"},
        {xtype:"splitbutton",itemId:"user-cp-favorites",iconCls:"x-toolUR x-toolUR-fav",tooltip:Explore.i18n("Favorites"),cls:"demoMode",hidden:!Explore.demoMode,menu:new Ext.menu.Menu({hidden:true,listeners:{click:function(f, d) {
            var c = a.getByItemId("searchPanel");
            var e = c.getSearchPresenter();
            e.searchByIds(d.searchRecordIds)
        }}})},
        {xtype:"tbseparator",hidden:!Explore.demoMode},
        {xtype:"button",tooltip:Explore.i18n("ExploreWorkspaces"),iconCls:"x-toolUR x-toolUR-max",hidden:(!Explore.demoMode || Explore.WorkspacesUrl == null || Explore.WorkspaceUrl == ""),handler:function() {
            var c = Explore.WorkspacesUrl;
            var d = window.open(c, "ExecutiveWorkspaces");
            d.focus()
        }},
        {xtype:"tbseparator",hidden:(!Explore.demoMode || Explore.WorkspacesUrl == null || Explore.WorkspaceUrl == "")},
        {xtype:"button",tooltip:Explore.i18n("Preferences"),handler:a._showPreferencesDialog,iconCls:"x-toolUR x-toolUR-setting"},
        {xtype:"tbseparator"},
        {xtype:"button",tooltip:Explore.i18n("Help"),iconCls:"x-toolUR x-toolUR-help",handler:a._openHelpFile},
        {xtype:"tbseparator"},
        {xtype:"splitbutton",tooltip:Explore.i18n("Autonomy navigation"),text:Explore.i18n("Demo"),hidden:!Explore.isDemo,iconCls:"autonomy-icon",menu:new Ext.menu.Menu({cls:"x-menu-autonomy",selectedItem:"understand",listeners:{afterrender:function(d) {
            var c = d.get(d.selectedItem);
            c.canActivate = false;
            c.setHandler(function() {
                return false
            });
            c.addClass("x-menu-item-selected")
        }},items:[
            {text:Explore.i18n("Convert"),itemId:"convert",iconCls:"launcher-tool-convert",handler:function() {
                window.open("http://208.77.164.100/author/?experimentId=1")
            }},
            {text:Explore.i18n("Understand"),itemId:"understand",iconCls:"launcher-tool-understand",handler:function() {
                window.open("https://www.google.com/#sclient=psy-ab&hl=en&source=hp&q=where+is+understand&pbx=1&oq=where+is+understand&aq=f&aqi=g-b1&aql=1&gs_sm=e&gs_upl=3378l10787l0l11554l26l17l3l0l0l0l451l6423l3-13.4l20l0&bav=on.2,or.r_gc.r_pw.r_cp.,cf.osb&fp=d6a6b13212a1ff43&biw=961&bih=344")
            }},
            {text:Explore.i18n("Attract"),itemId:"attract",iconCls:"launcher-tool-attract",handler:function() {
                window.open("https://10.2.1.180/login.html")
            }},
            {text:Explore.i18n("Segment"),itemId:"segment",iconCls:"launcher-tool-segment",handler:function() {
                window.open("http://208.77.164.100/segment/")
            }},
            {text:Explore.i18n("UserExperience"),iconCls:"launcher-tool-userExperience",itemId:"userExperience",handler:function() {
                window.open("http://208.77.164.100/author/demo/preview.html?url=http://fb.aurabank.com/campaign/multi/a/index.aspx?iq_id=M111")
            }},
            {text:Explore.i18n("PointofView"),itemId:"pointOfView",iconCls:"launcher-tool-customerPOV",handler:function() {
                window.open("http://portal.autonomy.com/optimost/google_AfterOptimost.html")
            }}
        ]})},
        {xtype:"tbseparator",hidden:!Explore.isDemo},
        {xtype:"button",tooltip:Explore.i18n("Logout"),iconCls:"x-toolUR x-toolUR-logout",handler:function(c, d) {
            if (Explore.demoMode && d.ctrlKey) {
                a._toggleDemoCss()
            } else {
                window.location = "../Logout.aspx"
            }
        }}
    ]};
    Ext.apply(this, b);
    Explore.view.UserControlPanel.superclass.initComponent.apply(this, arguments)
},_setupButtonIcon:function() {
    var b = this;
    var a = b.getByItemId("multiChannelIcon");
    if (a) {
        a.setIconClass((Explore.getNumberSocialMediaAccounts() > 1) ? "buttonMultiChannelUser" : "buttonChannelUser")
    }
},_setupTooltip:function() {
    var b = this;
    var a = Explore.getNumberAccountsByType(Explore.model.SocialMediaType.Facebook);
    var c = Explore.getNumberAccountsByType(Explore.model.SocialMediaType.Linkedin);
    var d = Explore.getNumberAccountsByType(Explore.model.SocialMediaType.Twitter);
    if (this._tooltipChannel) {
        this._tooltipChannel.destroy()
    }
    this._tooltipChannel = new Ext.ToolTip({itemId:"tooltipChannel",autoHide:false,anchor:"top",width:55,closable:false,border:false,layout:"hbox",html:'<table><tr><td width="70" align="right">' + ((d > 0) ? '<div class="target-3">' + d + "</div>" : "&nbsp") + '</td><td autoWidth="true" align="right" hidden=!explore.demoMode>' + ((c > 0) ? '<div class="target-3">' + c + "</div>" : "&nbsp") + '</td><td autoWidth="true" align="right" hidden=!explore.demoMode>' + ((a > 0) ? '<div class="target-3">' + a + "</div>" : "&nbsp") + "</td><tr></table>",items:[
        {xtype:"button",cls:"btn-no-border",itemId:"twitterBtn",handler:b._showChannelsDialog,scope:this,iconCls:"image-twitter",scale:"large"},
        {xtype:"label",html:"&nbsp"},
        {xtype:"button",cls:"btn-no-border",itemId:"linkedinBtn",handler:b._showChannelsDialog,scope:this,iconCls:"image-linkedin",hidden:!explore.demoMode,scale:"large"},
        {xtype:"label",html:"&nbsp"},
        {xtype:"button",cls:"btn-no-border",itemId:"facebookBtn",handler:b._showChannelsDialog,scope:this,iconCls:"image-facebook",hidden:!explore.demoMode,scale:"large"}
    ]});
    this._tooltipChannel.initTarget("channelIcon")
},_openHelpFile:function() {
    Explore.popupWindow("../help/usersguide.pdf", "exploreUserGuide", 800, 600)
},_showPreferencesDialog:function() {
    var a = new Explore.view.PreferencesDialog();
    a.show()
},_showChannelsDialog:function(b, d) {
    var a = this;
    var c = {defaultChannel:Explore.model.SocialMediaType.Twitter};
    var e = b.ownerCt;
    if (e) {
        e.hide()
    }
    if (b.itemId === "facebookBtn") {
        c.defaultChannel = Explore.model.SocialMediaType.Facebook
    } else {
        if (b.itemId === "twitterBtn") {
            c.defaultChannel = Explore.model.SocialMediaType.Twitter
        } else {
            c.defaultChannel = Explore.model.SocialMediaType.Linkedin
        }
    }
    var f = new Explore.view.MultiChannelLoginDialog(c);
    f.on("close", function() {
        a._setupTooltip();
        a._setupButtonIcon()
    }, this);
    f.show()
},_toggleDemoCss:function() {
    var b = "demo-css";
    if (demoCssNode) {
        demoCssNode.parentNode.removeChild(el)
    } else {
        var a = ".demoMode { border:3px solid red; background-color: #FF8888; }";
        if ("\v" == "v") {
            demoCssNode = document.createStyleSheet();
            demoCssNode.cssText = a
        } else {
            demoCssNode = document.createElement("style");
            demoCssNode.type = "text/css";
            document.getElementsByTagName("head")[0].appendChild(demoCssNode);
            demoCssNode[(typeof document.body.style.WebkitAppearance == "string") ? "innerText" : "innerHTML"] = a
        }
    }
},addFavorites:function(c, a, b) {
    var e = this.getByItemId("user-cp-favorites");
    e.menu.hide();
    var d = e.menu.addMenuItem({text:c,iconCls:"no-icon",showSeparator:false});
    d.searchRecordIds = b;
    d.searchId = a
}});
Ext.reg("explore.view.usercontrolpanel", Explore.view.UserControlPanel);
Ext.ns("Explore.view");
Explore.view.UserDialog = Ext.extend(Explore.base.EditorDialog, {itemDescription:Explore.i18n("User"),readOnly:true,height:530,initComponent:function() {
    var c = this;
    var b = this.editObject;
    var a = (b.Id > 0) ? false : true;

    function d(e) {
        return(e === 1) ? true : false
    }

    c.formItems = [
        {name:"FirstName",allowBlank:false,width:120,maxLength:60,disabled:d(b.Id)},
        {name:"MiddleName",allowBlank:true,width:120,maxLength:60},
        {name:"LastName",allowBlank:false,width:120,maxLength:60,disabled:d(b.Id)},
        {name:"LoginType",disabled:d(b.Id),xtype:"radiogroup",columns:2,items:[
            {boxLabel:Explore.i18n("appTitle"),name:"LoginType",value:Explore.model.LoginType.Explore,inputValue:Explore.model.LoginType.Explore},
            {boxLabel:Explore.i18n("Windows"),name:"LoginType",value:Explore.model.LoginType.WindowsIntegrated,inputValue:Explore.model.LoginType.WindowsIntegrate,disabled:true}
        ],listeners:{change:function(f, g) {
            var j = g.value;
            var h = c.getByItemId("UIPassword");
            h.setVisible(j === Explore.model.LoginType.Explore);
            h.allowBlank = (j !== Explore.model.LoginType.Explore);
            var e = c.getByItemId("Login");
            if (j === Explore.model.LoginType.Explore) {
                e.vtype = null
            } else {
                e.vtype = "windowsusername"
            }
            e.validate()
        },beforerender:function(f, g) {
            Explore.data.UserDataStore.getUsingWindowsImpersonation(function(e) {
                if (f.items.items[1] != null) {
                    (!e.Result) ? f.items.items[1].disable() : f.items.items[1].enable()
                }
            })
        }}},
        {name:"Login",allowBlank:false,width:200,maxLength:50,disabled:d(b.Id)},
        {name:"UIPassword",allowBlank:false,width:120,inputType:"password",maxLength:50},
        {fieldLabel:Explore.i18n("Group"),name:"GroupId",disabled:d(b.Id),xtype:"selectboxfield",width:200,allowBlank:false,valueNotFoundText:"(" + Explore.i18n("notfound") + ")",valueField:"Id",displayField:"Name",store:new Ext.data.JsonStore({fields:["Id","Name"],data:[]}),listeners:{afterrender:function(e) {
            Explore.data.UserDataStore.getGroups(function(f) {
                e.getStore().loadData(f);
                e.setValue(e.getValue())
            })
        }}},
        {xtype:"container",layout:{type:"hbox",align:"middle"},fieldLabel:Explore.i18n("Role"),items:[
            {name:"RoleId",itemId:"RoleId",xtype:"selectboxfield",disabled:d(b.Id),width:200,allowBlank:false,valueNotFoundText:"(" + Explore.i18n("notfound") + ")",valueField:"Id",displayField:"Name",store:new Ext.data.JsonStore({fields:["Id","Name"],data:[]}),listeners:{afterrender:function(e) {
                Explore.data.UserDataStore.getRoles(function(f) {
                    e.getStore().loadData(f);
                    e.setValue(e.getValue())
                })
            }}},
            {xtype:"button",text:Explore.i18n("CreateNewRole"),margins:"0 0 0 15",disabled:d(b.Id),hidden:!Explore.Security.isAuthorized("ROLES_CREATE"),handler:this.addRole,scope:this}
        ]},
        {name:"Email",width:200,maxLength:80,vtype:"email",listeners:{invalid:function(e) {
            c.getByItemId("emailAccountInformation").setValue(false);
            c.getByItemId("emailAccountInformation").setDisabled(true)
        },valid:function(e) {
            val = (e.getValue().length == 0) ? true : false;
            c.getByItemId("emailAccountInformation").setDisabled(val);
            if (val == false) {
                c.getByItemId("emailAccountInformation").setValue(true)
            } else {
                c.getByItemId("emailAccountInformation").setValue(false)
            }
        }}},
        {name:"EmployeeId",width:120,maxLength:50},
        {name:"Address",width:200,maxLength:100},
        {name:"City",width:120,maxLength:60},
        {name:"State",width:60,maxLength:60},
        {name:"Zip",width:60,maxLength:50},
        {name:"Phone",width:120,maxLength:25},
        {name:"EnableNotifications",xtype:"checkbox",hideLabel:true,boxLabel:Explore.i18n("EnableNotifications")},
        {name:"EmailAccountInformation",xtype:"checkbox",itemId:"emailAccountInformation",hideLabel:true,boxLabel:Explore.i18n("EmailAccountInformation"),disabled:true}
    ];
    Explore.view.UserDialog.superclass.initComponent.apply(this, arguments);
    c.on("afterrender", function() {
        c.getByItemId("myForm").getForm().isValid()
    }, c, {single:true})
},getObjectName:function() {
    return this.editObject.FullNameFML
},displayObject:function() {
    Explore.view.UserDialog.superclass.displayObject.call(this);
    var a = this.getByItemId("UIPassword");
    a.setVisible(this.editObject.LoginType === Explore.model.LoginType.Explore);
    a.allowBlank = (this.editObject.LoginType !== Explore.model.LoginType.Explore)
},populateObject:function() {
    Explore.view.UserDialog.superclass.populateObject.call(this);
    var a = this.editObject;
    a.EmailAccountNotification = this.getByItemId("emailAccountInformation").getValue()
},addRole:function() {
    var c = {};
    var a = this;
    var b = new Explore.view.RoleDialog({editObject:c,readOnly:false});
    b.on("save", function() {
        Explore.data.UserDataStore.saveRole(c, function(e) {
            var f = e.Result.Id;
            var d = a.getByItemId("RoleId");
            Explore.data.UserDataStore.getRoles(function(g) {
                d.getStore().loadData(g);
                d.setValue(f)
            })
        })
    });
    b.show(a)
}});
Ext.ns("Explore.view");
Explore.view.UserPicker = Ext.extend(Explore.base.AdministrationTreePanel, {collapsible:false,itemDescription:Explore.i18n("User"),currentGroupId:null,checkedUserIds:null,_isDirty:false,checkable:false,cls:"user-picker-tree hierarchy-tree",useArrows:true,autoScroll:true,animate:true,containerScroll:true,initComponent:function() {
    var c = this;
    c.loadFn = Explore.data.UserDataStore.getUser;
    c.saveFn = Explore.data.UserDataStore.saveUser;
    c.deleteFn = Explore.data.UserDataStore.deleteUser;
    c.editDialogFn = Explore.view.UserDialog;
    c.permissions = {view:Explore.Security.isAuthorized("USERS_VIEW"),create:Explore.Security.isAuthorized("USERS_CREATE"),update:Explore.Security.isAuthorized("USERS_UPDATE"),"delete":Explore.Security.isAuthorized("USERS_DELETE")};
    new Ext.tree.TreeSorter(c, {folderSort:true,dir:"asc",property:"tag",sortType:function(f) {
        return parseInt(f.id, 10)
    }});
    Explore.data.UserDataStore.on("userGroupModified", function(g) {
        var f = c.getByItemId("tree");
        var h = "GROUP" + g;
        f.refreshAndSelectNode(null, h)
    });
    Explore.data.UserDataStore.on("userModified", function(g) {
        var f = c.getByItemId("tree");
        var h = "USER" + g;
        f.refreshAndSelectNode(null, h)
    });
    var e = this.checkable ? false : undefined;
    var b = new Ext.tree.TreeNode({nodeType:"node",text:Explore.i18n("MyOrganization"),id:"GROUP1",singleClickExpand:true,uiProvider:Ext.tree.TriStateNodeUI,checked:e,expanded:true,tag:{groupId:1,type:"GROUP"}});
    var a = new Ext.tree.TreeLoader({preloadChildren:true,directFn:UserService.GetOrganizationNodes,baseAttrs:{uiProvider:Ext.tree.TriStateNodeUI,checked:e,singleClickExpand:true,expanded:this.checkable}});
    a.load(b, function() {
        c.checkUserIds(c.checkedUserIds);
        c._isDirty = false
    });
    var d = {root:b,rootVisible:true,loader:a,keys:[
        {key:Ext.EventObject.DELETE,fn:function() {
            try {
                if (c.permissions["delete"]) {
                    var g = c.getSelectionModel().getSelectedNode();
                    if (g) {
                        var j = g.attributes.tag.id;
                        var f = g.text;
                        if (j) {
                            c.deleteCommand(j, f)
                        } else {
                            j = g.attributes.tag.groupId;
                            c.checkForUsers(g.childNodes, g.parentNode, f, j)
                        }
                    }
                }
            } catch(h) {
            }
        },scope:c},
        {key:"r",fn:function() {
            c.refresh(null, function() {
                var f = c.getRootNode();
                f.select()
            })
        }}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, d));
    Explore.view.UserPicker.superclass.initComponent.apply(this, arguments);
    this.on("checkchange", this.onCheckChange, this)
},onCheckChange:function() {
    this._isDirty = true
},isDirty:function() {
    return this._isDirty
},newCommand:function() {
    var a = this;
    var b = a.getSelectionModel().getSelectedNode();
    var c = {LoginType:Explore.model.LoginType.Explore,RoleId:1,GroupId:1};
    if (b) {
        if (b.attributes.tag.type === "USER") {
            b = b.parentNode
        }
        currentGroupId = b.attributes.tag.groupId;
        c.GroupId = currentGroupId;
        c.Group = {Id:currentGroupId,Name:b.attributes.text}
    }
    var d = new a.editDialogFn({editObject:c,readOnly:false});
    d.on("save", function() {
        a.onSave(c)
    });
    d.show(a)
},deleteCommand:function(e, b) {
    var a = this;
    log.info("deleteCommand", e, b);
    if (!a.permissions["delete"]) {
        Explore.view.StatusBox.showWarning(Explore.i18n("PermissionDenied"), Explore.i18n("YourRoleDoesNotHavePermissionToPerformTheRequestedOperation"));
        return
    }
    if (e == 1) {
        Explore.view.StatusBox.showWarning(Explore.i18n("appTitle"), String.format(Explore.i18n("_UserCanNotBeDeleted"), b))
    } else {
        log.info("deleteCommand", e, b);
        var a = this;
        var d = function(f) {
            if (f.ErrorCode == 0) {
            } else {
                Explore.view.StatusBox.showError(Explore.i18n("appTitle"), f.Message)
            }
        };
        var c = String.format(Explore.i18n("AreYouSureYouWantToDeleteThe_"), Explore.i18n("user"), b);
        Explore.view.StatusBox.confirm(Explore.i18n("appTitle"), c, function() {
            var f = new Explore.view.DeleteConfirmationWindow({mytype:"User",deleteFn:Explore.data.UserDataStore.deleteUser,myId:e,callback:d});
            f.start()
        })
    }
},confirmDelete:function(a, c, h) {
    var b = this;
    var f = String.format(Explore.i18n("AreYouSureYouWantToDeleteThe_"), Explore.i18n("User") + " " + Explore.i18n("Group"), c);
    var e = b.getNodeById("GROUP" + h);
    e.expand(true);
    var d = function() {
        b.refresh(a)
    };
    var g = function(j) {
    };
    Explore.view.StatusBox.confirm(Explore.i18n("appTitle"), f, function() {
        Explore.data.UserDataStore.getGroupChildren(h, function(p) {
            var l = [];
            var o = {Id:h,leaf:false,name:c};
            l.push(o);
            function k(r) {
                var u = r.text;
                var t = r.tag.id || r.tag.groupId;
                var q = r.leaf;
                var s = {name:u,Id:t,leaf:q};
                l.push(s)
            }

            function n(q) {
                if (q) {
                    for (var r = 0; r < q.length; r++) {
                        var s = q[r];
                        k(s);
                        n(s.children)
                    }
                }
            }

            n(p);
            var j = {mytype:"User",results:l,deleteFn:Explore.data.UserDataStore.deleteUser,deleteGroupFn:Explore.data.UserDataStore.deleteGroup,groupDelCallback:g,callback:g,cancelFn:d,doneFn:d};
            var m = new Explore.view.RecursiveDeleteWindow(j);
            m.start()
        })
    })
},checkUser:function(b, a) {
    var c = this.getNodeById("USER" + b);
    if (c) {
        c.getUI().toggleCheck(a)
    }
},checkUserIds:function(b) {
    if (b) {
        this.checkedUserIds = b;
        for (var a = 0; a < b.length; a++) {
            this.checkUser(b[a], true)
        }
    }
},getSelectedUserIds:function() {
    var d = this.getChecked();
    var a = [];
    if (d) {
        for (var b = 0; b < d.length; b++) {
            var c = d[b];
            if (c.isLeaf()) {
                a.push(c.attributes.tag.id)
            }
        }
    }
    return a
},checkForUsers:function(d, a, b, e) {
    userFound = false;
    var c = 0;
    for (var c = 0; c < d.length; c++) {
        if (d[c].id.indexOf("USER") > -1) {
            Explore.view.StatusBox.showWarning(Explore.i18n("appTitle"), String.format(Explore.i18n("_GroupCanNotBeDeletedAllUsersMustBeDeletedOrMovedToAnotherGroup"), b));
            userFound = true;
            break
        } else {
            this.checkForUsers(d[c].childNodes, a, b, e)
        }
    }
    if (!userFound) {
        this.confirmDelete(a, b, e)
    }
},getContextMenu:function() {
    var b = this;
    var c = Explore.view.UserPicker.superclass.getContextMenu.call(this);
    var e = c.getByItemId("RenameGroup");
    if (e == null) {
        e = c.insert(0, {itemId:"RenameGroup",text:Explore.i18n("EditGroup"),handler:function() {
            if (b.contextMenuNode) {
                var h = b.contextMenuNode.attributes.tag.groupId;
                Explore.view.StatusBox.prompt(Explore.i18n("appTitle"), Explore.i18n("EnterGroupName"), b.contextMenuNode.attributes.text, function(j) {
                    if (j) {
                        Explore.data.UserDataStore.renameGroup(h, j, function(k) {
                            if (k.ErrorCode == 0) {
                            } else {
                                Explore.view.StatusBox.showError(Explore.i18n("appTitle"), k.Message)
                            }
                        })
                    }
                })
            }
        }})
    }
    if (b.contextMenuNode != null) {
        e.setDisabled(((b.contextMenuNode != null) && (b.contextMenuNode.isRoot)) ? true : false)
    }
    var a = c.getByItemId("AddGroup");
    if (a == null) {
        a = c.insert(1, {itemId:"AddGroup",iconCls:"new-icon",text:Explore.i18n("NewGroup"),handler:function() {
            Explore.view.StatusBox.prompt(Explore.i18n("appTitle"), Explore.i18n("EnterGroupName"), "", function(h) {
                if (h) {
                    Explore.data.UserDataStore.saveGroup(h, b.contextMenuNode.attributes.tag.groupId, function(j) {
                        if (j.ErrorCode == 0) {
                        } else {
                            Explore.view.StatusBox.showError(Explore.i18n("appTitle"), j.Message)
                        }
                    })
                }
            })
        }})
    }
    var d = c.getByItemId("DeleteGroup");
    if (d == null) {
        d = c.insert(2, {itemId:"DeleteGroup",iconCls:"delete-icon",text:Explore.i18n("DeleteGroup"),handler:function() {
            var h = b.contextMenuNode.attributes.text;
            if (b.getRootNode().attributes.text == h) {
                Explore.view.StatusBox.showWarning(Explore.i18n("appTitle"), String.format(Explore.i18n("_GroupCanNotBeDeleted"), h))
            } else {
                var j = b.contextMenuNode.attributes.tag.groupId;
                b.confirmDelete(b.contextMenuNode.parentNode, h, j)
            }
        }})
    }
    d.setDisabled(((b.contextMenuNode != null) && (b.contextMenuNode.isRoot)) ? true : false);
    var g = c.get("Delete" + b.itemDescription);
    var f = c.get("Edit" + b.itemDescription);
    if (b.contextMenuNode.attributes.tag.type == "GROUP") {
        e.show();
        d.show();
        a.show();
        e.setDisabled(!b.permissions.update || b.contextMenuNode.id === "GROUP1");
        d.setDisabled(!b.permissions["delete"] || b.contextMenuNode.id === "GROUP1");
        a.setDisabled(!b.permissions.create);
        if (g != null) {
            g.hide()
        }
        if (f != null) {
            f.hide()
        }
    } else {
        e.hide();
        d.hide();
        a.hide();
        g.show();
        f.show();
        if (!b.permissions["delete"] || ((currentUser.Id === b.contextMenuNode.attributes.tag.id) || (b.contextMenuNode.attributes.tag.id === 1))) {
            g.setDisabled(true)
        } else {
            g.setDisabled(false)
        }
        if (b.permissions.update) {
            f.setDisabled()
        }
    }
    return c
}});
Explore.view.UserPicker.lastRefresh = new Date();
Ext.reg("explore.view.userpicker", Explore.view.UserPicker);
Ext.ns("Explore.view.automation");
Explore.view.automation.AutomationOnRulePanel = Ext.extend(Ext.form.FormPanel, {rule:null,initComponent:function() {
    var b = this;
    var c = this._changeSentimentBtnGroup = new Explore.view.common.SentimentFormField({width:"100%",itemId:"changesentiment",baseCls:"engagement-side-panel-top",listeners:{sentimentpressed:function(h) {
    }}});
    var f = this._priorityCombo = new Explore.view.common.EngagementPriorityCombo({name:"Priority",itemId:"Priority",anchor:"0",listeners:{scope:this,priorityselected:function(k, h, j) {
    }}});
    var e = this._statusCombo = new Explore.view.common.EngagementStatusCombo({name:"CurrentStatus",itemId:"CurrentStatus",anchor:"0",listeners:{scope:this,statusselected:function(k, h, j) {
    }}});
    var d = this._projectsCmp = new Explore.view.searchresultdetail.assignitems.Project({itemId:"projectsComp",getAutomationAction:function() {
        var l = this.rule,h = l.getActionByType("AssignProjects"),j = this.getValue();
        var k = new Explore.data.model.AutomationAction({Action:Explore.model.AutomationAction.AssignProjects,EngagementItem:new Explore.data.model.EngagementItem({ProjectNames:j.names,Projects:j.ids})});
        if (h) {
            k.Id = h.Id
        }
        return j.ids.length ? k : null
    }});
    var g = this._usersCmp = new Explore.view.searchresultdetail.assignitems.Users({itemId:"Users",getAutomationAction:function() {
        var l = this.rule,j = l.getActionByType("AssignUsers"),h = this.getValue();
        var k = new Explore.data.model.AutomationAction({Action:Explore.model.AutomationAction.AssignUsers,EngagementItem:new Explore.data.model.EngagementItem({UserNames:h.names,Users:h.ids})});
        if (j) {
            k.Id = j.Id
        }
        return h.ids.length > 0 ? k : null
    }});
    var a = {title:Explore.i18n("Action on Rule"),baseCls:"engagement-side-panel",defaults:{rule:this.rule,baseCls:"engagement-side-panel-top"},padding:10,items:[c,f,e,b.getTagsField(),b.getClassificationField(),d,g]};
    Ext.apply(this, a);
    Explore.view.automation.AutomationOnRulePanel.superclass.initComponent.apply(this, arguments)
},displayObject:function() {
    var e = this.rule;
    if (e) {
        var f = e.getPriority();
        var h = this.getByItemId("Priority");
        h.setValue(f);
        var j = e.getCurrentStatus();
        var g = this.getByItemId("CurrentStatus");
        g.setValue(j);
        var d = e.getAddTagsObj() || e.getRemoveTagObj();
        this.getTagsField().setValue(d);
        var k = e.getAddClassificationObj() || e.getRemoveClassificationObj();
        this.getClassificationField().setValue(k);
        var b = e.getAssignedProjectsObj();
        this._projectsCmp.setValue(b);
        var c = e.getUsersObj();
        this._usersCmp.setValue(c);
        var a = e.getSentiment();
        this._changeSentimentBtnGroup.setValue(a)
    }
},isDirty:function() {
    var p = false;
    var k = this.rule;
    var e = k.getSentiment();
    sentimentFieldVal = this._changeSentimentBtnGroup.getValue();
    if (e) {
        p |= (e !== sentimentFieldVal)
    } else {
        p |= (!!sentimentFieldVal)
    }
    var m = k.getPriority(),n = this.getByItemId("Priority").getValue();
    if (m != null) {
        p |= (m !== n)
    } else {
        p |= (!!n)
    }
    var c = k.getCurrentStatus(),b = this.getByItemId("CurrentStatus").getValue();
    if (c != null) {
        p |= (c !== b)
    } else {
        p |= (!!b)
    }
    var h = this.getTagsField().getValue(),j = k.getAddTagsObj() || k.getRemoveTagObj();
    if (j != null) {
        p |= !(Explore.areArraysSame(h.ids, j.ids))
    } else {
        p |= (h.ids.length > 0)
    }
    var o = this.getClassificationField().getValue(),f = k.getAddClassificationObj() || k.getRemoveClassificationObj();
    if (f != null) {
        p |= !(Explore.areArraysSame(o.ids, f.ids))
    } else {
        p |= (o.ids.length > 0)
    }
    var a = k.getAssignedProjectsObj(),l = this._projectsCmp.getValue();
    if (a != null) {
        p |= !(Explore.areArraysSame(a.ids, l.ids))
    } else {
        p |= (l.ids.length > 0)
    }
    var g = k.getUsersObj(),d = this._usersCmp.getValue();
    if (g) {
        p |= !(Explore.areArraysSame(g.ids, d.ids))
    } else {
        p |= (d.ids.length > 0)
    }
    return p
},getClassificationField:function() {
    var a = this;
    if (!a._classificationField) {
        a._classificationField = new Explore.view.searchresultdetail.assignitems.Classification({itemId:"classifyComp",getAutomationAction:function() {
            var e = this.rule,b = e.getActionByType("AddClassification"),c = this.getValue();
            var d = new Explore.data.model.AutomationAction({Action:Explore.model.AutomationAction.AddClassification,EngagementItem:new Explore.data.model.EngagementItem({ClassificationNames:c.names,Classifications:c.ids})});
            if (b) {
                d.Id = b.Id
            }
            return(c.ids.length > 0) ? d : null
        }})
    }
    return a._classificationField
},getTagsField:function() {
    var a = this;
    if (!a._tagsField) {
        a._tagsField = new Explore.view.searchresultdetail.assignitems.Tags({itemId:"tagsComp",getAutomationAction:function() {
            var e = this.rule,c = e.getActionByType("AddTag"),b = this.getValue();
            var d = new Explore.data.model.AutomationAction({Action:Explore.model.AutomationAction.AddTag,EngagementItem:new Explore.data.model.EngagementItem({TagNames:b.names,Tags:b.ids})});
            if (c) {
                d.Id = c.Id
            }
            return b.ids.length ? d : null
        }})
    }
    return a._tagsField
},getActions:function() {
    var b = [this._changeSentimentBtnGroup.getAutomationAction(),this._priorityCombo.getAutomationAction(),this._statusCombo.getAutomationAction(),this.getTagsField().getAutomationAction(),this.getClassificationField().getAutomationAction(),this._projectsCmp.getAutomationAction(),this._usersCmp.getAutomationAction()];
    var a = function(d) {
        var c = [];
        for (var e = 0; e < d.length; e++) {
            if (d[e]) {
                c.push(d[e])
            }
        }
        return c
    };
    return a(b)
}});
Ext.reg("explore.view.automation.actiononrulepanel", Explore.view.automation.AutomationOnRulePanel);
Ext.ns("Explore.view.automation");
Explore.view.automation.AutomationRuleDialog = Ext.extend(Explore.base.EditorDialog, {itemDescription:Explore.i18n("AutomationRule"),layout:"form",autoScroll:true,maxBoxHeight:600,autoHeight:true,labelWidth:115,defaults:{padding:10},readOnly:false,initComponent:function() {
    var a = this;
    var e = a.getAutomationRule();
    var d = {xtype:"textfield",name:"Name",padding:10,fieldLabel:"Name (required)",allowBlank:false};
    var c = {xtype:a.readOnly ? "displayfield" : "textfield",name:"Description",padding:10,allowBlank:true};
    var f = {xtype:"checkbox",name:"IsEnabled",fieldLabel:"",boxLabel:Explore.i18n("RuleEnabled")};
    var b = {padding:10,itemId:"searchcriteriasummarylink",xtype:"explore.view.searchcriteriasummarylink",fieldLabel:Explore.i18n("SearchCriteria_1"),searchCriteria:e.SearchInfo,readOnly:a.readOnly};
    a.formItems = [d,c,f,b];
    Explore.view.automation.AutomationRuleDialog.superclass.initComponent.apply(this, arguments)
},createWindowItems:function() {
    var a = Explore.view.AdvancedSearchCriteriaDialog.superclass.createWindowItems.apply(this, arguments);
    var d = this.getAutomationRule();
    var b = this._actionOnRulePanel = new Explore.view.automation.AutomationOnRulePanel({labelWidth:115,rule:d});
    var c = this._notificationPanel = new Explore.view.automation.NotificationOptionsPanel({labelWidth:270,rule:d});
    var e = this._executionPanel = new Explore.view.automation.ExecutionOptionsPanel({rule:d});
    a.push(b);
    a.push(c);
    a.push(e);
    return a
},getAutomationRule:function() {
    return this.editObject
},isDirty:function() {
    var a = Explore.view.RuleDialog.superclass.isDirty.call(this);
    a |= this.getByItemId("searchcriteriasummarylink").isDirty();
    a |= this._actionOnRulePanel.isDirty();
    a |= this._notificationPanel.isDirty();
    a |= this._executionPanel.isDirty();
    return a
},isValid:function(a) {
    var b = Explore.view.RuleDialog.superclass.isValid.call(this, a);
    b &= (this.getByItemId("searchcriteriasummarylink").getValue() != null);
    b &= (this.getActions().length > 0);
    return b
},displayObject:function() {
    var a = this;
    Explore.view.RuleDialog.superclass.displayObject.call(this);
    var b = a.getAutomationRule();
    a._actionOnRulePanel.displayObject();
    a._notificationPanel.displayObject();
    a._executionPanel.displayObject()
},getActions:function() {
    var a = this,b = a._actionOnRulePanel.getActions();
    notifcationActions = a._notificationPanel.getActions();
    return b.concat(notifcationActions)
},populateObject:function() {
    var a = this,b = a.getAutomationRule();
    Explore.view.RuleDialog.superclass.populateObject.call(this);
    b.SearchInfo = this.getByItemId("searchcriteriasummarylink").getValue();
    b.Actions = a.getActions();
    a._executionPanel.populateObject()
}});
Ext.ns("Explore.view.automation");
Explore.view.automation.ExecutionOptionsPanel = Ext.extend(Ext.form.FormPanel, {border:false,frame:false,currentTags:[],baseCls:"engagement-side-panel",padding:10,labelWidth:85,defaults:{baseCls:"engagement-side-panel-top",border:false,frame:false},initComponent:function() {
    var b = this;
    var g = {xtype:"radio",name:"scheduleExecute",itemId:"scheduleExecute",checked:true,hideLabel:true,boxLabel:Explore.i18n("ExecuteOnSchedule"),listeners:{check:function(h, j) {
    }}};
    var c = {itemId:"executeonschedule",layout:{type:"hbox",align:"middle"},xtype:"container",height:50,width:"100%",items:[
        {xtype:"label",text:Explore.i18n("ExecuteRuleEvery")},
        {xtype:"numberfield",width:40,allowDecimals:false,allowNegative:false,minValue:1,itemId:"frequency",value:1,emptyText:1,margins:"0 8 0 8",allowBlank:false},
        {xtype:"selectboxfield",itemId:"intervalCombo",width:100,options:[
            [Explore.model.AutomationInterval.Minutes,Explore.i18n("Minute_s_")],
            [Explore.model.AutomationInterval.Hours,Explore.i18n("Hour_s_")],
            [Explore.model.AutomationInterval.Days,Explore.i18n("Day_s_")],
            [Explore.model.AutomationInterval.Week,Explore.i18n("Weeks_s_")]
        ],value:Explore.model.AutomationInterval.Hours},
        {xtype:"label",text:Explore.i18n("StartTime"),margins:"0 0 0 8"},
        {xtype:"timefield",itemId:"startTimeField",value:"12:00 AM",increment:30,width:90,margins:"0 8 0 8",allowBlank:false}
    ]};
    var e = {text:Explore.i18n("Start Date"),xtype:"label"};
    var f = {xtype:"explore.view.common.daterangepicker",itemId:"dateRangePicker",margins:"0 0 0 10",width:380,horizontalLayout:true};
    var d = {xtype:"container",width:"100%",layout:{type:"hbox",align:"middle"},defaults:{baseCls:"engagement-side-panel-top",border:false,frame:false},items:[e,f]};
    var a = {title:Explore.i18n("Execution Options"),items:[g,c,d]};
    Ext.apply(this, a);
    Explore.view.automation.ExecutionOptionsPanel.superclass.initComponent.apply(this, arguments)
},getStartTime:function() {
    var a = Explore.parseSerializedDate(this.rule.Plan.StartDate);
    if (a) {
        var b = a.getHours();
        var c = "AM";
        if (b === 0) {
            b = 12
        } else {
            if (b > 12) {
                b -= 12;
                c = "PM"
            }
        }
        return(b + ":" + String.leftPad(a.getMinutes(), 2, "0") + " " + c)
    }
    return"12:00 AM"
},addTimeToDate:function(c, e) {
    var f = e.indexOf(":");
    var a = e.indexOf(" ");
    var b = parseInt(e.substring(0, f));
    var d = parseInt(e.substring(f + 1, a));
    if (e.substring(a + 1).toUpperCase() == "PM") {
        b += 12
    } else {
        if (b == 12) {
            b = 0
        }
    }
    c.setHours(b, d, 0, 0);
    return c
},displayObject:function() {
    var f = this.rule;
    if (f) {
        var e = f.Plan,d = e.IsPerpetual,h = {filterByDateType:d ? 0 : 3,startDate:!d ? e.StartDate : null,endDate:!d ? e.EndDate : null};
        if (f.PlanType == 0) {
            var b = this.getByItemId("dateRangePicker"),a = this.getByItemId("frequency"),c = this.getByItemId("intervalCombo"),g = this.getByItemId("startTimeField");
            b.populateUI(h);
            a.setValue(e.Frequency);
            c.setValue(e.Interval);
            g.setValue(this.getStartTime())
        } else {
        }
    }
},isDirty:function() {
    var m = false,g = this.rule,h = g.Plan,b = h.IsPerpetual,d = h.IsPerpetual ? 0 : 3;
    var c = this.getByItemId("dateRangePicker"),a = !b ? c.getStartDate() : null,e = !b ? c.getEndDate() : null,l = c.getFilterByDateType(),j = this.getByItemId("frequency").getValue(),k = this.getByItemId("intervalCombo").getValue(),f = this.getByItemId("startTimeField").getValue();
    m |= (d !== l);
    if (l !== Explore.model.FilterByDateType.Any) {
        if (a) {
            m |= (this.addTimeToDate(a, f).toString() != new Date(h.StartDate).toString())
        } else {
            m |= false
        }
        if (e) {
            e.setHours(23);
            e.setMinutes(59);
            e.setSeconds(59);
            m |= (e.toString() != new Date(h.EndDate).toString())
        } else {
            m |= false
        }
    }
    m |= (j != h.Frequency);
    m |= (k != h.Interval);
    m |= (f != this.getStartTime());
    return m
},populateObject:function() {
    var g = this.rule;
    delete g.IsPerpetual;
    delete g.Frequency;
    delete g.Interval;
    delete g.StartDate;
    delete g.EndDate;
    var c = this.getByItemId("dateRangePicker"),b = c.getStartDate(),e = c.getEndDate(),k = c.getFilterByDateType(),h = this.getByItemId("frequency").getValue(),j = this.getByItemId("intervalCombo").getValue(),f = this.getByItemId("startTimeField").getValue();
    g.Plan = {Frequency:h,Interval:j,PlanType:0,Threshold:0};
    var d = {};
    this.getByItemId("dateRangePicker").populateObject(d);
    if (d.filterByDateType === Explore.model.FilterByDateType.Any) {
        g.Plan.IsPerpetual = true;
        var a = new Date();
        a.setHours(0, 0, 0, 0);
        g.Plan.StartDate = this.addTimeToDate(a, f)
    } else {
        g.Plan.IsPerpetual = false;
        g.Plan.StartDate = this.addTimeToDate(d.startDate, f);
        g.Plan.EndDate = d.endDate
    }
}});
Ext.reg("explore.view.automation.exectionoptionspanel", Explore.view.automation.ExecutionOptionsPanel);
Ext.ns("Explore.view.automation");
Explore.view.automation.NotificationOptionsPanel = Ext.extend(Ext.form.FormPanel, {baseCls:"engagement-side-panel",defaults:{border:false,frame:false,baseCls:"engagement-side-panel-top"},initComponent:function() {
    var c = this;
    var d = this._usersCmp = new Explore.view.searchresultdetail.assignitems.Users({fieldLabel:Explore.i18n("Send a notification email to selected users "),itemId:"usersComp",labelWidth:270,getAutomationAction:function() {
        var h = c.rule,e = h.getActionByType("SendNotification"),g = this.getValue();
        var f = new Explore.data.model.AutomationAction({Action:Explore.model.AutomationAction.SendNotification,UsersEmailIds:g.ids});
        if (e) {
            f.Id = e.Id
        }
        return(g.ids.length > 0 ? f : null)
    }});
    var b = this._saveToUncField = new Ext.form.TextField({fieldLabel:Explore.i18n("Save notification to file system"),getAutomationAction:function() {
        var h = c.rule,e = h.getActionByType("SaveToUNC"),g = this.getValue();
        var f = new Explore.data.model.AutomationAction({Action:Explore.model.AutomationAction.SaveToUNC,UNCPath:g});
        if (e) {
            f.Id = e.Id
        }
        return(g ? f : null)
    },anchor:"0",itemId:"saveToUncField"});
    var a = {title:Explore.i18n("Notification Options"),items:[d,b]};
    Ext.apply(this, a);
    Explore.view.automation.NotificationOptionsPanel.superclass.initComponent.apply(this, arguments)
},displayObject:function() {
    var e = this.rule;
    if (e) {
        var b = this._usersCmp,a = e.getSendEmailNotificationObj();
        b.setValue(a);
        var c = this._saveToUncField,d = e.getSaveToUNCObj();
        if (d) {
            c.setValue(d.path)
        }
    }
},getActions:function() {
    var b = [this._usersCmp.getAutomationAction(),this._saveToUncField.getAutomationAction()];
    var a = function(c) {
        var e = [];
        for (var d = 0; d < c.length; d++) {
            if (c[d]) {
                e.push(c[d])
            }
        }
        return e
    };
    b = a(b);
    return b
},isDirty:function() {
    var d = false,e = this.rule,c = e.getSaveToUNCObj(),b = this._saveToUncField.getValue(),a = e.getSendEmailNotificationObj(),f = this._usersCmp.getValue();
    if (c != null) {
        d |= (c.path !== b)
    } else {
        d |= (!!b)
    }
    if (a != null) {
        d |= !(Explore.areArraysSame(a.ids, f.ids))
    } else {
        d |= (f.ids.length > 0)
    }
    return d
}});
Ext.ns("Explore.view.automation");
Explore.view.automation.RuleDialogActionItem = Ext.extend(Ext.Container, {actions:null,rule:null,showUsers:false,showUnc:false,targetNameProperty:"Name",text:"",hideLabel:true,targetJsonFn:null,initComponent:function() {
    var j = this;
    this.origChecked = false;
    this.origTarget;
    this.actionInfo = null;
    this.origActionId = null;
    var a = new Ext.data.ArrayStore({id:0,fields:["id","text"],data:[]});
    for (var d = 0; d < this.actions.length; d++) {
        var c = this.actions[d];
        a.loadData([
            [c,Explore.i18n("RuleActionDropDown_" + Explore.model.AutomationAction.getName(c))]
        ], true);
        var h = this.getAction(c);
        if (h !== null) {
            this.actionInfo = h;
            this.origChecked = true;
            this.origTarget = this.actionInfo[this.primaryAttribute];
            this.origActionId = this.actionInfo.Action
        }
    }
    var e = new Ext.data.JsonStore({fields:["Id",this.targetNameProperty],data:[]});
    var f = this.text + "&nbsp;&nbsp;";
    var g = [];
    var b = {items:[
        {xtype:"container",layout:{type:"hbox",align:"middle"},items:g,height:30}
    ]};
    g.push({xtype:"radio",name:"ruleAction",itemId:"radio",checked:this.origChecked,listeners:{check:function(l, n) {
        var m = j.getByItemId("userPicker");
        if (m) {
            m.setVisible(n)
        }
        var k = j.getByItemId("uncPathPanel");
        if (k) {
            k.setVisible(n)
        }
    }}});
    if (this.actions.length > 1) {
        g.push({xtype:"selectboxfield",itemId:"subAction",width:100,store:a,valueField:"id",displayField:"text",value:this.origChecked ? this.origActionId : this.actions[0]});
        f = "&nbsp;&nbsp;" + f
    }
    g.push({xtype:"box",autoEl:{tag:"span",style:{"white-space":"nowrap"},html:f}});
    if (this.targetJsonFn) {
        g.push({xtype:"selectboxfield",itemId:"target",width:150,store:e,valueField:"Id",displayField:this.targetNameProperty,value:this.origChecked ? this.origTarget : null})
    }
    if (this.showUsers) {
        b.items.push({xtype:"explore.view.userpicker",itemId:"userPicker",height:150,width:300,checkable:true,hidden:!this.origChecked})
    }
    if (this.showUnc) {
        b.items.push({xtype:"container",itemId:"uncPathPanel",layout:{type:"hbox",align:"middle"},height:30,hidden:!this.origChecked,items:[
            {xtype:"box",autoEl:{tag:"span",style:{"white-space":"nowrap"},html:Explore.i18n("DestinationUNCPath") + ":"}},
            {xtype:"textfield",itemId:"OutputUncPath",name:"OutputUncPath",value:(this.actionInfo != null) ? this.actionInfo.UNCPath : "",width:150,margins:"0 0 0 10"}
        ]})
    }
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.automation.RuleDialogActionItem.superclass.initComponent.apply(this, arguments);
    this.on("afterrender", function() {
        if (Ext.isFunction(j.targetJsonFn)) {
            j.targetJsonFn(function(l) {
                e.loadData(l);
                var m = j.getByItemId("target");
                m.setValue(m.getValue())
            })
        }
        if (this.showUsers && this.origChecked) {
            var k = j.getByItemId("userPicker");
            if (this.actionInfo) {
                k.checkUserIds(this.actionInfo.Users)
            }
        }
    })
},getAction:function(b) {
    var c = this.rule;
    if (c != null && c.Actions != null) {
        for (var a = 0; a < c.Actions.length; a++) {
            if (b === c.Actions[a].Action) {
                return c.Actions[a]
            }
        }
    }
    return null
},populateObject:function(e) {
    var b = this;
    var f = b.getByItemId("radio").getValue();
    var e = this.rule;
    if (f === true) {
        if (this.actionInfo == null) {
            this.actionInfo = {};
            if (e.Actions == null) {
                e.Actions = []
            }
            e.Actions.push(this.actionInfo)
        }
        if (this.actions.length > 1) {
            this.actionInfo.Action = b.getByItemId("subAction").getValue()
        } else {
            this.actionInfo.Action = this.actions[0]
        }
        delete this.actionInfo.Attributes;
        if (this.targetJsonFn) {
            var a = b.getByItemId("target");
            this.actionInfo[this.primaryAttribute] = a.getValue()
        }
        if (this.showUsers) {
            var d = b.getByItemId("userPicker");
            this.actionInfo.Users = d.getSelectedUserIds()
        }
        if (this.showUnc) {
            var c = b.getByItemId("OutputUncPath");
            this.actionInfo.UNCPath = c.getValue()
        }
    } else {
        if (this.actionInfo !== null) {
            e.Actions.remove(this.actionInfo)
        }
    }
},isValid:function() {
    var c = false;
    var d = this.getByItemId("radio").getValue();
    if (d) {
        if (this.actions.length > 1) {
            if (this.getByItemId("subAction").getValue() === "") {
                c = false
            } else {
                if (this.getByItemId("target").getValue() === "" || this.getByItemId("target").getValue() === null) {
                    c = false
                } else {
                    c = true
                }
            }
        } else {
            if (this.showUsers && this.getByItemId("userPicker")) {
                var a = this.getByItemId("userPicker").getSelectedUserIds();
                if (a != null && a.length > 0) {
                    c = true
                }
            } else {
                if (this.showUnc && this.getByItemId("OutputUncPath")) {
                    var b = this.getByItemId("OutputUncPath").getValue().trim();
                    if (b && b.length > 0) {
                        c = true
                    }
                } else {
                    c = true
                }
            }
        }
    }
    return c
},isDirty:function() {
    var a = false;
    var b = this.getByItemId("radio").getValue();
    if (b !== this.origChecked) {
        a = true
    } else {
        if (b) {
            if (this.actions.length > 1) {
                if (this.getByItemId("subAction").isDirty()) {
                    a = true
                }
            }
            if (this.targetJsonFn && this.getByItemId("target").isDirty()) {
                a = true
            }
            if (this.showUsers && this.getByItemId("userPicker").isDirty()) {
                a = true
            }
        }
    }
    return a
}});
Ext.reg("explore.view.automation.ruledialogactionitem", Explore.view.automation.RuleDialogActionItem);
Ext.ns("Explore.view.common");
Explore.view.common.BarColumn = Ext.extend(Ext.grid.Column, {tpl:new Ext.XTemplate('<div class ="bar-background" ">', '<div class ="bar-filled" style="width: {[this.getPercentage(values)]}%;">', "{[this.getPercentage(values)]}", "</div>", "</div>", {getPercentage:function(a) {
    var b = a.value;
    if (b) {
        return(b)
    }
    return b
}}),constructor:function(a) {
    if (a.renderer) {
        this.baseRenderer = a.renderer;
        a = Ext.apply({}, a);
        delete a.renderer
    }
    Ext.grid.Column.call(this, a);
    this.renderer = Explore.view.common.BarColumn.prototype.renderer.createDelegate(this)
},getQtip:function(e, f, a, g, c, b, d) {
    return e
},baseRenderer:function(a) {
    return a
},renderer:function(d, e, a, f, c, b) {
    if (a) {
        e.css += " x-grid3-td-slider-cell";
        return this.tpl.apply({align:this.align || "left",value:d,qtip:this.getQtip.apply(this, arguments)})
    } else {
        return d
    }
}});
Ext.ns("Explore.view.common");
Explore.view.common.CheckboxGroup = Ext.extend(Ext.form.CheckboxGroup, {height:150,setValue:function(c) {
    this.value = c;
    function a(e) {
        if (typeof c === "boolean") {
            return c
        } else {
            return c.indexOf(e.itemId) >= 0
        }
    }

    if (this.rendered) {
        for (var d = 0; d < this.items.length;
             d++) {
            var b = this.items.items[d];
            b.setValue(a(b))
        }
    } else {
        for (var d = 0; d < this.items.length; d++) {
            var b = this.items[d];
            b.checked = a(b)
        }
    }
},getHeaderChecked:function() {
    if (this.headerCheck) {
        return this.headerCheck.getValue()
    } else {
        return null
    }
},getValue:function() {
    var a = [];
    for (var c = 0; c < this.items.length; c++) {
        var b = this.items.items[c];
        if (b.getValue()) {
            a.push(b.itemId)
        }
    }
    return a
},onRender:function(e, b) {
    if (!this.el) {
        var g = {id:this.id,cls:"checkbox-group",border:true,renderTo:e,bufferResize:false,items:[],height:this.height,autoScroll:true,layout:"anchor",defaultType:this.defaultType,defaults:{hideLabel:true},padding:5};
        for (var d = 0; d < this.items.length; d++) {
            var f = this.items[d];
            if (f.fieldLabel) {
                f.hideLabel = false
            }
        }
        g.items = this.items;
        if (this.initialConfig.showHeaderCheck) {
            this.headerCheck = new Explore.view.common.TristateCheck({boxLabel:this.initialConfig.headerText});
            g.tbar = {cls:"no-toolbar-background",items:this.headerCheck}
        } else {
            if (this.initialConfig.headerText) {
                g.tbar = {cls:"no-toolbar-background",items:{xtype:"label",text:this.initialConfig.headerText}}
            }
        }
        this.panel = new Ext.Panel(g);
        this.panel.ownerCt = this;
        this.el = this.panel.getEl();
        if (this.forId && this.itemCls) {
            var c = this.el.up(this.itemCls).child("label", true);
            if (c) {
                c.setAttribute("htmlFor", this.forId)
            }
        }
        var a = this.panel.findBy(function(h) {
            return h.isFormField
        }, this);
        this.items = new Ext.util.MixedCollection();
        this.items.addAll(a);
        if (this.headerCheck) {
            this.headerCheck.monitorChecks(a)
        }
    }
    Ext.form.CheckboxGroup.superclass.onRender.call(this, e, b)
}});
Ext.reg("explore.view.common.checkboxgroup", Explore.view.common.CheckboxGroup);
Ext.ns("Explore.view.common");
Explore.view.common.Cloud = Ext.extend(Ext.Container, {autofit:true,cloudItems:[],initComponent:function() {
    var a = this;
    var c = ["cloudItemClick","cloudItemContextMenu"];
    a.addEvents(c);
    a.enableBubble(c);
    var b = {border:false,autoScroll:false,padding:0,cls:"cloud-panel",items:{xtype:"container",itemId:"cloudContainerFit",cls:"cloud-fit-panel",border:false,padding:0,autoHeight:true,listeners:{afterlayout:function(d, e) {
        if (a.autofit && d.isVisible()) {
            a.autofitCloud(d)
        }
    },scope:a},items:this.createCloudStartPlaceholder()}};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.common.Cloud.superclass.initComponent.apply(this, arguments)
},sortFunc:function(d, c) {
    if (!c) {
        return 1
    } else {
        if (!d) {
            return -1
        }
    }
    return(d.term === c.term) ? 0 : (d.term > c.term) ? 1 : -1
},setDataItems:function(a) {
    this.cloudItems = [];
    if (a) {
        for (var b = 0; b < a.length; b++) {
            var c = a[b];
            if (c && c.term) {
                this.cloudItems.push(a[b])
            }
        }
        this.cloudItems.sort(this.sortFunc)
    }
    this.onItemsChanged()
},getDataItems:function() {
    return this.cloudItems
},onItemsChanged:function() {
    this.regenerateCloud()
},regenerateCloud:function() {
    var a = this.getByItemId("cloudContainerFit");
    a.removeAll();
    a.add(this.createCloudTopicItems());
    this.doLayout()
},autofitCloud:function(d) {
    var b = this,a = b.getEl().dom,c = d.getEl().dom;
    if (a && a.offsetHeight && c && c.style) {
        var f = a.offsetWidth;
        var h = a.offsetHeight - c.offsetTop / 2;
        var e = 100;
        var g = 2;
        c.style.height = "auto";
        do{
            c.style.fontSize = (++g) + "px"
        } while (c.offsetHeight < h && c.offsetWidth <= f && g < e);
        if (g > 1) {
            c.style.fontSize = (g - 1) + "px"
        }
    }
},createCloudStartPlaceholder:function() {
    return{xtype:"component",cls:"cloud-start",autoEl:{tag:"span",html:" "}}
},createSeparator:function() {
    return{xtype:"component",autoEl:{tag:"span",html:" | "}}
},createTermComponent:function(a, c) {
    var b = this;
    if (a.data.WasRun === false) {
        a.term += "*";
        b.showUncalcultedLabel = true
    }
    return{xtype:"component",exploreTag:a,listeners:{render:function(d) {
        d.getEl().on("click", function() {
            b.fireEvent("cloudItemClick", d.exploreTag)
        });
        d.getEl().on("contextmenu", function(f) {
            b.fireEvent("cloudItemContextMenu", d.exploreTag, f)
        })
    }},autoEl:{tag:"span",html:a.term.replace(/"/g, "&quot;"),title:a.tooltip,cls:"topic cloud-weight-" + c}}
},getRange:function(c, b) {
    var f = 0;
    var a = 0;
    if (c) {
        for (var e = 0; e < c.length; e++) {
            var d = (b) ? b(c[e]) : c[e];
            f = (e > 0) ? Math.min(f, d) : d;
            a = (e > 0) ? Math.max(a, d) : d
        }
    }
    return{min:f,max:a}
},basisSelector:function(a) {
    return a.weight
},createCloudTopicItems:function() {
    var h = [];
    var g = this.getRange(this.cloudItems, this.basisSelector);
    var f = 10;
    var e = f / Math.max(1, g.max - g.min);
    h.push(this.createCloudStartPlaceholder());
    for (var d = 0; d < this.cloudItems.length; d++) {
        var a = this.cloudItems[d];
        var b = this.basisSelector(a);
        var c = Math.round(e * (b - g.min));
        if (d > 0) {
            h.push(this.createSeparator())
        }
        h.push(this.createTermComponent(a, c))
    }
    return h
}});
Ext.reg("explore.view.common.cloud", Explore.view.common.Cloud);
Ext.ns("Explore.view.common");
Explore.view.common.Cluster = Ext.extend(Explore.base.WidgetBase, {projectId:null,DEFAULT_RADIUS:8,DEFAULT_SIZE:512,scaleX:1,scaleY:1,stretch:true,errorCls:"",urlPrefix:"../",clusterResults:null,initComponent:function() {
    var a = this;
    a.projectId = Explore.presenter.ProjectsPresenter.getCurrentProjectId();
    var d = Ext.id();
    Explore.ensureExtDirect(a.initialConfig.applicationBaseURL);
    if (typeof a.initialConfig.applicationBaseURL !== "undefined") {
        a.urlPrefix = a.initialConfig.applicationBaseURL;
        if (!a.urlPrefix.match(/\/$/)) {
            a.urlPrefix += "/"
        }
    }
    var b = {layout:"card",border:false,items:[
        {xtype:"container",cls:this.x,items:{xtype:"component",autoEl:{tag:"span",html:"(" + Explore.i18n("selectSavedSearch") + ")"}}},
        {xtype:"container",itemId:"statusPanel",border:false,items:{xtype:"panel",border:false,padding:"12 12 12 12",width:"75%",items:[
            {xtype:"label",itemId:"statuslabel",text:""},
            {xtype:"container",height:10,border:false},
            {xtype:"button",text:Explore.i18n("submitNewClusterJob"),handler:function() {
                a.submitClusterJob()
            }}
        ]}},
        {xtype:"container",itemId:"clusterMainPanel",layout:new Explore.layout.ClusterImageLayout({stretch:a.stretch}),listeners:{resize:function(f, g, e) {
            if (a.stretch) {
                a.scaleX = g / a.DEFAULT_SIZE;
                a.scaleY = e / a.DEFAULT_SIZE
            } else {
                a.scaleX = a.scaleY = Math.min(g, e) / a.DEFAULT_SIZE
            }
            a.setupImageMap()
        }},items:[
            {itemId:"clustersImage",xtype:"component",autoEl:{tag:"img",cls:"clusters-image",usemap:"#clustersImageMap" + d}},
            {itemId:"clustersImageMap",xtype:"component",autoEl:{tag:"map",cls:"clusters-image-map",name:"clustersImageMap" + d}}
        ]}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.common.Cluster.superclass.initComponent.apply(this, arguments);
    a.on("afterrender", function() {
        var e = a.initialConfig;
        if (e.searchId && e.searchType) {
            var f = {searchId:e.searchId,searchType:e.searchType};
            if (typeof f.searchType === "string") {
                f.searchType = parseInt(f.searchType, 10)
            }
            a.doSearch(f)
        }
    });
    var c = true;
    a.on("afterlayout", function() {
        if (c) {
            c = false;
            if (this.ownerCt.getItemId() === "cardContainer") {
                a.showBusy()
            }
        }
    })
},getCoords:function(c) {
    var b = this.scaleX * c.x;
    var d = this.scaleY * c.y;
    var a = Math.min(this.scaleX, this.scaleY) * this.DEFAULT_RADIUS;
    return String.format("{0},{1},{2}", b, d, a)
},setupImageMap:function() {
    var e = this;
    log.debug("setupImageMap scale=", e.scaleX, e.scaleY);
    if (e.clusterResults != null) {
        var d = e.getByItemId("clustersImage");
        var g = e.getByItemId("clustersImageMap");
        var c = [];
        var b = e.clusterResults.imageMap;
        for (var f = 0; f < b.length; f++) {
            var a = b[f];
            var h = Explore.i18n("Score") + ": ( " + a.score + " ) \n" + a.text;
            h = h.replace(/"/g, "&quot;");
            c.push(String.format('<area title="{0}" href="#" onclick="return Explore.view.ClustersAreaClick(this, {2}, \'{3}\');" shape="circle" alt="{0}" coords="{1}" />', h, this.getCoords(a), a.id, e.id))
        }
        if (g && g.el && g.el.dom) {
            g.el.dom.innerHTML = c.join("")
        }
    }
},exportData:function() {
    if (this.clusterResults != null) {
        Explore.utils.Exporter.exportClusterImage(this.urlPrefix + this.clusterResults.imageSrc)
    } else {
        this.showError(Explore.i18n("ExportNotSupported_PleaseWaitUntilTheClusterHasLoaded_"))
    }
},setStatus:function(b) {
    var c = this;
    var a = b || "";
    var d = c.getByItemId("statuslabel");
    if (d) {
        d.setText(a)
    }
},submitClusterJob:function() {
    var a = this;
    if (a.currentSearchId && a.currentSearchType) {
        Explore.data.ClusterDataStore.submitClusterJobForSavedSearch(a.currentSearchId, a.projectId);
        a.setStatus(Explore.i18n("NewClusterSubmttedTryLater"))
    }
},closeBusyMessage:function() {
    this.hideStatus();
    if (Explore.view.StatusBox && Explore.view.StatusBox.close) {
        Explore.view.StatusBox.close()
    }
},doSearch:function(d) {
    var b = this;
    b.currentSearchId = d.searchId;
    b.currentSearchType = d.searchType;
    var a = b.getByItemId("clustersImage");
    var c = b.getByItemId("clustersImageMap");
    if (a.rendered && c.rendered) {
        a.el.dom.src = Ext.BLANK_IMAGE_URL;
        c.el.dom.innerHTML = ""
    }
    selfclusterResults = null;
    if (b.currentSearchType !== 1) {
        b.getLayout().setActiveItem(0);
        b.closeBusyMessage();
        return
    } else {
        Explore.data.ClusterDataStore.getClusterResultInfo(d.searchId, d.searchType, b.projectId, function(e) {
            if (e) {
                if (d.canceled) {
                    log.debug("Search was canceled. Ignoring results.")
                } else {
                    if (e.imageMap.length == 0) {
                        b.getLayout().setActiveItem(1);
                        Explore.data.ClusterDataStore.getClusterErrorInfo(d.searchId, d.searchType, b.projectId, function(f) {
                            if (f != null) {
                                b.setStatus(Explore.i18n("" + f.ID))
                            }
                        })
                    } else {
                        b.getLayout().setActiveItem(2);
                        b.clusterResults = e;
                        a.el.dom.src = b.urlPrefix + e.imageSrc;
                        b.setupImageMap()
                    }
                }
            }
            b.closeBusyMessage()
        })
    }
},getClusterById:function(d) {
    var b = this.clusterResults.imageMap;
    for (var c = 0; c < b.length; c++) {
        var a = b[c];
        if (a.id === d) {
            return a
        }
    }
    return null
},areaClick:function(d) {
    log.info("Clusters areaClick: " + d);
    var b = this;
    var c = Explore.showSearchPanel();
    if (c) {
        var a = b.getClusterById(d);
        Explore.data.IDOLDataStore.getSearchCriteriaBySearchId(this.currentSearchId, function(e) {
            e.searchTerms = "SAVEDSEARCH::(" + e.Name + ")+AND+(" + a.text + ")";
            e.searchTermsUI = "SAVEDSEARCH::(" + e.Name + ")+AND+(" + a.text + ")";
            e.searchType = 0;
            e.projectId = Explore.presenter.ProjectsPresenter.getCurrentProjectId();
            e.timezoneOffsetMilliseconds = Explore.getLocalTimeZoneOffset();
            c.searchByCriteria(e, {bypassBusyMessage:false})
        })
    }
    return false
}});
Ext.reg("explore.view.common.cluster", Explore.view.common.Cluster);
Explore.view.ClustersAreaClick = function(b, a, c) {
    var d = Ext.getCmp(c);
    d.areaClick(a);
    return false
};
Ext.ns("Explore.layout");
Explore.layout.ClusterImageLayout = Ext.extend(Ext.layout.ContainerLayout, {stretch:true,monitorResize:true,onLayout:function(d, g) {
    Explore.layout.ClusterImageLayout.superclass.onLayout.call(this, d, g);
    if (!this.container.collapsed) {
        var f = (Ext.isIE6 && Ext.isStrict && g.dom == document.body) ? g.getViewSize() : g.getStyleSize();
        var b = d.items.itemAt(0);
        var c = d.items.itemAt(1);
        var e,a;
        if (this.stretch) {
            e = f.width;
            a = f.height
        } else {
            e = a = Math.min(f.width, f.height)
        }
        if (e > 0 && a > 0 && (e != this.lastWith || a != this.lastHeight)) {
            log.debug("ClusterImageLayout size", e, a);
            this.lastWidth = e;
            this.lastHeight = a;
            b.el.setSize(e, a)
        }
    }
}});
Ext.ns("Explore.view.common");
Explore.view.common.DateRangePicker = Ext.extend(Ext.Panel, {isTwitter:false,isFacebook:false,supportTrailingRanges:false,defaultValues:{},customOptions:null,initComponent:function() {
    var j = this;
    Ext.applyIf(this.defaultValues, {dateType:Explore.model.FilterByDateType.Any,startDate:-90});
    var c = j.getTbar();
    var f = {xtype:"selectboxfield",itemId:"mainDateSelect",mode:"local",width:this.supportTrailingRanges ? 180 : 120,ctCls:"date-field",store:new Ext.data.JsonStore({fields:["id","text","showStartDate","showEndDate","realTimeDays"],data:j.getDateOptions()}),valueField:"id",displayField:"text",value:this.defaultValues.dateType,listeners:{beforeselect:function(l, k, m) {
        j.onFilterTypeChanged(k);
        j.ownerCt.doLayout()
    }}};
    var d = {itemId:"startDateLabel",xtype:"box",autoEl:{tag:"div",style:this.horizontalLayout ? "padding:5px 5px 0px 5px" : ""},html:this.horizontalLayout ? "" : Explore.i18n("StartDate") + ":",cls:"date-label",hidden:this.defaultValues && this.defaultValues.showStartDate ? false : true};
    var h = {itemId:"fffilterFromDate",xtype:"datefield",width:105,format:Explore.getDateFormatByPref({ignoreTime:true}),altFormats:Explore.getDateFormatByPref({ignoreTime:true}),value:(this.defaultValues && this.defaultValues.startDate != null) ? this.defaultValues.startDate : new Date,hideLabel:true,hidden:this.defaultValues && this.defaultValues.showStartDate ? false : true};
    var a = {itemId:"endDateLabel",xtype:"box",autoEl:{tag:"div",style:this.horizontalLayout ? "padding:5px 0px 0px 5px" : ""},html:this.horizontalLayout ? Explore.i18n("and") : Explore.i18n("EndDate") + ":",cls:"date-label",hidden:this.defaultValues && this.defaultValues.showEndDate ? false : true};
    var g = {itemId:"fffilterEndDate",xtype:"datefield",width:105,format:Explore.getDateFormatByPref({ignoreTime:true}),altFormats:Explore.getDateFormatByPref({ignoreTime:true}),value:(this.defaultValues && this.defaultValues.endDate != null) ? this.defaultValues.endDate : new Date,hideLabel:true,hidden:this.defaultValues && this.defaultValues.showEndDate ? false : true};
    var e = {xtype:"box",border:false,width:this.isTwitter ? 10 : 5};
    var b = {xtype:"container",layout:this.horizontalLayout ? {type:"hbox",align:"middle"} : "auto",border:false,cls:"date-range-picker",tbar:c,height:this.horizontalLayout ? 30 : undefined,width:this.horizontalLayout ? 500 : undefined,items:[f,d,h,a,e,g]};
    Ext.apply(this, Ext.apply(b, this.initialConfig));
    Explore.view.common.DateRangePicker.superclass.initComponent.apply(this, arguments)
},getStartDate:function() {
    var a = this;
    var b = a.getByItemId("fffilterFromDate");
    if (b.isVisible()) {
        return b.getValue()
    } else {
        return null
    }
},populateObject:function(e) {
    var c = this;
    var b = c.getByItemId("mainDateSelect");
    var d = c.getByItemId("fffilterFromDate");
    var a = c.getByItemId("fffilterEndDate");
    e.filterByDateType = b.getValue();
    if (d.isVisible()) {
        e.startDate = d.getValue()
    } else {
        e.startDate = null
    }
    if (a.isVisible()) {
        e.endDate = a.getValue()
    } else {
        e.endDate = null
    }
    if (e.endDate) {
        e.endDate.setHours(23);
        e.endDate.setMinutes(59);
        e.endDate.setSeconds(59)
    }
},populateUI:function(g) {
    var d = this;
    var c = d.getByItemId("mainDateSelect");
    var f = d.getByItemId("fffilterFromDate");
    var a = d.getByItemId("fffilterEndDate");
    var e = g.filterByDateType || Explore.model.FilterByDateType.Any;
    c.setValue(e);
    var b = c.getStore().getById(e);
    d.onFilterTypeChanged(b);
    if (e === Explore.model.FilterByDateType.Between || e === Explore.model.FilterByDateType.Before || e === Explore.model.FilterByDateType.After) {
        f.setValue(Explore.formatDate(g.startDate, f.format));
        a.setValue(Explore.formatDate(g.endDate, a.format))
    }
},getFilterByDateType:function() {
    return this.getByItemId("mainDateSelect").getValue()
},getEndDate:function() {
    var b = this;
    var a = b.getByItemId("fffilterEndDate");
    if (a.isVisible()) {
        return a.getValue()
    } else {
        return null
    }
},getFilterBetweenDefaultStartDate:function(b, a) {
    return Explore.formatDate(Explore.getStartDateFromTimeWindow(Explore.model.TimeWindow.Past3Months, a.getValue(), null), b.format)
},onFilterTypeChanged:function(f) {
    var j = this;
    var c = j.getByItemId("fffilterFromDate");
    var b = j.getByItemId("fffilterEndDate");
    if (f.id == Explore.model.TimeWindow.Between) {
        c.setValue(this.getFilterBetweenDefaultStartDate(c, b))
    }
    var d = j.getByItemId("startDateLabel");
    var a = j.getByItemId("endDateLabel");
    var h = f.get("showStartDate");
    var e = f.get("showEndDate");
    var g = (h && e);
    c.setVisible(h);
    b.setVisible(e);
    d.setVisible(g);
    a.setVisible(g);
    j.doLayout()
},getDateOptions:function() {
    var a = this;
    if (a.customOptions && a.customOptions.length) {
        return a.customOptions
    }
    var b = [
        {id:Explore.model.FilterByDateType.Any,text:Explore.i18n("FilterByDateType_Any"),showStartDate:false,showEndDate:false},
        {id:Explore.model.FilterByDateType.Between,text:Explore.i18n("FilterByDateType_Between"),showStartDate:true,showEndDate:true}
    ];
    if (this.isTwitter || this.isFacebook) {
        b.push({id:Explore.model.FilterByDateType.After,text:Explore.i18n("FilterByDateType_After"),showStartDate:true,showEndDate:false});
        b.push({id:Explore.model.FilterByDateType.Before,text:Explore.i18n("FilterByDateType_Before"),showStartDate:false,showEndDate:true})
    }
    if (this.supportTrailingRanges) {
        b.push({id:Explore.model.FilterByDateType.PastDay,text:Explore.i18n("FilterByDateType_PastDay"),showStartDate:false,showEndDate:false});
        b.push({id:Explore.model.FilterByDateType.PastWeek,text:Explore.i18n("FilterByDateType_PastWeek"),showStartDate:false,showEndDate:false});
        b.push({id:Explore.model.FilterByDateType.PastMonth,text:Explore.i18n("FilterByDateType_PastMonth"),showStartDate:false,showEndDate:false});
        b.push({id:Explore.model.FilterByDateType.PastYear,text:Explore.i18n("FilterByDateType_PastYear"),showStartDate:false,showEndDate:false})
    }
    return b
},getTbar:function() {
    var a;
    if (this.initialConfig.headerText) {
        a = {cls:"no-toolbar-background",items:[
            {xtype:"component",autoEl:{tag:"div"},html:this.initialConfig.headerText}
        ]};
        delete a.headerText
    }
    return a
}});
Ext.reg("explore.view.common.daterangepicker", Explore.view.common.DateRangePicker);
Ext.ns("Explore.view.common");
Explore.view.common.DisabledToolDecorator = function(a, b) {
    b.toolTemplate = new Ext.XTemplate('<div class="x-tool x-tool-{id}<tpl if="this.isDisabled(values)">-dis disabled</tpl>">&#160;</div>', {isDisabled:function(d) {
        var c = d.disabled || false;
        return c
    }});
    this.hideTools = function(c) {
        for (var e = 0; e < c.length; e++) {
            var f = c[e];
            var d = a.tools[f];
            if (d) {
                d.hide()
            }
        }
    };
    this.showTools = function(c) {
        for (var e = 0;
             e < c.length; e++) {
            var f = c[e];
            var d = a.tools[f];
            if (d) {
                d.show()
            }
        }
    };
    this.enableTools = function(c) {
        for (var e = 0; e < c.length; e++) {
            var f = c[e];
            var d = a.tools[f];
            if (d) {
                d.addClass("x-tool-" + f);
                d.removeClass("x-tool-" + f + "-dis");
                d.removeClass("x-item-disabled");
                d.removeClass("disabled")
            }
        }
    };
    this.disableTools = function(c) {
        for (var e = 0; e < c.length; e++) {
            var f = c[e];
            var d = a.tools[f];
            if (d) {
                d.addClass("x-item-disabled");
                d.addClass("disabled");
                d.addClass("x-tool-" + f + "-dis");
                d.removeClass("x-tool-" + f)
            }
        }
    };
    return this
};
Ext.ns("Explore.view");
Explore.view.common.DocCountComponent = Ext.extend(Ext.Component, {initComponent:function() {
    Explore.view.common.DocCountComponent.superclass.initComponent.apply(this, arguments)
},loadCounts:function(c, d) {
    var a = this;
    var b = {Type:c,Id:d};
    if (a._docTooltip) {
        a._docTooltip.destroy()
    }
    this.update(Explore.i18n("Calculating"));
    DocumentCountService.GetDocCount(b, function(e) {
        if (e) {
            a.update(Explore.formatNumber(e.TotalCount));
            if (e.TotalCount > 0) {
                a._docTooltip = new Explore.view.common.DocCountToolTip({target:a.getEl(),documentCounts:e})
            }
        } else {
            a.update(Explore.i18n("Error"))
        }
    })
}});
Ext.reg("explore.view.common.doccountcomponent", Explore.view.common.DocCountComponent);
Ext.ns("Explore.view");
Explore.view.common.DocCountToolTip = Ext.extend(Ext.ToolTip, {anchor:"top",constrainPosition:true,autoShow:true,documentCounts:null,initComponent:function() {
    if (this.documentCounts) {
        var e = [];
        var b = this.documentCounts.CountsByType;
        for (var a = 0; a < b.length; a++) {
            var d = b[a];
            var c = d.Key;
            e.push('<div class="docCountTip" style="background-image:url(\'' + Explore.SearchResults.getIcnSmallByType(c) + "')\">");
            e.push(c);
            e.push(":");
            e.push(Explore.formatNumber(d.Value));
            e.push(" ");
            e.push(Explore.i18n("docs"));
            e.push("</div>")
        }
        this.html = e.join("")
    } else {
        this.html = Explore.i18n("Error")
    }
    Explore.view.common.DocCountToolTip.superclass.initComponent.apply(this, arguments)
}});
Ext.reg("explore.view.common.doccounttooltip", Explore.view.common.DocCountToolTip);
Ext.ns("Explore.view.common");
Ext.ns("Explore.view.common");
Explore.view.common.DynamicGridPanel = Ext.extend(Ext.Panel, {gridConfig:{},colConfig:{},initComponent:function() {
    var b = this;
    var a = {layout:"fit",border:false,frame:false};
    Ext.apply(this, a);
    Explore.view.common.DynamicGridPanel.superclass.initComponent.apply(this, arguments)
},getGrid:function() {
    return this._grid
},createGrid:function(b) {
    if (this._grid) {
        this._grid.destroy();
        this.removeAll();
        this._grid = null
    }
    var a = Ext.applyIf({columns:b.Columns,stripeRows:true,viewConfig:{autoFill:true},store:new Ext.data.ArrayStore({fields:b.Fields,data:b.Data})}, this.gridConfig);
    this._grid = new Ext.grid.GridPanel(a);
    this.add(this._grid);
    this.doLayout();
    return this._grid
}});
Ext.reg("Explore.view.common.DynamicGridPanel", Explore.view.common.DynamicGridPanel);
Ext.ns("Explore.view.common");
Explore.view.common.FillSlider = Ext.extend(Ext.slider.SingleSlider, {anchor:"-5",constructor:function(a) {
    a = a || {};
    Ext.applyIf(a, {values:[a.value || 0]});
    Explore.view.common.FillSlider.superclass.constructor.call(this, a)
},moveThumb:function(c, b, a) {
    this.syncFill(b);
    Explore.view.common.FillSlider.superclass.moveThumb.call(this, c, b, a)
},syncFill:function(a) {
    var b = this.getEl(),d = b.query(".fill-slider")[0],c = Ext.fly(d);
    c.setWidth(a + 6);
    this.syncValMarker(a)
},syncValMarker:function(b) {
    var c = this.getEl(),e = c.query(".fill-value")[0],d = Ext.fly(e),a = b - 2;
    if (this.animate === false) {
        d.setLeft(a)
    } else {
        d.shift({left:a,stopFx:true,duration:0.35})
    }
    d.update(this.getValue() + "")
},onRender:function() {
    this.autoEl = {cls:"x-slider x-slider-horz",cn:[
        {cls:"x-slider-end",cn:[
            {cls:"x-slider-inner",cn:[
                {tag:"a",cls:"x-slider-focus",href:"#",tabIndex:"-1",hidefocus:"on"},
                {cls:"fill-value",tag:"div",html:"0"}
            ]}
        ]},
        {cls:"fill-slider",tag:"div"}
    ]};
    Ext.slider.MultiSlider.superclass.onRender.apply(this, arguments);
    this.endEl = this.el.first();
    this.innerEl = this.endEl.first();
    this.focusEl = this.innerEl.child(".x-slider-focus");
    for (var b = 0; b < this.thumbs.length; b++) {
        this.thumbs[b].render()
    }
    var a = this.innerEl.child(".x-slider-thumb");
    this.halfThumb = (this.vertical ? a.getHeight() : a.getWidth()) / 2;
    this.initEvents();
    this.syncThumb()
}});
Ext.ns("Explore.view");
Explore.view.common.GridSelector = Ext.extend(Ext.grid.GridPanel, {cls:"gray-grid",stripeRows:false,enableColumnMove:false,enableColumnHide:false,enableColumnResize:false,enableHdMenu:false,singleSelect:true,autoExpandColumn:"Name",initComponent:function() {
    var a = this;
    if (!this.selModel) {
        this.createSelectionModel()
    }
    Explore.view.common.GridSelector.superclass.initComponent.apply(this, arguments);
    if (this.menuItems) {
        this.on("rowcontextmenu", this.showContextMenu, this)
    }
},createSelectionModel:function() {
    this.selModel = new Ext.grid.RowSelectionModel({singleSelect:this.singleSelect})
},showContextMenu:function(c, d, a) {
    if (!this.menu) {
        this.menu = new Ext.menu.Menu({items:this.menuItems})
    }
    if (!this.selModel.isSelected(d)) {
        this.selModel.selectRow(d)
    }
    this.menu.contextRowIndex = d;
    this.menu.contextRecord = this.getStore().getAt(d);
    var b = {grid:c,menu:this.menu,rowIndex:this.menu.contextRowIndex,record:this.menu.contextRecord,originalEvent:a,showMenu:true};
    this.fireEvent("beforeShowContextMenu", c, b);
    if (b.showMenu) {
        this.menu.showAt(a.getXY());
        a.preventDefault()
    }
},getSelections:function() {
    var a = this.getSelectionModel();
    var b = [];
    if (a) {
        if (a instanceof Ext.grid.CellSelectionModel) {
            b = a.getSelectedCell()
        } else {
            b = a.getSelections()
        }
    }
    return b
},destroy:function() {
    if (this.menu) {
        this.menu.destroy()
    }
    Explore.view.common.GridSelector.superclass.destroy.apply(this, arguments)
}});
Ext.reg("explore.view.common.gridselector", Explore.view.common.GridSelector);
Ext.ns("Explore.view");
Explore.view.common.LinearGuage = Ext.extend(Ext.BoxComponent, {chartData:null,barHeight:20,chartMargin:10,cornerRadius:5,chartFont:"12px Tahoma 400",initComponent:function() {
    var a = this;
    Explore.view.common.LinearGuage.superclass.initComponent.apply(this, arguments);
    a.on("resize", a.drawChart, a)
},setChartData:function(a) {
    this.chartData = a;
    this.drawChart()
},addRoundedRectangle:function(b, l, k, m, g, f, d, c, a, e) {
    var j = [];
    if (f > m) {
        f = m
    }
    if (d > m) {
        d = m
    }
    if (c > m) {
        c = m
    }
    if (a > m) {
        a = m
    }
    j = j.concat(["M",l,f + k,"Q",l,k,l + f,k]);
    j = j.concat(["L",l + m - d,k,"Q",l + m,k,l + m,k + d]);
    j = j.concat(["L",l + m,k + g - c,"Q",l + m,k + g,l + m - c,k + g]);
    j = j.concat(["L",l + a,k + g,"Q",l,k + g,l,k + g - a,"Z"]);
    var n = b.add(Ext.apply({type:"path",path:j}, e));
    b.renderItem(n);
    return n
},addLine:function(b, a, j, c, f, d) {
    var g = ["M",a,j,"L",a + c,j + f];
    var e = b.add(Ext.apply({type:"path",path:g}, d));
    b.renderItem(e);
    return e
},addIndicator:function(b, a, h, f, c) {
    var e = Math.round(f / 2);
    var g = [];
    g = g.concat(["M",a,h,"L",a + e,h - f]);
    g = g.concat(["L",a - e,h - f]);
    g = g.concat(["L",a,h]);
    var d = b.add(Ext.apply({type:"path",path:g}, c));
    b.renderItem(d);
    return d
},addTextSprite:function(d, l, k, n, h, f, b, e) {
    var m = d.add(Ext.apply({type:"text",x:l,y:k,text:n}, e));
    d.renderItem(m);
    var a,c;
    if (h === "right") {
        a = m.getBBox();
        c = a.width;
        m.setAttributes({translate:{type:"translate",x:-c,y:0}}, true)
    } else {
        if (h === "center") {
            a = m.getBBox();
            c = a.width;
            var g = c / 2;
            var j = -g;
            if (l + g > b) {
                j = (b - c) - l
            }
            if (l - g < f) {
                j = f - l
            }
            m.setAttributes({translate:{type:"translate",x:j,y:0}}, true)
        }
    }
    return m
},drawChart:function() {
    var b = this.chartData,c = this.getEl();
    if (!c || !c.dom || !b) {
        return
    }
    var n = c.getComputedWidth(),g = c.getComputedHeight();
    if (n === 0) {
        return
    }
    var a = this.cornerRadius;
    var r = b.min;
    var t = b.max;
    var q = b.value;
    var e = (q - r) / (t - r);
    var h = b.indicatorText;
    var k = this.chartMargin;
    var f = 23;
    var s = this.barHeight;
    var j = n - 2 * k;
    var d = Math.round(e * j);
    var u = 10;
    var o = k + f;
    if (this.drawComponent) {
        this.drawComponent.destroy()
    }
    this.drawComponent = new Ext4.draw.Component({viewBox:false,renderTo:c.dom,width:n,height:g});
    this.drawComponent.surface.addGradient({id:"home-chart-gradient-background",angle:90,stops:{0:{color:"#888788"},100:{color:"#BBBBBD"}}});
    this.drawComponent.surface.addGradient({id:"home-chart-gradient-foreground",angle:90,stops:{0:{color:"#CAE9F7"},50:{color:"#60A8D8"},100:{color:"#0B73B8"}}});
    this.drawComponent.surface.addGradient({id:"home-chart-gradient-indicator",angle:90,stops:{0:{color:"#EFEFEF"},100:{color:"#B7B6B6"}}});
    var p = this.drawComponent.surface;
    this.addRoundedRectangle(p, k, o, j, s, a, a, a, a, {stroke:"#6C6C6A","stroke-width":2,fill:"url(#home-chart-gradient-background)"});
    var l = (d >= j - 1) ? a : 0;
    this.addRoundedRectangle(p, k, o, d, s, a, l, l, a, {stroke:"#29A0CB","stroke-width":2,fill:"url(#home-chart-gradient-foreground)"});
    this.addLine(p, k, o + s, 0, u, {stroke:"#818281","stroke-width":2});
    this.addTextSprite(p, k - 3, o + s + u + 10, Explore.formatNumber(r), "left", k, n - k, {font:this.chartFont});
    this.addLine(p, k + j, o + s, 0, u, {stroke:"#818281","stroke-width":2});
    this.addTextSprite(p, k + j, o + s + u + 10, Explore.formatNumber(t), "right", k, n - k, {font:this.chartFont});
    this.addIndicator(p, k + d, o - 2, 12, {stroke:"#818281","stroke-width":1,fill:"url(#home-chart-gradient-indicator)"});
    var m = k + d;
    this.addTextSprite(p, m, k, h, "center", k, n - k, {font:this.chartFont})
}});
Ext.reg("explore.view.common.linearguage", Explore.view.common.LinearGuage);
Explore.view.common.MapImpl = function(e, A) {
    var e = (e || {});
    e.detail = (e.detail || {});
    var c = (e.bgcolor || "#ffffff");
    var z = (e.fgcolor || "#dddddd");
    var h = (e.bordercolor || "#aaaaaa");
    var n = ((e.padding || 10) * 2);
    var d = (e.zoom || "ca,cl,us,ru");
    var u = 0;
    var t = 0;
    var p = {};
    var k = document.getElementById(e.id);
    if (!k) {
        alert("Error: missing or incorrect canvas 'id'")
    }
    var a = k.width;
    var g = k.height;
    k.style.backgroundColor = c;
    var f = (k).getContext("2d");
    f.clearRect(0, 0, a, g);
    f.lineWidth = (e.borderwidth || 1);
    var b = d.split(",");
    var y = A[b[0]][0][0][0];
    var x = A[b[0]][0][0][0];
    var w = A[b[0]][0][0][1];
    var v = A[b[0]][0][0][1];
    for (var s = 0; s < b.length; s++) {
        for (var o = 0; o < A[b[s]].length; o++) {
            for (iCoord = 0; iCoord < A[b[s]][o].length;
                 iCoord++) {
                y = Math.min(y, A[b[s]][o][iCoord][0]);
                x = Math.max(x, A[b[s]][o][iCoord][0]);
                w = Math.min(w, A[b[s]][o][iCoord][1]);
                v = Math.max(v, A[b[s]][o][iCoord][1])
            }
        }
    }
    var j = Math.min(((a - n) / (x - y)), ((g - n) / (v - w)));
    var m = (y + ((x - y) / 2));
    var l = (w + ((v - w) / 2));
    u = ((m * j) - (a / 2));
    t = ((l * j) - (g / 2));
    for (var r in A) {
        q(r, z)
    }
    for (var r in e.detail) {
        if (A[r]) {
            q(r, e.detail[r].color)
        }
    }
    function q(E, D) {
        f.fillStyle = D;
        f.strokeStyle = h;
        f.beginPath();
        p[E] = [];
        var C = (navigator.userAgent.indexOf("MSIE") > -1);
        for (var F = 0; F < A[E].length; F++) {
            p[E].push([]);
            f.moveTo((A[E][F][0][0] * j) - u, (A[E][F][0][1] * j) - t);
            for (iCoord = 1; iCoord < A[E][F].length; iCoord++) {
                var B = (A[E][F][iCoord][0] * j) - u;
                var G = (A[E][F][iCoord][1] * j) - t;
                p[E][F].push([B,G]);
                f.lineTo(B, G)
            }
            f.closePath();
            f.fill();
            if (C == true) {
                f.beginPath();
                f.moveTo((A[E][F][0][0] * j) - u, (A[E][F][0][1] * j) - t);
                for (iCoord = 1;
                     iCoord < A[E][F].length; iCoord++) {
                    f.lineTo((A[E][F][iCoord][0] * j) - u, (A[E][F][iCoord][1] * j) - t)
                }
                f.closePath()
            }
            f.stroke()
        }
        if (E == "za") {
            if (e.detail.ls) {
                f.fillStyle = e.detail.ls.color
            } else {
                f.fillStyle = z
            }
            f.beginPath();
            for (var F = 0; F < A.ls.length; F++) {
                f.moveTo((A.ls[F][0][0] * j) - u, (A.ls[F][0][1] * j) - t);
                for (iCoord = 1;
                     iCoord < A.ls[F].length; iCoord++) {
                    f.lineTo((A.ls[F][iCoord][0] * j) - u, (A.ls[F][iCoord][1] * j) - t)
                }
                f.closePath();
                f.fill();
                f.stroke()
            }
        }
    }

    return p
};
Ext.namespace("Autonomy.adopt.performance.chart");
Ext.ns("Explore.view.common");
Explore.view.common.MapPanel = Ext.extend(Ext.Panel, {mapTypes:{world:{coords:{ad:[
    [
        [4687,2398],
        [4679,2402],
        [4679,2398]
    ]
],ae:[
    [
        [5995,2942],
        [6059,2942],
        [6115,2890],
        [6119,2902],
        [6119,2922],
        [6107,2922],
        [6107,2946],
        [6099,2946],
        [6087,2986],
        [6023,2978]
    ]
],af:[
    [
        [6239,2782],
        [6263,2754],
        [6263,2738],
        [6239,2734],
        [6231,2686],
        [6251,2614],
        [6283,2626],
        [6367,2554],
        [6387,2562],
        [6419,2566],
        [6459,2566],
        [6499,2526],
        [6511,2530],
        [6511,2542],
        [6519,2542],
        [6515,2566],
        [6523,2582],
        [6555,2562],
        [6591,2558],
        [6607,2566],
        [6599,2570],
        [6583,2578],
        [6555,2574],
        [6523,2586],
        [6511,2598],
        [6523,2626],
        [6503,2646],
        [6507,2654],
        [6499,2662],
        [6475,2662],
        [6487,2682],
        [6467,2690],
        [6459,2722],
        [6447,2730],
        [6431,2726],
        [6399,2742],
        [6383,2750],
        [6383,2778],
        [6323,2794],
        [6279,2794]
    ]
],ag:[
    [
        [3015.38,3131.88],
        [3013.25,3136.25],
        [3020,3136.12]
    ],
    [
        [3014.62,3116.75],
        [3016.75,3122.25],
        [3018.5,3120.25]
    ]
],ai:[
    [
        [2983.25,3102],
        [2980.62,3105.88],
        [2986,3102.5]
    ],
    [
        [2984.62,3105.75],
        [2980.12,3108.5],
        [2984.75,3110]
    ]
],al:[
    [
        [5167,2398],
        [5183,2418],
        [5179,2442],
        [5191,2454],
        [5191,2462],
        [5171,2494],
        [5151,2470],
        [5155,2422],
        [5147,2422]
    ]
],am:[
    [
        [5823,2438],
        [5783,2442],
        [5787,2478],
        [5811,2486],
        [5843,2494],
        [5851,2514],
        [5859,2514],
        [5859,2490],
        [5839,2482],
        [5847,2470]
    ]
],an:[
    [
        [2822.83,3260.33],
        [2834.17,3268.58],
        [2831.67,3269.92]
    ],
    [
        [2843.92,3262],
        [2849.08,3265.83],
        [2846.42,3270.17]
    ]
],ao:[
    [
        [4955,3722],
        [4975,3702],
        [4983,3710],
        [4967,3722],
        [4967,3738],
        [4959,3738]
    ],
    [
        [4967,3746],
        [4979,3742],
        [5075,3742],
        [5099,3798],
        [5147,3798],
        [5151,3770],
        [5179,3770],
        [5179,3778],
        [5211,3778],
        [5223,3886],
        [5271,3878],
        [5271,3930],
        [5215,3930],
        [5215,4014],
        [5255,4058],
        [5187,4066],
        [5139,4062],
        [5123,4050],
        [5007,4050],
        [4983,4038],
        [4947,4046],
        [4947,4006],
        [4971,3942],
        [4999,3910],
        [5003,3878],
        [4979,3826],
        [4991,3814],
        [4963,3750]
    ]
],ar:[
    [
        [2875,4198],
        [2903,4170],
        [2911,4178],
        [2943,4182],
        [2951,4198],
        [2959,4178],
        [2995,4182],
        [3047,4226],
        [3127,4270],
        [3099,4322],
        [3175,4326],
        [3199,4306],
        [3207,4274],
        [3227,4274],
        [3227,4318],
        [3127,4406],
        [3103,4514],
        [3103,4534],
        [3139,4558],
        [3155,4602],
        [3127,4642],
        [3003,4662],
        [3003,4722],
        [2935,4722],
        [2943,4770],
        [2915,4854],
        [2867,4878],
        [2867,4910],
        [2911,4926],
        [2907,4958],
        [2863,4998],
        [2859,5022],
        [2827,5038],
        [2823,5058],
        [2843,5106],
        [2803,5094],
        [2751,5094],
        [2739,5046],
        [2719,5050],
        [2711,5002],
        [2763,4866],
        [2747,4766],
        [2763,4666],
        [2779,4650],
        [2799,4494],
        [2787,4434],
        [2839,4306],
        [2839,4250],
        [2871,4230]
    ]
],as:[
    [
        [9613,3964.17],
        [9607.5,3966.17],
        [9609.67,3968]
    ]
],at:[
    [
        [4895,2238],
        [4979,2238],
        [4975,2218],
        [5003,2198],
        [5027,2202],
        [5035,2186],
        [5087,2198],
        [5087,2230],
        [5067,2258],
        [5023,2274],
        [4999,2270],
        [4959,2254],
        [4915,2262],
        [4891,2250]
    ]
],au:[
    [
        [8331,4062],
        [8375,3874],
        [8423,3970],
        [8455,3986],
        [8483,4086],
        [8659,4274],
        [8671,4366],
        [8639,4474],
        [8583,4566],
        [8575,4622],
        [8483,4666],
        [8439,4642],
        [8411,4666],
        [8311,4622],
        [8291,4562],
        [8251,4518],
        [8207,4542],
        [8147,4458],
        [8071,4446],
        [7951,4466],
        [7887,4514],
        [7791,4514],
        [7735,4546],
        [7663,4518],
        [7679,4462],
        [7623,4306],
        [7639,4278],
        [7615,4230],
        [7707,4138],
        [7823,4110],
        [7867,4030],
        [7887,4046],
        [7975,3954],
        [8007,3986],
        [8043,3986],
        [8039,3966],
        [8083,3906],
        [8119,3910],
        [8131,3886],
        [8235,3918],
        [8199,3982]
    ],
    [
        [8439,4718],
        [8487,4734],
        [8535,4718],
        [8535,4762],
        [8499,4810],
        [8475,4806],
        [8439,4730]
    ]
],aw:[
    [
        [2799.58,3254.08],
        [2804.92,3259.75],
        [2800.08,3258.42]
    ]
],ax:[
    [
        [5167.55,1771.71],
        [5152.61,1777.71],
        [5171.63,1788.18]
    ]
],az:[
    [
        [5859,2418],
        [5855,2426],
        [5867,2438],
        [5863,2446],
        [5831,2434],
        [5823,2438],
        [5847,2470],
        [5839,2482],
        [5859,2490],
        [5859,2514],
        [5899,2490],
        [5923,2530],
        [5939,2474],
        [5959,2466],
        [5939,2458],
        [5915,2422],
        [5899,2442]
    ],
    [
        [5843,2494],
        [5811,2486],
        [5835,2510],
        [5851,2514]
    ]
],ba:[
    [
        [5143,2322],
        [5143,2370],
        [5123,2402],
        [5051,2326],
        [5055,2314]
    ]
],bb:[
    [
        [3073.33,3235.62],
        [3079.38,3240.04],
        [3074.21,3243.46]
    ]
],bd:[
    [
        [6979,3006],
        [6971,2938],
        [6951,2930],
        [6975,2910],
        [6955,2894],
        [6963,2878],
        [6995,2886],
        [6999,2910],
        [7067,2918],
        [7035,2954],
        [7043,2978],
        [7063,2954],
        [7071,3002],
        [7071,3022],
        [7059,3030],
        [7043,2982]
    ]
],be:[
    [
        [4707,2118],
        [4727,2106],
        [4771,2102],
        [4795,2114],
        [4787,2126],
        [4799,2126],
        [4807,2142],
        [4799,2150],
        [4791,2158],
        [4791,2170],
        [4783,2170]
    ]
],bf:[
    [
        [4663,3298],
        [4703,3274],
        [4645,3194],
        [4615,3194],
        [4587,3206],
        [4583,3214],
        [4563,3218],
        [4499,3278],
        [4495,3314],
        [4527,3334],
        [4547,3322],
        [4567,3342],
        [4567,3298],
        [4627,3298],
        [4635,3294],
        [4643,3294]
    ]
],bg:[
    [
        [5243,2438],
        [5239,2418],
        [5227,2406],
        [5243,2378],
        [5227,2358],
        [5235,2346],
        [5243,2358],
        [5315,2362],
        [5355,2350],
        [5391,2362],
        [5387,2374],
        [5359,2402],
        [5375,2418],
        [5331,2426],
        [5327,2438],
        [5303,2442],
        [5283,2430]
    ]
],bh:[
    [
        [5962.25,2884.67],
        [5970.12,2881.33],
        [5967.79,2894.33]
    ]
],bi:[
    [
        [5447,3650],
        [5451,3674],
        [5419,3706],
        [5407,3678],
        [5399,3662]
    ]
],bj:[
    [
        [4711,3418],
        [4711,3350],
        [4719,3350],
        [4739,3314],
        [4731,3286],
        [4735,3278],
        [4711,3258],
        [4703,3274],
        [4663,3298],
        [4659,3314],
        [4679,3326],
        [4687,3422]
    ]
],bn:[
    [
        [7663,3458],
        [7671,3474],
        [7655,3462],
        [7655,3478],
        [7651,3482],
        [7639,3470]
    ]
],bo:[
    [
        [2815,4050],
        [2827,4030],
        [2839,4018],
        [2819,3998],
        [2835,3918],
        [2815,3878],
        [2847,3878],
        [2887,3850],
        [2923,3842],
        [2931,3906],
        [3055,3954],
        [3059,4018],
        [3107,4018],
        [3107,4046],
        [3127,4070],
        [3115,4122],
        [3087,4102],
        [3019,4110],
        [2995,4182],
        [2959,4178],
        [2951,4198],
        [2943,4182],
        [2911,4178],
        [2903,4170],
        [2875,4198],
        [2855,4198]
    ]
],br:[
    [
        [3283,3478],
        [3247,3530],
        [3207,3526],
        [3155,3538],
        [3095,3554],
        [3071,3538],
        [3063,3454],
        [3047,3450],
        [3047,3458],
        [2987,3494],
        [2939,3478],
        [2959,3522],
        [2975,3526],
        [2907,3570],
        [2883,3558],
        [2867,3534],
        [2855,3542],
        [2803,3542],
        [2803,3558],
        [2819,3558],
        [2819,3570],
        [2799,3570],
        [2799,3594],
        [2819,3622],
        [2803,3698],
        [2779,3698],
        [2727,3722],
        [2719,3758],
        [2695,3786],
        [2747,3854],
        [2787,3838],
        [2787,3878],
        [2847,3878],
        [2887,3850],
        [2923,3842],
        [2931,3906],
        [3055,3954],
        [3059,4018],
        [3107,4018],
        [3107,4046],
        [3127,4070],
        [3115,4122],
        [3115,4178],
        [3175,4182],
        [3187,4230],
        [3215,4230],
        [3207,4274],
        [3227,4274],
        [3227,4318],
        [3127,4406],
        [3147,4402],
        [3243,4478],
        [3231,4494],
        [3235,4510],
        [3359,4358],
        [3363,4278],
        [3435,4222],
        [3539,4198],
        [3611,4054],
        [3623,3934],
        [3719,3818],
        [3723,3770],
        [3707,3722],
        [3663,3718],
        [3587,3662],
        [3491,3650],
        [3471,3662],
        [3455,3626],
        [3383,3602],
        [3355,3626],
        [3367,3594],
        [3323,3578],
        [3327,3542],
        [3315,3538]
    ]
],bs:[
    [
        [2587,2914],
        [2579,2930],
        [2591,2938],
        [2599,2930]
    ],
    [
        [2599,2938],
        [2591,2942],
        [2603,2954]
    ],
    [
        [2571,2874],
        [2595,2866],
        [2595,2870]
    ],
    [
        [2607,2866],
        [2619,2878],
        [2611,2890],
        [2615,2878]
    ]
],bt:[
    [
        [6971,2862],
        [6999,2870],
        [7059,2866],
        [7055,2850],
        [7047,2850],
        [7047,2842],
        [7003,2826]
    ]
],bw:[
    [
        [5299,4058],
        [5375,4162],
        [5411,4178],
        [5347,4222],
        [5311,4278],
        [5247,4266],
        [5211,4310],
        [5183,4310],
        [5179,4298],
        [5187,4290],
        [5163,4254],
        [5163,4174],
        [5191,4174],
        [5191,4074],
        [5251,4066],
        [5259,4078]
    ]
],by:[
    [
        [5379,1934],
        [5339,1954],
        [5311,2006],
        [5259,2018],
        [5267,2062],
        [5251,2078],
        [5259,2082],
        [5259,2098],
        [5303,2086],
        [5443,2106],
        [5455,2082],
        [5475,2082],
        [5467,2042],
        [5499,2034],
        [5451,1986],
        [5451,1954]
    ]
],bz:[
    [
        [2299,3114],
        [2319,3094],
        [2319,3146],
        [2303,3166],
        [2299,3166]
    ]
],ca:[
    [
        [3159,2102],
        [3083,2230],
        [3247,2250],
        [3227,2170],
        [3155,2162],
        [3187,2094]
    ],
    [
        [2583,1346],
        [2723,1446],
        [2739,1486],
        [2683,1534],
        [2703,1558],
        [2611,1570],
        [2591,1602],
        [2623,1614],
        [2691,1602],
        [2771,1666],
        [2907,1706],
        [2835,1638],
        [2931,1670],
        [2951,1642],
        [2859,1526],
        [2971,1582],
        [3027,1510],
        [2855,1422],
        [2883,1386],
        [2835,1322],
        [2603,1226],
        [2539,1246],
        [2495,1174],
        [2395,1206],
        [2395,1270],
        [2367,1226],
        [2407,1174],
        [2335,1174],
        [2275,1254],
        [2279,1294],
        [2339,1310],
        [2291,1310],
        [2339,1350],
        [2571,1362]
    ],
    [
        [2519,1178],
        [2555,1222],
        [2643,1218],
        [2595,1182]
    ],
    [
        [1899,1190],
        [1871,1222],
        [1895,1306],
        [1991,1362],
        [1959,1406],
        [1835,1386],
        [1667,1430],
        [1559,1358],
        [1695,1338],
        [1555,1330],
        [1527,1310],
        [1583,1286],
        [1515,1278],
        [1535,1234],
        [1623,1190],
        [1651,1226],
        [1667,1210],
        [1727,1238],
        [1731,1214],
        [1783,1234],
        [1803,1278],
        [1803,1198],
        [1855,1210],
        [1835,1182],
        [1871,1174]
    ],
    [
        [1611,1186],
        [1479,1254],
        [1471,1286],
        [1411,1314],
        [1335,1262],
        [1387,1170],
        [1363,1146],
        [1455,1134],
        [1551,1150]
    ],
    [
        [1587,970],
        [1415,1042],
        [1559,1038]
    ],
    [
        [1615,1030],
        [1559,1098],
        [1707,1142],
        [1859,1098],
        [1863,1054],
        [1799,1046],
        [1775,1006],
        [1743,1078]
    ],
    [
        [1871,870],
        [1979,890],
        [2027,954],
        [1907,930]
    ],
    [
        [1903,1022],
        [2075,1034],
        [2067,1106],
        [2015,1106]
    ],
    [
        [2135,1082],
        [2103,1106],
        [2167,1126],
        [2183,1094]
    ],
    [
        [2091,1002],
        [2259,1014],
        [2299,1074],
        [2535,1078],
        [2523,1130],
        [2279,1138],
        [2211,1090],
        [2187,1034],
        [2147,1042]
    ],
    [
        [2051,910],
        [2119,974],
        [2199,962]
    ],
    [
        [2627,1434],
        [2607,1466],
        [2643,1486],
        [2667,1446]
    ],
    [
        [1659,949.999],
        [1747,933.999],
        [1751,961.999],
        [1691,977.999]
    ],
    [
        [2883,2322],
        [2859,2294],
        [2859,2250],
        [2823,2238],
        [2759,2318],
        [2671,2318],
        [2643,2338],
        [2563,2354],
        [2543,2374],
        [2563,2374],
        [2567,2386],
        [2459,2414],
        [2459,2406],
        [2475,2382],
        [2491,2370],
        [2503,2318],
        [2539,2338],
        [2519,2290],
        [2427,2274],
        [2419,2266],
        [2411,2222],
        [2327,2186],
        [2283,2218],
        [2143,2186],
        [1415,2186],
        [1347,2146],
        [1395,2190],
        [1395,2206],
        [1335,2186],
        [1267,2126],
        [1283,2122],
        [1323,2134],
        [1207,2014],
        [1215,1986],
        [1227,1938],
        [1079,1798],
        [1031,1830],
        [935,1770],
        [935,1374],
        [1083,1410],
        [1239,1350],
        [1219,1374],
        [1291,1346],
        [1347,1386],
        [1367,1354],
        [1643,1430],
        [1611,1454],
        [1687,1462],
        [1751,1450],
        [1795,1474],
        [1807,1446],
        [1859,1426],
        [1787,1434],
        [1795,1422],
        [1859,1410],
        [1871,1430],
        [1955,1462],
        [2047,1454],
        [2047,1434],
        [2079,1426],
        [2031,1402],
        [2071,1358],
        [2127,1414],
        [2091,1426],
        [2119,1442],
        [2115,1478],
        [2135,1446],
        [2179,1422],
        [2155,1374],
        [2107,1342],
        [2139,1262],
        [2123,1178],
        [2175,1154],
        [2267,1166],
        [2223,1226],
        [2179,1222],
        [2167,1270],
        [2231,1346],
        [2207,1370],
        [2227,1386],
        [2271,1382],
        [2335,1438],
        [2347,1486],
        [2395,1418],
        [2395,1366],
        [2503,1394],
        [2479,1438],
        [2507,1474],
        [2435,1546],
        [2363,1518],
        [2355,1570],
        [2251,1646],
        [2159,1754],
        [2151,1826],
        [2191,1838],
        [2211,1898],
        [2259,1890],
        [2411,1970],
        [2479,1970],
        [2479,2054],
        [2535,2106],
        [2579,2070],
        [2543,1986],
        [2623,1938],
        [2611,1862],
        [2575,1834],
        [2615,1786],
        [2591,1686],
        [2735,1706],
        [2811,1754],
        [2827,1830],
        [2863,1854],
        [2911,1830],
        [2943,1762],
        [3059,1958],
        [3135,1990],
        [3179,2070],
        [3071,2142],
        [2891,2142],
        [2787,2242],
        [2899,2178],
        [2951,2186],
        [2939,2270],
        [3011,2294],
        [3047,2250],
        [3059,2290],
        [2919,2366],
        [2899,2338],
        [2947,2294]
    ],
    [
        [2387,1558],
        [2355,1638],
        [2407,1658],
        [2455,1618],
        [2511,1642],
        [2523,1630]
    ],
    [
        [1999,1174],
        [2083,1166],
        [2099,1270],
        [2043,1298],
        [1943,1222],
        [2011,1222]
    ],
    [
        [2339,982],
        [2287,1026],
        [2563,1034],
        [2563,990],
        [2687,898],
        [2659,870],
        [2783,838],
        [3031,682],
        [2691,622],
        [2475,658],
        [2459,694],
        [2411,666],
        [2223,730],
        [2383,798],
        [2531,790],
        [2359,814],
        [2443,894],
        [2367,894],
        [2339,942],
        [2403,962],
        [2327,962]
    ],
    [
        [2199,746],
        [2307,826],
        [2403,870],
        [2303,938],
        [2223,934],
        [2103,830]
    ]
],cd:[
    [
        [5407,3678],
        [5399,3662],
        [5399,3650],
        [5419,3622],
        [5419,3586],
        [5463,3530],
        [5447,3522],
        [5451,3494],
        [5359,3454],
        [5243,3458],
        [5231,3478],
        [5175,3470],
        [5155,3450],
        [5127,3474],
        [5127,3494],
        [5127,3506],
        [5103,3606],
        [5063,3646],
        [5063,3678],
        [5055,3690],
        [5027,3714],
        [5019,3714],
        [5019,3702],
        [4999,3706],
        [4991,3714],
        [4983,3710],
        [4967,3722],
        [4967,3738],
        [4959,3738],
        [4967,3746],
        [4979,3742],
        [5075,3742],
        [5099,3798],
        [5147,3798],
        [5151,3770],
        [5179,3770],
        [5179,3778],
        [5211,3778],
        [5223,3886],
        [5271,3878],
        [5279,3878],
        [5283,3890],
        [5303,3886],
        [5307,3894],
        [5347,3906],
        [5351,3894],
        [5407,3942],
        [5423,3942],
        [5423,3910],
        [5403,3914],
        [5383,3890],
        [5391,3870],
        [5387,3834],
        [5399,3814],
        [5443,3802],
        [5411,3750],
        [5403,3718]
    ]
],cf:[
    [
        [5127,3494],
        [5127,3474],
        [5155,3450],
        [5175,3470],
        [5231,3478],
        [5243,3458],
        [5359,3454],
        [5243,3298],
        [5127,3374],
        [5047,3386],
        [5019,3430],
        [5063,3530],
        [5075,3494]
    ]
],cg:[
    [
        [5063,3530],
        [5075,3494],
        [5127,3494],
        [5127,3506],
        [5103,3606],
        [5063,3646],
        [5063,3678],
        [5055,3690],
        [5027,3714],
        [5019,3714],
        [5019,3702],
        [4999,3706],
        [4991,3714],
        [4983,3710],
        [4975,3702],
        [4955,3722],
        [4931,3690],
        [4943,3678],
        [4951,3686],
        [4943,3650],
        [4967,3646],
        [4967,3638],
        [4975,3634],
        [4983,3650],
        [5011,3650],
        [5019,3602],
        [5003,3594],
        [5019,3554],
        [4987,3554],
        [4987,3530],
        [5023,3530],
        [5063,3546]
    ]
],ch:[
    [
        [4839,2238],
        [4823,2242],
        [4799,2282],
        [4819,2274],
        [4823,2290],
        [4847,2290],
        [4859,2274],
        [4875,2294],
        [4887,2274],
        [4907,2282],
        [4915,2262],
        [4891,2250],
        [4895,2238]
    ]
],ci:[
    [
        [4567,3454],
        [4555,3414],
        [4575,3370],
        [4567,3342],
        [4547,3322],
        [4527,3334],
        [4495,3314],
        [4479,3322],
        [4475,3310],
        [4455,3322],
        [4431,3318],
        [4419,3390],
        [4415,3414],
        [4443,3438],
        [4439,3474],
        [4491,3454],
        [4543,3450]
    ]
],cl:[
    [
        [2843,5106],
        [2803,5094],
        [2751,5094],
        [2739,5046],
        [2719,5050],
        [2711,5002],
        [2763,4866],
        [2747,4766],
        [2763,4666],
        [2779,4650],
        [2799,4494],
        [2787,4434],
        [2839,4306],
        [2839,4250],
        [2871,4230],
        [2875,4198],
        [2855,4198],
        [2815,4050],
        [2791,4074],
        [2799,4162],
        [2759,4406],
        [2763,4474],
        [2719,4606],
        [2703,4614],
        [2715,4678],
        [2699,4734],
        [2703,4750],
        [2695,4754],
        [2683,4802],
        [2703,4810],
        [2715,4750],
        [2731,4750],
        [2707,4854],
        [2699,4818],
        [2683,4834],
        [2679,4878],
        [2651,4914],
        [2687,4918],
        [2675,4950],
        [2655,4958],
        [2659,5050],
        [2671,5038],
        [2663,5078],
        [2691,5078],
        [2667,5086],
        [2715,5130],
        [2675,5118],
        [2739,5182],
        [2823,5210],
        [2927,5198],
        [2927,5190],
        [2899,5182],
        [2847,5142],
        [2831,5110],
        [2815,5110],
        [2791,5130],
        [2791,5142],
        [2819,5142],
        [2799,5154],
        [2803,5166],
        [2827,5182],
        [2795,5170],
        [2787,5150],
        [2775,5166],
        [2743,5150],
        [2771,5158],
        [2783,5122],
        [2819,5102]
    ]
],cm:[
    [
        [4895,3530],
        [5023,3530],
        [5063,3546],
        [5063,3530],
        [5019,3430],
        [5047,3386],
        [5007,3330],
        [5015,3322],
        [5047,3322],
        [5035,3294],
        [5039,3270],
        [5019,3242],
        [5011,3242],
        [5011,3262],
        [5019,3262],
        [5023,3282],
        [5007,3290],
        [4939,3418],
        [4915,3402],
        [4863,3462],
        [4903,3502]
    ]
],cn:[
    [
        [6947,2182],
        [6935,2186],
        [6891,2210],
        [6891,2250],
        [6819,2250],
        [6795,2314],
        [6747,2322],
        [6747,2410],
        [6691,2446],
        [6659,2450],
        [6643,2466],
        [6607,2466],
        [6583,2478],
        [6579,2494],
        [6575,2494],
        [6583,2522],
        [6603,2526],
        [6607,2566],
        [6635,2582],
        [6639,2606],
        [6683,2618],
        [6715,2650],
        [6707,2658],
        [6731,2698],
        [6715,2710],
        [6707,2702],
        [6699,2706],
        [6711,2738],
        [6767,2770],
        [6795,2770],
        [6895,2830],
        [6955,2838],
        [6971,2830],
        [6971,2862],
        [7003,2826],
        [7047,2842],
        [7075,2834],
        [7127,2798],
        [7147,2802],
        [7163,2794],
        [7195,2826],
        [7207,2818],
        [7231,2846],
        [7231,2894],
        [7203,2926],
        [7203,2946],
        [7235,2942],
        [7239,2970],
        [7255,2974],
        [7243,2998],
        [7267,3002],
        [7271,3018],
        [7295,3014],
        [7299,3022],
        [7311,3026],
        [7307,2994],
        [7311,2990],
        [7323,2990],
        [7331,2982],
        [7347,2990],
        [7407,2966],
        [7443,2982],
        [7443,3002],
        [7475,3018],
        [7491,3010],
        [7527,3018],
        [7519,3030],
        [7531,3050],
        [7543,3042],
        [7535,3030],
        [7623,2994],
        [7623,2978],
        [7631,2986],
        [7643,2986],
        [7707,2966],
        [7779,2894],
        [7847,2782],
        [7811,2770],
        [7843,2750],
        [7835,2718],
        [7819,2702],
        [7799,2650],
        [7771,2634],
        [7843,2570],
        [7855,2574],
        [7859,2558],
        [7847,2554],
        [7835,2558],
        [7815,2542],
        [7779,2566],
        [7763,2554],
        [7763,2534],
        [7735,2534],
        [7735,2506],
        [7763,2506],
        [7771,2498],
        [7823,2450],
        [7851,2462],
        [7831,2490],
        [7835,2506],
        [7823,2514],
        [7823,2518],
        [7887,2482],
        [7907,2482],
        [7975,2422],
        [8003,2438],
        [8007,2418],
        [8047,2402],
        [8055,2386],
        [8071,2406],
        [8071,2390],
        [8083,2386],
        [8083,2326],
        [8103,2310],
        [8135,2322],
        [8179,2214],
        [8079,2234],
        [8051,2178],
        [7991,2162],
        [7947,2058],
        [7879,2030],
        [7815,2038],
        [7791,2058],
        [7791,2066],
        [7811,2066],
        [7811,2086],
        [7735,2170],
        [7703,2158],
        [7675,2218],
        [7683,2234],
        [7755,2222],
        [7791,2258],
        [7783,2270],
        [7723,2270],
        [7627,2326],
        [7583,2318],
        [7567,2342],
        [7579,2362],
        [7515,2402],
        [7455,2406],
        [7399,2430],
        [7287,2394],
        [7175,2394],
        [7139,2342],
        [7087,2322],
        [7027,2314],
        [7019,2302],
        [7031,2286],
        [7007,2226],
        [6951,2202]
    ],
    [
        [7545,3053.5],
        [7510,3059.5],
        [7493,3075.75],
        [7495,3096.5],
        [7518.25,3106],
        [7541.5,3090.25],
        [7555,3063.5]
    ]
],co:[
    [
        [2595,3398],
        [2611,3378],
        [2607,3358],
        [2623,3366],
        [2671,3294],
        [2715,3290],
        [2759,3258],
        [2771,3270],
        [2751,3282],
        [2711,3346],
        [2759,3402],
        [2799,3402],
        [2815,3426],
        [2867,3422],
        [2855,3470],
        [2871,3498],
        [2859,3510],
        [2875,3526],
        [2883,3558],
        [2867,3534],
        [2855,3542],
        [2803,3542],
        [2803,3558],
        [2819,3558],
        [2819,3570],
        [2799,3570],
        [2799,3594],
        [2819,3622],
        [2803,3698],
        [2783,3686],
        [2799,3658],
        [2755,3646],
        [2719,3650],
        [2703,3618],
        [2663,3590],
        [2571,3550],
        [2611,3490],
        [2603,3478],
        [2607,3410]
    ]
],cr:[
    [
        [2443,3302],
        [2435,3306],
        [2411,3294],
        [2391,3290],
        [2387,3294],
        [2383,3318],
        [2403,3334],
        [2415,3330],
        [2459,3370],
        [2467,3334]
    ]
],cu:[
    [
        [2423,2990],
        [2479,2966],
        [2575,2986],
        [2691,3050],
        [2599,3058],
        [2611,3038],
        [2483,2982],
        [2419,3006]
    ],
    [
        [2459,3002],
        [2455,3014],
        [2471,3014]
    ]
],cy:[
    [
        [5547.67,2608.5],
        [5524.5,2618.5],
        [5504.17,2617.33],
        [5500.67,2625.5],
        [5488.33,2627.33],
        [5505.5,2642.5],
        [5532.33,2628.67],
        [5531.33,2620.33]
    ]
],cz:[
    [
        [5135,2170],
        [5087,2198],
        [5035,2186],
        [5027,2202],
        [5003,2198],
        [4963,2146],
        [5031,2122],
        [5127,2158]
    ]
],de:[
    [
        [4823,2038],
        [4827,2026],
        [4871,2018],
        [4867,1982],
        [4891,1982],
        [4907,1998],
        [4931,1998],
        [4927,2014],
        [4983,1998],
        [5011,2018],
        [5019,2046],
        [5011,2054],
        [5023,2066],
        [5031,2122],
        [4963,2146],
        [5003,2198],
        [4975,2218],
        [4979,2238],
        [4839,2238],
        [4855,2190],
        [4807,2174],
        [4811,2162],
        [4799,2150],
        [4807,2142],
        [4799,2126],
        [4787,2126],
        [4803,2102],
        [4795,2090],
        [4819,2086],
        [4827,2042]
    ]
],dj:[
    [
        [5771,3254],
        [5751,3258],
        [5739,3278],
        [5739,3298],
        [5767,3298],
        [5775,3286],
        [5763,3282],
        [5779,3270]
    ]
],dk:[
    [
        [4867,1982],
        [4891,1982],
        [4895,1958],
        [4915,1978],
        [4923,1962],
        [4907,1954],
        [4899,1958],
        [4899,1954],
        [4927,1922],
        [4911,1918],
        [4915,1874],
        [4887,1898],
        [4867,1898],
        [4851,1922],
        [4851,1958],
        [4867,1962]
    ],
    [
        [4967,1938],
        [4951,1942],
        [4951,1950],
        [4943,1942],
        [4931,1954],
        [4935,1970],
        [4959,1978],
        [4959,1970],
        [4967,1966],
        [4959,1958],
        [4971,1954]
    ]
],dk:[
    [
        [4867,1982],
        [4891,1982],
        [4895,1958],
        [4915,1978],
        [4923,1962],
        [4907,1954],
        [4899,1958],
        [4899,1954],
        [4927,1922],
        [4911,1918],
        [4915,1874],
        [4887,1898],
        [4867,1898],
        [4851,1922],
        [4851,1958],
        [4867,1962]
    ],
    [
        [4967,1938],
        [4951,1942],
        [4951,1950],
        [4943,1942],
        [4931,1954],
        [4935,1970],
        [4959,1978],
        [4959,1970],
        [4967,1966],
        [4959,1958],
        [4971,1954]
    ],
    [
        [4931,1978],
        [4927,1986],
        [4943,1994],
        [4955,1990],
        [4963,1978],
        [4947,1978],
        [4943,1982]
    ]
],dm:[
    [
        [3024.5,3173.5],
        [3030.62,3177.12],
        [3030.38,3184.25],
        [3027.62,3185.25]
    ]
],"do":[
    [
        [2755,3062],
        [2755,3106],
        [2763,3118],
        [2787,3098],
        [2839,3102],
        [2847,3094],
        [2779,3058]
    ]
],dz:[
    [
        [4863,2574],
        [4859,2626],
        [4835,2666],
        [4879,2718],
        [4887,2770],
        [4887,2886],
        [4955,2958],
        [4831,3034],
        [4795,3074],
        [4751,3082],
        [4723,3082],
        [4667,3026],
        [4506.85,2917.81],
        [4411,2854],
        [4411,2842],
        [4411,2814],
        [4539,2742],
        [4539,2726],
        [4607,2714],
        [4583,2630],
        [4719,2574]
    ]
],ec:[
    [
        [2663,3590],
        [2571,3550],
        [2515,3614],
        [2515,3646],
        [2543,3666],
        [2531,3678],
        [2527,3706],
        [2551,3706],
        [2563,3722],
        [2591,3666],
        [2627,3654],
        [2663,3614]
    ]
],ee:[
    [
        [5231,1826],
        [5219,1830],
        [5231,1838],
        [5215,1846],
        [5219,1870],
        [5251,1842],
        [5235,1838],
        [5243,1830]
    ],
    [
        [5279,1870],
        [5303,1862],
        [5335,1882],
        [5347,1878],
        [5355,1882],
        [5367,1870],
        [5359,1834],
        [5375,1810],
        [5315,1802],
        [5255,1818],
        [5263,1854],
        [5283,1854]
    ]
],eg:[
    [
        [5539,2738],
        [5559,2790],
        [5539,2838],
        [5491,2778],
        [5575,2970],
        [5531,3010],
        [5511,3002],
        [5299,3002],
        [5299,2730],
        [5318.47,2729.77],
        [5403,2754],
        [5455,2734],
        [5507,2746]
    ]
],eh:[
    [
        [4411,2854],
        [4411,2842],
        [4295,2842],
        [4279,2874],
        [4259,2886],
        [4247,2926],
        [4195,3006],
        [4195,3022],
        [4295,3022],
        [4295,2974],
        [4323,2962],
        [4323,2890],
        [4411,2890]
    ]
],er:[
    [
        [5651,3110],
        [5611,3138],
        [5599,3210],
        [5627,3214],
        [5635,3194],
        [5651,3206],
        [5695,3206],
        [5751,3258],
        [5771,3254],
        [5719,3198],
        [5695,3190],
        [5687,3178],
        [5683,3182],
        [5671,3162],
        [5659,3122]
    ]
],es:[
    [
        [4719,2402],
        [4723,2422],
        [4655,2462],
        [4631,2498],
        [4580.09,2579.73],
        [4499,2594],
        [4495,2598],
        [4459,2566],
        [4443,2566],
        [4447,2494],
        [4475,2430],
        [4407,2414],
        [4395,2386],
        [4435,2358],
        [4595,2374],
        [4679,2398],
        [4679,2402],
        [4687,2398]
    ],
    [
        [4721.33,2478.5],
        [4730.83,2486],
        [4720.67,2501.67],
        [4700.17,2490.17]
    ],
    [
        [4739.67,2477.67],
        [4748.33,2474.5],
        [4752.83,2483.67]
    ],
    [
        [4671.33,2510],
        [4679.67,2504],
        [4682.33,2507],
        [4675.33,2513.17]
    ]
],et:[
    [
        [5583,3466],
        [5579,3446],
        [5507,3382],
        [5511,3366],
        [5531,3366],
        [5543,3302],
        [5555,3306],
        [5599,3210],
        [5627,3214],
        [5635,3194],
        [5651,3206],
        [5695,3206],
        [5751,3258],
        [5739,3278],
        [5739,3298],
        [5767,3298],
        [5759,3306],
        [5791,3346],
        [5871,3378],
        [5899,3378],
        [5823,3458],
        [5795,3458],
        [5739,3482],
        [5719,3482],
        [5711,3474],
        [5679,3498],
        [5639,3494],
        [5607,3470]
    ]
],fi:[
    [
        [5271,1550],
        [5259,1454],
        [5183,1406],
        [5199,1390],
        [5239,1422],
        [5271,1414],
        [5295,1426],
        [5335,1362],
        [5371,1358],
        [5403,1374],
        [5411,1382],
        [5399,1402],
        [5383,1414],
        [5395,1414],
        [5387,1426],
        [5395,1446],
        [5427,1466],
        [5403,1498],
        [5431,1554],
        [5423,1558],
        [5419,1582],
        [5443,1622],
        [5427,1638],
        [5471,1670],
        [5459,1690],
        [5371,1766],
        [5247,1794],
        [5199,1766],
        [5207,1726],
        [5195,1678],
        [5287,1590],
        [5307,1586],
        [5303,1562]
    ]
],fj:[
    [
        [9318.16,4045.3],
        [9292.48,4064.04],
        [9317.84,4074.22],
        [9334.15,4066.62]
    ],
    [
        [9327.69,4032.22],
        [9334.48,4038.84],
        [9373.56,4033.68],
        [9362.26,4015.58]
    ]
],fr:[
    [
        [4595,2374],
        [4679,2398],
        [4687,2398],
        [4719,2402],
        [4723,2378],
        [4751,2370],
        [4803,2382],
        [4824.67,2368.45],
        [4835,2362],
        [4839,2346],
        [4819,2342],
        [4823,2330],
        [4815,2318],
        [4827,2306],
        [4819,2274],
        [4799,2282],
        [4823,2242],
        [4839,2238],
        [4855,2190],
        [4807,2174],
        [4791,2170],
        [4783,2170],
        [4707,2118],
        [4679,2126],
        [4679,2150],
        [4635,2178],
        [4611,2174],
        [4607,2166],
        [4591,2166],
        [4599,2202],
        [4567,2202],
        [4555,2194],
        [4515,2202],
        [4527,2230],
        [4575,2238],
        [4611,2302],
        [4607,2342]
    ],
    [
        [4887.88,2382.5],
        [4890.5,2411.62],
        [4881.12,2434.38],
        [4866,2418],
        [4866.62,2399.88],
        [4883.5,2392.12]
    ]
],fk:[
    [
        [3119,5070],
        [3047,5070],
        [3051,5090],
        [3035,5090],
        [3047,5102],
        [3083,5074],
        [3067,5106],
        [3123,5082]
    ]
],ga:[
    [
        [4931,3690],
        [4943,3678],
        [4951,3686],
        [4943,3650],
        [4967,3646],
        [4967,3638],
        [4975,3634],
        [4983,3650],
        [5011,3650],
        [5019,3602],
        [5003,3594],
        [5019,3554],
        [4987,3554],
        [4987,3530],
        [4939,3530],
        [4939,3562],
        [4891,3562],
        [4887,3586],
        [4871,3610],
        [4883,3638]
    ]
],gb:[
    [
        [4647,2130],
        [4675,2114],
        [4675,2106],
        [4653,2106],
        [4683,2082],
        [4687,2062],
        [4671,2050],
        [4651,2050],
        [4647,2058],
        [4639,2054],
        [4647,2046],
        [4627,1998],
        [4607,1990],
        [4595,1954],
        [4559,1938],
        [4591,1878],
        [4535,1878],
        [4559,1842],
        [4507,1842],
        [4483,1886],
        [4475,1930],
        [4515,1958],
        [4507,1986],
        [4547,1982],
        [4563,2038],
        [4531,2038],
        [4523,2034],
        [4519,2038],
        [4523,2046],
        [4515,2058],
        [4531,2054],
        [4531,2078],
        [4503,2086],
        [4507,2098],
        [4555,2106],
        [4571.17,2096.17],
        [4559,2110],
        [4527,2114],
        [4495,2150],
        [4503,2154],
        [4515,2142],
        [4531,2142],
        [4543,2146],
        [4551,2134],
        [4567,2130],
        [4607,2134],
        [4619,2126]
    ],
    [
        [4451,1974],
        [4427,1998],
        [4447,2010],
        [4455,1998],
        [4475,2014],
        [4499,1998],
        [4479,1966]
    ]
],gd:[
    [
        [3018.62,3264.12],
        [3022.5,3267.5],
        [3016.38,3271.12]
    ]
],ge:[
    [
        [5731,2430],
        [5759,2430],
        [5783,2442],
        [5823,2438],
        [5831,2434],
        [5863,2446],
        [5867,2438],
        [5855,2426],
        [5859,2418],
        [5839,2410],
        [5843,2402],
        [5695,2366],
        [5691,2374],
        [5727,2394],
        [5735,2426]
    ]
],gf:[
    [
        [3223,3434],
        [3207,3458],
        [3223,3494],
        [3207,3526],
        [3247,3530],
        [3283,3478],
        [3255,3450]
    ]
],gh:[
    [
        [4671,3426],
        [4655,3410],
        [4651,3318],
        [4635,3305.33],
        [4643,3294],
        [4635,3293.67],
        [4627,3298],
        [4567,3298],
        [4567,3342],
        [4575,3370],
        [4555,3414],
        [4567,3454],
        [4587,3462]
    ]
],gi:[
    [
        [4499,2594],
        [4500.58,2596.42],
        [4498.31,2596.91]
    ]
],gl:[
    [
        [2875,806],
        [2935,834],
        [2727,930],
        [2851,986],
        [2775,998],
        [2859,1062],
        [3007,1042],
        [3152.73,1129.71],
        [3194.33,1212],
        [3184.33,1289.33],
        [3242.67,1270.33],
        [3303,1330],
        [3207.19,1321.19],
        [3231,1390],
        [3307,1370],
        [3227,1470],
        [3351,1730],
        [3491,1786],
        [3591,1574],
        [3711,1538],
        [3791,1434],
        [4051,1358],
        [4047,1202],
        [4135,1138],
        [4115,878],
        [4323,730],
        [4195,706],
        [4047,746],
        [4063,674],
        [3767,590],
        [3351,646],
        [3387,694],
        [3275,662],
        [3287,698],
        [3179,682],
        [3011,722],
        [3015,762],
        [2975,758]
    ]
],gm:[
    [
        [4199,3242],
        [4243,3230],
        [4267,3238],
        [4279,3234],
        [4247,3222],
        [4203,3230]
    ]
],gn:[
    [
        [4291,3350],
        [4315,3326],
        [4347,3326],
        [4363,3358],
        [4359,3366],
        [4371,3362],
        [4387,3366],
        [4391,3390],
        [4403,3398],
        [4411,3386],
        [4419,3390],
        [4431,3318],
        [4395,3266],
        [4343,3274],
        [4339,3258],
        [4279,3254],
        [4279,3278],
        [4251,3286],
        [4247,3298]
    ]
],gp:[
    [
        [3016.75,3154.25],
        [3022.88,3155.25],
        [3025.5,3149.5],
        [3032.62,3157.38],
        [3022.88,3159.5],
        [3018.5,3165.62]
    ]
],gq:[
    [
        [4891,3562],
        [4939,3562],
        [4939,3530],
        [4895,3530],
        [4887,3558]
    ],
    [
        [4875,3490],
        [4867,3502],
        [4859,3498],
        [4867,3490]
    ]
],gr:[
    [
        [5171,2494],
        [5191,2462],
        [5191,2454],
        [5243,2438],
        [5283,2430],
        [5303,2442],
        [5327,2438],
        [5331,2426],
        [5327,2458],
        [5299,2450],
        [5263,2458],
        [5271,2470],
        [5251,2474],
        [5239,2466],
        [5231,2478],
        [5283,2538],
        [5271,2538],
        [5271,2554],
        [5259,2542],
        [5247,2546],
        [5259,2558],
        [5247,2562],
        [5235,2554],
        [5247,2590],
        [5235,2578],
        [5231,2590],
        [5219,2570],
        [5215,2578],
        [5207,2566],
        [5211,2562],
        [5195,2542],
        [5211,2530],
        [5243,2542],
        [5247,2538],
        [5215,2530],
        [5195,2530]
    ],
    [
        [5259,2614],
        [5259,2622],
        [5295.2,2630.39],
        [5331,2630],
        [5331,2622]
    ]
],gt:[
    [
        [2303,3166],
        [2299,3166],
        [2299,3114],
        [2251,3114],
        [2251,3130],
        [2239,3130],
        [2263,3162],
        [2231,3162],
        [2215,3202],
        [2243,3218],
        [2271,3222],
        [2291,3206],
        [2323,3170]
    ]
],gw:[
    [
        [4247,3298],
        [4251,3286],
        [4279,3278],
        [4279,3254],
        [4239,3254],
        [4199,3262],
        [4223,3278],
        [4235,3278],
        [4231,3286]
    ]
],gy:[
    [
        [3071,3366],
        [3043,3390],
        [3055,3402],
        [3027,3430],
        [3047,3450],
        [3063,3454],
        [3071,3538],
        [3095,3554],
        [3155,3538],
        [3115,3478],
        [3139,3434]
    ]
],hk:[
    [
        [7631,2986],
        [7643,2986],
        [7639,2994]
    ]
],hm:[
    [
        [6563,5126],
        [6579,5130],
        [6567,5134]
    ]
],hn:[
    [
        [2291,3206],
        [2335,3222],
        [2331,3238],
        [2347,3246],
        [2411,3194],
        [2455,3190],
        [2423,3166],
        [2323,3170]
    ]
],hr:[
    [
        [5135,2294],
        [5107,2294],
        [5071,2270],
        [5051,2286],
        [5043,2306],
        [4999,2306],
        [5003,2326],
        [5123,2402],
        [5051,2326],
        [5055,2314],
        [5143,2322]
    ]
],ht:[
    [
        [2755,3062],
        [2755,3106],
        [2687,3102],
        [2687,3094],
        [2739,3094],
        [2731,3074],
        [2711,3066],
        [2727,3058]
    ]
],hu:[
    [
        [5223,2210],
        [5239,2222],
        [5223,2230],
        [5195,2282],
        [5151,2282],
        [5135,2294],
        [5107,2294],
        [5071,2270],
        [5067,2258],
        [5087,2230],
        [5087,2222],
        [5103,2230],
        [5135,2226],
        [5135,2222],
        [5179,2206]
    ]
],id:[
    [
        [7139,3442],
        [7199,3454],
        [7219,3482],
        [7363,3582],
        [7355,3606],
        [7383,3618],
        [7395,3650],
        [7415,3654],
        [7423,3670],
        [7415,3742],
        [7375,3734],
        [7323,3694],
        [7259,3590],
        [7243,3582],
        [7235,3546],
        [7183,3494],
        [7171,3490]
    ],
    [
        [7399,3642],
        [7419,3630],
        [7431,3654],
        [7443,3658],
        [7439,3674],
        [7423,3662],
        [7419,3646]
    ],
    [
        [7467,3658],
        [7463,3674],
        [7479,3674],
        [7483,3662]
    ],
    [
        [7423,3746],
        [7407,3770],
        [7435,3774],
        [7431,3782],
        [7647,3822],
        [7643,3798],
        [7607,3790],
        [7599,3778],
        [7635,3774],
        [7551,3762],
        [7539,3770],
        [7491,3766],
        [7483,3750]
    ],
    [
        [7735,3482],
        [7679,3478],
        [7647,3550],
        [7623,3558],
        [7591,3550],
        [7583,3562],
        [7543,3566],
        [7519,3538],
        [7499,3562],
        [7515,3622],
        [7523,3618],
        [7535,3666],
        [7575,3666],
        [7575,3682],
        [7647,3682],
        [7647,3698],
        [7687,3686],
        [7735,3562],
        [7763,3562],
        [7723,3506]
    ],
    [
        [7919,3542],
        [7931,3550],
        [7907,3578],
        [7803,3578],
        [7791,3606],
        [7819,3626],
        [7831,3610],
        [7879,3606],
        [7831,3646],
        [7875,3710],
        [7867,3738],
        [7855,3726],
        [7863,3706],
        [7839,3718],
        [7831,3714],
        [7819,3662],
        [7795,3670],
        [7807,3738],
        [7775,3734],
        [7779,3682],
        [7759,3678],
        [7795,3570],
        [7819,3558],
        [7899,3570]
    ],
    [
        [7647,3806],
        [7667,3802],
        [7679,3810],
        [7667,3822]
    ],
    [
        [7691,3806],
        [7703,3810],
        [7695,3822],
        [7683,3818]
    ],
    [
        [7711,3810],
        [7707,3830],
        [7747,3818]
    ],
    [
        [7731,3802],
        [7763,3806],
        [7767,3818],
        [7751,3822]
    ],
    [
        [7783,3818],
        [7803,3806],
        [7851,3818],
        [7923,3802],
        [7927,3810],
        [7835,3822]
    ],
    [
        [7919,3826],
        [7923,3838],
        [7887,3866],
        [7879,3858],
        [7891,3838]
    ],
    [
        [7803,3862],
        [7811,3854],
        [7787,3834],
        [7763,3838]
    ],
    [
        [7951,3674],
        [7975,3670],
        [7983,3686],
        [7971,3690]
    ],
    [
        [8003,3666],
        [8059,3666],
        [8079,3690],
        [8023,3674],
        [8011,3682]
    ],
    [
        [8015,3522],
        [8007,3528.86],
        [7987,3546],
        [7995,3598],
        [8011,3614],
        [7999,3586],
        [7999,3574],
        [8019,3582],
        [8019,3578],
        [8003,3570],
        [8019,3558],
        [8019,3546],
        [7995,3570],
        [7995,3562],
        [8003,3546],
        [7999,3542]
    ],
    [
        [7991,3626],
        [7987,3634],
        [8003,3634]
    ],
    [
        [7907,3634],
        [7959,3638],
        [7907,3642]
    ],
    [
        [8079,3622],
        [8119,3598],
        [8159,3606],
        [8171,3658],
        [8183,3674],
        [8199,3678],
        [8259,3630],
        [8343,3658],
        [8343,3826],
        [8311,3802],
        [8255,3810],
        [8267,3786],
        [8287,3782],
        [8263,3730],
        [8147,3682],
        [8139,3698],
        [8111,3662],
        [8155,3650],
        [8111,3646],
        [8103,3630]
    ],
    [
        [8171,3734],
        [8163,3754],
        [8163,3766],
        [8179,3754]
    ],
    [
        [8095,3778],
        [8083,3794],
        [8083,3802],
        [8095,3786]
    ]
],ie:[
    [
        [4475,2014],
        [4455,1998],
        [4447,2010],
        [4427,1998],
        [4451,1974],
        [4455,1966],
        [4423,1970],
        [4407,1990],
        [4419,1994],
        [4411,2002],
        [4375,2002],
        [4375,2034],
        [4395,2046],
        [4367,2078],
        [4383,2102],
        [4471,2078],
        [4483,2050]
    ]
],il:[
    [
        [5563,2686],
        [5575,2682],
        [5575,2698],
        [5571,2746],
        [5559,2790],
        [5539,2738],
        [5551,2722]
    ]
],"in":[
    [
        [6431,2950],
        [6507,2934],
        [6495,2898],
        [6487,2898],
        [6483,2874],
        [6471,2874],
        [6467,2862],
        [6491,2834],
        [6499,2842],
        [6527,2834],
        [6599,2746],
        [6599,2726],
        [6619,2710],
        [6603,2706],
        [6579,2650],
        [6591,2638],
        [6631,2646],
        [6683,2618],
        [6715,2650],
        [6707,2658],
        [6731,2698],
        [6715,2710],
        [6707,2702],
        [6699,2706],
        [6711,2738],
        [6767,2770],
        [6739,2806],
        [6827,2854],
        [6847,2850],
        [6863,2854],
        [6863,2862],
        [6883,2870],
        [6951,2878],
        [6955,2838],
        [6971,2830],
        [6971,2862],
        [6999,2870],
        [7059,2866],
        [7055,2850],
        [7047,2850],
        [7047,2842],
        [7075,2834],
        [7127,2798],
        [7147,2802],
        [7163,2794],
        [7195,2826],
        [7195,2838],
        [7183,2850],
        [7191,2862],
        [7175,2854],
        [7139,2874],
        [7111,2950],
        [7091,2946],
        [7087,2994],
        [7071,3002],
        [7063,2954],
        [7043,2978],
        [7035,2954],
        [7067,2918],
        [6999,2910],
        [6995,2886],
        [6963,2878],
        [6955,2894],
        [6975,2910],
        [6951,2930],
        [6971,2938],
        [6979,3006],
        [6927,3014],
        [6923,3038],
        [6743,3182],
        [6751,3238],
        [6735,3282],
        [6735,3318],
        [6723,3318],
        [6715,3342],
        [6695,3350],
        [6691,3370],
        [6675,3378],
        [6651,3354],
        [6643,3326],
        [6571,3166],
        [6547,3062],
        [6555,3042],
        [6543,2998],
        [6531,3026],
        [6499,3038],
        [6451,2994],
        [6483,2986],
        [6483,2978],
        [6467,2982]
    ]
],iq:[
    [
        [5815,2566],
        [5755,2566],
        [5735,2586],
        [5727,2586],
        [5715,2650],
        [5659,2678],
        [5671,2714],
        [5743,2742],
        [5815,2802],
        [5863,2802],
        [5879,2778],
        [5911,2778],
        [5895,2726],
        [5835,2658],
        [5851,2606],
        [5831,2602]
    ]
],ir:[
    [
        [5911,2778],
        [5895,2726],
        [5835,2658],
        [5851,2606],
        [5831,2602],
        [5815,2566],
        [5799,2498],
        [5811,2486],
        [5835,2510],
        [5851,2514],
        [5859,2514],
        [5899,2490],
        [5923,2530],
        [5931,2554],
        [6003,2586],
        [6059,2574],
        [6055,2562],
        [6123,2530],
        [6247,2582],
        [6251,2614],
        [6231,2686],
        [6239,2734],
        [6263,2738],
        [6263,2754],
        [6239,2782],
        [6299,2854],
        [6299,2874],
        [6263,2882],
        [6255,2914],
        [6143,2898],
        [6131,2858],
        [6075,2874],
        [5995,2838],
        [5951,2770]
    ]
],is:[
    [
        [4019,1586],
        [4067,1614],
        [4047,1634],
        [4147,1654],
        [4283,1582],
        [4215,1518],
        [4107,1534],
        [4083,1566],
        [4043,1518],
        [3999,1562],
        [4059,1566]
    ]
],it:[
    [
        [4835,2362],
        [4871,2338],
        [4983,2442],
        [5051,2478],
        [5067,2514],
        [5051,2534],
        [5059,2546],
        [5091,2502],
        [5075,2486],
        [5091,2466],
        [5119,2486],
        [5127,2474],
        [5075,2442],
        [5059,2430],
        [5063,2418],
        [5035,2418],
        [4995,2366],
        [4963,2346],
        [4963,2306],
        [4995,2294],
        [4999,2270],
        [4959,2254],
        [4915,2262],
        [4907,2282],
        [4887,2274],
        [4875,2294],
        [4859,2274],
        [4847,2290],
        [4823,2290],
        [4827,2306],
        [4815,2318],
        [4823,2330],
        [4819,2342],
        [4839,2346]
    ],
    [
        [5047,2534],
        [5035,2578],
        [4963,2546]
    ],
    [
        [4887,2442],
        [4899,2466],
        [4891,2506],
        [4859,2506],
        [4855,2454]
    ]
],jm:[
    [
        [2579,3102],
        [2607,3094],
        [2639,3110],
        [2611,3118]
    ]
],jo:[
    [
        [5659,2678],
        [5607,2710],
        [5575,2698],
        [5571,2746],
        [5559,2790],
        [5559,2798],
        [5587,2802],
        [5639,2762],
        [5611,2734],
        [5671,2714]
    ]
],jp:[
    [
        [8359,2310],
        [8351,2378],
        [8311,2394],
        [8319,2430],
        [8339,2422],
        [8327,2402],
        [8367,2394],
        [8399,2414],
        [8463,2374],
        [8455,2342],
        [8427,2354],
        [8367,2302]
    ],
    [
        [8159,2650],
        [8179,2662],
        [8163,2682],
        [8147,2674],
        [8131,2698],
        [8115,2678],
        [8131,2658],
        [8139,2666],
        [8147,2662],
        [8151,2654]
    ],
    [
        [8079,2662],
        [8111,2690],
        [8087,2738],
        [8075,2750],
        [8059,2738],
        [8067,2698],
        [8039,2682]
    ],
    [
        [8327,2438],
        [8339,2434],
        [8375,2498],
        [8343,2542],
        [8335,2606],
        [8223,2650],
        [8207,2678],
        [8183,2654],
        [8195,2638],
        [8119,2654],
        [8111,2662],
        [8079,2658],
        [8083,2646],
        [8127,2614],
        [8191,2610],
        [8207,2618],
        [8215,2610],
        [8211,2598],
        [8239,2566],
        [8247,2578],
        [8299,2534],
        [8319,2482],
        [8315,2458]
    ]
],ke:[
    [
        [5531,3478],
        [5543,3466],
        [5583,3466],
        [5607,3470],
        [5639,3494],
        [5679,3498],
        [5711,3474],
        [5719,3482],
        [5739,3482],
        [5715,3514],
        [5715,3610],
        [5731,3630],
        [5707,3654],
        [5695,3658],
        [5695,3674],
        [5671,3710],
        [5627,3678],
        [5631,3670],
        [5535,3614],
        [5531,3582],
        [5563,3534]
    ]
],kg:[
    [
        [6575,2494],
        [6499,2498],
        [6463,2494],
        [6459,2486],
        [6479,2474],
        [6495,2482],
        [6503,2474],
        [6523,2478],
        [6559,2454],
        [6523,2434],
        [6515,2442],
        [6487,2430],
        [6511,2414],
        [6503,2410],
        [6519,2390],
        [6567,2402],
        [6587,2378],
        [6627,2390],
        [6719,2390],
        [6747,2410],
        [6691,2446],
        [6659,2450],
        [6643,2466],
        [6607,2466],
        [6583,2478],
        [6579,2494]
    ]
],kh:[
    [
        [7383,3314],
        [7415,3298],
        [7427,3306],
        [7419,3282],
        [7463,3262],
        [7463,3202],
        [7447,3210],
        [7439,3206],
        [7427,3210],
        [7427,3218],
        [7423,3222],
        [7403,3210],
        [7351,3210],
        [7327,3234],
        [7339,3274],
        [7347,3290],
        [7347,3302],
        [7355,3302],
        [7359,3298],
        [7363,3306],
        [7359,3310],
        [7363,3314],
        [7367,3310]
    ]
],kp:[
    [
        [7907,2482],
        [7975,2422],
        [8003,2438],
        [8007,2418],
        [8047,2402],
        [8055,2386],
        [8071,2406],
        [8043,2430],
        [8047,2454],
        [7987,2486],
        [7987,2506],
        [8011,2522],
        [7967,2546],
        [7919,2538],
        [7931,2494]
    ]
],kr:[
    [
        [8011,2522],
        [8043,2574],
        [8031,2630],
        [7963,2650],
        [7955,2630],
        [7967,2598],
        [7955,2578],
        [7971,2570],
        [7967,2546]
    ]
],kw:[
    [
        [5911,2778],
        [5895,2794],
        [5911,2818],
        [5891,2818],
        [5887,2806],
        [5863,2802],
        [5879,2778]
    ]
],ky:[
    [
        [2482.74,3012.25],
        [2490.15,3008.87],
        [2486.86,3012.25]
    ],
    [
        [2496.75,3010.45],
        [2498.82,3012.74],
        [2502.79,3008.19]
    ]
],kz:[
    [
        [6111,2438],
        [6099,2442],
        [6067,2406],
        [6035,2410],
        [6019,2426],
        [6015,2410],
        [6027,2398],
        [6003,2390],
        [5975,2346],
        [5959,2342],
        [5959,2330],
        [5987,2334],
        [5979,2322],
        [5991,2310],
        [6027,2306],
        [6035,2266],
        [5983,2250],
        [5931,2274],
        [5863,2206],
        [5891,2138],
        [5911,2162],
        [5923,2154],
        [5919,2134],
        [5975,2094],
        [6015,2094],
        [6103,2134],
        [6175,2114],
        [6207,2138],
        [6251,2126],
        [6255,2106],
        [6215,2086],
        [6243,2074],
        [6235,2058],
        [6247,2050],
        [6267,2050],
        [6271,2046],
        [6247,2038],
        [6247,2018],
        [6463,1966],
        [6499,1966],
        [6511,2010],
        [6571,2018],
        [6571,2030],
        [6655,2002],
        [6743,2126],
        [6767,2110],
        [6799,2130],
        [6831,2118],
        [6903,2170],
        [6919,2166],
        [6935,2186],
        [6891,2210],
        [6891,2250],
        [6819,2250],
        [6795,2314],
        [6747,2322],
        [6747,2410],
        [6719,2390],
        [6627,2390],
        [6587,2378],
        [6567,2402],
        [6519,2390],
        [6503,2410],
        [6451,2438],
        [6439,2458],
        [6419,2442],
        [6395,2442],
        [6387,2418],
        [6375,2418],
        [6375,2386],
        [6367,2390],
        [6343,2362],
        [6267,2370],
        [6243,2342],
        [6179,2302],
        [6111,2322]
    ]
],la:[
    [
        [7295,3014],
        [7267,3046],
        [7279,3054],
        [7279,3070],
        [7299,3070],
        [7291,3122],
        [7295,3126],
        [7323,3106],
        [7335,3118],
        [7355,3098],
        [7391,3130],
        [7391,3150],
        [7415,3174],
        [7411,3190],
        [7411,3206],
        [7403,3210],
        [7423,3222],
        [7427,3218],
        [7427,3210],
        [7439,3206],
        [7447,3210],
        [7463,3202],
        [7467,3186],
        [7455,3170],
        [7463,3166],
        [7399,3098],
        [7403,3094],
        [7371,3074],
        [7399,3054],
        [7375,3030],
        [7363,3038],
        [7343,3022],
        [7343,3010],
        [7323,2990],
        [7311,2990],
        [7307,2994],
        [7311,3026],
        [7299,3022]
    ]
],lb:[
    [
        [5583,2642],
        [5591,2642],
        [5599,2654],
        [5575,2682],
        [5563,2686]
    ]
],lc:[
    [
        [3038.88,3214.75],
        [3035.38,3222.88],
        [3039.88,3224.5]
    ]
],lk:[
    [
        [6739,3330],
        [6763,3346],
        [6787,3390],
        [6791,3410],
        [6759,3434],
        [6743,3426],
        [6731,3378],
        [6743,3342]
    ]
],lr:[
    [
        [4439,3474],
        [4443,3438],
        [4415,3414],
        [4419,3390],
        [4411,3386],
        [4403,3398],
        [4391,3390],
        [4387,3366],
        [4371,3362],
        [4339,3406],
        [4399,3454]
    ]
],ls:[
    [
        [5375,4418],
        [5415,4382],
        [5391,4358],
        [5351,4390]
    ]
],lt:[
    [
        [5199,1966],
        [5191,1938],
        [5223,1926],
        [5295,1926],
        [5339,1954],
        [5311,2006],
        [5259,2018],
        [5235,1998],
        [5235,1974]
    ]
],lu:[
    [
        [4791,2158],
        [4791,2170],
        [4807,2174],
        [4811,2162],
        [4799,2150]
    ]
],lv:[
    [
        [5191,1938],
        [5223,1926],
        [5295,1926],
        [5339,1954],
        [5379,1934],
        [5371,1890],
        [5347,1878],
        [5335,1882],
        [5303,1862],
        [5279,1870],
        [5279,1894],
        [5259,1906],
        [5231,1874],
        [5199,1894]
    ]
],ly:[
    [
        [5299,2730],
        [5299,3002],
        [5299,3058],
        [5271,3058],
        [5271,3070],
        [5059,2962],
        [5035.03,2973.9],
        [5015,2986],
        [4995,2970],
        [4955,2958],
        [4887,2886],
        [4887,2770],
        [4911,2754],
        [4903,2734],
        [4943,2706],
        [4943,2686],
        [5039,2710],
        [5051,2734],
        [5143,2770],
        [5171,2742],
        [5163,2726],
        [5211,2690],
        [5247,2702],
        [5251,2714],
        [5295,2722]
    ]
],ma:[
    [
        [4583,2630],
        [4607,2714],
        [4539,2726],
        [4539,2742],
        [4411,2814],
        [4411,2842],
        [4295,2842],
        [4375,2794],
        [4383,2734],
        [4415,2686],
        [4459,2662],
        [4483,2610],
        [4499,2606],
        [4507,2622]
    ]
],mc:[
    [
        [4823,2370],
        [4824.88,2368.75],
        [4824.75,2370.25]
    ]
],md:[
    [
        [5343,2210],
        [5383,2266],
        [5375,2282],
        [5387,2314],
        [5419,2310],
        [5439,2282],
        [5427,2270],
        [5403,2222],
        [5363,2206]
    ]
],me:[
    [
        [5175,2386],
        [5167,2398],
        [5147,2422],
        [5123,2402],
        [5143,2370]
    ]
],mg:[
    [
        [5827,4274],
        [5875,4258],
        [5967,3994],
        [5935,3902],
        [5875,3990],
        [5807,4018],
        [5791,4050],
        [5807,4118],
        [5779,4166],
        [5787,4218],
        [5803,4262]
    ]
],mk:[
    [
        [5227,2406],
        [5239,2418],
        [5243,2438],
        [5191,2454],
        [5179,2442],
        [5183,2418]
    ]
],ml:[
    [
        [4507,2918],
        [4467,2918],
        [4491,3150],
        [4499,3158],
        [4495,3178],
        [4359,3178],
        [4351,3190],
        [4335,3174],
        [4319,3202],
        [4339.03,3257.91],
        [4343,3274],
        [4395,3266],
        [4431,3318],
        [4455,3322],
        [4475,3310],
        [4479,3322],
        [4495,3314],
        [4499,3278],
        [4563,3218],
        [4583,3214],
        [4587,3206],
        [4615,3194],
        [4645.25,3194],
        [4665,3194],
        [4675,3182],
        [4731,3182],
        [4751,3154],
        [4751,3082],
        [4723,3082],
        [4667,3026]
    ]
],mm:[
    [
        [7059,3030],
        [7071,3022],
        [7071,3002],
        [7087,2994],
        [7091,2946],
        [7111,2950],
        [7139,2874],
        [7175,2854],
        [7191,2862],
        [7183,2850],
        [7195,2838],
        [7195,2826],
        [7207,2818],
        [7231,2846],
        [7231,2894],
        [7203,2926],
        [7203,2946],
        [7235,2942],
        [7239,2970],
        [7255,2974],
        [7243,2998],
        [7267,3002],
        [7271,3018],
        [7295,3014],
        [7267,3046],
        [7215,3066],
        [7199,3098],
        [7207,3118],
        [7235,3154],
        [7227,3166],
        [7227,3182],
        [7219,3186],
        [7227,3210],
        [7247,3226],
        [7243,3242],
        [7255,3278],
        [7227,3326],
        [7227,3302],
        [7231,3282],
        [7231,3258],
        [7187,3130],
        [7179,3150],
        [7147,3174],
        [7115,3162],
        [7123,3122],
        [7107,3086],
        [7095,3074],
        [7099,3066],
        [7079,3054]
    ]
],mn:[
    [
        [6947,2182],
        [6951,2202],
        [7007,2226],
        [7031,2286],
        [7019,2302],
        [7027,2314],
        [7087,2322],
        [7139,2342],
        [7175,2394],
        [7287,2394],
        [7399,2430],
        [7455,2406],
        [7515,2402],
        [7579,2362],
        [7567,2342],
        [7583,2318],
        [7627,2326],
        [7723,2270],
        [7783,2270],
        [7791,2258],
        [7755,2222],
        [7683,2234],
        [7675,2218],
        [7703,2158],
        [7639,2146],
        [7547,2182],
        [7403,2138],
        [7363,2150],
        [7327,2134],
        [7323,2106],
        [7239,2082],
        [7207,2122],
        [7219,2138],
        [7211,2154],
        [7195,2162],
        [7127,2154],
        [7115,2134],
        [7063,2126]
    ]
],mq:[
    [
        [3031.62,3194.75],
        [3040.12,3197.5],
        [3041.25,3206.62],
        [3035.12,3204.88]
    ]
],mr:[
    [
        [4195,3022],
        [4295,3022],
        [4295,2974],
        [4323,2962],
        [4323,2890],
        [4411,2890],
        [4411,2854],
        [4507,2918],
        [4467,2918],
        [4491,3150],
        [4499,3158],
        [4495,3178],
        [4359,3178],
        [4351,3190],
        [4335,3174],
        [4319,3202],
        [4263,3146],
        [4207,3158],
        [4219,3118],
        [4207,3074],
        [4215,3050]
    ]
],ms:[
    [
        [3004,3142.62],
        [3007.12,3142],
        [3006.25,3145.5]
    ]
],mt:[
    [
        [5013.88,2597.25],
        [5023.25,2603.5],
        [5018.25,2606]
    ]
],mw:[
    [
        [5503,3830],
        [5535,3842],
        [5559,3894],
        [5555,3950],
        [5583,3974],
        [5579,4014],
        [5563,4026],
        [5567,4042],
        [5539,4006],
        [5547,3990],
        [5543,3970],
        [5523,3974],
        [5511,3958],
        [5523,3866]
    ]
],mx:[
    [
        [2087,2890],
        [2039,2878],
        [1975,2782],
        [1951,2778],
        [1931,2806],
        [1843,2726],
        [1799,2726],
        [1799,2738],
        [1723,2738],
        [1627,2702],
        [1563,2702],
        [1599,2782],
        [1647,2822],
        [1639,2842],
        [1615,2838],
        [1691,2890],
        [1691,2922],
        [1755,2974],
        [1767,2962],
        [1627,2766],
        [1627,2722],
        [1663,2738],
        [1691,2806],
        [1875,3014],
        [1867,3046],
        [1919,3102],
        [2103,3174],
        [2139,3158],
        [2163,3162],
        [2215,3202],
        [2231,3162],
        [2263,3162],
        [2239,3130],
        [2251,3130],
        [2251,3114],
        [2299,3114],
        [2319,3094],
        [2335,3098],
        [2355,3010],
        [2267,3026],
        [2255,3074],
        [2227,3094],
        [2155,3106],
        [2143,3090],
        [2123,3090],
        [2067,2994]
    ]
],my:[
    [
        [7271,3422],
        [7275,3418],
        [7295,3426],
        [7295,3442],
        [7315,3438],
        [7323,3426],
        [7355,3458],
        [7355,3514],
        [7363,3522],
        [7379,3550],
        [7363,3550],
        [7359,3554],
        [7299,3514],
        [7299,3502],
        [7283,3486]
    ],
    [
        [7519,3538],
        [7543,3566],
        [7583,3562],
        [7591,3550],
        [7623,3558],
        [7647,3550],
        [7679,3478],
        [7735,3482],
        [7755,3474],
        [7743,3458],
        [7771,3450],
        [7711,3402],
        [7663,3458],
        [7671,3474],
        [7655,3462],
        [7655,3478],
        [7651,3482],
        [7639,3470],
        [7607,3506],
        [7567,3518],
        [7555,3550]
    ]
],mz:[
    [
        [5703,3866],
        [5623,3894],
        [5559,3894],
        [5555,3950],
        [5583,3974],
        [5579,4014],
        [5563,4026],
        [5567,4042],
        [5539,4006],
        [5547,3990],
        [5543,3970],
        [5523,3974],
        [5511,3958],
        [5435,3986],
        [5439,4002],
        [5439,4010],
        [5503,4030],
        [5503,4126],
        [5463,4186],
        [5479,4286],
        [5483,4310],
        [5503,4310],
        [5503,4290],
        [5495,4286],
        [5575,4226],
        [5571,4178],
        [5551,4130],
        [5615,4058],
        [5687,4022],
        [5711,3978]
    ]
],na:[
    [
        [5163,4254],
        [5163,4174],
        [5191,4174],
        [5191,4074],
        [5251,4066],
        [5259,4078],
        [5299,4058],
        [5279,4050],
        [5255,4058],
        [5187,4066],
        [5139,4062],
        [5123,4050],
        [5007,4050],
        [4983,4038],
        [4947,4046],
        [5019,4202],
        [5031,4298],
        [5071,4362],
        [5087,4342],
        [5099,4362],
        [5147,4370],
        [5163,4354]
    ]
],nc:[
    [
        [8945,4124],
        [8983,4144],
        [9025,4185],
        [8974,4158]
    ]
],ne:[
    [
        [4735,3278],
        [4711,3258],
        [4703,3274],
        [4644.5,3194],
        [4665.33,3194],
        [4675,3182],
        [4731,3182],
        [4751,3154],
        [4751,3082],
        [4795,3074],
        [4831,3034],
        [4955,2958],
        [4995,2970],
        [5015,2986],
        [5035,2974],
        [5059,3046],
        [5047,3138],
        [4995,3206],
        [4995,3226],
        [4967,3242],
        [4923,3234],
        [4891,3250],
        [4847,3234],
        [4823,3246],
        [4759,3222]
    ]
],ng:[
    [
        [4863,3462],
        [4915,3402],
        [4939,3418],
        [5007,3290],
        [5023,3282],
        [5019,3262],
        [5011,3262],
        [5011,3242],
        [4995,3226],
        [4967,3242],
        [4923,3234],
        [4891,3250],
        [4847,3234],
        [4823,3246],
        [4759,3222],
        [4735,3278],
        [4731,3286],
        [4739,3314],
        [4719,3350],
        [4711,3350],
        [4711,3418],
        [4755,3418],
        [4799,3474]
    ]
],ni:[
    [
        [2347,3246],
        [2411,3194],
        [2455,3190],
        [2435,3286],
        [2443,3302],
        [2435,3306],
        [2411,3294],
        [2411,3290],
        [2399,3274],
        [2383,3270],
        [2391,3290],
        [2387,3294],
        [2339,3250]
    ]
],nl:[
    [
        [4795,2114],
        [4803,2102],
        [4795,2090],
        [4819,2086],
        [4827,2042],
        [4819,2034],
        [4787,2038],
        [4767,2050],
        [4759,2074],
        [4727,2106],
        [4771,2102]
    ]
],no:[
    [
        [4931,1826],
        [4947,1826],
        [4951,1794],
        [4967,1786],
        [4963,1750],
        [4979,1734],
        [4959,1718],
        [4955,1658],
        [4979,1622],
        [5007,1626],
        [5011,1606],
        [4999,1602],
        [5019,1534],
        [5035,1534],
        [5067,1494],
        [5063,1478],
        [5095,1450],
        [5107,1454],
        [5115,1430],
        [5163,1438],
        [5167,1406],
        [5183,1406],
        [5199,1390],
        [5239,1422],
        [5271,1414],
        [5295,1426],
        [5335,1362],
        [5371,1358],
        [5403,1374],
        [5411,1382],
        [5399,1402],
        [5451,1370],
        [5395,1354],
        [5431,1358],
        [5455,1342],
        [5395,1318],
        [5375,1334],
        [5387,1314],
        [5355,1314],
        [5335,1342],
        [5339,1314],
        [5299,1350],
        [5319,1310],
        [5287,1314],
        [5247,1358],
        [5243,1346],
        [5135,1362],
        [4883,1646],
        [4779,1702],
        [4767,1746],
        [4787,1846],
        [4827,1866],
        [4855,1862],
        [4919,1810]
    ]
],np:[
    [
        [6955,2838],
        [6951,2878],
        [6883,2870],
        [6863,2862],
        [6863,2854],
        [6847,2850],
        [6827,2854],
        [6739,2806],
        [6767,2770],
        [6795,2770],
        [6895,2830]
    ]
],nz:[
    [
        [9179,4530],
        [9231,4630],
        [9223,4666],
        [9203,4678],
        [9243,4706],
        [9231,4738],
        [9247,4750],
        [9331,4630],
        [9299,4634],
        [9259,4622]
    ],
    [
        [9175,4714],
        [9187,4738],
        [9219,4734],
        [9215,4758],
        [9175,4810],
        [9183,4822],
        [9139,4834],
        [9095,4910],
        [9011,4894],
        [9023,4866],
        [9127,4790],
        [9143,4754],
        [9159,4742],
        [9159,4726]
    ]
],om:[
    [
        [6115,2890],
        [6119,2882],
        [6123,2882],
        [6119,2902]
    ],
    [
        [6119,2922],
        [6107,2922],
        [6107,2946],
        [6099,2946],
        [6087,2986],
        [6103,3002],
        [6083,3058],
        [6003,3086],
        [6035,3150],
        [6159,3086],
        [6211,2986]
    ]
],pn:[
    [
        [2467,3334],
        [2459,3370],
        [2491,3374],
        [2515,3398],
        [2539,3390],
        [2527,3370],
        [2555,3350],
        [2583,3366],
        [2579,3374],
        [2595,3398],
        [2611,3378],
        [2607,3358],
        [2575,3338],
        [2547,3334],
        [2507,3358]
    ]
],pe:[
    [
        [2531,3678],
        [2527,3706],
        [2551,3706],
        [2563,3722],
        [2591,3666],
        [2627,3654],
        [2663,3614],
        [2663,3590],
        [2703,3618],
        [2719,3650],
        [2755,3646],
        [2799,3658],
        [2783,3686],
        [2803,3698],
        [2779,3698],
        [2727,3722],
        [2719,3758],
        [2695,3786],
        [2747,3854],
        [2787,3838],
        [2787,3878],
        [2815,3878],
        [2835,3918],
        [2819,3998],
        [2803,3994],
        [2803,4010],
        [2823,4018],
        [2827,4030],
        [2815,4050],
        [2791,4074],
        [2635,3958],
        [2639,3946],
        [2539,3766],
        [2507,3738],
        [2507,3698]
    ]
],pg:[
    [
        [8343,3826],
        [8343,3658],
        [8459,3706],
        [8467,3730],
        [8511,3746],
        [8523,3766],
        [8499,3766],
        [8543,3830],
        [8559,3826],
        [8599,3866],
        [8519,3858],
        [8467,3798],
        [8435,3786],
        [8387,3838]
    ],
    [
        [8527,3734],
        [8575,3758],
        [8635,3730],
        [8639,3702],
        [8619,3702],
        [8623,3718],
        [8599,3734]
    ],
    [
        [8655,3718],
        [8659,3694],
        [8603,3658],
        [8647,3694]
    ],
    [
        [8703,3730],
        [8739,3762],
        [8727,3770],
        [8707,3746]
    ]
],ph:[
    [
        [7814,3092.33],
        [7848,3103],
        [7851.33,3151.67],
        [7826,3184.33],
        [7846,3217],
        [7900,3226.33],
        [7897.33,3251.67],
        [7841.33,3221.67],
        [7814,3227],
        [7786.67,3156.33],
        [7804.67,3160.33]
    ],
    [
        [7801.33,3231],
        [7827.33,3232.33],
        [7826.67,3266.33]
    ],
    [
        [7873.33,3273],
        [7878,3256.33],
        [7896.67,3271],
        [7881.33,3265.67]
    ],
    [
        [7841.33,3274.33],
        [7878.67,3284.33],
        [7845.33,3309.67]
    ],
    [
        [7854,3329],
        [7880.67,3298.33],
        [7877.33,3334.33],
        [7897.33,3293.67],
        [7896,3314.33],
        [7870.67,3347.67]
    ],
    [
        [7902.67,3257.67],
        [7928,3253.67],
        [7942,3299]
    ],
    [
        [7920,3285],
        [7906,3295],
        [7927.33,3323.67]
    ],
    [
        [7902.67,3318.33],
        [7888.67,3339],
        [7908.67,3329.67]
    ],
    [
        [7777.33,3285],
        [7784.67,3311.67],
        [7716.67,3369.67],
        [7772,3306.33]
    ],
    [
        [7937,3318],
        [7933.5,3349.5],
        [7896,3371.5],
        [7885.5,3358],
        [7848.5,3377.5],
        [7843,3406.5],
        [7861,3385],
        [7867,3395],
        [7889,3379],
        [7903.5,3392.5],
        [7896.5,3421.5],
        [7934,3439.5],
        [7939,3417.5],
        [7931,3408.5],
        [7945,3391],
        [7952.5,3422],
        [7965.5,3383.5]
    ],
    [
        [7837.5,3414],
        [7853,3412.5],
        [7845.5,3419]
    ]
],pk:[
    [
        [6255,2914],
        [6263,2882],
        [6299,2874],
        [6299,2854],
        [6239,2782],
        [6279,2794],
        [6323,2794],
        [6383,2778],
        [6383,2750],
        [6431,2726],
        [6447,2730],
        [6459,2722],
        [6467,2690],
        [6487,2682],
        [6475,2662],
        [6499,2662],
        [6507,2654],
        [6503,2646],
        [6523,2626],
        [6511,2598],
        [6523,2586],
        [6555,2574],
        [6583,2578],
        [6607,2566],
        [6635,2582],
        [6639,2606],
        [6683,2618],
        [6631,2646],
        [6591,2638],
        [6579,2650],
        [6603,2706],
        [6619,2710],
        [6599,2726],
        [6599,2746],
        [6527,2834],
        [6499,2842],
        [6491,2834],
        [6467,2862],
        [6471,2874],
        [6483,2874],
        [6487,2898],
        [6495,2898],
        [6507,2934],
        [6431,2950],
        [6415,2950],
        [6387,2906]
    ]
],pl:[
    [
        [5011,2018],
        [5123,1986],
        [5135,2002],
        [5235,1998],
        [5259,2018],
        [5267,2062],
        [5251,2078],
        [5259,2082],
        [5259,2098],
        [5271,2138],
        [5235,2170],
        [5239,2186],
        [5231,2186],
        [5135,2170],
        [5127,2158],
        [5031,2122],
        [5023,2066],
        [5011,2054],
        [5019,2046]
    ]
],pr:[
    [
        [2875,3098],
        [2875,3110],
        [2911,3110],
        [2915,3098]
    ]
],pt:[
    [
        [4407,2414],
        [4475,2430],
        [4447,2494],
        [4443,2566],
        [4403,2570],
        [4407,2526],
        [4391,2522],
        [4411,2442]
    ]
],py:[
    [
        [2995,4182],
        [3019,4110],
        [3087,4102],
        [3115,4122],
        [3115,4178],
        [3175,4182],
        [3187,4230],
        [3215,4230],
        [3207,4274],
        [3199,4306],
        [3175,4326],
        [3099,4322],
        [3127,4270],
        [3047,4226]
    ]
],qa:[
    [
        [5987,2934],
        [5975,2926],
        [5975,2898],
        [5987,2886],
        [5995,2894],
        [5995,2922]
    ]
],ro:[
    [
        [5239,2222],
        [5223,2230],
        [5195,2282],
        [5171,2282],
        [5235,2346],
        [5243,2358],
        [5315,2362],
        [5355,2350],
        [5391,2362],
        [5403,2326],
        [5415,2326],
        [5419,2310],
        [5387,2314],
        [5375,2282],
        [5383,2266],
        [5343,2210],
        [5295,2234]
    ]
],rs:[
    [
        [5171,2282],
        [5235,2346],
        [5227,2358],
        [5243,2378],
        [5227,2406],
        [5183,2418],
        [5167,2398],
        [5175,2386],
        [5143,2370],
        [5143,2322],
        [5135,2294],
        [5151,2282]
    ]
],ru:[
    [
        [5135,2002],
        [5199,1966],
        [5235,1974],
        [5235,1998]
    ],
    [
        [5375,1810],
        [5359,1834],
        [5367,1870],
        [5355,1882],
        [5371,1890],
        [5379,1934],
        [5451,1954],
        [5451,1986],
        [5499,2034],
        [5467,2042],
        [5475,2082],
        [5527,2070],
        [5539,2110],
        [5559,2110],
        [5575,2142],
        [5603,2146],
        [5623,2138],
        [5691,2170],
        [5683,2226],
        [5651,2230],
        [5643,2250],
        [5675,2254],
        [5631,2270],
        [5647,2282],
        [5619,2310],
        [5603,2306],
        [5599,2314],
        [5691,2374],
        [5695,2366],
        [5843,2402],
        [5839,2410],
        [5859,2418],
        [5899,2442],
        [5915,2422],
        [5867,2338],
        [5891,2298],
        [5919,2290],
        [5931,2274],
        [5863,2206],
        [5891,2138],
        [5911,2162],
        [5923,2154],
        [5919,2134],
        [5975,2094],
        [6015,2094],
        [6103,2134],
        [6175,2114],
        [6207,2138],
        [6251,2126],
        [6255,2106],
        [6215,2086],
        [6243,2074],
        [6235,2058],
        [6247,2050],
        [6267,2050],
        [6271,2046],
        [6247,2038],
        [6247,2018],
        [6463,1966],
        [6499,1966],
        [6511,2010],
        [6571,2018],
        [6571,2030],
        [6655,2002],
        [6743,2126],
        [6767,2110],
        [6799,2130],
        [6831,2118],
        [6903,2170],
        [6919,2166],
        [6935,2186],
        [6947,2182],
        [7063,2126],
        [7115,2134],
        [7127,2154],
        [7195,2162],
        [7211,2154],
        [7219,2138],
        [7207,2122],
        [7239,2082],
        [7323,2106],
        [7327,2134],
        [7363,2150],
        [7403,2138],
        [7547,2182],
        [7639,2146],
        [7703,2158],
        [7735,2170],
        [7811,2086],
        [7811,2066],
        [7791,2066],
        [7791,2058],
        [7815,2038],
        [7879,2030],
        [7947,2058],
        [7991,2162],
        [8051,2178],
        [8079,2234],
        [8179,2214],
        [8135,2322],
        [8103,2310],
        [8083,2326],
        [8083,2386],
        [8071,2390],
        [8071,2406],
        [8115,2382],
        [8135,2394],
        [8199,2358],
        [8319,2206],
        [8355,2038],
        [8287,2002],
        [8263,2030],
        [8195,1978],
        [8399,1814],
        [8715,1818],
        [8691,1798],
        [8771,1718],
        [8851,1714],
        [8847,1762],
        [8959,1682],
        [8963,1690],
        [8935,1750],
        [8763,1882],
        [8727,1962],
        [8755,2122],
        [8903,1986],
        [8895,1938],
        [8927,1934],
        [8919,1870],
        [8895,1866],
        [8967,1790],
        [9127,1770],
        [9299,1682],
        [9343,1698],
        [9359,1678],
        [9287,1594],
        [9363,1586],
        [9395,1542],
        [9547,1614],
        [9635,1534],
        [9519,1490],
        [9511,1506],
        [9503,1478],
        [9263,1366],
        [9111,1354],
        [9131,1406],
        [9091,1414],
        [9067,1362],
        [8871,1390],
        [8807,1314],
        [8643,1326],
        [8535,1250],
        [8339,1222],
        [8311,1290],
        [8163,1302],
        [8127,1270],
        [8075,1326],
        [8015,1206],
        [7883,1178],
        [7863,1218],
        [7611,1166],
        [7435,1206],
        [7627,1090],
        [7619,1046],
        [7551,1018],
        [7447,1030],
        [7455,1006],
        [7379,962],
        [7159,1066],
        [6991,1078],
        [6895,1138],
        [6907,1166],
        [6751,1190],
        [6771,1246],
        [6827,1282],
        [6763,1262],
        [6671,1238],
        [6639,1282],
        [6699,1314],
        [6615,1294],
        [6611,1230],
        [6559,1294],
        [6591,1338],
        [6583,1402],
        [6647,1410],
        [6595,1426],
        [6595,1470],
        [6539,1530],
        [6483,1522],
        [6543,1486],
        [6571,1430],
        [6547,1314],
        [6559,1222],
        [6487,1202],
        [6435,1278],
        [6391,1370],
        [6451,1414],
        [6435,1434],
        [6291,1374],
        [6215,1362],
        [6243,1410],
        [6203,1422],
        [6191,1410],
        [6035,1418],
        [5899,1470],
        [5891,1498],
        [5827,1486],
        [5863,1454],
        [5803,1426],
        [5787,1486],
        [5795,1534],
        [5743,1522],
        [5679,1562],
        [5695,1598],
        [5611,1574],
        [5603,1594],
        [5635,1614],
        [5627,1634],
        [5555,1606],
        [5551,1542],
        [5491,1502],
        [5495,1490],
        [5575,1526],
        [5647,1538],
        [5695,1530],
        [5727,1494],
        [5719,1466],
        [5587,1402],
        [5451,1370],
        [5399,1402],
        [5383,1414],
        [5395,1414],
        [5387,1426],
        [5395,1446],
        [5427,1466],
        [5403,1498],
        [5431,1554],
        [5423,1558],
        [5419,1582],
        [5443,1622],
        [5427,1638],
        [5471,1670],
        [5459,1690],
        [5371,1766],
        [5427,1786],
        [5379,1798]
    ],
    [
        [5923,1382],
        [5903,1414],
        [5931,1418],
        [5959,1394]
    ],
    [
        [6135,1338],
        [5995,1290],
        [6119,1110],
        [6247,1046],
        [6403,1010],
        [6451,1018],
        [6439,1050],
        [6243,1102],
        [6147,1182],
        [6095,1250],
        [6107,1298],
        [6155,1322]
    ],
    [
        [7319,870],
        [7251,950],
        [7395,926]
    ],
    [
        [7263,842],
        [7259,898],
        [7103,854]
    ],
    [
        [7091,842],
        [7191,814],
        [7211,786],
        [7147,762],
        [7039,834]
    ],
    [
        [8367,2034],
        [8367,2282],
        [8403,2266],
        [8387,2222],
        [8411,2174],
        [8431,2182],
        [8395,2018]
    ]
],rw:[
    [
        [5439,3614],
        [5427,3626],
        [5419,3622],
        [5399,3650],
        [5399,3662],
        [5447,3650]
    ]
],sa:[
    [
        [5911,2818],
        [5891,2818],
        [5887,2806],
        [5863,2802],
        [5815,2802],
        [5743,2742],
        [5671,2714],
        [5611,2734],
        [5639,2762],
        [5587,2802],
        [5559,2798],
        [5547,2830],
        [5559,2830],
        [5627,2938],
        [5651,2954],
        [5667,2994],
        [5663,3002],
        [5687,3050],
        [5707,3062],
        [5763,3154],
        [5775,3146],
        [5775,3130],
        [5783,3126],
        [5867,3134],
        [5879,3142],
        [5903,3110],
        [6003,3086],
        [6083,3058],
        [6103,3002],
        [6087,2986],
        [6023,2978],
        [5995,2942],
        [5987,2934],
        [5975,2926],
        [5955,2894],
        [5951,2866],
        [5923,2846]
    ]
],sb:[
    [
        [8749,3763],
        [8766.5,3771],
        [8777.5,3784]
    ],
    [
        [8800,3786.5],
        [8838,3805.5],
        [8833.5,3811]
    ],
    [
        [8833,3829.5],
        [8852,3835],
        [8862.5,3847],
        [8841,3846.5]
    ],
    [
        [8857,3807.5],
        [8864,3807],
        [8880,3842],
        [8862,3826]
    ],
    [
        [8877.5,3853.5],
        [8899,3863.5],
        [8896,3874.5]
    ],
    [
        [8762.5,3795.5],
        [8777.5,3799.5],
        [8793,3819.5],
        [8771.5,3811]
    ]
],sd:[
    [
        [5243,3298],
        [5215,3246],
        [5247,3170],
        [5271,3170],
        [5271,3070],
        [5271,3058],
        [5299,3058],
        [5299,3002],
        [5511,3002],
        [5531,3010],
        [5575,2970],
        [5607,2998],
        [5623,3090],
        [5651,3110],
        [5611,3138],
        [5599,3210],
        [5555,3306],
        [5543,3302],
        [5531,3366],
        [5511,3366],
        [5507,3382],
        [5579,3446],
        [5583,3466],
        [5543,3466],
        [5531,3478],
        [5519,3490],
        [5451,3494],
        [5359,3454]
    ]
],se:[
    [
        [4931,1826],
        [4979,1922],
        [4967,1934],
        [4983,1966],
        [5015,1958],
        [5023,1938],
        [5063,1934],
        [5083,1842],
        [5139,1798],
        [5111,1766],
        [5095,1758],
        [5091,1722],
        [5127,1666],
        [5207,1606],
        [5195,1590],
        [5227,1546],
        [5271,1550],
        [5259,1454],
        [5183,1406],
        [5167,1406],
        [5163,1438],
        [5115,1430],
        [5107,1454],
        [5095,1450],
        [5063,1478],
        [5067,1494],
        [5035,1534],
        [5019,1534],
        [4999,1602],
        [5011,1606],
        [5007,1626],
        [4979,1622],
        [4955,1658],
        [4959,1718],
        [4979,1734],
        [4963,1750],
        [4967,1786],
        [4951,1794],
        [4947,1826]
    ]
],sg:[
    [
        [7363,3550],
        [7359,3554],
        [7367,3558],
        [7371,3550]
    ]
],si:[
    [
        [4995,2294],
        [4999,2270],
        [5023,2274],
        [5067,2258],
        [5071,2270],
        [5051,2286],
        [5043,2306],
        [4999,2306]
    ]
],sk:[
    [
        [5135,2170],
        [5231,2186],
        [5223,2210],
        [5179,2206],
        [5135,2222],
        [5135,2226],
        [5103,2230],
        [5087,2222],
        [5087,2198]
    ]
],sl:[
    [
        [4339,3406],
        [4371,3362],
        [4359,3366],
        [4363,3358],
        [4347,3326],
        [4315,3326],
        [4291,3350],
        [4295,3370],
        [4311,3390]
    ]
],sn:[
    [
        [4199,3262],
        [4239,3254],
        [4279,3254],
        [4339,3258],
        [4319,3202],
        [4263,3146],
        [4207,3158],
        [4203,3174],
        [4183,3198],
        [4203,3230],
        [4247,3222],
        [4279,3234],
        [4267,3238],
        [4243,3230],
        [4199,3242]
    ]
],so:[
    [
        [5739,3482],
        [5795,3458],
        [5823,3458],
        [5899,3378],
        [5871,3378],
        [5791,3346],
        [5759,3306],
        [5767,3298],
        [5775,3286],
        [5803,3314],
        [5819,3314],
        [5979,3274],
        [5987,3310],
        [5927,3418],
        [5899,3470],
        [5847,3526],
        [5779,3574],
        [5731,3630],
        [5715,3610],
        [5715,3514]
    ]
],sr:[
    [
        [3139,3434],
        [3115,3478],
        [3155,3538],
        [3207,3526],
        [3223,3494],
        [3207,3458],
        [3223,3434]
    ]
],sv:[
    [
        [2291,3206],
        [2335,3222],
        [2331,3238],
        [2271,3222]
    ]
],sy:[
    [
        [5583,2602],
        [5595,2602],
        [5603,2578],
        [5659,2578],
        [5755,2566],
        [5735,2586],
        [5727,2586],
        [5715,2650],
        [5659,2678],
        [5607,2710],
        [5575,2698],
        [5575,2682],
        [5599,2654],
        [5591,2642],
        [5583,2642]
    ]
],sz:[
    [
        [5479,4286],
        [5463,4278],
        [5447,4298],
        [5459,4322],
        [5479,4322],
        [5483,4310]
    ]
],td:[
    [
        [5035,2974],
        [5059,2962],
        [5271,3070],
        [5271,3170],
        [5247,3170],
        [5215,3246],
        [5243,3298],
        [5127,3374],
        [5047,3386],
        [5007,3330],
        [5015,3322],
        [5047,3322],
        [5035,3294],
        [5039,3270],
        [5019,3242],
        [5011,3242],
        [4995,3226],
        [4995,3206],
        [5047,3138],
        [5059,3046]
    ]
],tf:[
    [
        [6451,4978],
        [6471,4994],
        [6491,4990],
        [6483,5014],
        [6447,5010]
    ]
],tg:[
    [
        [4687,3422],
        [4679,3326],
        [4659,3314],
        [4663,3298],
        [4643,3294],
        [4635,3306],
        [4651,3318],
        [4655,3410],
        [4671,3426]
    ]
],th:[
    [
        [7339,3274],
        [7327,3234],
        [7351,3210],
        [7403,3210],
        [7411,3206],
        [7411,3190],
        [7415,3174],
        [7391,3150],
        [7391,3130],
        [7355,3098],
        [7335,3118],
        [7323,3106],
        [7295,3126],
        [7291,3122],
        [7299,3070],
        [7279,3070],
        [7279,3054],
        [7267,3046],
        [7215,3066],
        [7199,3098],
        [7207,3118],
        [7235,3154],
        [7227,3166],
        [7227,3182],
        [7219,3186],
        [7227,3210],
        [7247,3226],
        [7243,3242],
        [7255,3278],
        [7227,3326],
        [7223,3386],
        [7231,3370],
        [7271,3422],
        [7275,3418],
        [7295,3426],
        [7295,3442],
        [7315,3438],
        [7323,3426],
        [7303,3406],
        [7291,3410],
        [7279,3398],
        [7263,3346],
        [7247,3346],
        [7243,3322],
        [7267,3270],
        [7267,3234],
        [7291,3234],
        [7287,3254],
        [7319,3258]
    ]
],tj:[
    [
        [6459,2566],
        [6419,2566],
        [6435,2538],
        [6431,2514],
        [6407,2502],
        [6415,2490],
        [6439,2490],
        [6491,2446],
        [6499,2454],
        [6487,2466],
        [6503,2474],
        [6495,2482],
        [6479,2474],
        [6459,2486],
        [6463,2494],
        [6499,2498],
        [6575,2494],
        [6583,2522],
        [6603,2526],
        [6607,2566],
        [6591,2558],
        [6555,2562],
        [6523,2582],
        [6515,2566],
        [6519,2542],
        [6511,2542],
        [6511,2530],
        [6499,2526]
    ]
],tl:[
    [
        [7919,3826],
        [7927,3818],
        [7979,3810],
        [7983,3814],
        [7923,3838]
    ]
],tm:[
    [
        [6055,2562],
        [6123,2530],
        [6247,2582],
        [6251,2614],
        [6283,2626],
        [6367,2554],
        [6387,2562],
        [6387,2542],
        [6279,2478],
        [6255,2438],
        [6219,2434],
        [6215,2406],
        [6171,2394],
        [6135,2422],
        [6139,2438],
        [6111,2438],
        [6099,2442],
        [6067,2406],
        [6035,2410],
        [6019,2426],
        [6027,2438],
        [6027,2422],
        [6035,2414],
        [6055,2414],
        [6075,2446],
        [6051,2462],
        [6035,2454],
        [6027,2442],
        [6023,2478],
        [6043,2482],
        [6043,2494],
        [6035,2498],
        [6047,2502]
    ]
],tn:[
    [
        [4943,2686],
        [4943,2706],
        [4903,2734],
        [4911,2754],
        [4887,2770],
        [4879,2718],
        [4835,2666],
        [4859,2626],
        [4863,2574],
        [4899,2562],
        [4915,2578],
        [4931,2570],
        [4915,2598],
        [4931,2626],
        [4903,2658]
    ]
],to:[
    [
        [9489.33,4149.67],
        [9498.33,4151.33],
        [9493.5,4155.17]
    ]
],tr:[
    [
        [5375,2418],
        [5331,2426],
        [5327,2458],
        [5343,2462],
        [5367,2446],
        [5403,2450],
        [5411,2458],
        [5367,2470],
        [5355,2466],
        [5339,2466],
        [5327,2482],
        [5327,2494],
        [5343,2502],
        [5347,2530],
        [5335,2530],
        [5367,2562],
        [5363,2570],
        [5423,2598],
        [5439,2590],
        [5443,2574],
        [5483,2586],
        [5499,2602],
        [5527,2598],
        [5555,2578],
        [5571,2586],
        [5583,2574],
        [5591,2582],
        [5579,2590],
        [5583,2602],
        [5595,2602],
        [5603,2578],
        [5659,2578],
        [5755,2566],
        [5815,2566],
        [5799,2498],
        [5811,2486],
        [5787,2478],
        [5783,2442],
        [5759,2430],
        [5731,2430],
        [5695,2450],
        [5647,2450],
        [5595,2442],
        [5559,2414],
        [5515,2418],
        [5463,2438],
        [5459,2446],
        [5403,2442],
        [5379,2430]
    ]
],tt:[
    [
        [3016.38,3320.62],
        [3025,3316.62],
        [3021,3304.75],
        [3039,3301.88],
        [3036.25,3321]
    ],
    [
        [3041.88,3292.5],
        [3048.88,3288.12],
        [3049.62,3291.38]
    ]
],tw:[
    [
        [7819,2918],
        [7843,2918],
        [7815,3006],
        [7791,2978],
        [7795,2954]
    ]
],tz:[
    [
        [5671,3710],
        [5627,3678],
        [5631,3670],
        [5534.67,3613.83],
        [5515.17,3637.67],
        [5527,3646],
        [5519,3654],
        [5475,3654],
        [5475,3614],
        [5439,3614],
        [5447,3650],
        [5451,3674],
        [5419,3706],
        [5427,3742],
        [5423,3754],
        [5435,3762],
        [5459,3814],
        [5503,3830],
        [5535,3842],
        [5559,3894],
        [5623,3894],
        [5703,3866],
        [5683,3850],
        [5671,3806],
        [5679,3770],
        [5659,3746]
    ]
],ua:[
    [
        [5475,2082],
        [5455,2082],
        [5443,2106],
        [5303,2086],
        [5259,2098],
        [5271,2138],
        [5235,2170],
        [5239,2186],
        [5231,2186],
        [5223,2210],
        [5239,2222],
        [5295,2234],
        [5343,2210],
        [5363,2206],
        [5403,2222],
        [5427,2270],
        [5439,2282],
        [5447,2270],
        [5523,2290],
        [5495,2306],
        [5519,2314],
        [5519,2334],
        [5535,2338],
        [5595,2318],
        [5599,2306],
        [5571,2310],
        [5547,2294],
        [5567,2274],
        [5643,2250],
        [5651,2230],
        [5683,2226],
        [5691,2170],
        [5623,2138],
        [5603,2146],
        [5575,2142],
        [5559,2110],
        [5539,2110],
        [5527,2070]
    ]
],ug:[
    [
        [5451,3494],
        [5519,3490],
        [5531,3478],
        [5563,3534],
        [5531,3582],
        [5515,3578],
        [5479,3590],
        [5475,3614],
        [5439,3614],
        [5427,3626],
        [5419,3622],
        [5419,3586],
        [5463,3530],
        [5447,3522]
    ]
],us:[
    [
        [1563,2702],
        [1627,2702],
        [1723,2738],
        [1799,2738],
        [1799,2726],
        [1843,2726],
        [1931,2806],
        [1951,2778],
        [1975,2782],
        [2039,2878],
        [2087,2890],
        [2079,2850],
        [2159,2786],
        [2235,2786],
        [2259,2806],
        [2307,2766],
        [2379,2766],
        [2403,2786],
        [2431,2770],
        [2471,2810],
        [2463,2834],
        [2507,2910],
        [2531,2910],
        [2539,2870],
        [2499,2758],
        [2511,2722],
        [2655,2606],
        [2635,2542],
        [2647,2554],
        [2695,2486],
        [2699,2462],
        [2791,2422],
        [2779,2390],
        [2795,2358],
        [2883,2322],
        [2859,2294],
        [2859,2250],
        [2823,2238],
        [2759,2318],
        [2671,2318],
        [2643,2338],
        [2635,2366],
        [2623,2374],
        [2563,2374],
        [2567,2386],
        [2559,2398],
        [2491,2430],
        [2459,2430],
        [2451,2418],
        [2475,2382],
        [2463,2350],
        [2439,2362],
        [2451,2314],
        [2415,2294],
        [2375,2330],
        [2367,2366],
        [2375,2386],
        [2359,2422],
        [2343,2426],
        [2331,2378],
        [2363,2294],
        [2399,2282],
        [2411,2286],
        [2443,2286],
        [2419,2270],
        [2407,2262],
        [2351,2274],
        [2319,2250],
        [2323,2238],
        [2295,2254],
        [2223,2262],
        [2283,2218],
        [2143,2186],
        [1415,2186],
        [1415,2214],
        [1363,2210],
        [1383,2282],
        [1383,2334],
        [1367,2390],
        [1383,2438],
        [1371,2466],
        [1475,2642],
        [1539,2666]
    ],
    [
        [1215,1986],
        [1227,1938],
        [1079,1798],
        [1031,1830],
        [935,1770],
        [935,1374],
        [523,1298],
        [275,1410],
        [267,1434],
        [411,1522],
        [391,1538],
        [335,1534],
        [335,1510],
        [227,1554],
        [279,1598],
        [363,1598],
        [407,1586],
        [415,1634],
        [351,1666],
        [323,1654],
        [279,1718],
        [307,1750],
        [291,1766],
        [347,1798],
        [375,1782],
        [391,1806],
        [387,1838],
        [431,1826],
        [463,1846],
        [515,1830],
        [499,1882],
        [307,1990],
        [319,1998],
        [455,1942],
        [615,1830],
        [591,1818],
        [667,1742],
        [651,1818],
        [755,1786],
        [759,1754],
        [787,1750],
        [863,1786],
        [955,1798],
        [963,1794],
        [971,1806],
        [1047,1854],
        [1103,1930],
        [1115,1914],
        [1155,1986],
        [1179,1978]
    ]
],uy:[
    [
        [3235,4510],
        [3231,4494],
        [3243,4478],
        [3147,4402],
        [3127,4406],
        [3103,4514],
        [3163,4542],
        [3219,4538]
    ]
],uz:[
    [
        [6419,2566],
        [6387,2562],
        [6387,2542],
        [6279,2478],
        [6255,2438],
        [6219,2434],
        [6215,2406],
        [6171,2394],
        [6135,2422],
        [6139,2438],
        [6111,2438],
        [6111,2322],
        [6179,2302],
        [6243,2342],
        [6267,2370],
        [6343,2362],
        [6367,2390],
        [6375,2386],
        [6375,2418],
        [6387,2418],
        [6395,2442],
        [6419,2442],
        [6439,2458],
        [6451,2438],
        [6503,2410],
        [6511,2414],
        [6487,2430],
        [6515,2442],
        [6523,2434],
        [6559,2454],
        [6523,2478],
        [6503,2474],
        [6487,2466],
        [6499,2454],
        [6491,2446],
        [6439,2490],
        [6415,2490],
        [6407,2502],
        [6431,2514],
        [6435,2538]
    ]
],vc:[
    [
        [3031.88,3234.62],
        [3034.5,3236.38],
        [3032.38,3242.25],
        [3029.5,3238.75]
    ]
],ve:[
    [
        [2751,3282],
        [2711,3346],
        [2759,3402],
        [2799,3402],
        [2815,3426],
        [2867,3422],
        [2855,3470],
        [2871,3498],
        [2859,3510],
        [2875,3526],
        [2883,3558],
        [2907,3570],
        [2975,3526],
        [2959,3522],
        [2939,3478],
        [2987,3494],
        [3047,3458],
        [3047,3450],
        [3027,3430],
        [3055,3402],
        [3043,3390],
        [3071,3366],
        [3043,3358],
        [3039,3338],
        [2991,3306],
        [2935,3322],
        [2903,3306],
        [2855,3310],
        [2819,3282],
        [2763,3302],
        [2775,3338],
        [2759,3346],
        [2743,3330],
        [2759,3306]
    ]
],vn:[
    [
        [7475,3018],
        [7443,3002],
        [7443,2982],
        [7407,2966],
        [7347,2990],
        [7331,2982],
        [7323,2990],
        [7343,3010],
        [7343,3022],
        [7363,3038],
        [7375,3030],
        [7399,3054],
        [7371,3074],
        [7403,3094],
        [7399,3098],
        [7463,3166],
        [7455,3170],
        [7467,3186],
        [7463,3202],
        [7463,3262],
        [7419,3282],
        [7427,3306],
        [7415,3298],
        [7383,3314],
        [7399,3326],
        [7391,3366],
        [7503,3290],
        [7515,3250],
        [7499,3186],
        [7411,3086],
        [7423,3058]
    ]
],vu:[
    [
        [9015.5,3976],
        [9019.5,4002.5],
        [9032.5,4000]
    ],
    [
        [9031.5,4008.5],
        [9038,4026.5],
        [9047,4022.5]
    ]
],wa:[
    [
        [9556.33,3944.17],
        [9568.17,3942.33],
        [9571.17,3951.83],
        [9563.17,3951.83]
    ],
    [
        [9575.33,3953.83],
        [9582.17,3952.17],
        [9590.83,3959.33]
    ]
],wf:[
    [
        [9415.75,3964],
        [9420.25,3967.5],
        [9417,3967.5]
    ]
],ye:[
    [
        [5763,3154],
        [5775,3146],
        [5775,3130],
        [5783,3126],
        [5867,3134],
        [5879,3142],
        [5903,3110],
        [6003,3086],
        [6035,3150],
        [6011,3162],
        [6011,3174],
        [5787,3258]
    ]
],za:[
    [
        [5503,4310],
        [5483,4310],
        [5479,4322],
        [5459,4322],
        [5447,4298],
        [5463,4278],
        [5479,4286],
        [5463,4186],
        [5411,4178],
        [5347,4222],
        [5311,4278],
        [5247,4266],
        [5211,4310],
        [5183,4310],
        [5179,4298],
        [5187,4290],
        [5163,4254],
        [5163,4354],
        [5147,4370],
        [5099,4362],
        [5087,4342],
        [5071,4362],
        [5123,4474],
        [5111,4482],
        [5163,4542],
        [5215,4526],
        [5315,4518],
        [5423,4442],
        [5491,4358]
    ]
],zm:[
    [
        [5255,4058],
        [5215,4014],
        [5215,3930],
        [5271,3930],
        [5271,3878],
        [5279,3878],
        [5283,3890],
        [5303,3886],
        [5307,3894],
        [5347,3906],
        [5351,3894],
        [5407,3942],
        [5423,3942],
        [5423,3910],
        [5403,3914],
        [5383,3890],
        [5391,3870],
        [5387,3834],
        [5399,3814],
        [5443,3802],
        [5439,3810],
        [5455,3818],
        [5459,3814],
        [5503,3830],
        [5523,3866],
        [5511,3958],
        [5435,3986],
        [5439,4002],
        [5399,4010],
        [5395,4026],
        [5351,4062],
        [5299,4058],
        [5279,4050]
    ]
],zw:[
    [
        [5463,4186],
        [5503,4126],
        [5503,4030],
        [5439,4010],
        [5439,4002],
        [5399,4010],
        [5395,4026],
        [5351,4062],
        [5299,4058],
        [5375,4162],
        [5411,4178]
    ]
]},zoomVisible:true,zoomAll:Explore.i18n("Zoom_World"),defaultZoom:"ca,cl,us,ru"},us:{coords:{al:[
    [
        [622.33521,602.8125],
        [620.77368,588.1246],
        [618.11742,569.99957],
        [618.27367,556.4058],
        [619.05492,526.40576],
        [618.89867,510.31198],
        [619.05823,504.10775],
        [626.55494,503.74947],
        [653.42998,501.24947],
        [662.0539,500.60944],
        [661.91105,502.71882],
        [662.0673,504.75008],
        [662.6923,508.03133],
        [665.97356,515.68759],
        [668.31731,525.21886],
        [669.72356,531.15637],
        [671.28606,535.84387],
        [672.69232,542.56263],
        [674.72357,548.65639],
        [677.22357,551.93765],
        [677.69232,555.2189],
        [679.56733,556.00015],
        [679.72358,558.03141],
        [678.00482,562.71891],
        [677.53607,565.84392],
        [677.37982,567.71892],
        [678.94233,571.93768],
        [679.25483,577.09393],
        [678.47357,579.43769],
        [679.09858,580.21894],
        [680.50483,581.00019],
        [681.50543,583.45061],
        [675.41167,583.45061],
        [668.84916,584.07561],
        [644.16162,586.88811],
        [634.09851,588.24779],
        [634.00536,591.87461],
        [635.72411,593.59336],
        [638.22411,595.46836],
        [638.78553,603.13821],
        [633.42896,605.625],
        [630.77271,605.3125],
        [633.42896,603.4375],
        [633.42896,602.5],
        [630.46021,596.71875],
        [628.27271,596.09375],
        [626.86646,600.3125],
        [625.61646,602.96875],
        [624.99146,602.8125],
        [622.33521,602.8125]
    ]
],ak:[
    [
        [170.46112,590.15502],
        [170.14862,672.65541],
        [171.71112,673.59291],
        [174.67989,673.74916],
        [176.08614,672.65541],
        [178.58615,672.65541],
        [178.74241,675.46792],
        [185.46119,682.03045],
        [185.92994,684.53046],
        [189.2112,682.65545],
        [189.83621,682.4992],
        [190.14871,679.53044],
        [191.55496,677.96793],
        [192.64872,677.81168],
        [194.52373,676.40542],
        [197.49249,678.43668],
        [198.1175,681.2492],
        [199.9925,682.34295],
        [201.08626,684.68671],
        [204.83628,686.40547],
        [208.11754,692.18675],
        [210.7738,695.93676],
        [212.96131,698.59303],
        [214.36757,702.18679],
        [219.21134,703.90555],
        [224.21137,705.93681],
        [225.14887,710.15558],
        [225.61762,713.12434],
        [224.68012,716.40561],
        [222.96136,718.59312],
        [221.39885,717.81187],
        [219.9926,714.8431],
        [217.33633,713.43685],
        [215.61758,712.34309],
        [214.83632,713.12434],
        [216.24258,715.78061],
        [216.39883,719.37437],
        [215.30507,719.84312],
        [213.43007,717.96812],
        [211.39881,716.71811],
        [211.86756,718.28062],
        [213.11756,719.99938],
        [212.33631,720.78063],
        [212.33631,720.78063],
        [211.55506,720.46813],
        [211.08631,719.84312],
        [210.61755,719.21812],
        [209.05505,716.56186],
        [209.05505,716.56186],
        [208.11754,714.37435],
        [208.11754,714.37435],
        [207.80504,715.62436],
        [207.18004,715.31185],
        [206.55503,714.99935],
        [205.93003,713.9056],
        [205.93003,713.9056],
        [207.64879,712.03059],
        [206.24253,710.62433],
        [206.24253,705.78056],
        [205.46128,705.78056],
        [204.68003,709.06182],
        [203.58627,709.53058],
        [202.64877,705.93681],
        [202.02376,702.34304],
        [201.24251,701.87429],
        [201.55501,707.34307],
        [201.55501,708.43682],
        [200.14875,707.18682],
        [196.71124,701.40554],
        [194.67998,700.93679],
        [194.05498,697.34302],
        [192.49247,694.53051],
        [190.92996,693.43675],
        [190.92996,691.24924],
        [192.96122,689.99924],
        [192.49247,689.68674],
        [189.99246,690.31174],
        [186.71119,687.96798],
        [184.21118,685.15546],
        [179.52366,682.65545],
        [175.61739,680.15544],
        [176.8674,677.03043],
        [176.8674,675.46792],
        [175.14864,677.03043],
        [172.33613,678.12418],
        [168.74236,677.03043],
        [163.27358,674.68667],
        [157.96106,674.68667],
        [157.33606,675.15542],
        [151.08603,671.4054],
        [149.05477,671.0929],
        [146.39851,665.46787],
        [142.96099,665.78037],
        [139.52347,667.18663],
        [139.99223,671.56165],
        [141.08598,668.74914],
        [142.02349,669.06164],
        [140.61723,673.28041],
        [143.74224,670.62415],
        [144.36725,672.18665],
        [140.61723,676.40542],
        [139.36722,676.09292],
        [138.89847,674.21791],
        [137.64847,673.43666],
        [136.39846,674.53042],
        [133.7422,672.81166],
        [130.77343,674.84292],
        [129.05468,676.87418],
        [125.77341,678.90544],
        [121.24214,678.74918],
        [120.77339,676.71793],
        [124.36715,676.09292],
        [124.36715,674.84292],
        [122.17964,674.21791],
        [123.11715,671.87415],
        [125.30466,668.12414],
        [125.30466,666.40538],
        [125.46091,665.62412],
        [129.67968,663.43661],
        [130.61718,664.68662],
        [133.27345,664.68662],
        [132.02344,662.18661],
        [128.42967,661.87411],
        [123.5859,664.53037],
        [121.24214,667.81163],
        [119.52338,670.31165],
        [118.42963,672.49916],
        [114.36711,673.90541],
        [111.39834,676.40542],
        [111.08584,677.96793],
        [113.27335,678.90544],
        [114.05461,680.93669],
        [111.39834,684.06171],
        [105.14832,688.12423],
        [97.648277,692.18675],
        [95.617017,693.2805],
        [90.460745,694.37426],
        [85.304465,696.56177],
        [87.023225,697.81177],
        [85.616965,699.21803],
        [85.148215,700.31178],
        [82.491955,699.37428],
        [79.366945,699.53053],
        [78.585685,701.71804],
        [77.648185,701.71804],
        [77.960685,699.37428],
        [74.523165,700.62429],
        [71.710655,701.56179],
        [68.42939,700.31178],
        [65.616877,702.18679],
        [62.491863,702.18679],
        [60.460603,703.4368],
        [58.898096,704.21805],
        [56.866837,703.90555],
        [54.366825,702.8118],
        [52.179315,703.4368],
        [51.241811,704.3743],
        [49.679303,703.28055],
        [49.679303,701.40554],
        [52.648067,700.15553],
        [58.741845,700.78054],
        [62.960615,699.21803],
        [64.991874,697.18677],
        [67.804387,696.56177],
        [69.523145,695.78051],
        [72.179408,695.93676],
        [73.741915,697.18677],
        [74.679415,696.87427],
        [76.866925,694.21801],
        [79.835695,693.2805],
        [83.116955,692.6555],
        [84.366965,692.343],
        [84.991965,692.81175],
        [85.773225,692.81175],
        [87.023225,689.21798],
        [90.929495,687.81173],
        [92.804505,684.21796],
        [94.992017,679.84294],
        [96.554527,678.43668],
        [96.867027,675.93667],
        [95.304517,677.18668],
        [92.023245,677.81168],
        [91.398245,675.46792],
        [90.148245,675.15542],
        [89.210735,676.09292],
        [89.054485,678.90544],
        [87.648225,678.74918],
        [86.241975,673.12416],
        [84.991965,674.37416],
        [83.898215,673.90541],
        [83.585715,672.0304],
        [79.679445,672.18665],
        [77.648185,673.28041],
        [75.148175,672.96791],
        [76.554425,671.56165],
        [77.023175,669.06164],
        [76.398175,667.18663],
        [77.804435,666.24913],
        [79.054435,666.09288],
        [78.429435,664.37412],
        [78.429435,660.15535],
        [77.491935,659.21784],
        [76.710675,660.6241],
        [70.773151,660.6241],
        [69.366895,659.37409],
        [68.741892,655.62408],
        [66.710632,652.18656],
        [66.710632,651.24906],
        [68.741892,650.4678],
        [68.898142,648.43654],
        [69.991897,647.34279],
        [69.210644,646.87404],
        [67.960638,647.34279],
        [66.866883,644.68653],
        [67.804387,639.84275],
        [72.179408,636.71774],
        [74.679415,635.15523],
        [76.554425,631.56147],
        [79.210695,630.31146],
        [81.710705,631.40522],
        [82.023205,633.74898],
        [84.366965,633.43647],
        [87.491975,631.09271],
        [89.054485,631.71772],
        [89.991985,632.34272],
        [91.554495,632.34272],
        [93.742007,631.09271],
        [94.523267,626.87394],
        [94.523267,626.87394],
        [94.835767,624.06143],
        [95.460767,623.59268],
        [96.085767,623.12393],
        [96.398267,622.65518],
        [96.398267,622.65518],
        [95.304517,620.78017],
        [92.804505,621.56142],
        [89.679485,622.34267],
        [87.804475,621.87392],
        [84.366965,620.15516],
        [79.523195,619.99891],
        [76.085675,616.40515],
        [76.554425,612.65513],
        [77.179435,610.31137],
        [75.148175,608.59261],
        [73.273163,604.99884],
        [73.741915,604.21759],
        [80.304445,603.74884],
        [82.335705,603.74884],
        [83.273205,604.68634],
        [83.898215,604.68634],
        [83.741965,603.12383],
        [87.491975,602.49883],
        [89.991985,602.81133],
        [91.398245,603.90509],
        [89.991985,605.93635],
        [89.523235,607.3426],
        [92.179505,608.90511],
        [97.023277,610.62387],
        [98.742037,609.68637],
        [96.554527,605.4676],
        [95.617017,602.34258],
        [96.554527,601.56133],
        [93.273257,599.68632],
        [92.804505,598.59256],
        [93.273257,597.03006],
        [92.492005,593.28004],
        [89.679485,588.74877],
        [87.335725,584.68625],
        [90.148245,582.81124],
        [93.273257,582.81124],
        [94.992017,583.43624],
        [99.054537,583.27999],
        [102.6483,579.84248],
        [103.74206,576.87371],
        [107.33583,574.52995],
        [108.89833,575.46746],
        [111.55459,574.84245],
        [115.14836,572.81119],
        [116.24212,572.65494],
        [117.17962,573.4362],
        [121.55464,573.27995],
        [124.2109,570.31118],
        [125.30466,570.31118],
        [128.74217,572.65494],
        [130.61718,574.6862],
        [130.14843,575.77996],
        [130.77343,576.87371],
        [132.33594,575.31121],
        [136.08596,575.62371],
        [136.39846,579.21747],
        [138.27347,580.62373],
        [145.1485,581.24873],
        [151.24228,585.31125],
        [152.64853,584.37375],
        [157.64856,586.87376],
        [159.67982,586.24876],
        [161.55483,585.4675],
        [166.24235,587.34251],
        [170.46112,590.15502]
    ],
    [
        [59.210598,618.1239],
        [61.241857,623.28018],
        [61.085606,624.21768],
        [58.273093,623.90518],
        [56.554335,619.99891],
        [54.835577,618.59266],
        [52.491816,618.59266],
        [52.335566,616.09264],
        [54.054324,613.74888],
        [55.148079,616.09264],
        [56.554335,617.4989],
        [59.210598,618.1239]
    ],
    [
        [56.710586,650.4678],
        [60.304353,651.24906],
        [63.898119,652.18656],
        [64.679373,653.12407],
        [63.116866,656.71783],
        [60.148102,656.56158],
        [56.866837,653.12407],
        [56.710586,650.4678]
    ],
    [
        [36.710493,636.87399],
        [37.804249,639.374],
        [38.898004,640.93651],
        [37.804249,641.71776],
        [35.772989,638.749],
        [35.772989,636.87399],
        [36.710493,636.87399]
    ],
    [
        [23.429182,707.49932],
        [26.710447,705.31181],
        [29.991712,704.3743],
        [32.491724,704.6868],
        [32.960476,706.24931],
        [34.835485,706.71806],
        [36.710493,704.84306],
        [36.397992,703.28055],
        [39.054254,702.65555],
        [41.866767,705.15556],
        [40.773012,706.87431],
        [36.554243,707.96807],
        [33.89798,707.49932],
        [30.304214,706.40556],
        [26.085444,707.81182],
        [24.522937,708.12432],
        [23.429182,707.49932]
    ],
    [
        [70.773151,703.1243],
        [72.335658,704.99931],
        [74.366915,703.4368],
        [72.960661,702.18679],
        [70.773151,703.1243]
    ],
    [
        [73.585664,706.09306],
        [74.679415,703.90555],
        [76.710675,704.21805],
        [75.929425,706.09306],
        [73.585664,706.09306]
    ],
    [
        [96.398267,704.21805],
        [97.804527,705.93681],
        [98.742037,704.84306],
        [97.960777,702.96805],
        [96.398267,704.21805]
    ],
    [
        [104.83581,692.18675],
        [105.92957,697.81177],
        [108.74208,698.59303],
        [113.58585,695.78051],
        [117.80462,693.2805],
        [116.24212,690.93674],
        [116.71087,688.59298],
        [114.67961,689.84299],
        [111.8671,689.06173],
        [113.4296,687.96798],
        [115.30461,688.74923],
        [119.05463,687.03047],
        [119.52338,685.62422],
        [117.17962,684.84296],
        [117.96087,682.96795],
        [115.30461,684.84296],
        [110.77334,688.28048],
        [106.08582,691.09299],
        [104.83581,692.18675]
    ],
    [
        [145.7735,672.96791],
        [148.11726,671.56165],
        [147.17976,669.84289],
        [145.461,670.7804],
        [145.7735,672.96791]
    ]
],az:[
    [
        [150.8118,526.19515],
        [148.27271,528.28125],
        [147.96021,529.6875],
        [148.42896,530.625],
        [166.71021,540.9375],
        [178.42896,548.28125],
        [192.64771,556.5625],
        [208.89771,566.25],
        [220.77271,568.59375],
        [245.05967,571.20814],
        [247.50579,559.11977],
        [251.13286,532.7886],
        [257.86462,481.67727],
        [261.9794,451.74794],
        [238.20589,448.1923],
        [211.91034,443.77288],
        [179.6,437.66664],
        [176.77589,455.15298],
        [176.33395,455.59492],
        [174.67667,458.13609],
        [172.24599,458.0256],
        [171.03065,455.37395],
        [168.379,455.04249],
        [167.49511,453.93764],
        [166.61123,453.93764],
        [165.72734,454.49007],
        [163.84909,455.48444],
        [163.73861,462.22405],
        [163.51763,463.88133],
        [162.96521,476.03474],
        [161.5289,478.13396],
        [160.97647,481.33804],
        [163.62812,486.08892],
        [164.84346,491.72368],
        [165.61686,492.71805],
        [166.61123,493.27048],
        [166.50074,495.48019],
        [164.95395,496.80601],
        [161.63938,498.46329],
        [159.76113,500.34155],
        [158.32482,503.87708],
        [157.77239,508.62796],
        [155.01025,511.27961],
        [153.02151,511.94253],
        [152.91103,517.57729],
        [152.46908,519.23457],
        [152.91103,520.00797],
        [156.44656,520.56039],
        [155.89413,523.21205],
        [154.45782,525.31127],
        [150.8118,526.19515]
    ]
],ar:[
    [
        [588.84904,485.07202],
        [585.13051,485.97831],
        [579.16429,485.53636],
        [579.8272,482.66374],
        [582.9208,480.01209],
        [583.36274,477.80238],
        [581.59497,474.92975],
        [570.98836,475.37169],
        [550.87999,476.25558],
        [528.34094,476.91849],
        [505.80189,477.36043],
        [507.34869,483.98957],
        [507.34868,491.94454],
        [508.67452,502.55125],
        [508.89549,539.12185],
        [511.1052,541.0001],
        [513.97782,539.67428],
        [516.62948,540.77913],
        [517.04542,550.75693],
        [539.16529,550.61963],
        [557.39783,549.84542],
        [567.18065,549.6545],
        [568.28793,547.63409],
        [568.01091,544.20338],
        [566.24638,541.33075],
        [567.79156,539.89525],
        [566.24638,537.4678],
        [566.90768,535.04197],
        [568.23027,529.62414],
        [570.66418,527.63055],
        [570.00127,525.42245],
        [573.53681,520.23044],
        [576.18846,518.90785],
        [576.07878,517.46426],
        [575.7449,515.69972],
        [578.50623,510.28836],
        [580.82885,509.07383],
        [581.20012,505.76092],
        [582.91153,504.56077],
        [583.73935,500.46822],
        [582.44278,496.592],
        [586.34904,494.29483],
        [586.88089,492.34321],
        [588.07482,488.21846],
        [588.84904,485.07202]
    ]
],ca:[
    [
        [149.83979,525.47333],
        [153.52718,525.00106],
        [154.96349,523.05694],
        [155.67103,521.18081],
        [152.60082,521.09371],
        [151.53844,519.38968],
        [152.29061,517.7324],
        [152.24598,511.78742],
        [154.38983,510.50408],
        [156.99686,508.00754],
        [157.39418,503.25666],
        [158.9856,499.87623],
        [160.86385,497.84287],
        [164.02331,496.18559],
        [165.25989,495.48019],
        [165.99081,494.04601],
        [165.15154,493.18337],
        [164.22304,491.72368],
        [163.31791,486.55424],
        [160.51115,481.49315],
        [160.60496,478.80015],
        [158.47779,475.66079],
        [143.98082,453.20886],
        [125.19828,425.45576],
        [103.52188,393.52758],
        [91.244552,374.6368],
        [92.98113,367.66971],
        [99.565647,342.5895],
        [107.41012,312.20598],
        [95.458567,308.98065],
        [82.421275,305.66608],
        [70.267871,301.6886],
        [62.975828,299.69986],
        [51.927278,296.82724],
        [45.112441,294.49626],
        [43.585205,299.0625],
        [43.428955,306.25],
        [38.428955,317.65625],
        [35.460205,320.15625],
        [35.147705,321.25],
        [33.428955,322.03125],
        [32.022705,326.09375],
        [31.241455,329.21875],
        [33.897705,333.28125],
        [35.460205,337.34375],
        [36.553955,340.78125],
        [36.241455,347.03125],
        [34.522705,350],
        [33.897705,355.625],
        [32.960205,359.21875],
        [34.678955,362.96875],
        [37.335205,367.34375],
        [39.522705,372.03125],
        [40.772705,375.9375],
        [40.460205,379.0625],
        [40.147705,379.53125],
        [40.147705,381.5625],
        [45.616455,387.65625],
        [45.147705,390],
        [44.522705,392.1875],
        [43.897705,394.0625],
        [44.053955,402.03125],
        [46.085205,405.625],
        [47.960205,408.125],
        [50.616455,408.59375],
        [51.553955,411.25],
        [50.460205,414.6875],
        [48.428955,416.25],
        [47.335205,416.25],
        [46.553955,420],
        [47.022705,422.8125],
        [50.147705,427.03125],
        [51.710205,432.1875],
        [53.116455,436.71875],
        [54.366455,439.6875],
        [57.647705,445.3125],
        [59.053955,447.8125],
        [59.522705,450.625],
        [61.085205,451.5625],
        [61.085205,453.90625],
        [60.303955,455.78125],
        [58.585205,462.65625],
        [58.116455,464.53125],
        [60.460205,467.1875],
        [64.522705,467.65625],
        [68.897705,469.375],
        [72.647705,471.40625],
        [75.460205,471.40625],
        [78.272705,474.375],
        [80.772705,479.0625],
        [81.866455,481.25],
        [85.616455,483.28125],
        [90.303955,484.0625],
        [91.710205,486.09375],
        [92.335205,489.21875],
        [90.928955,489.84375],
        [91.241455,490.78125],
        [94.366457,491.5625],
        [97.022707,491.71875],
        [99.835207,496.25],
        [103.58521,500.3125],
        [104.36646,502.5],
        [106.86646,506.5625],
        [107.17896,509.6875],
        [107.17896,518.75],
        [107.64771,520.46875],
        [117.33521,521.875],
        [136.39771,524.53125],
        [149.83979,525.47333]
    ],
    [
        [64.835518,477.42057],
        [66.085522,478.90495],
        [65.929272,480.15495],
        [62.804261,480.07683],
        [62.257384,478.90495],
        [61.632382,477.49869],
        [64.835518,477.42057]
    ],
    [
        [66.710524,477.42057],
        [67.882403,476.79557],
        [71.319915,478.82682],
        [74.288676,479.9987],
        [73.429298,480.62371],
        [69.054282,480.38933],
        [67.491777,478.82682],
        [66.710524,477.42057]
    ],
    [
        [86.710595,496.56126],
        [88.429345,498.82689],
        [89.210605,499.7644],
        [90.694985,500.31127],
        [91.241855,498.90502],
        [90.304355,497.18626],
        [87.726225,495.23313],
        [86.710595,495.38938],
        [86.710595,496.56126]
    ],
    [
        [85.304335,504.92066],
        [87.023095,507.96755],
        [88.194975,509.84256],
        [86.788715,510.07693],
        [85.538715,508.90505],
        [85.538715,508.90505],
        [84.835585,507.4988],
        [84.835585,507.10817],
        [84.835585,506.71755],
        [84.835585,504.99879],
        [84.835585,504.99879],
        [85.304335,504.92066]
    ]
],ct:[
    [
        [861.64413,325.68808],
        [861.03761,321.6244],
        [860.25636,317.40564],
        [858.69386,311.62438],
        [854.68093,312.49878],
        [833.58714,317.10816],
        [834.21214,320.3113],
        [835.61839,327.34257],
        [835.61839,335.15508],
        [834.52464,337.34259],
        [836.29571,339.38112],
        [841.08521,336.09375],
        [844.52271,332.96875],
        [846.39771,330.9375],
        [847.17896,331.5625],
        [849.83521,330.15625],
        [854.83521,329.0625],
        [861.64413,325.68808]
    ]
],co:[
    [
        [383.624,399.86545],
        [385.01569,379.29603],
        [353.99477,376.33416],
        [330.35054,373.72497],
        [294.33258,369.74752],
        [274.33468,367.31687],
        [271.79349,388.75109],
        [268.6999,410.40625],
        [265.07283,437.45625],
        [263.61756,448.1923],
        [263.37535,450.86307],
        [296.16617,454.53034],
        [332.64377,458.65411],
        [363.53472,461.71403],
        [379.58708,462.53204]
    ]
],de:[
    [
        [812.50495,374.375],
        [813.07451,372.34267],
        [813.09531,371.17809],
        [811.86834,371.09266],
        [809.83708,372.65517],
        [808.43083,374.06142],
        [809.83708,378.12393],
        [812.02459,383.59269],
        [814.05584,392.96771],
        [815.61835,399.06148],
        [820.46211,398.90523],
        [826.39866,397.73386],
        [824.21021,390.625],
        [823.27271,391.09375],
        [819.83521,388.75],
        [818.11646,384.21875],
        [816.24146,380.78125],
        [814.05396,379.84375],
        [812.02271,376.40625],
        [812.50495,374.375]
    ]
],dc:[
    [
        [840,450]
    ]
],fl:[
    [
        [747.79051,582.26014],
        [749.98034,589.3338],
        [753.58521,598.75],
        [758.74146,607.8125],
        [762.33521,613.90625],
        [767.02271,619.21875],
        [770.92896,622.8125],
        [772.49146,625.625],
        [771.39771,626.875],
        [770.61646,628.125],
        [773.42896,635.3125],
        [776.24146,638.125],
        [778.74146,643.28125],
        [782.17896,648.90625],
        [786.55396,656.875],
        [787.80396,664.21875],
        [788.27271,675.78125],
        [788.89771,677.5],
        [788.58521,680.78125],
        [786.24146,682.03125],
        [786.55396,683.90625],
        [785.92896,685.78125],
        [786.24146,688.125],
        [786.71021,690],
        [784.05396,693.125],
        [781.08521,694.53125],
        [777.33521,694.6875],
        [775.92896,696.25],
        [773.58521,697.1875],
        [772.33521,696.71875],
        [771.24146,695.78125],
        [770.92896,692.96875],
        [770.14771,689.6875],
        [766.86646,684.6875],
        [763.42896,682.5],
        [759.67896,682.1875],
        [758.89771,683.4375],
        [755.92896,679.21875],
        [755.30396,675.78125],
        [752.80396,671.875],
        [751.08521,670.78125],
        [749.52271,672.8125],
        [747.80396,672.5],
        [745.77271,667.65625],
        [742.96021,663.90625],
        [740.14771,658.75],
        [737.64771,655.78125],
        [734.21021,652.1875],
        [736.24146,649.84375],
        [739.36646,644.53125],
        [739.21021,642.96875],
        [734.83521,642.03125],
        [733.27271,642.65625],
        [733.58521,643.28125],
        [736.08521,644.21875],
        [734.67896,648.59375],
        [733.89771,649.0625],
        [732.17896,645.15625],
        [730.92896,640.46875],
        [730.61646,637.8125],
        [732.02271,633.28125],
        [732.02271,624.0625],
        [729.05396,620.46875],
        [727.80396,617.5],
        [722.80396,616.25],
        [720.92896,615.625],
        [719.36646,613.125],
        [716.08521,611.5625],
        [714.99146,608.28125],
        [712.33521,607.34375],
        [709.99146,603.75],
        [705.92896,602.34375],
        [703.11646,600.9375],
        [700.61646,600.9375],
        [696.71021,601.71875],
        [696.55396,603.59375],
        [697.33521,604.53125],
        [696.86646,605.625],
        [693.89771,605.46875],
        [690.30396,608.90625],
        [686.86646,610.78125],
        [683.11646,610.78125],
        [679.99146,612.03125],
        [679.67896,609.375],
        [678.11646,607.5],
        [675.30396,606.40625],
        [673.74146,605],
        [665.92896,601.25],
        [658.58521,599.53125],
        [654.36646,600.15625],
        [648.58521,600.625],
        [642.80396,602.65625],
        [639.44116,603.2487],
        [639.2112,595.46836],
        [636.7112,593.59336],
        [634.99245,591.87461],
        [635.30495,588.90585],
        [645.14871,587.65585],
        [669.83625,584.84335],
        [676.39876,584.21835],
        [681.65283,584.48924],
        [684.15283,588.23925],
        [685.55908,589.6455],
        [693.38621,590.14347],
        [703.84384,589.51847],
        [724.63625,588.26847],
        [729.89971,587.61667],
        [734.32377,587.64347],
        [734.48002,590.45597],
        [738.17604,591.23722],
        [738.48854,586.59132],
        [736.92604,582.21631],
        [737.84893,581.50811],
        [742.7905,581.94764],
        [747.79051,582.26014]
    ],
    [
        [759.91605,710.23387],
        [762.25981,709.60887],
        [763.50981,709.3745],
        [764.91607,707.10886],
        [767.1817,705.54636],
        [768.43171,706.01511],
        [770.07234,706.32761],
        [770.46296,707.34324],
        [767.10358,708.51512],
        [763.04106,709.92137],
        [760.77543,711.09325],
        [759.91605,710.23387]
    ],
    [
        [772.96297,705.39011],
        [774.13485,706.40574],
        [776.79111,704.37448],
        [781.94738,700.31197],
        [785.54114,696.56195],
        [787.96302,690.15568],
        [788.90053,688.51505],
        [789.05678,685.23379],
        [788.35365,685.70254],
        [787.41615,688.43692],
        [786.00989,692.89006],
        [782.88488,697.96821],
        [778.66612,702.03072],
        [775.38486,703.90573],
        [772.96297,705.39011]
    ]
],ga:[
    [
        [684.21127,497.65572],
        [679.52376,498.43697],
        [671.39875,499.53072],
        [663.11749,500.39009],
        [663.11749,502.49947],
        [663.27374,504.53073],
        [663.89874,507.81198],
        [667.18,515.46824],
        [669.52375,524.99951],
        [670.93,530.93702],
        [672.4925,535.62452],
        [673.89876,542.34328],
        [675.93001,548.43704],
        [678.43001,551.7183],
        [678.89876,554.99955],
        [680.77377,555.7808],
        [680.93002,557.81206],
        [679.21126,562.49956],
        [678.74251,565.62457],
        [678.58626,567.49957],
        [680.14877,571.71833],
        [680.46127,576.87458],
        [679.68001,579.21834],
        [680.30502,579.99959],
        [681.71127,580.78084],
        [682.33627,584.06209],
        [684.83627,587.8121],
        [686.24252,589.21835],
        [693.89879,589.3746],
        [704.35642,588.7496],
        [725.14883,587.4996],
        [730.41229,586.8478],
        [734.83635,586.8746],
        [734.9926,589.6871],
        [737.4926,590.46835],
        [737.8051,586.2496],
        [736.2426,581.87459],
        [737.33635,580.31209],
        [742.96136,581.09334],
        [747.77218,581.40049],
        [747.02271,575.3125],
        [749.21021,565.625],
        [750.61646,561.5625],
        [750.14771,559.0625],
        [753.37052,553.02719],
        [752.8773,551.72075],
        [751.02793,552.40174],
        [748.52793,551.15173],
        [747.90293,549.12048],
        [746.65293,545.68298],
        [744.46542,543.65172],
        [741.96542,543.02672],
        [740.40292,538.33922],
        [737.5758,532.21624],
        [733.5133,530.34123],
        [731.48204,528.46623],
        [730.23204,525.96623],
        [728.20079,524.09122],
        [726.01329,522.84122],
        [723.82578,520.02872],
        [720.85703,517.84122],
        [716.48202,516.12246],
        [716.01327,514.71621],
        [713.66952,511.90371],
        [713.20077,510.49745],
        [709.91951,505.75374],
        [706.63826,505.90999],
        [702.64657,502.96822],
        [701.39657,501.71822],
        [701.08407,499.99947],
        [701.86532,498.12447],
        [704.13825,496.93067],
        [703.04227,495.74936],
        [703.11755,495.46821],
        [697.49254,496.40571],
        [690.77378,497.18696],
        [684.21127,497.65572]
    ]
],hi:[
    [
        [242.96145,653.59282],
        [244.83646,650.1553],
        [247.02397,649.8428],
        [247.33647,650.62405],
        [245.30521,653.59282],
        [242.96145,653.59282]
    ],
    [
        [252.80525,649.99905],
        [258.74278,652.49906],
        [260.77404,652.18656],
        [262.33654,648.43654],
        [261.71154,645.15528],
        [257.64902,644.68653],
        [253.74275,646.40528],
        [252.80525,649.99905]
    ],
    [
        [282.49289,659.6866],
        [286.08665,664.99912],
        [288.43041,664.68662],
        [289.52417,664.21787],
        [290.93042,665.46787],
        [294.52419,665.31162],
        [295.4617,663.90537],
        [292.64918,662.18661],
        [290.77417,658.59284],
        [288.74291,655.15533],
        [283.11789,657.96784],
        [282.49289,659.6866]
    ],
    [
        [302.02423,668.28039],
        [303.27423,666.40538],
        [307.8055,667.34288],
        [308.43051,666.87413],
        [314.36803,667.49913],
        [314.05553,668.74914],
        [311.55552,670.15539],
        [307.33675,669.84289],
        [302.02423,668.28039]
    ],
    [
        [307.1805,673.28041],
        [309.05551,677.03043],
        [312.02427,675.93667],
        [312.33677,674.37416],
        [310.77427,672.3429],
        [307.1805,672.0304],
        [307.1805,673.28041]
    ],
    [
        [313.89928,672.18665],
        [316.08679,669.37414],
        [320.61806,671.7179],
        [324.83683,672.81166],
        [329.0556,675.46792],
        [329.0556,677.34293],
        [325.61809,679.06169],
        [320.93056,679.99919],
        [318.5868,678.59293],
        [313.89928,672.18665]
    ],
    [
        [329.99311,687.18672],
        [331.55561,685.93672],
        [334.83688,687.49923],
        [342.18066,690.93674],
        [345.46193,692.968],
        [347.02443,695.31176],
        [348.89944,699.53053],
        [352.80571,702.03054],
        [352.49321,703.28055],
        [348.74319,706.40556],
        [344.68067,707.81182],
        [343.27442,707.18682],
        [340.30565,708.90557],
        [337.96189,712.03059],
        [335.77438,714.8431],
        [334.05562,714.68685],
        [330.61811,712.18684],
        [330.30561,707.81182],
        [330.93061,705.46806],
        [329.3681,699.99928],
        [327.33684,698.28052],
        [327.18059,695.78051],
        [329.3681,694.84301],
        [331.39936,691.87425],
        [331.86811,690.93674],
        [330.30561,689.21798],
        [329.99311,687.18672]
    ]
],id:[
    [
        [153.93546,322.36183],
        [158.21433,305.44513],
        [162.41278,288.31988],
        [163.73861,284.23191],
        [166.16929,278.48667],
        [164.95395,276.27696],
        [162.52326,276.38744],
        [161.74987,275.39307],
        [162.19181,274.28822],
        [162.52326,271.30511],
        [166.8322,266.0018],
        [168.59997,265.55986],
        [169.70482,264.45501],
        [170.25725,261.36141],
        [171.14113,260.6985],
        [174.89764,255.06374],
        [178.65415,250.86529],
        [178.87512,247.21927],
        [175.56055,244.6781],
        [174.28997,240.42441],
        [174.67667,231.08839],
        [178.21221,215.17847],
        [182.52114,195.07011],
        [186.16716,182.03283],
        [186.90359,178.35693],
        [199.46477,180.80043],
        [195.44586,201.58861],
        [198.29511,209.03576],
        [197.27949,213.45518],
        [199.20237,217.8746],
        [202.29597,219.51064],
        [206.60703,228.98902],
        [209.21193,232.67966],
        [209.80898,233.78452],
        [213.12355,234.88938],
        [213.56549,237.34342],
        [206.8705,253.58267],
        [207.18071,256.78888],
        [209.76649,259.57226],
        [211.58101,260.03758],
        [216.2214,256.54454],
        [216.57411,256.0601],
        [216.72495,256.87813],
        [216.96929,260.87471],
        [219.46585,273.33834],
        [222.80378,275.92412],
        [223.22235,276.74214],
        [225.30033,279.10695],
        [224.54818,281.8011],
        [225.21109,285.42587],
        [227.09148,286.30976],
        [229.14608,284.72048],
        [231.64262,284.25516],
        [234.89133,285.80196],
        [237.32201,285.22828],
        [240.98928,285.07317],
        [244.83502,286.61997],
        [247.48668,286.33314],
        [248.39394,284.08093],
        [250.80124,282.48739],
        [251.50665,284.12343],
        [252.10369,286.28638],
        [254.33465,288.74044],
        [250.68863,311.91902],
        [245.71674,339.95691],
        [241.69674,339.64888],
        [233.78641,338.16795],
        [224.30804,336.40018],
        [212.55195,334.10123],
        [200.44316,331.68117],
        [192.24386,329.90278],
        [183.29454,328.29012],
        [174.36859,326.56696],
        [152.51445,322.36904],
        [160.6948,323.81524],
        [153.93546,322.36183]
    ]
],il:[
    [
        [614.80311,443.17095],
        [614.80311,439.68688],
        [615.05251,434.98284],
        [617.34968,431.95099],
        [619.06844,428.31065],
        [621.56844,424.57718],
        [621.20937,419.50056],
        [619.27127,416.07656],
        [619.17812,412.84188],
        [619.84969,407.74873],
        [619.05191,400.81061],
        [618.02126,385.5612],
        [616.77126,371.04646],
        [615.87985,359.79681],
        [615.61646,358.90625],
        [614.83521,356.40625],
        [613.58521,352.8125],
        [612.02271,351.09375],
        [610.61646,348.59375],
        [610.39071,343.2885],
        [600.81946,344.55682],
        [574.52391,346.2141],
        [566.127,345.79979],
        [566.34797,348.09236],
        [568.55768,348.75527],
        [569.44156,349.86012],
        [569.8835,351.62789],
        [573.64001,354.94246],
        [574.30293,357.15217],
        [573.64001,360.46674],
        [571.87224,364.00227],
        [571.20933,366.43295],
        [568.99962,368.20072],
        [567.23185,368.86364],
        [562.14952,370.18946],
        [561.4866,371.95723],
        [560.82369,373.94597],
        [561.4866,375.2718],
        [563.25437,376.8186],
        [563.0334,380.79607],
        [561.26563,382.34287],
        [560.60272,383.88967],
        [560.60272,386.54132],
        [558.83495,386.98326],
        [557.28815,388.08812],
        [557.06718,389.41395],
        [557.28815,391.40269],
        [555.63087,392.67326],
        [554.6365,395.38017],
        [555.07844,398.9157],
        [557.28815,405.98678],
        [564.35923,413.27882],
        [569.66253,416.81436],
        [569.44156,421.01281],
        [570.32545,422.33864],
        [576.51264,422.78058],
        [579.16429,424.10641],
        [578.50138,427.64194],
        [576.29167,433.38719],
        [575.62875,436.48079],
        [577.83846,440.23729],
        [584.02565,445.31963],
        [588.44508,445.98254],
        [590.43381,450.84391],
        [592.42255,453.9375],
        [591.53867,456.81012],
        [593.08547,460.7876],
        [594.85324,462.77634],
        [596.73252,462.01056],
        [597.39623,459.91978],
        [599.36438,458.53006],
        [602.4924,457.46635],
        [605.47768,458.60667],
        [608.25713,459.63732],
        [609.02185,459.4345],
        [608.95875,458.23409],
        [607.9281,455.5613],
        [608.35028,453.26412],
        [610.55431,451.74819],
        [612.83496,450.79416],
        [613.95876,450.38852],
        [613.39686,449.10846],
        [612.66218,447.01411],
        [613.86561,445.79415],
        [614.80311,443.17095]
    ]
],"in":[
    [
        [615.39807,442.44979],
        [615.46117,439.68688],
        [615.92992,435.31187],
        [618.11742,432.49937],
        [619.83618,428.74936],
        [622.33618,424.68686],
        [621.86743,419.06185],
        [620.14868,416.40559],
        [619.83618,413.28059],
        [620.61743,407.96808],
        [620.14868,401.24932],
        [618.89867,385.78055],
        [617.64867,370.93678],
        [616.71068,359.60901],
        [619.67896,360.46875],
        [621.08521,361.40625],
        [622.17896,361.09375],
        [624.21021,359.21875],
        [626.94508,357.65588],
        [631.86744,357.49926],
        [653.11748,355.31175],
        [658.5066,354.79643],
        [659.95943,370.21862],
        [664.0685,405.82715],
        [664.64693,411.40559],
        [664.28786,413.59309],
        [665.47475,415.32837],
        [665.56791,416.65499],
        [663.131,418.20097],
        [659.71003,419.70036],
        [656.61507,420.23222],
        [656.03664,424.93626],
        [651.61506,428.13787],
        [648.91223,432.01409],
        [649.22473,434.31127],
        [648.66284,435.79413],
        [645.4477,435.79413],
        [643.91524,434.23163],
        [641.50537,435.45159],
        [638.91221,436.90442],
        [639.06847,439.85664],
        [637.91463,440.10604],
        [637.46241,439.12197],
        [635.36805,437.66914],
        [632.22651,438.96572],
        [630.72712,441.87136],
        [629.3374,441.09011],
        [627.93115,439.54414],
        [623.61622,440.01289],
        [618.21057,440.95039],
        [615.39807,442.44979]
    ]
],ia:[
    [
        [565.30564,346.54395],
        [565.47056,348.42139],
        [567.68027,349.52301],
        [568.7835,350.73753],
        [569.11576,351.95692],
        [572.87227,355.05214],
        [573.53519,357.15217],
        [572.7626,359.91836],
        [571.32386,363.34421],
        [570.55127,365.99424],
        [568.45124,367.54266],
        [566.79314,368.0959],
        [561.49146,369.5314],
        [560.82854,371.73788],
        [560.05595,373.94597],
        [560.60919,375.2718],
        [562.26728,376.92828],
        [562.26566,380.46704],
        [560.16886,382.01384],
        [559.72531,383.45096],
        [559.72531,385.88326],
        [558.28657,386.3252],
        [556.63009,387.64941],
        [556.18977,389.08492],
        [556.63009,390.74463],
        [555.30184,391.90877],
        [553.08485,389.30751],
        [551.65096,386.76877],
        [543.58957,387.54135],
        [533.75878,388.09297],
        [509.56002,388.75751],
        [496.96143,388.97848],
        [487.90162,389.19945],
        [486.62988,389.31664],
        [485.03061,384.99453],
        [484.80964,378.58636],
        [483.26284,374.60888],
        [482.59993,369.52655],
        [480.39022,365.99101],
        [479.50634,361.35062],
        [476.85468,354.05857],
        [475.74983,348.86575],
        [474.424,346.76653],
        [472.8772,344.11488],
        [474.64497,339.91643],
        [475.9708,334.39215],
        [473.31915,332.40341],
        [472.8772,329.75176],
        [473.76109,327.32107],
        [475.41838,327.32107],
        [486.57741,327.32107],
        [534.52813,326.65816],
        [553.73968,325.99525],
        [555.52847,328.65013],
        [557.29948,331.18402],
        [557.7398,331.96147],
        [555.97041,334.61797],
        [556.41074,338.69866],
        [558.84143,342.45517],
        [561.71081,344.21808],
        [564.03505,344.44067],
        [565.30564,346.54395]
    ]
],ks:[
    [
        [504.20834,465.91243],
        [492.01239,466.11002],
        [447.46581,465.66809],
        [404.39959,463.67933],
        [380.59416,462.464],
        [384.59926,399.91008],
        [405.702,400.68347],
        [444.81359,402.00929],
        [487.46129,402.45124],
        [492.38638,402.45124],
        [495.52461,405.56821],
        [498.19964,405.78918],
        [499.06014,406.82817],
        [499.06014,408.77016],
        [497.29238,410.31696],
        [496.85043,412.83688],
        [498.99428,416.30656],
        [501.42497,419.33428],
        [503.85565,421.25716],
        [504.87125,432.06136],
        [504.20834,465.91243]
    ]
],ky:[
    [
        [715.30124,439.51411],
        [713.05447,442.10725],
        [708.99196,445.54476],
        [704.8363,451.2494],
        [703.11755,452.96815],
        [703.11755,454.9994],
        [699.36754,457.03065],
        [693.89879,460.31191],
        [690.49702,460.68368],
        [640.36505,465.41858],
        [625.13293,467.13733],
        [620.66639,467.63288],
        [616.92751,467.60608],
        [616.70816,471.68512],
        [608.8025,471.82484],
        [602.08374,472.44984],
        [592.00224,472.64856],
        [593.851,472.43435],
        [595.95809,470.7313],
        [597.94683,469.62645],
        [598.1678,466.53285],
        [599.05169,464.76508],
        [597.49864,462.31115],
        [598.27364,460.46816],
        [600.46115,458.74941],
        [602.4924,458.12441],
        [605.14865,459.37441],
        [608.58616,460.62441],
        [609.67991,460.31191],
        [609.83616,458.12441],
        [608.58616,455.78065],
        [608.89866,453.59315],
        [610.77366,452.1869],
        [613.27367,451.5619],
        [614.83617,450.9369],
        [614.05492,449.21814],
        [613.42992,447.34314],
        [614.52367,446.56189],
        [615.53929,443.35875],
        [618.42992,441.71813],
        [624.05493,440.78063],
        [627.49244,440.31188],
        [628.89869,442.18688],
        [630.61744,442.96813],
        [632.33619,439.84313],
        [635.1487,438.43688],
        [637.0237,439.99938],
        [637.80495,441.09313],
        [639.83621,440.62438],
        [639.67995,437.34313],
        [642.49246,435.78062],
        [643.58621,434.99937],
        [644.67996,436.56187],
        [649.21122,436.56187],
        [649.99247,434.53062],
        [649.67997,432.34312],
        [652.49247,428.90561],
        [657.02373,425.15561],
        [657.49248,420.7806],
        [660.14874,420.4681],
        [663.89874,418.74935],
        [666.555,416.87434],
        [666.24249,414.99934],
        [664.83624,413.59309],
        [665.38312,411.48372],
        [669.3675,411.24934],
        [671.71125,410.46809],
        [674.52376,412.03059],
        [676.08626,416.24934],
        [681.71127,416.56184],
        [683.43002,418.2806],
        [685.46127,418.43685],
        [687.80503,417.0306],
        [690.77378,417.49935],
        [692.02378,418.9056],
        [694.68004,416.40559],
        [696.39879,415.15559],
        [697.96129,415.15559],
        [698.58629,417.81185],
        [700.30505,418.74935],
        [702.64578,420.89028],
        [702.80203,426.20279],
        [703.58328,427.76529],
        [706.08329,429.17154],
        [706.70829,431.35905],
        [709.52079,434.9528],
        [712.02079,437.60906],
        [715.30124,439.51411]
    ]
],la:[
    [
        [599.72251,608.82814],
        [598.72751,606.29948],
        [597.62265,603.31071],
        [594.41777,599.88809],
        [595.30326,593.36377],
        [595.18874,592.26054],
        [593.96935,592.59119],
        [586.01439,593.47345],
        [561.82372,593.91702],
        [561.16243,591.60248],
        [562.04469,583.42978],
        [565.24959,577.68292],
        [570.11256,569.28278],
        [569.55771,566.96501],
        [570.77224,566.30695],
        [571.21581,564.41981],
        [569.00609,562.43268],
        [568.89804,560.55524],
        [567.12865,556.35517],
        [566.68751,550.61315],
        [557.28815,550.72283],
        [538.72658,551.60672],
        [517.26477,551.63434],
        [517.29239,560.8875],
        [517.9553,569.94731],
        [518.61822,573.70382],
        [521.0489,577.6813],
        [521.93278,582.54267],
        [526.13123,587.84597],
        [526.3522,590.93957],
        [527.01512,591.60248],
        [526.3522,599.77841],
        [523.47958,604.63977],
        [525.02638,606.62851],
        [524.36346,609.05919],
        [523.70055,616.13027],
        [522.37472,619.22386],
        [522.49308,622.71927],
        [527.02271,621.25],
        [534.83521,620.9375],
        [544.83521,624.375],
        [551.08521,625.46875],
        [554.67896,624.0625],
        [557.80396,625.15625],
        [560.92896,626.09375],
        [561.71021,624.0625],
        [558.58521,622.96875],
        [556.08521,623.4375],
        [553.42896,621.875],
        [553.42896,621.875],
        [553.58521,620.625],
        [554.21021,620.46875],
        [554.83521,620.3125],
        [557.17896,619.53125],
        [557.17896,619.53125],
        [558.89771,620.9375],
        [560.61646,620],
        [563.74146,620.625],
        [565.14771,622.96875],
        [565.46021,625.15625],
        [569.83521,625.46875],
        [571.55396,627.1875],
        [570.77271,628.75],
        [569.52271,629.53125],
        [571.08521,631.09375],
        [579.21021,634.53125],
        [582.64771,633.28125],
        [583.58521,630.9375],
        [586.08521,630.3125],
        [587.80396,628.90625],
        [589.05396,629.84375],
        [589.83521,632.65625],
        [587.64771,633.4375],
        [588.27271,634.0625],
        [591.55396,632.8125],
        [593.74146,629.53125],
        [594.52271,629.0625],
        [592.49146,628.75],
        [593.27271,627.1875],
        [593.11646,625.78125],
        [595.14771,625.3125],
        [596.24146,624.0625],
        [596.86646,624.84375],
        [596.86646,624.84375],
        [596.71021,627.8125],
        [597.49146,627.8125],
        [598.27271,627.8125],
        [601.55396,628.4375],
        [601.55396,628.4375],
        [605.46021,630.3125],
        [606.39771,631.71875],
        [609.21021,631.71875],
        [610.30396,632.65625],
        [612.49146,629.6875],
        [612.49146,628.28125],
        [611.24146,628.28125],
        [607.96021,625.625],
        [602.33521,624.84375],
        [599.21021,622.65625],
        [600.30396,620],
        [602.49146,620.3125],
        [602.64771,619.6875],
        [600.92896,618.75],
        [600.92896,618.28125],
        [604.05396,618.28125],
        [605.77271,615.3125],
        [604.52271,613.4375],
        [604.21021,610.78125],
        [602.80396,610.9375],
        [600.92896,612.96875],
        [600.30396,615.46875],
        [597.33521,614.84375],
        [596.39771,613.125],
        [598.11646,611.25],
        [600.06958,609.53126],
        [599.72251,608.82814]
    ]
],me:[
    [
        [909.99146,226.40625],
        [911.86646,228.4375],
        [914.05396,232.03125],
        [914.05396,233.90625],
        [912.02271,238.4375],
        [910.14771,239.0625],
        [906.86646,242.03125],
        [902.17896,247.34375],
        [902.17896,247.34375],
        [901.55396,247.34375],
        [900.92896,247.34375],
        [900.30396,247.34375],
        [899.99146,245.3125],
        [899.99146,245.3125],
        [898.27271,245.46875],
        [897.33521,246.875],
        [894.99146,248.28125],
        [894.05396,249.6875],
        [895.61646,251.09375],
        [895.14771,251.71875],
        [894.67896,254.375],
        [892.80396,254.21875],
        [892.80396,252.65625],
        [892.49146,251.40625],
        [891.08521,251.71875],
        [889.36646,248.59375],
        [887.33521,249.84375],
        [888.58521,251.25],
        [888.89771,252.34375],
        [888.11646,253.59375],
        [888.42896,256.5625],
        [888.58521,258.125],
        [887.02271,260.625],
        [884.21021,261.09375],
        [883.89771,263.90625],
        [878.74146,266.875],
        [877.49146,267.34375],
        [875.92896,265.9375],
        [872.96021,269.375],
        [873.89771,272.5],
        [872.49146,273.75],
        [872.33521,277.96875],
        [871.24952,284.01862],
        [868.86968,282.90135],
        [868.40092,279.93259],
        [864.65092,278.83884],
        [864.33842,276.18258],
        [857.30715,253.52628],
        [853.24908,240.34303],
        [854.62208,240.22882],
        [856.08521,240.625],
        [856.08521,238.125],
        [856.86646,232.8125],
        [859.36646,228.28125],
        [860.77271,224.375],
        [858.89771,222.03125],
        [858.89771,216.25],
        [859.67896,215.3125],
        [860.46021,212.65625],
        [860.30396,211.25],
        [860.14771,206.5625],
        [861.86646,201.875],
        [864.67896,193.28125],
        [866.71021,189.21875],
        [867.96021,189.21875],
        [869.21021,189.375],
        [869.21021,190.46875],
        [870.46021,192.65625],
        [873.11646,193.28125],
        [873.89771,192.5],
        [873.89771,191.5625],
        [877.80396,188.75],
        [879.52271,187.03125],
        [880.92896,187.1875],
        [886.71021,189.53125],
        [888.58521,190.46875],
        [897.33521,219.375],
        [903.11646,219.375],
        [903.89771,221.25],
        [904.05396,225.9375],
        [906.86646,228.125],
        [907.64771,228.125],
        [907.80396,227.65625],
        [907.33521,226.5625],
        [909.99146,226.40625]
    ],
    [
        [889.76025,255.5448],
        [891.24463,254.06042],
        [892.57276,255.07605],
        [893.11964,257.41981],
        [891.47901,258.27919],
        [889.76025,255.5448]
    ],
    [
        [896.24465,249.84166],
        [897.9634,251.63854],
        [897.9634,251.63854],
        [899.21341,251.71666],
        [899.21341,251.40416],
        [899.21341,251.09166],
        [899.44778,249.45103],
        [899.44778,249.45103],
        [900.30716,248.66978],
        [899.52591,246.95102],
        [897.57278,247.65415],
        [896.24465,249.84166]
    ]
],md:[
    [
        [826.61706,398.42399],
        [820.68146,399.67297],
        [815.06996,399.82922],
        [813.2881,392.96771],
        [811.25685,383.59269],
        [809.06934,378.12393],
        [807.82408,373.87281],
        [800.56927,375.44087],
        [786.19094,378.1697],
        [749.99293,385.46788],
        [751.08637,390.31181],
        [752.02387,395.78056],
        [752.33637,395.46806],
        [754.36763,393.12431],
        [756.55513,390.59426],
        [758.89888,389.9993],
        [760.30514,388.59305],
        [762.02389,386.09305],
        [763.27389,386.71805],
        [766.08639,386.40555],
        [768.5864,384.3743],
        [770.52612,382.96967],
        [772.3096,382.50092],
        [773.89891,383.59305],
        [776.71141,384.9993],
        [778.58641,386.71805],
        [779.75829,388.20243],
        [783.74267,389.84305],
        [783.74267,392.65556],
        [789.05518,393.90556],
        [790.16131,394.4294],
        [791.52596,392.46897],
        [794.31148,394.37319],
        [793.07608,396.77205],
        [792.33643,400.62432],
        [790.61768,403.12432],
        [790.61768,405.15558],
        [791.24268,406.87433],
        [796.13715,408.18465],
        [800.30396,408.125],
        [803.27271,409.0625],
        [805.30396,409.375],
        [806.24146,407.34375],
        [804.83521,405.3125],
        [804.83521,403.59375],
        [802.49146,401.5625],
        [800.46021,396.25],
        [801.71021,391.09375],
        [801.55396,389.0625],
        [800.30396,387.8125],
        [800.30396,387.8125],
        [801.71021,386.25],
        [801.71021,385.625],
        [801.71021,385],
        [802.17896,383.59375],
        [802.17896,383.59375],
        [804.05396,382.34375],
        [805.92896,380.78125],
        [806.39771,381.71875],
        [804.99146,383.28125],
        [803.74146,386.875],
        [804.05396,387.96875],
        [805.77271,388.28125],
        [806.24146,393.59375],
        [804.21021,394.53125],
        [804.52271,397.96875],
        [804.99146,397.8125],
        [806.08521,395.9375],
        [807.64771,397.65625],
        [806.08521,398.90625],
        [805.77271,402.1875],
        [808.27271,405.46875],
        [812.02271,405.9375],
        [813.58521,405.15625],
        [816.71344,409.19919],
        [818.02633,409.71754],
        [824.45732,407.0142],
        [826.39771,403.125],
        [826.61706,398.42399]
    ],
    [
        [810.54123,407.10783],
        [811.63498,409.52971],
        [811.79123,411.24847],
        [812.88498,413.04535],
        [812.88498,413.04535],
        [813.74436,412.18597],
        [813.74436,411.87347],
        [813.74436,411.56097],
        [813.04124,408.90471],
        [813.04124,408.90471],
        [812.33811,406.63907],
        [810.54123,407.10783]
    ]
],ma:[
    [
        [887.53146,319.69638],
        [889.63069,319.03346],
        [890.07264,317.37618],
        [891.06701,317.48666],
        [892.06138,319.69638],
        [890.84604,320.13832],
        [887.08952,320.24881],
        [887.53146,319.69638]
    ],
    [
        [878.47163,320.46978],
        [880.68134,317.92861],
        [882.22815,317.92861],
        [883.99592,319.36492],
        [881.67572,320.35929],
        [879.57649,321.35366],
        [878.47163,320.46978]
    ],
    [
        [844.83716,299.2175],
        [861.7122,295.15499],
        [863.89971,294.52999],
        [865.93096,291.40499],
        [869.54267,289.79735],
        [872.33521,294.0625],
        [869.99146,299.0625],
        [869.67896,300.46875],
        [871.55396,302.96875],
        [872.64771,302.1875],
        [874.36646,302.1875],
        [876.55396,304.6875],
        [880.30396,310.46875],
        [883.74146,310.9375],
        [885.92896,310],
        [887.64771,308.28125],
        [886.86646,305.625],
        [884.83521,304.0625],
        [883.42896,304.84375],
        [882.49146,303.59375],
        [882.96021,303.125],
        [884.99146,302.96875],
        [886.71021,303.75],
        [888.58521,306.09375],
        [889.52271,308.90625],
        [889.83521,311.25],
        [885.77271,312.65625],
        [882.02271,314.53125],
        [878.27271,318.90625],
        [876.39771,320.3125],
        [876.39771,319.375],
        [878.74146,317.96875],
        [879.21021,316.25],
        [878.42896,313.28125],
        [875.61646,314.6875],
        [874.83521,316.09375],
        [875.30396,318.28125],
        [873.30679,319.24819],
        [870.65153,314.87258],
        [867.37027,310.65382],
        [865.36907,308.90201],
        [859.05445,310.71542],
        [854.13255,311.73104],
        [833.03876,316.34042],
        [832.64964,311.56128],
        [833.27464,301.32689],
        [838.27465,300.46751],
        [844.83716,299.2175]
    ]
],mi:[
    [
        [579.82856,230.97629],
        [581.59633,228.98755],
        [583.69556,228.21415],
        [588.88839,224.45763],
        [591.0981,223.9052],
        [591.54005,224.34715],
        [586.56819,229.31901],
        [583.3641,231.19726],
        [581.37536,232.08115],
        [579.82856,230.97629]
    ],
    [
        [663.11884,262.0292],
        [663.74384,264.45108],
        [666.86885,264.60733],
        [668.11886,263.43545],
        [668.11886,263.43545],
        [668.04073,262.0292],
        [667.72823,261.87295],
        [667.41573,261.7167],
        [666.16573,260.07607],
        [666.16573,260.07607],
        [664.05635,260.31044],
        [662.49384,260.46669],
        [662.18134,261.56045],
        [663.11884,262.0292]
    ],
    [
        [692.17896,322.96875],
        [689.05396,315],
        [686.86646,306.25],
        [684.52271,303.125],
        [682.02271,301.40625],
        [680.46021,302.5],
        [676.71021,304.21875],
        [674.83521,309.0625],
        [672.17896,312.65625],
        [671.08521,313.28125],
        [669.67896,312.65625],
        [669.67896,312.65625],
        [667.17896,311.25],
        [667.33521,310.625],
        [667.49146,310],
        [667.80396,305.78125],
        [667.80396,305.78125],
        [671.08521,304.53125],
        [671.86646,301.25],
        [672.49146,298.75],
        [674.83521,297.1875],
        [674.52271,287.5],
        [672.96021,285.3125],
        [671.71021,284.53125],
        [670.92896,282.5],
        [671.71021,281.71875],
        [673.27271,282.03125],
        [673.42896,280.46875],
        [671.08521,278.28125],
        [669.83521,275.78125],
        [667.33521,275.78125],
        [662.96021,274.375],
        [657.64771,271.09375],
        [654.99146,271.09375],
        [654.36646,271.71875],
        [653.42896,271.25],
        [650.46021,269.0625],
        [647.64771,270.78125],
        [644.83521,272.96875],
        [645.14771,276.40625],
        [646.08521,276.71875],
        [648.11646,277.1875],
        [648.58521,277.96875],
        [646.08521,278.75],
        [643.58521,279.0625],
        [642.17896,280.78125],
        [641.86646,282.8125],
        [642.17896,284.375],
        [642.49146,289.6875],
        [639.05396,291.71875],
        [638.42896,291.5625],
        [638.42896,287.5],
        [639.67896,285.15625],
        [640.30396,282.8125],
        [639.52271,282.03125],
        [637.64771,282.8125],
        [636.71021,286.875],
        [634.05396,287.96875],
        [632.33521,289.84375],
        [632.17896,290.78125],
        [632.80396,291.5625],
        [632.17896,294.0625],
        [629.99146,294.53125],
        [629.99146,295.625],
        [630.77271,297.96875],
        [629.67896,303.90625],
        [628.11646,307.8125],
        [628.74146,312.34375],
        [629.21021,313.4375],
        [628.42896,315.78125],
        [628.11646,316.5625],
        [627.80396,319.21875],
        [631.24146,325],
        [634.05396,331.25],
        [635.46021,335.9375],
        [634.67896,340.46875],
        [633.74146,346.25],
        [631.39771,351.25],
        [631.08521,353.90625],
        [627.93541,356.88814],
        [632.19647,356.73152],
        [652.89813,354.54401],
        [659.93239,353.58999],
        [660.02554,355.20057],
        [666.64815,354.02869],
        [676.60158,352.57587],
        [680.32678,352.13038],
        [680.46021,351.5625],
        [680.61646,350.15625],
        [682.64771,346.5625],
        [684.58131,344.88281],
        [684.36646,340],
        [685.91,338.45646],
        [686.96412,338.125],
        [687.17896,334.6875],
        [688.66333,331.75782],
        [689.67896,332.34375],
        [689.83521,332.96875],
        [690.61646,333.125],
        [692.49146,332.1875],
        [692.17896,322.96875]
    ],
    [
        [566.17415,259.15473],
        [566.86646,258.59375],
        [569.52271,257.8125],
        [572.96021,255.625],
        [572.96021,254.6875],
        [573.58521,254.0625],
        [579.36646,253.125],
        [581.71021,251.25],
        [585.92896,249.21875],
        [586.08521,247.96875],
        [587.96021,245.15625],
        [589.67896,244.375],
        [590.92896,242.65625],
        [593.11646,240.46875],
        [597.33521,238.125],
        [601.86646,237.65625],
        [602.96021,238.75],
        [602.64771,239.6875],
        [599.05396,240.625],
        [597.64771,243.59375],
        [595.46021,244.375],
        [594.99146,246.71875],
        [592.64771,249.84375],
        [592.33521,252.34375],
        [593.11646,252.8125],
        [594.05396,251.71875],
        [597.49146,248.90625],
        [598.74146,250.15625],
        [600.92896,250.15625],
        [604.05396,251.09375],
        [605.46021,252.1875],
        [606.86646,255.15625],
        [609.52271,257.8125],
        [613.27271,257.65625],
        [614.67896,256.71875],
        [616.24146,257.96875],
        [617.80396,258.4375],
        [619.05396,257.65625],
        [620.14771,257.65625],
        [621.71021,256.71875],
        [625.61646,253.28125],
        [628.89771,252.1875],
        [635.30396,251.875],
        [639.67896,250],
        [642.17896,248.75],
        [643.58521,248.90625],
        [643.58521,254.375],
        [644.05396,254.6875],
        [646.86646,255.46875],
        [648.74146,255],
        [654.67896,253.4375],
        [655.77271,252.34375],
        [657.17896,252.8125],
        [657.17896,259.53125],
        [660.30396,262.5],
        [661.55396,263.125],
        [662.80396,264.0625],
        [661.55396,264.375],
        [660.77271,264.0625],
        [657.17896,263.59375],
        [655.14771,264.21875],
        [652.96021,264.0625],
        [649.83521,265.46875],
        [648.11646,265.46875],
        [642.49146,264.21875],
        [637.49146,264.375],
        [635.61646,266.875],
        [628.89771,267.5],
        [626.55396,268.28125],
        [625.46021,271.25],
        [624.21021,272.34375],
        [623.74146,272.1875],
        [622.33521,270.625],
        [617.96021,272.96875],
        [617.33521,272.96875],
        [616.24146,271.40625],
        [615.46021,271.5625],
        [613.58521,275.78125],
        [612.64771,279.6875],
        [609.57305,286.454],
        [608.43568,285.45434],
        [607.10985,284.45754],
        [605.23402,274.51384],
        [601.80817,273.18964],
        [599.82428,270.97993],
        [588.10957,268.32827],
        [585.34986,267.33309],
        [577.3949,265.23306],
        [569.76897,264.1282],
        [566.17415,259.15473]
    ]
],mn:[
    [
        [473.76109,275.83481],
        [473.31915,267.65888],
        [471.55138,260.58781],
        [469.78361,247.55052],
        [469.34167,238.04876],
        [467.5739,234.73419],
        [466.0271,229.87283],
        [466.0271,219.92913],
        [466.69001,216.17262],
        [464.93002,210.90341],
        [494.05396,210.9375],
        [494.36646,202.96875],
        [494.99146,202.8125],
        [497.17896,203.28125],
        [499.05396,204.0625],
        [499.83521,209.375],
        [501.24146,215.3125],
        [502.80396,216.875],
        [507.49146,216.875],
        [507.80396,218.28125],
        [513.89771,218.59375],
        [513.89771,220.625],
        [518.58521,220.625],
        [518.89771,219.375],
        [519.99146,218.28125],
        [522.17896,217.65625],
        [523.42896,218.59375],
        [526.24146,218.59375],
        [529.99146,221.09375],
        [535.14771,223.4375],
        [537.49146,223.90625],
        [537.96021,222.96875],
        [539.36646,222.5],
        [539.83521,225.3125],
        [542.33521,226.5625],
        [542.80396,226.09375],
        [544.05396,226.25],
        [544.05396,228.28125],
        [546.55396,229.21875],
        [549.52271,229.21875],
        [551.08521,228.4375],
        [554.21021,225.3125],
        [556.71021,224.84375],
        [557.49146,226.5625],
        [557.96021,227.8125],
        [558.89771,227.8125],
        [559.83521,227.03125],
        [568.42896,226.71875],
        [570.14771,229.6875],
        [570.77271,229.6875],
        [571.46244,228.63951],
        [575.75375,228.28125],
        [575.16214,230.48442],
        [571.35524,232.26006],
        [562.4189,236.18527],
        [557.80396,238.125],
        [554.83521,240.625],
        [552.49146,244.0625],
        [550.30396,247.8125],
        [548.58521,248.59375],
        [544.21021,253.4375],
        [542.96021,253.59375],
        [539.24714,256.42946],
        [536.52496,259.48458],
        [536.30399,262.35558],
        [536.52335,269.87345],
        [534.97978,271.42025],
        [529.89745,275.3961],
        [528.12645,280.922],
        [530.56036,284.44783],
        [531.00392,286.88337],
        [529.89421,289.75761],
        [529.67485,293.29476],
        [530.1168,300.14163],
        [533.42813,304.11103],
        [536.30399,304.11103],
        [538.72982,306.3272],
        [541.82503,307.64656],
        [545.36219,312.51278],
        [552.21229,317.36767],
        [553.98167,319.36126],
        [554.2075,324.67913],
        [534.30878,325.34204],
        [476.07644,325.7856],
        [475.74983,291.30279],
        [475.30789,288.43017],
        [471.33041,285.1156],
        [470.22555,283.34783],
        [470.22555,281.80103],
        [472.21429,280.25424],
        [473.54012,278.92841],
        [473.76109,275.83481]
    ]
],ms:[
    [
        [621.33096,603.00464],
        [621.08521,604.21875],
        [616.08521,604.21875],
        [614.67896,603.4375],
        [612.64771,603.125],
        [606.08521,605],
        [604.36646,604.21875],
        [601.86646,608.28125],
        [600.80082,609.03323],
        [599.7146,606.62851],
        [598.60974,602.872],
        [595.29518,599.77841],
        [596.40003,592.48636],
        [595.73712,591.60248],
        [593.96935,591.82345],
        [586.01439,592.48636],
        [562.59146,593.14928],
        [562.14952,591.60248],
        [562.81243,583.86849],
        [566.127,577.90227],
        [571.20933,569.06343],
        [570.32545,567.07469],
        [571.4303,567.07469],
        [572.09322,563.9811],
        [569.8835,562.21333],
        [570.10448,560.44556],
        [568.11574,556.02614],
        [567.83952,550.86094],
        [569.16534,548.29215],
        [568.77865,544.0937],
        [567.45282,541.22107],
        [568.77865,539.89525],
        [567.45282,537.90651],
        [567.89477,536.13874],
        [568.77865,530.17252],
        [571.65127,527.52087],
        [570.98836,525.53213],
        [574.5239,520.44979],
        [577.17555,519.56591],
        [577.17555,517.13523],
        [576.51264,515.8094],
        [579.16429,510.72707],
        [581.81594,509.62221],
        [581.91978,506.32433],
        [590.30488,506.24948],
        [613.58617,504.37448],
        [618.01345,504.15351],
        [618.02126,510.31198],
        [618.17751,526.40576],
        [617.39626,556.4058],
        [617.24001,569.99957],
        [619.89627,588.1246],
        [621.33096,603.00464]
    ]
],mo:[
    [
        [554.86232,392.83982],
        [552.42679,389.85589],
        [551.32193,387.64618],
        [543.80892,388.30909],
        [534.30716,388.75103],
        [509.77937,389.63492],
        [496.74208,389.85589],
        [489.11861,389.96637],
        [486.90887,390.07686],
        [488.12421,392.50754],
        [487.90324,394.71725],
        [490.33392,398.47376],
        [493.31702,402.45124],
        [496.30014,405.10289],
        [498.50985,405.32386],
        [499.83567,406.20775],
        [499.83567,409.08037],
        [498.06791,410.62717],
        [497.62596,412.83688],
        [499.6147,416.15145],
        [502.04539,419.02407],
        [504.47607,420.79184],
        [505.80189,432.06136],
        [505.13898,466.2014],
        [505.35995,470.7313],
        [505.80189,475.93463],
        [528.45062,475.82172],
        [550.87999,475.15881],
        [570.98836,474.3846],
        [582.25303,474.16201],
        [584.34983,477.47335],
        [583.68854,480.67015],
        [580.70461,482.99277],
        [580.15138,484.76862],
        [585.34986,485.21057],
        [589.11446,484.54765],
        [590.77417,479.23788],
        [591.40379,473.57711],
        [593.64518,471.62004],
        [595.30003,470.18292],
        [597.28877,469.18774],
        [597.40006,466.42317],
        [597.95492,464.76508],
        [596.95812,463.07532],
        [594.30486,463.21505],
        [592.20806,460.67792],
        [590.88061,456.59077],
        [591.65481,454.15685],
        [589.77575,450.84391],
        [588.00637,446.42125],
        [583.36759,445.64866],
        [576.63202,440.23729],
        [574.97069,436.26144],
        [575.74329,433.16784],
        [577.73364,427.31291],
        [578.1772,424.54512],
        [576.29329,423.54832],
        [569.66739,422.77735],
        [568.67382,421.12249],
        [568.56576,417.03371],
        [563.26246,413.71753],
        [556.52041,406.20613],
        [554.3107,399.13505],
        [554.08812,395.05114],
        [554.86232,392.83982]
    ]
],mt:[
    [
        [362.40849,269.84522],
        [363.03463,259.06782],
        [365.21753,235.11028],
        [365.65948,230.24891],
        [366.26497,226.92172],
        [366.54336,220.21596],
        [367.45167,206.15136],
        [337.80396,203.4375],
        [309.52271,200],
        [281.24146,196.09375],
        [249.99146,190.9375],
        [232.17896,187.65625],
        [200.55051,180.95554],
        [196.22139,201.58861],
        [199.53596,208.88065],
        [198.21013,213.30007],
        [199.9779,217.71949],
        [203.0715,219.04532],
        [207.53767,229.45434],
        [210.14257,232.52455],
        [210.58451,233.62941],
        [213.89908,234.73427],
        [214.34102,236.723],
        [207.49092,253.73778],
        [207.49092,256.16846],
        [209.9216,259.26205],
        [210.80548,259.26205],
        [215.44587,256.38943],
        [216.10879,255.28457],
        [217.65559,255.94749],
        [217.43461,261.02982],
        [220.08627,273.18323],
        [222.95889,275.61391],
        [223.84277,276.27682],
        [225.61054,278.48653],
        [225.1686,281.8011],
        [225.83151,285.11566],
        [226.93637,285.99955],
        [229.14608,283.78984],
        [231.79773,283.78984],
        [234.89133,285.33664],
        [237.32201,284.45275],
        [241.29949,284.45275],
        [244.83502,285.99955],
        [247.48668,285.55761],
        [247.92862,282.68498],
        [250.80124,282.02207],
        [252.12707,283.3479],
        [252.56901,286.44149],
        [254.28888,287.76078],
        [255.77096,276.58277],
        [275.77097,279.45539],
        [303.01627,283.27777],
        [319.01544,285.1114],
        [349.40908,288.45164],
        [360.0314,289.9247],
        [361.04817,275.01376],
        [362.40849,269.84522]
    ]
],ne:[
    [
        [485.71264,390.38707],
        [487.03847,392.97286],
        [487.12771,395.02746],
        [489.40328,398.62887],
        [492.03156,401.67571],
        [487.15108,401.67571],
        [445.1238,400.76844],
        [405.702,399.90794],
        [385.21968,398.97944],
        [386.25654,378.36539],
        [353.99477,375.71374],
        [358.19322,333.17681],
        [373.21925,334.17118],
        [392.6647,335.27603],
        [409.90045,336.38089],
        [432.88144,337.48574],
        [443.26708,337.0438],
        [445.25582,339.25351],
        [449.89621,342.12614],
        [451.00107,343.01002],
        [455.19952,341.68419],
        [458.95603,341.24225],
        [461.60768,341.02128],
        [463.37545,342.34711],
        [468.23681,343.89391],
        [471.10943,345.4407],
        [471.55138,346.9875],
        [472.43526,348.97624],
        [474.20303,348.97624],
        [474.9743,349.02086],
        [475.92404,354.05857],
        [478.5757,361.81594],
        [479.7698,366.30122],
        [481.8244,369.99187],
        [482.3322,374.76399],
        [483.7239,378.89657],
        [484.25508,385.14964]
    ]
],nv:[
    [
        [153.62525,323.29247],
        [173.90327,327.65271],
        [183.29454,329.53097],
        [192.24386,331.29873],
        [198.63714,332.87739],
        [198.09746,338.54615],
        [194.67241,355.29533],
        [190.71618,374.60692],
        [188.83793,384.00032],
        [186.7387,396.83788],
        [183.68972,412.70317],
        [180.28592,427.86306],
        [178.38341,437.7027],
        [176.00036,453.91213],
        [175.55842,454.9745],
        [174.52156,457.36056],
        [172.71131,457.25007],
        [171.65107,454.59842],
        [168.99942,454.11185],
        [167.65022,453.16211],
        [165.68059,453.47232],
        [164.7967,454.17986],
        [163.53888,455.48444],
        [163.11819,462.22405],
        [162.58699,463.88133],
        [162.18968,475.56942],
        [160.91183,477.22621],
        [159.09821,475.04037],
        [145.06656,453.05375],
        [126.28402,424.99044],
        [104.29741,392.28673],
        [92.330295,374.32659],
        [93.911767,367.97992],
        [100.65139,342.89971],
        [108.27489,312.60101],
        [140.75763,320.47114],
        [154.01589,323.34376]
    ]
],nh:[
    [
        [868.99529,289.32172],
        [869.83521,288.28125],
        [870.88894,285.10037],
        [868.43097,284.21747],
        [867.96221,281.24871],
        [864.21221,280.15496],
        [863.89971,277.4987],
        [856.86844,254.8424],
        [852.42102,240.78614],
        [851.55396,240.78125],
        [850.92896,242.34375],
        [850.30396,241.875],
        [849.36646,240.9375],
        [847.96021,242.8125],
        [847.91336,247.67614],
        [848.21458,253.15369],
        [850.08958,255.80995],
        [850.08958,259.71621],
        [846.49582,264.60955],
        [843.99582,265.70331],
        [843.99582,266.79706],
        [845.08957,268.51581],
        [845.08957,276.79708],
        [844.30832,285.70335],
        [844.15207,290.39086],
        [845.08957,291.64087],
        [844.93332,296.01587],
        [844.46457,297.73463],
        [845.87082,298.59098],
        [861.7122,294.05822],
        [863.89971,293.43322],
        [865.38258,290.96628],
        [868.99529,289.32172]
    ]
],nm:[
    [
        [290.93695,568.28239],
        [290.3083,562.36421],
        [298.66279,562.87203],
        [327.19136,565.83387],
        [354.63426,567.22557],
        [356.53376,545.64053],
        [360.13513,491.63462],
        [361.21664,472.89431],
        [363.16289,473.23214],
        [363.14908,462.5278],
        [332.02335,460.20517],
        [296.32128,455.92629],
        [263.0099,451.94881],
        [258.95036,481.67727],
        [252.2186,533.09881],
        [248.59153,559.11977],
        [246.61073,571.98367],
        [261.55396,573.90625],
        [262.80396,564.21875],
        [278.89771,566.71875],
        [290.93695,568.28239]
    ]
],nj:[
    [
        [818.11835,335.62383],
        [816.0871,337.96759],
        [816.0871,340.93635],
        [814.21209,343.9051],
        [814.05584,345.46761],
        [815.30585,346.71761],
        [815.1496,349.06137],
        [812.96209,350.15512],
        [813.74334,352.81137],
        [813.89959,353.90513],
        [816.55585,354.21763],
        [817.49335,356.71763],
        [820.93086,359.06139],
        [823.27461,360.62389],
        [823.27461,361.40514],
        [820.14961,364.3739],
        [818.5871,366.5614],
        [817.18085,369.21766],
        [814.99335,370.46766],
        [813.82147,371.17079],
        [813.58709,372.34267],
        [812.99825,374.86217],
        [814.05396,377.03125],
        [817.17896,379.84375],
        [821.86646,382.03125],
        [825.77271,382.65625],
        [825.92896,384.0625],
        [825.14771,385],
        [825.46021,387.65625],
        [826.24146,387.65625],
        [828.27271,385.3125],
        [829.05396,380.625],
        [831.71021,376.71875],
        [834.67896,370.46875],
        [835.77271,365.15625],
        [835.14771,364.0625],
        [834.99146,355],
        [833.42896,351.71875],
        [832.33521,352.5],
        [829.67896,352.8125],
        [829.21021,352.34375],
        [830.30396,351.40625],
        [832.33521,349.53125],
        [832.39616,348.47403],
        [832.02463,345.15511],
        [832.49338,342.49885],
        [832.33713,340.4676],
        [829.83713,339.37384],
        [825.46212,338.43634],
        [821.71211,337.34259],
        [818.11835,335.62383]
    ]
],ny:[
    [
        [818.55706,334.74642],
        [817.46331,333.80892],
        [814.9633,333.65267],
        [812.7758,331.77767],
        [811.19977,325.85367],
        [807.85705,325.94118],
        [805.49513,323.32362],
        [786.7586,327.55891],
        [745.19601,335.99643],
        [737.91836,337.18332],
        [737.20491,330.93147],
        [738.58521,329.84375],
        [739.83521,328.75],
        [740.77271,327.1875],
        [742.49146,326.09375],
        [744.36646,324.375],
        [744.83521,322.8125],
        [746.86646,320.15625],
        [747.96021,319.21875],
        [747.80396,318.28125],
        [746.55396,315.3125],
        [744.83521,315.15625],
        [742.96021,309.21875],
        [745.77271,307.5],
        [749.99146,306.09375],
        [753.89771,304.84375],
        [757.02271,304.375],
        [763.11646,304.21875],
        [764.99146,305.46875],
        [766.55396,305.625],
        [768.58521,304.375],
        [771.08521,303.28125],
        [776.08521,302.8125],
        [778.11646,301.09375],
        [779.83521,297.96875],
        [781.39771,296.09375],
        [783.42896,296.09375],
        [785.30396,295],
        [785.46021,292.8125],
        [784.05396,290.78125],
        [783.74146,289.375],
        [784.83521,287.34375],
        [784.83521,285.9375],
        [783.11646,285.9375],
        [781.39771,285.15625],
        [780.61646,284.0625],
        [780.46021,281.5625],
        [786.08521,276.25],
        [786.71021,275.46875],
        [788.11646,272.65625],
        [790.92896,268.28125],
        [793.58521,264.6875],
        [795.61646,262.34375],
        [797.95073,260.57924],
        [800.92896,259.375],
        [806.24146,258.125],
        [809.36646,258.28125],
        [813.74146,256.875],
        [821.05346,254.87315],
        [821.55586,259.68616],
        [823.89962,265.93618],
        [824.68087,270.93619],
        [823.74337,274.6862],
        [826.24337,279.06121],
        [827.02462,281.09246],
        [826.24337,283.90497],
        [829.05588,285.15497],
        [829.68088,285.46747],
        [832.64964,296.0925],
        [832.1313,300.98283],
        [831.66255,311.4516],
        [832.4438,316.76411],
        [833.22505,320.20162],
        [834.6313,327.23289],
        [834.6313,335.0454],
        [833.53755,337.23291],
        [835.31532,339.159],
        [836.08521,340.78125],
        [834.21021,342.5],
        [834.52271,343.75],
        [835.77271,343.4375],
        [837.17896,342.1875],
        [839.36646,339.6875],
        [840.46021,339.0625],
        [842.02271,339.6875],
        [844.21021,339.84375],
        [851.86646,336.09375],
        [854.67896,333.4375],
        [855.92896,332.03125],
        [859.99146,333.59375],
        [856.71021,337.03125],
        [852.96021,339.84375],
        [846.08521,345],
        [843.58521,345.9375],
        [837.96021,347.8125],
        [834.05396,348.90625],
        [832.91854,348.39116],
        [832.68269,344.82608],
        [833.15144,342.16982],
        [832.99519,340.13857],
        [830.27584,338.49643],
        [825.90083,337.55893],
        [822.15082,336.46518],
        [818.55706,334.74642]
    ]
],nc:[
    [
        [821.93245,440.14615],
        [823.58521,444.6875],
        [827.02271,450.9375],
        [829.36646,453.28125],
        [829.99146,455.46875],
        [827.64771,455.625],
        [828.42896,456.25],
        [828.11646,460.3125],
        [825.61646,461.5625],
        [824.99146,463.59375],
        [823.74146,466.40625],
        [820.14771,467.96875],
        [817.80396,467.65625],
        [816.39771,467.5],
        [814.83521,466.25],
        [815.14771,467.5],
        [815.14771,468.4375],
        [817.02271,468.4375],
        [817.80396,469.6875],
        [815.92896,475.78125],
        [819.99146,475.78125],
        [820.61646,477.34375],
        [822.80396,475.15625],
        [824.05396,474.6875],
        [822.17896,478.125],
        [819.21021,482.8125],
        [817.96021,482.8125],
        [816.86646,482.34375],
        [814.21021,482.96875],
        [809.21021,485.3125],
        [802.96021,490.46875],
        [799.67896,495],
        [797.80396,501.25],
        [797.33521,503.59375],
        [792.80396,504.0625],
        [787.53333,505.35442],
        [777.91981,497.42642],
        [765.73229,490.08266],
        [762.91979,489.3014],
        [750.73227,490.70766],
        [746.59894,491.4327],
        [745.03644,488.30769],
        [742.1655,486.26183],
        [726.22797,486.73058],
        [719.19671,487.51183],
        [710.4467,491.88684],
        [704.50919,494.38684],
        [702.94669,494.69934],
        [697.32168,495.63684],
        [690.60292,496.41809],
        [684.04041,496.88685],
        [684.52377,492.96821],
        [686.24252,491.56196],
        [688.89878,490.93696],
        [689.52378,487.3432],
        [693.58629,484.68695],
        [697.33629,483.28069],
        [701.3988,479.84319],
        [705.61755,477.81194],
        [706.24255,474.84318],
        [709.99256,471.09318],
        [710.61756,470.93693],
        [710.61756,470.93693],
        [710.61756,472.03068],
        [711.39881,472.03068],
        [712.18006,472.03068],
        [713.27382,472.34318],
        [713.27382,472.34318],
        [715.46132,468.90567],
        [717.49257,468.28067],
        [719.68007,468.59317],
        [721.24258,465.15567],
        [724.05508,462.65566],
        [724.52383,460.62441],
        [724.52383,456.79628],
        [728.89884,457.49941],
        [735.7961,456.2494],
        [751.08637,454.3744],
        [767.6489,451.8744],
        [786.90389,448.00769],
        [805.97677,443.98226],
        [816.96087,441.27942],
        [821.93245,440.14615]
    ],
    [
        [825.69753,472.02993],
        [828.19754,469.60804],
        [831.24442,467.10803],
        [832.7288,466.48303],
        [832.88505,464.5299],
        [832.26005,458.59238],
        [830.8538,456.32675],
        [830.22879,454.52987],
        [830.93192,454.29549],
        [833.58818,459.60801],
        [833.97881,463.9049],
        [833.82256,467.18616],
        [830.5413,468.67054],
        [827.80691,471.0143],
        [826.71316,472.18618],
        [825.69753,472.02993]
    ]
],nd:[
    [
        [473.20653,275.05928],
        [472.85383,267.81399],
        [470.93096,260.74292],
        [469.16319,247.55052],
        [468.72125,238.04876],
        [466.79837,235.0444],
        [465.25157,229.87283],
        [465.25157,219.92913],
        [465.91448,216.17262],
        [463.86993,210.85765],
        [436.39771,210.3125],
        [418.42896,209.6875],
        [392.80396,208.4375],
        [368.69252,206.61668],
        [367.474,220.37107],
        [366.14817,234.95517],
        [363.96527,259.06782],
        [363.49537,269.71921],
        [418.40996,273.35738],
        [473.20653,275.05928]
    ]
],oh:[
    [
        [724.63106,340.14481],
        [718.74146,344.0625],
        [714.99146,346.25],
        [711.71021,349.84375],
        [707.80396,353.59375],
        [704.67896,354.375],
        [701.86646,354.84375],
        [696.55396,357.34375],
        [694.52271,357.5],
        [691.24146,354.53125],
        [686.24146,355.15625],
        [683.74146,353.75],
        [681.44008,352.44438],
        [676.71126,353.12425],
        [666.8675,354.68675],
        [659.36748,355.85863],
        [660.61749,369.99927],
        [662.33624,383.28054],
        [664.83624,405.93683],
        [665.38312,410.60631],
        [669.3675,410.4816],
        [671.71125,409.70035],
        [674.96247,411.15318],
        [676.96367,415.37193],
        [681.93062,415.3554],
        [683.75905,417.40319],
        [685.46127,417.34008],
        [687.91471,416.04351],
        [690.33507,416.40258],
        [692.24313,417.80883],
        [693.9123,415.74753],
        [696.17944,414.49753],
        [698.18064,413.83947],
        [698.80564,416.49573],
        [700.5244,417.43323],
        [703.88377,419.69885],
        [705.99315,419.62073],
        [707.10042,418.51045],
        [707.03732,417.17032],
        [708.59982,415.76406],
        [708.75607,410.92031],
        [708.75607,410.92031],
        [709.69357,407.1703],
        [709.69357,407.1703],
        [711.16293,405.77756],
        [712.63228,406.65196],
        [713.43007,407.82232],
        [714.60044,407.65256],
        [714.19178,405.32232],
        [713.64641,404.70034],
        [713.64641,402.35658],
        [714.58391,401.10658],
        [716.77141,397.82533],
        [718.02141,396.41908],
        [720.05267,396.88783],
        [722.24017,395.32532],
        [725.20892,392.04407],
        [727.39643,388.29406],
        [727.59925,383.04467],
        [728.068,378.20091],
        [728.068,373.66965],
        [726.97425,370.7009],
        [727.91175,369.29464],
        [728.80145,368.37198],
        [727.44356,358.85857],
        [724.63106,340.14481]
    ]
],ok:[
    [
        [380.45605,463.43925],
        [370.12561,462.99736],
        [363.9108,462.5278],
        [364.15939,462.72114],
        [363.4795,472.79443],
        [384.70974,474.15422],
        [415.69245,475.41419],
        [413.43598,499.0156],
        [412.99404,516.25134],
        [413.21501,517.79814],
        [417.41346,521.33368],
        [419.4022,522.43853],
        [420.06512,522.21756],
        [420.72803,520.22882],
        [422.05386,521.99659],
        [424.0426,521.99659],
        [424.0426,520.67076],
        [426.69425,521.99659],
        [426.25231,525.7531],
        [430.22979,525.97407],
        [432.66047,527.07893],
        [436.6375,527.74184],
        [439.06863,529.50961],
        [441.27834,527.52087],
        [444.59291,528.18378],
        [447.02359,531.49835],
        [447.90747,531.49835],
        [447.90747,533.70806],
        [450.11718,534.37097],
        [452.32689,532.16126],
        [454.09466,532.82417],
        [456.52534,532.82417],
        [457.40923,535.25486],
        [462.04962,537.02262],
        [463.37545,536.35971],
        [465.14322,532.38223],
        [466.24807,532.38223],
        [467.35293,534.37097],
        [471.33041,535.03388],
        [474.86594,536.35971],
        [477.73857,537.2436],
        [479.50634,536.35971],
        [480.16925,533.92903],
        [484.3677,533.92903],
        [486.35644,534.81291],
        [489.00809,532.82417],
        [490.11295,532.82417],
        [490.77586,534.37097],
        [494.75334,534.37097],
        [496.30014,532.38223],
        [498.06791,532.82417],
        [500.05665,535.25486],
        [503.15024,537.02262],
        [506.24384,537.90651],
        [508.11996,538.98799],
        [507.74388,503.01657],
        [506.41804,492.40986],
        [506.26295,483.83446],
        [504.87125,477.51554],
        [504.1191,470.57619],
        [504.05324,466.88769],
        [492.3226,467.19576],
        [447.46581,466.75383],
        [403.93427,464.76507],
        [380.45605,463.43925]
    ]
],or:[
    [
        [153.28498,322.43652],
        [157.4388,305.13492],
        [161.94746,287.85456],
        [162.96308,283.76659],
        [165.23865,278.33156],
        [164.64374,277.2076],
        [162.21305,277.16297],
        [160.97434,275.54818],
        [161.41628,274.13311],
        [161.90284,270.9949],
        [166.21178,265.69159],
        [167.97955,264.62922],
        [169.0844,263.52437],
        [170.52071,260.07808],
        [174.43232,254.59842],
        [177.87862,250.86529],
        [178.09959,247.52948],
        [174.94013,245.14342],
        [173.7717,240.78432],
        [160.97647,237.16509],
        [146.39238,233.74004],
        [131.47684,233.85052],
        [131.0349,232.5247],
        [125.73159,234.51344],
        [121.42266,233.96101],
        [119.10246,232.41421],
        [117.88712,233.07713],
        [113.35722,232.85615],
        [111.69994,231.53033],
        [106.6176,229.54159],
        [105.8442,229.65208],
        [101.64575,228.21576],
        [99.767497,229.98353],
        [93.801277,229.65208],
        [88.056035,225.6746],
        [88.718945,224.9012],
        [88.939915,217.38818],
        [86.730205,213.63168],
        [82.752725,213.07925],
        [82.089815,210.64857],
        [79.814665,210.19762],
        [74.210205,212.1875],
        [72.022705,218.4375],
        [68.897705,228.125],
        [65.772705,234.375],
        [60.928955,247.96875],
        [54.678955,261.09375],
        [46.866455,273.28125],
        [44.991455,276.09375],
        [44.210205,284.375],
        [42.960205,290.15625],
        [45.577759,293.56562],
        [52.082384,295.7415],
        [63.28604,298.92433],
        [70.888295,301.37839],
        [82.886593,304.89055],
        [95.768779,308.36023],
        [108.49586,311.80651]
    ]
],pa:[
    [
        [812.36412,370.54428],
        [813.45788,369.91928],
        [815.64538,369.32734],
        [817.05163,366.67108],
        [818.61414,364.48358],
        [821.73914,361.51482],
        [821.73914,360.73357],
        [819.39539,359.17107],
        [815.95788,356.82731],
        [815.02038,354.32731],
        [812.36412,354.01481],
        [812.20787,352.92105],
        [811.42662,350.2648],
        [813.61413,349.17105],
        [813.77038,346.82729],
        [812.52037,345.57729],
        [812.67662,344.01478],
        [814.55163,341.04603],
        [814.55163,338.07727],
        [816.81726,335.73352],
        [817.0246,334.68633],
        [814.52459,334.53008],
        [812.33709,332.65508],
        [809.99333,327.49882],
        [807.08931,326.59924],
        [804.83707,324.53006],
        [786.86828,328.43632],
        [745.30569,336.87384],
        [736.71192,338.28009],
        [736.23284,331.43328],
        [730.92896,336.875],
        [729.67896,337.34375],
        [725.61731,340.25194],
        [728.43065,358.74889],
        [730.82926,368.15263],
        [734.28151,386.76947],
        [737.44141,386.15314],
        [748.98526,384.70095],
        [785.64256,377.29229],
        [800.02089,374.56346],
        [808.04344,372.9954],
        [808.30161,372.76485],
        [810.33287,371.20234],
        [812.36412,370.54428]
    ]
],ri:[
    [
        [862.49149,325.46873],
        [862.0247,321.40505],
        [861.24345,317.18629],
        [859.60283,311.48316],
        [865.14971,309.99878],
        [866.71221,311.09253],
        [869.99347,315.31129],
        [872.80498,319.60877],
        [869.99146,321.09375],
        [868.74146,320.9375],
        [867.64771,322.65625],
        [865.30396,324.53125],
        [862.49149,325.46873]
    ]
],sc:[
    [
        [753.42896,550.78125],
        [751.71137,551.7183],
        [749.21137,550.46829],
        [748.58637,548.43704],
        [747.33637,544.99954],
        [745.14886,542.96828],
        [742.64886,542.34328],
        [741.08636,537.65578],
        [738.4301,531.87452],
        [734.3676,529.99951],
        [732.33634,528.12451],
        [731.08634,525.62451],
        [729.05509,523.7495],
        [726.86759,522.4995],
        [724.68008,519.687],
        [721.71133,517.4995],
        [717.33632,515.78074],
        [716.86757,514.37449],
        [714.52382,511.56199],
        [714.05507,510.15573],
        [710.77381,505.15573],
        [707.49256,505.31198],
        [703.5863,502.96822],
        [702.3363,501.71822],
        [702.0238,499.99947],
        [702.80505,498.12447],
        [704.99255,497.18696],
        [704.68005,495.15571],
        [710.61756,492.65571],
        [719.36757,488.2807],
        [726.39883,487.49945],
        [742.33636,487.0307],
        [744.52386,488.9057],
        [746.08636,492.03071],
        [750.30512,491.56196],
        [762.49264,490.1557],
        [765.30514,490.93696],
        [777.49266,498.28072],
        [787.26244,506.13059],
        [782.02271,511.40625],
        [779.52271,517.34375],
        [779.05396,523.4375],
        [777.49146,524.21875],
        [776.39771,526.875],
        [774.05396,527.5],
        [772.02271,530.9375],
        [769.36646,533.59375],
        [767.17896,536.875],
        [765.61646,537.65625],
        [762.17896,540.9375],
        [759.36646,541.09375],
        [760.30396,544.21875],
        [755.46021,549.53125],
        [753.42896,550.78125]
    ]
],sd:[
    [
        [474.64838,348.04446],
        [473.7266,346.99977],
        [472.25678,343.49446],
        [474.02455,339.91643],
        [475.04016,334.54726],
        [472.54362,332.55852],
        [472.25678,329.90687],
        [472.83045,327.01086],
        [474.90844,326.23533],
        [475.19527,320.69194],
        [475.12941,291.613],
        [474.53236,288.74038],
        [470.55488,285.27071],
        [469.60513,283.34783],
        [469.60513,281.49082],
        [471.43876,280.25424],
        [472.9197,278.46309],
        [473.09605,275.83481],
        [417.63443,274.28802],
        [363.34027,270.53151],
        [362.59923,275.63418],
        [361.0402,290.97134],
        [359.74001,308.31756],
        [358.19322,332.09107],
        [373.68457,333.08544],
        [392.6647,334.19029],
        [410.05556,335.45025],
        [433.03655,336.71021],
        [443.42219,335.95806],
        [446.18646,338.16777],
        [450.36153,341.0404],
        [451.31128,341.76917],
        [454.7342,340.90866],
        [458.64582,340.62183],
        [461.29747,340.55596],
        [464.30609,341.72669],
        [468.70213,343.11838],
        [471.72985,344.82028],
        [472.32691,346.67729],
        [473.21079,348.51092],
        [473.89282,348.0456],
        [474.64838,348.04446]
    ]
],tn:[
    [
        [691.39878,461.56191],
        [641.24246,466.40567],
        [626.01034,468.12442],
        [621.5438,468.61997],
        [617.80492,468.59317],
        [617.80492,472.34318],
        [609.67991,472.81193],
        [602.96115,473.43693],
        [592.23649,473.48807],
        [591.98061,479.1282],
        [589.914,485.19371],
        [588.95223,488.10878],
        [587.64863,492.34321],
        [587.33613,494.84321],
        [583.42987,497.03071],
        [584.83612,500.46822],
        [583.89862,504.68697],
        [582.96265,505.4502],
        [589.97585,505.26239],
        [613.25714,503.38739],
        [618.41344,503.23114],
        [626.22591,502.76238],
        [653.10095,500.26238],
        [662.93131,499.48113],
        [671.06972,498.54363],
        [679.19473,497.44988],
        [683.88224,496.66863],
        [683.75603,492.31015],
        [685.47478,490.9039],
        [688.13104,490.2789],
        [688.75604,486.68514],
        [692.81855,484.02889],
        [696.56855,482.62263],
        [700.63106,479.18513],
        [704.84981,477.15388],
        [705.69416,473.74641],
        [709.88288,469.99641],
        [710.50788,469.84016],
        [710.50788,469.84016],
        [710.50788,470.93391],
        [711.28913,470.93391],
        [712.07038,470.93391],
        [713.16414,471.24641],
        [713.16414,471.24641],
        [715.35164,467.8089],
        [717.38289,467.1839],
        [719.57039,467.4964],
        [721.1329,464.0589],
        [723.17766,461.88792],
        [723.75609,460.95344],
        [723.92656,457.15292],
        [722.49258,456.8744],
        [720.14883,458.74941],
        [712.49256,458.90566],
        [700.89869,460.74273],
        [691.39878,461.56191]
    ]
],tx:[
    [
        [362.77836,473.88015],
        [384.70974,474.92975],
        [414.76181,476.03461],
        [412.50534,498.70539],
        [412.21851,516.25134],
        [412.28437,518.26346],
        [416.48282,521.9541],
        [418.16135,522.74874],
        [419.91001,522.99309],
        [420.57292,521.77988],
        [421.43344,522.61701],
        [423.11196,523.08233],
        [424.66302,522.37693],
        [425.76361,522.77212],
        [425.47678,526.06331],
        [429.60937,527.05981],
        [432.19515,527.85446],
        [436.01753,528.36226],
        [438.13799,530.13003],
        [441.27834,528.60661],
        [443.97249,528.95931],
        [445.93785,531.65346],
        [446.97683,531.96367],
        [446.82173,533.86317],
        [449.80697,534.99139],
        [452.482,533.247],
        [453.93955,533.5997],
        [456.21513,533.75481],
        [456.6337,535.56507],
        [461.11898,537.48794],
        [463.68566,537.29035],
        [465.60854,533.31287],
        [465.93786,533.31287],
        [467.04272,535.1465],
        [471.33041,536.11962],
        [474.55573,537.29035],
        [477.73857,538.01913],
        [479.81655,537.29035],
        [480.63457,534.85967],
        [484.21259,534.85967],
        [486.04623,535.58844],
        [489.00809,534.06502],
        [489.64763,534.06502],
        [490.00033,535.1465],
        [494.13292,535.1465],
        [496.45525,533.93329],
        [498.06791,534.22012],
        [499.43623,536.03039],
        [502.2196,537.64304],
        [505.62342,538.68204],
        [508.27507,540.05249],
        [510.63988,541.62052],
        [513.82271,540.76002],
        [515.69884,541.70977],
        [516.19284,551.51004],
        [516.51686,560.8875],
        [517.17977,570.10242],
        [517.68758,574.01403],
        [520.27337,578.45683],
        [521.31236,582.38756],
        [525.04549,588.46639],
        [525.57667,591.24978],
        [526.08448,592.2229],
        [525.42156,599.4682],
        [522.85916,603.70913],
        [523.78553,606.4734],
        [523.43282,608.90408],
        [522.61481,615.97516],
        [521.28898,618.60344],
        [521.87299,622.84287],
        [516.39771,624.375],
        [506.86646,628.75],
        [505.92896,630.625],
        [503.42896,632.5],
        [501.39771,633.90625],
        [500.14771,634.6875],
        [494.67896,639.84375],
        [492.02271,641.875],
        [486.86646,645],
        [481.39771,647.34375],
        [475.30396,650.625],
        [473.58521,652.03125],
        [467.96021,655.46875],
        [464.67896,656.09375],
        [460.92896,661.40625],
        [457.02271,661.71875],
        [456.08521,663.59375],
        [458.27271,665.46875],
        [456.86646,670.78125],
        [455.61646,675.15625],
        [454.52271,678.90625],
        [453.74146,683.28125],
        [454.52271,685.625],
        [456.24146,692.34375],
        [457.17896,698.28125],
        [458.89771,700.9375],
        [457.96021,702.34375],
        [454.99146,704.21875],
        [449.52271,700.46875],
        [444.21021,699.375],
        [442.96021,699.84375],
        [439.83521,699.21875],
        [435.77271,696.25],
        [430.77271,695.15625],
        [423.42896,691.875],
        [421.39771,688.125],
        [420.14771,681.875],
        [417.02271,680],
        [416.39771,677.8125],
        [417.02271,677.1875],
        [417.33521,673.90625],
        [416.08521,673.28125],
        [415.46021,672.34375],
        [416.71021,668.125],
        [415.14771,665.9375],
        [412.02271,664.6875],
        [408.74146,660.46875],
        [405.30396,654.0625],
        [401.24146,651.5625],
        [401.39771,649.6875],
        [396.24146,637.8125],
        [395.46021,633.75],
        [393.74146,631.875],
        [393.58521,630.46875],
        [387.80396,625.3125],
        [385.30396,622.34375],
        [385.30396,621.25],
        [382.80396,619.21875],
        [376.24146,618.125],
        [369.05396,617.5],
        [366.08521,615.3125],
        [361.71021,617.03125],
        [358.27271,618.4375],
        [356.08521,621.5625],
        [355.14771,625.15625],
        [350.92896,631.09375],
        [348.58521,633.4375],
        [346.08521,632.5],
        [344.36646,631.40625],
        [342.49146,630.78125],
        [338.74146,628.59375],
        [338.74146,627.96875],
        [337.02271,626.09375],
        [332.02271,624.0625],
        [324.83521,616.5625],
        [322.64771,612.03125],
        [322.64771,604.21875],
        [319.52271,597.96875],
        [319.05396,595.3125],
        [317.49146,594.375],
        [316.39771,592.34375],
        [311.55396,590.3125],
        [310.30396,588.75],
        [303.42896,581.09375],
        [302.17896,577.96875],
        [297.6477,575.78124],
        [296.24145,571.56246],
        [293.74143,568.74997],
        [291.86644,568.28125],
        [291.23894,563.76016],
        [298.973,564.42309],
        [327.03625,567.07472],
        [355.09958,568.62152],
        [357.30929,545.64053],
        [361.06577,491.94483],
        [362.61259,473.82494],
        [363.93842,473.85257]
    ],
    [
        [459.60251,699.99946],
        [459.05564,693.12444],
        [456.39938,686.17129],
        [455.8525,679.37439],
        [457.33688,671.40562],
        [460.54002,664.76497],
        [463.8994,659.53057],
        [466.94629,656.09306],
        [467.57129,656.32744],
        [462.9619,662.73371],
        [458.74314,669.06186],
        [456.79,675.46813],
        [456.4775,680.46815],
        [457.33688,686.40567],
        [459.83689,693.35882],
        [460.30564,698.35883],
        [460.46189,699.76509],
        [459.60251,699.99946]
    ]
],ut:[
    [
        [262.17912,450.61872],
        [238.361,447.26166],
        [212.68587,442.53203],
        [179.99124,436.71356],
        [181.52677,427.86306],
        [184.62036,413.16849],
        [187.82444,397.14809],
        [189.92367,384.00032],
        [191.80192,375.38245],
        [195.44794,355.60554],
        [198.87299,338.70126],
        [199.95023,333.31509],
        [212.24174,335.49718],
        [223.84272,337.48592],
        [233.78641,339.25369],
        [241.85185,340.57952],
        [245.40653,341.04265],
        [243.97142,351.31729],
        [241.73717,364.04908],
        [249.28355,364.94638],
        [265.14097,366.69077],
        [273.07714,367.51777],
        [271.01796,388.75109],
        [267.92437,410.56136],
        [264.2973,437.45625],
        [262.68692,448.1923],
        [262.17912,450.61872]
    ]
],vt:[
    [
        [833.75992,300.24514],
        [832.97867,294.77638],
        [830.66797,285.13844],
        [830.04297,284.82594],
        [827.23046,283.57594],
        [828.01171,280.76343],
        [827.23046,278.73218],
        [824.62078,274.24749],
        [825.55828,270.49748],
        [824.77703,265.49747],
        [822.43327,259.24745],
        [821.65466,254.48969],
        [847.02369,247.96807],
        [847.33717,253.5924],
        [849.21217,256.24866],
        [849.21217,260.15492],
        [845.61841,264.06117],
        [843.11841,265.15493],
        [843.11841,266.24868],
        [844.21216,267.96743],
        [844.21216,276.2487],
        [843.43091,285.15497],
        [843.27466,289.84248],
        [844.21216,291.09249],
        [844.05591,295.46749],
        [843.58716,297.18625],
        [844.22567,298.70066],
        [837.50691,300.0288],
        [833.75992,300.24514]
    ]
],va:[
    [
        [818.83963,411.8982],
        [818.70054,410.01633],
        [824.93798,407.55179],
        [824.19336,410.66194],
        [821.37113,414.31457],
        [820.96703,418.74691],
        [821.41333,422.02388],
        [819.64654,426.83543],
        [817.5547,428.68744],
        [816.13357,424.20195],
        [816.56454,418.93521],
        [818.09843,414.89214],
        [818.83963,411.8982]
    ],
    [
        [821.04287,439.25237],
        [764.81567,451.40692],
        [728.64131,456.50931],
        [722.18649,456.14669],
        [719.68776,458.0086],
        [712.59426,458.2219],
        [704.49268,459.16685],
        [695.86521,460.08671],
        [704.06206,455.30403],
        [704.04938,453.29854],
        [705.51856,451.22424],
        [715.71912,440.10774],
        [719.53375,444.43535],
        [723.19015,445.36706],
        [725.64849,444.26491],
        [727.81083,442.99763],
        [730.26255,444.29619],
        [734.04572,442.91621],
        [735.85964,438.51236],
        [738.37351,439.03431],
        [741.13319,436.97439],
        [742.87224,437.45147],
        [745.60483,433.89795],
        [745.94143,431.88455],
        [745.01002,430.65167],
        [745.97923,428.84752],
        [751.07698,416.98126],
        [751.67311,411.43812],
        [752.86087,410.9321],
        [754.96649,413.29322],
        [758.77062,413.00213],
        [760.63526,405.68197],
        [763.33574,405.13988],
        [764.35036,402.49055],
        [766.84384,400.22222],
        [768.06937,397.95839],
        [769.5229,394.71763],
        [769.60499,389.81968],
        [779.09779,393.51456],
        [779.75585,393.84359],
        [779.73193,388.89069],
        [779.73193,388.89069],
        [783.64669,390.22194],
        [783.20015,392.76276],
        [791.08329,395.60404],
        [792.33289,397.33837],
        [791.494,400.89728],
        [790.27319,402.17873],
        [789.7842,403.86633],
        [790.26158,406.18864],
        [792.155,407.42423],
        [795.94196,408.82107],
        [798.79194,409.75664],
        [803.48587,410.66722],
        [805.56615,412.68578],
        [808.64981,413.07484],
        [809.48883,414.2347],
        [809.06405,418.76781],
        [810.39277,419.83346],
        [809.92985,421.69924],
        [811.11811,422.46258],
        [810.90374,423.80084],
        [808.29991,423.70908],
        [808.38589,425.27053],
        [810.59054,426.76176],
        [810.70801,428.12641],
        [812.42178,429.85203],
        [812.89711,432.29169],
        [810.42952,433.62677],
        [811.94912,435.07105],
        [817.55599,433.44165],
        [821.04287,439.25237]
    ]
],wa:[
    [
        [108.11646,157.8125],
        [112.33521,159.21875],
        [121.71021,161.875],
        [129.99146,163.75],
        [149.36646,169.21875],
        [171.55396,174.6875],
        [186.20718,177.96856],
        [185.23652,181.72262],
        [181.28029,195.07011],
        [176.97136,215.17847],
        [173.90114,230.77818],
        [173.56135,239.84306],
        [160.82136,236.07935],
        [145.77196,232.8094],
        [132.56258,233.3852],
        [131.0349,231.90428],
        [125.8867,233.73791],
        [122.04308,233.49569],
        [119.41267,231.79379],
        [117.88712,232.3016],
        [113.82254,232.08062],
        [112.01015,230.7548],
        [107.39313,229.07627],
        [105.99931,228.87655],
        [101.18043,227.59534],
        [99.457285,229.05289],
        [93.956383,228.72144],
        [89.296884,225.05418],
        [89.494475,224.28078],
        [89.560339,216.61265],
        [87.505735,212.85615],
        [83.528255,212.14861],
        [83.175558,209.87304],
        [80.745302,209.26698],
        [77.960205,208.75],
        [76.241455,209.6875],
        [74.053955,206.875],
        [74.366455,204.0625],
        [77.022705,203.75],
        [78.585205,199.84375],
        [76.085205,198.75],
        [76.241455,195.15625],
        [80.460205,194.53125],
        [77.803955,191.875],
        [76.397705,185],
        [77.022705,182.1875],
        [77.022705,174.53125],
        [75.303955,171.40625],
        [77.491455,162.34375],
        [79.522705,162.8125],
        [81.866455,165.625],
        [84.522705,168.125],
        [87.647705,170],
        [92.022705,172.03125],
        [94.991457,172.65625],
        [97.803957,174.0625],
        [101.08521,175],
        [103.27271,174.84375],
        [103.27271,172.5],
        [104.52271,171.40625],
        [106.55396,170.15625],
        [106.86646,171.25],
        [107.17896,172.96875],
        [104.99146,173.4375],
        [104.67896,175.46875],
        [106.39771,176.875],
        [107.49146,179.21875],
        [108.11646,181.09375],
        [109.52271,180.9375],
        [109.67896,179.6875],
        [108.74146,178.4375],
        [108.27271,175.3125],
        [109.05396,173.59375],
        [108.42896,172.1875],
        [108.42896,170],
        [110.14771,166.5625],
        [109.05396,164.0625],
        [106.71021,159.375],
        [107.02271,158.59375],
        [108.11646,157.8125]
    ],
    [
        [98.976267,163.59136],
        [100.9294,163.43511],
        [101.39815,164.76324],
        [102.88253,163.20073],
        [105.14816,163.20073],
        [105.92941,164.68511],
        [104.44503,166.32574],
        [105.07004,167.107],
        [104.36691,169.06013],
        [103.03878,169.45075],
        [103.03878,169.45075],
        [102.1794,169.52888],
        [102.1794,169.21638],
        [102.1794,168.90388],
        [103.58566,166.71637],
        [103.58566,166.71637],
        [101.94503,166.16949],
        [101.63253,167.57575],
        [100.9294,168.20075],
        [99.445017,166.01324],
        [98.976267,163.59136]
    ]
],wv:[
    [
        [748.91481,385.53277],
        [749.9896,390.31181],
        [751.03678,396.987],
        [754.47731,394.33075],
        [756.66481,391.36199],
        [759.11823,390.76704],
        [760.52449,389.36079],
        [762.24324,386.86079],
        [763.38357,387.48579],
        [766.19607,387.17329],
        [768.69608,385.14204],
        [770.6358,383.73741],
        [772.41928,383.26866],
        [773.67956,384.25111],
        [775.834,385.32833],
        [777.709,387.04708],
        [779.03713,388.29708],
        [778.89892,392.81181],
        [773.43015,389.84305],
        [769.05515,388.1243],
        [768.8989,393.28056],
        [768.43015,395.31181],
        [766.86765,397.96807],
        [766.24264,399.53057],
        [763.27389,401.87432],
        [762.80514,404.06183],
        [759.52388,404.37433],
        [759.21138,407.34308],
        [758.11763,412.65559],
        [755.61763,412.65559],
        [754.36763,411.87434],
        [752.80512,409.21808],
        [751.08637,409.37433],
        [750.77387,413.59309],
        [748.74262,419.99935],
        [743.89886,430.46812],
        [744.68011,431.71812],
        [744.52386,434.37437],
        [742.49261,436.24937],
        [741.08636,435.93687],
        [737.96135,438.28063],
        [735.46135,437.34313],
        [733.7426,441.87438],
        [733.7426,441.87438],
        [730.14884,442.65563],
        [729.52384,442.81188],
        [728.89884,442.96813],
        [727.18009,441.56188],
        [727.18009,441.56188],
        [724.83633,443.74938],
        [722.33633,444.37439],
        [719.52382,443.59313],
        [718.27382,442.34313],
        [716.15497,439.42096],
        [713.11756,437.49938],
        [710.61756,434.84312],
        [707.80506,431.24937],
        [707.18006,429.06186],
        [704.68005,427.65561],
        [703.8988,426.09311],
        [703.66442,421.01497],
        [705.7738,420.93685],
        [707.64881,420.1556],
        [707.80506,417.49935],
        [709.36756,416.09309],
        [709.52381,411.24934],
        [710.46131,407.49933],
        [711.71131,406.87433],
        [712.96131,407.96808],
        [713.43007,409.68683],
        [715.14882,408.74933],
        [715.61757,407.18683],
        [714.52382,405.46808],
        [714.52382,403.12432],
        [715.46132,401.87432],
        [717.64882,398.59307],
        [718.89882,397.18682],
        [720.93008,397.65557],
        [723.11758,396.09306],
        [726.08633,392.81181],
        [728.27384,389.0618],
        [728.58634,383.59305],
        [729.05509,378.74929],
        [729.05509,374.21803],
        [727.96134,371.24928],
        [728.89884,369.84302],
        [730.13936,368.59302],
        [733.51377,387.75656],
        [737.98979,387.03055],
        [748.91481,385.53277]
    ]
],wi:[
    [
        [610.10186,342.24552],
        [610.46021,339.375],
        [608.89771,335],
        [608.27271,329.0625],
        [607.17896,326.71875],
        [608.11646,323.75],
        [608.89771,320.9375],
        [610.30396,318.4375],
        [609.67896,315.15625],
        [609.05396,311.71875],
        [609.52271,310],
        [611.39771,307.65625],
        [611.55396,305],
        [610.77271,303.75],
        [611.39771,301.25],
        [611.86646,298.125],
        [614.52271,292.65625],
        [617.33521,286.09375],
        [617.49146,283.90625],
        [617.17896,282.96875],
        [616.39771,283.4375],
        [612.33521,289.53125],
        [609.67896,293.4375],
        [607.80396,295.15625],
        [607.02271,297.34375],
        [605.61646,298.125],
        [604.52271,300],
        [603.11646,299.6875],
        [602.96021,297.96875],
        [604.21021,295.625],
        [606.24146,291.09375],
        [607.96021,289.53125],
        [609.02467,287.31639],
        [607.44859,286.44143],
        [606.12276,285.1156],
        [604.57596,275.1719],
        [601.04043,274.06705],
        [599.7146,271.85734],
        [587.56119,269.20568],
        [585.13051,268.10083],
        [577.17555,265.89112],
        [569.22059,264.78626],
        [565.19067,259.56234],
        [564.67896,260.78125],
        [563.58521,260.625],
        [562.96021,259.53125],
        [560.30396,258.75],
        [559.21021,258.90625],
        [557.49146,259.84375],
        [556.55396,259.21875],
        [557.17896,257.34375],
        [559.05396,254.375],
        [560.14771,253.28125],
        [558.27271,251.875],
        [556.24146,252.65625],
        [553.42896,254.53125],
        [546.24146,257.65625],
        [543.42896,258.28125],
        [540.61646,257.8125],
        [539.66759,256.96364],
        [537.62173,259.70393],
        [537.40076,262.35558],
        [537.40076,270.53151],
        [536.2959,272.07831],
        [531.21357,275.83481],
        [529.00386,281.58006],
        [529.4458,281.80103],
        [531.87648,283.78977],
        [532.53939,286.88337],
        [530.77162,289.97696],
        [530.77162,293.73347],
        [531.21357,300.14163],
        [534.08619,303.01426],
        [537.40076,303.01426],
        [539.16853,306.10785],
        [542.48309,306.54979],
        [546.2396,312.07407],
        [553.0897,316.05155],
        [555.07844,318.7032],
        [555.96233,325.88477],
        [556.62524,329.08884],
        [558.83495,330.63564],
        [559.05592,331.96147],
        [557.06718,335.27603],
        [557.28815,338.36963],
        [559.71884,342.12614],
        [562.14952,343.23099],
        [565.02214,343.67293],
        [566.31955,345.00686],
        [575.18603,345.00684],
        [600.38075,343.56973],
        [610.10186,342.24552]
    ]
],wy:[
    [
        [360.07049,290.62761],
        [349.8744,289.84759],
        [318.86033,286.66246],
        [303.17138,284.67372],
        [275.77097,280.69624],
        [256.54649,277.82362],
        [255.1749,288.62554],
        [251.46416,312.07413],
        [246.38182,341.46328],
        [244.90206,351.6275],
        [243.28823,363.11844],
        [249.59376,364.01574],
        [274.60698,366.43199],
        [294.48769,368.66178],
        [330.04033,372.63923],
        [353.06413,375.40353],
        [357.41769,332.69024],
        [358.80937,308.16245],
        [360.07049,290.62761]
    ]
]},zoomVisible:false,defaultZoom:"wa,ak,hi,me,fl"}},mapCoords:null,constructor:function(a) {
    if (!a.chart.id) {
        a.chart.id = Ext.id()
    }
    var b = this.mapConfig = this.mapTypes[a.chart.mapType];
    this.data = Ext.apply({}, {zoomAll:b.zoomAll,zoomDisplay:b.zoomVisible ? "" : "display:none;"}, a.chart);
    if (b.zoomVisible) {
        this.MAP_CTRL_SIZE = 35;
        if (Ext.isIE) {
            this.MAP_CTRL_SIZE = 34
        } else {
            if (Ext.isGecko3) {
                this.MAP_CTRL_SIZE = 32
            }
        }
    } else {
        this.MAP_CTRL_SIZE = 0
    }
    this.worldmapcfg = (function() {
        var c = {id:a.chart.id,bgcolor:"#ccdeeb",fgcolor:"#ffffff",bordercolor:"#999999",borderwidth:0.5,zoom:b.defaultZoom,detail:a.chart.detail};
        return c
    }());
    Explore.view.common.MapPanel.superclass.constructor.call(this, Ext.apply({listeners:{afterlayout:this.initMap},tpl:new Ext.XTemplate('<div class="world-map-ctrl">', '<div class="legend">', "</div>", "</div>", '<canvas id="{id}" height="10"></canvas>', '<div class="world-map-ctrl" style="{zoomDisplay}">', '<div class="dropdown">', '<select id="world-map-dropdown-{id}" style="margin-top:5px">', '<option value="">{zoomAll}<option value="af">Afghanistan<option value="ax">Aland Islands<option value="al">Albania<option value="dz">Algeria<option value="as">American Samoa<option value="ad">Andorra<option value="ao">Angola<option value="ai">Anguilla<option value="ag">Antigua And Barbuda<option value="ar">Argentina<option value="am">Armenia<option value="aw">Aruba<option value="au">Australia<option value="at">Austria<option value="az">Azerbaijan<option value="bs">Bahamas<option value="bh">Bahrain<option value="bd">Bangladesh<option value="bb">Barbados<option value="by">Belarus<option value="be">Belgium<option value="bz">Belize<option value="bj">Benin<option value="bt">Bhutan<option value="bo">Bolivia<option value="ba">Bosnia And Herzegovina<option value="bw">Botswana<option value="br">Brazil<option value="bn">Brunei Darussalam<option value="bg">Bulgaria<option value="bf">Burkina Faso<option value="bi">Burundi<option value="kh">Cambodia<option value="cm">Cameroon<option value="ca">Canada<option value="ky">Cayman Islands<option value="cf">Central African Republic<option value="td">Chad<option value="cl">Chile<option value="cn">China<option value="co">Colombia<option value="cg">Congo<option value="cr">Costa Rica<option value="ci">Cote D\'ivoire<option value="hr">Croatia<option value="cu">Cuba<option value="cy">Cyprus<option value="cz">Czech Republic<option value="cd">Democratic Republic Of The Congo<option value="dk">Denmark<option value="dj">Djibouti<option value="dm">Dominica<option value="do">Dominican Republic<option value="ec">Ecuador<option value="eg">Egypt<option value="sv">El Salvador<option value="gq">Equatorial Guinea<option value="er">Eritrea<option value="ee">Estonia<option value="et">Ethiopia<option value="fk">Falkland Islands<option value="fj">Fiji<option value="fi">Finland<option value="fr">France<option value="gf">French Guiana<option value="tf">French Southern Territories<option value="ga">Gabon<option value="gm">Gambia<option value="ge">Georgia<option value="de">Germany<option value="gh">Ghana<option value="gi">Gibraltar<option value="gr">Greece<option value="gl">Greenland<option value="gd">Grenada<option value="gp">Guadeloupe<option value="gt">Guatemala<option value="gn">Guinea<option value="gw">Guinea-bissau<option value="gy">Guyana<option value="ht">Haiti<option value="hm">Heard Island And Mcdonald Islands<option value="hn">Honduras<option value="hk">Hong Kong<option value="hu">Hungary<option value="is">Iceland<option value="in">India<option value="id">Indonesia<option value="ir">Iran<option value="iq">Iraq<option value="ie">Ireland<option value="il">Israel<option value="it">Italy<option value="jm">Jamaica<option value="jp">Japan<option value="jo">Jordan<option value="kz">Kazakhstan<option value="ke">Kenya<option value="kp">Korea (North)<option value="kr">Korea (South)<option value="kw">Kuwait<option value="kg">Kyrgyzstan<option value="la">Laos<option value="lv">Latvia<option value="lb">Lebanon<option value="ls">Lesotho<option value="lr">Liberia<option value="ly">Libya<option value="lt">Lithuania<option value="lu">Luxembourg<option value="mk">Macedonia<option value="mg">Madagascar<option value="mw">Malawi<option value="my">Malaysia<option value="ml">Mali<option value="mt">Malta<option value="mq">Martinique<option value="mr">Mauritania<option value="mx">Mexico<option value="md">Moldova<option value="mc">Monaco<option value="mn">Mongolia<option value="me">Montenegro<option value="ms">Montserrat<option value="ma">Morocco<option value="mz">Mozambique<option value="mm">Myanmar<option value="na">Namibia<option value="np">Nepal<option value="nl">Netherlands<option value="an">Netherlands Antilles<option value="nc">New Caledonia<option value="nz">New Zealand<option value="ni">Nicaragua<option value="ne">Niger<option value="ng">Nigeria<option value="no">Norway<option value="om">Oman<option value="pk">Pakistan<option value="pa">Panama<option value="pg">Papua New Guinea<option value="py">Paraguay<option value="pe">Peru<option value="ph">Philippines<option value="pl">Poland<option value="pt">Portugal<option value="pr">Puerto Rico<option value="qa">Qatar<option value="ro">Romania<option value="ru">Russian Federation<option value="rw">Rwanda<option value="lc">Saint Lucia<option value="vc">Saint Vincent And The Grenadines<option value="sa">Saudi Arabia<option value="sn">Senegal<option value="rs">Serbia<option value="sl">Sierra Leone<option value="sg">Singapore<option value="sk">Slovak Republic<option value="si">Slovenia<option value="sb">Solomon Islands<option value="so">Somalia<option value="za">South Africa<option value="es">Spain<option value="lk">Sri Lanka<option value="sd">Sudan<option value="sr">Suriname<option value="sz">Swaziland<option value="se">Sweden<option value="ch">Switzerland<option value="sy">Syria<option value="tw">Taiwan<option value="tj">Tajikistan<option value="tz">Tanzania<option value="th">Thailand<option value="tl">Timor-leste<option value="tg">Togo<option value="to">Tonga<option value="tt">Trinidad And Tobago<option value="tn">Tunisia<option value="tr">Turkey<option value="tm">Turkmenistan<option value="ug">Uganda<option value="ua">Ukraine<option value="ae">United Arab Emirates<option value="gb">United Kingdom<option value="us">United States<option value="uy">Uruguay<option value="uz">Uzbekistan<option value="vu">Vanuatu<option value="ve">Venezuela<option value="vn">Vietnam<option value="wf">Wallis And Futuna Islands<option value="ye">Yemen<option value="zm">Zambia<option value="zw">Zimbabwe', "</select>", "</div>", "</div>")}, a))
},getZoomEl:function() {
    return Ext.getDom("world-map-dropdown-" + this.chart.id)
},doZoom:function() {
    var a = this.getZoomEl();
    var b = a[a.selectedIndex].value;
    this.oScaledWorldMap = Explore.view.common.MapImpl(Ext.apply({}, {zoom:b}, this.worldmapcfg), this.mapConfig.coords)
},initMap:function() {
    var o = this;
    var t = false;
    var l;
    var q = false;
    var n = {x:0,y:0};
    var a = {x:0,y:0};
    var b = {x:0,y:0};
    var f = Ext.getDom(this.chart.id);
    var d;
    var g = false;
    var m;
    var k = "";
    if (Ext.isIE8 || Ext.isIE7) {
        G_vmlCanvasManager.initElement(f)
    }
    function p(E, B, A) {
        var D,C,y,G,x,F = 0;
        var z = false;
        var w = E.length;
        for (D = 0,C = w - 1; D < w; C = D++) {
            y = E[D][0];
            G = E[D][1];
            x = E[C][0];
            F = E[C][1];
            if (((G > A) != (F > A)) && (B < (x - y) * (A - G) / (F - G) + y)) {
                z = !z
            }
        }
        return z
    }

    function r(x, w) {
        var y = o.oScaledWorldMap[x];
        for (var z = 0; z < y.length; z++) {
            var A = y[z];
            if (p(A, w.x, w.y)) {
                return true
            }
        }
        return false
    }

    function j(x) {
        var y = o.getZoomEl();
        var w = 0;
        for (w = 0; w < y.length; w++) {
            if (y[w].value === x) {
                y.selectedIndex = w;
                break
            }
        }
    }

    function e(x) {
        if (!x) {
            x = window.event
        }
        var y = (document.documentElement && document.documentElement.scrollLeft !== null) ? document.documentElement : document.body;
        var w = {x:(x.pageX === null || x.pageX === undefined) ? x.x + y.scrollLeft : x.layerX,y:(x.pageY === null || x.pageY === undefined) ? x.y + y.scrollTop : x.layerY};
        return w
    }

    function u(x) {
        if (!x) {
            x = window.event
        }
        var y = (document.documentElement && document.documentElement.scrollLeft !== null) ? document.documentElement : document.body;
        var w = {x:(x.pageX === null || x.pageX === undefined) ? x.clientX + y.scrollLeft : x.pageX,y:(x.pageY === null || x.pageY === undefined) ? x.clientY + y.scrollTop : x.pageY};
        return w
    }

    function s(w) {
        if (w && o.oScaledWorldMap) {
            for (var x in o.oScaledWorldMap) {
                if (o.oScaledWorldMap.hasOwnProperty(x) && r(x, w)) {
                    return x
                }
            }
        }
        return null
    }

    function h() {
        if (t && !q) {
            q = true;
            if (!g) {
                var w = s(a);
                var x = false;
                if (w) {
                    if (w === m && d) {
                        x = true
                    } else {
                        var y = o.chart.detail[w];
                        if (y && y.label) {
                            m = w;
                            x = true;
                            d = new Ext.QuickTip();
                            d.html = y.label
                        }
                    }
                }
                if (x && d) {
                    d.showAt([n.x + 10,n.y + 10])
                } else {
                    if (d) {
                        d.hide()
                    }
                }
                g = true
            }
            q = false
        }
    }

    function c() {
        clearInterval(l)
    }

    function v() {
        c();
        l = setInterval(h, 100)
    }

    f.onmouseout = function(w) {
        t = false
    };
    f.onmouseover = function(w) {
        t = true
    };
    f.onmousemove = function(w) {
        b = a;
        a = e(w);
        n = u(w);
        g = false
    };
    f.ondblclick = function(y) {
        var w = e(y);
        var x = s(w);
        if (x) {
            k = (x === k) ? "" : x;
            j(k);
            o.oScaledWorldMap = Explore.view.common.MapImpl(Ext.apply({}, {zoom:k}, o.worldmapcfg), this.mapConfig.coords)
        }
    };
    this.on({afterlayout:{fn:this.drawMap,scope:this,buffer:800}});
    Ext.get(this.getZoomEl()).on({change:{fn:this.doZoom,scope:this},keypress:{fn:this.doZoom,scope:this,delay:50}});
    o.removeListener("beforehide", c);
    o.addListener("beforehide", c);
    o.removeListener("beforedestroy", c);
    o.addListener("beforedestroy", c);
    v()
},drawMap:function() {
    var a = this.chart;
    var b = Ext.getDom(a.id);
    var d = this.body.getWidth();
    var c = this.body.getHeight();
    b.setAttribute("width", d);
    b.setAttribute("height", Math.max(0, c - this.MAP_CTRL_SIZE));
    this.oScaledWorldMap = Explore.view.common.MapImpl(this.worldmapcfg, this.mapConfig.coords)
}});
Ext.reg("explore.view.common.map", Explore.view.common.MapPanel);
Ext.form.MultiSelectDropDown = Ext.extend(Ext.form.TriggerField, {triggerClass:"x-form-trigger",defaultAutoCreate:{tag:"input",type:"text",size:"10",autocomplete:"off"},editable:false,lazyInit:false,hiddenValue:"",value:null,valueSeparator:";",textSeparator:", ",loadingText:Explore.i18n("Loading list..."),containerHeight:"",containerWidth:"",store:null,mode:"remote",valueField:"value",displayField:"text",selectedKeys:null,showAllCheckbox:false,allItemsText:Explore.i18n("All"),allItemsValue:"--ALL--",initComponent:function() {
    Ext.form.MultiSelectDropDown.superclass.initComponent.call(this);
    if (Ext.isArray(this.store)) {
        if (Ext.isArray(this.store[0])) {
            this.store = new Ext.data.SimpleStore({id:"value",fields:["value","text"],data:this.store});
            this.valueField = "value"
        } else {
            this.store = new Ext.data.ArrayStore({id:"text",fields:["text"],data:this.store,expandData:true});
            this.valueField = "text"
        }
        this.displayField = "text";
        this.mode = "local"
    }
},onRender:function(b, a) {
    Ext.form.MultiSelectDropDown.superclass.onRender.call(this, b, a);
    if (this.hiddenName) {
        this.hiddenField = this.el.insertSibling({tag:"input",type:"hidden",name:this.hiddenName,id:(this.hiddenId || this.hiddenName)}, "before", true);
        this.hiddenField.value = this.hiddenValue !== undefined ? this.hiddenValue : this.value !== undefined ? this.value : "";
        this.el.dom.removeAttribute("name")
    }
    if (this.menu == null) {
        this.menu = new Ext.menu.Menu();
        this.menu.on("hide", function() {
            if (this.tmp != this.lastSelectionText && this.lastSelectionText != "") {
                this.tmp = this.lastSelectionText;
                this.fireEvent("change", this)
            }
        }, this);
        this.store.on("load", function() {
            this.buildMenuItems()
        }, this);
        this.buildMenuItems()
    }
},buildMenuItems:function() {
    this.menu.removeAll();
    if (this.showAllCheckbox) {
        this.headerCheck = new Explore.view.common.TristateCheckMenuItem({text:this.initialConfig.allItemsText,hideOnClick:false,listeners:{checkchange:this.checkAllHandler,scope:this}});
        this.menu.add(this.headerCheck)
    }
    this.checkItems = [];
    this.store.each(function(a) {
        this.checkItems.push(new Ext.menu.CheckItem({text:a.data[this.displayField],value:a.data[this.valueField],hideOnClick:false,listeners:{checkchange:this.checkHandler,scope:this,delay:10}}))
    }, this);
    this.menu.add(this.checkItems);
    if (this.showAllCheckbox) {
        this.headerCheck.monitorChecks(this.checkItems)
    }
    this.populateList()
},getStore:function() {
    return this.store
},initValue:function() {
    if (this.selectedKeys !== null) {
        this.setValues(this.selectedKeys);
        this.originalValue = this.getValue()
    }
},onTriggerClick:function() {
    if (this.disabled) {
        return
    }
    this.menu.show(this.el, "bl");
    if (this.containerHeight != "" && this.menu.el.getHeight() > this.containerHeight) {
        this.menu.el.setHeight(this.containerHeight);
        this.menu.el.dom.style.overflowY = "auto"
    }
    var a = this.containerWidth != "" ? this.containerWidth : (this.width > this.menu.el.getWidth() ? this.width - 1 : this.menu.el.getWidth());
    this.menu.items.each(function(b) {
        b.el.setWidth(a);
        b.el.dom.style.overflowX = "hidden"
    }, this);
    this.menu.el.setWidth(a);
    this.menu.el.dom.style.overflowX = "hidden";
    this.populateList()
},validateBlur:function() {
    return !this.menu || !this.menu.isVisible()
},getValue:function() {
    if (this.showAllCheckbox && (this.headerCheck.checked === true)) {
        return this.allItemsValue
    } else {
        if (this.hiddenField) {
            return this.hiddenField.value || ""
        } else {
            if (this.valueField) {
                return typeof this.value != "undefined" ? this.value : ""
            } else {
                return Ext.form.MultiSelectDropDown.superclass.getValue.call(this)
            }
        }
    }
},setValue:function(a, b) {
    if (b == undefined && a != undefined) {
        this.setValues(a.split(this.valueSeparator));
        return
    }
    if (a == undefined) {
        a = "";
        b = ""
    }
    this.lastSelectionText = b;
    if (this.hiddenField) {
        this.hiddenField.value = a
    }
    Ext.form.MultiSelectDropDown.superclass.setValue.call(this, b);
    this.value = a;
    if (b.trim() == "") {
        Ext.QuickTips.unregister(this.el)
    } else {
        Ext.QuickTips.register({target:this.el,text:b})
    }
},getValues:function() {
    var a = [];
    if (this.showAllCheckbox && (this.headerCheck.checked === true)) {
        a.push(this.allItemsValue)
    } else {
        if (this.showAllCheckbox && (this.headerCheck.checked === false)) {
        } else {
            if (this.checkItems) {
                for (var c = 0;
                     c < this.checkItems.length; c++) {
                    var b = this.checkItems[c];
                    if (b.checked) {
                        a.push(b.value)
                    }
                }
            }
        }
    }
    return a
},setValues:function(c) {
    this.selectedKeys = c;
    var e = "";
    var d = "";
    for (var a = 0; a < c.length; a++) {
        if (c[a] === this.allItemsValue) {
            d = this.allItemsValue;
            e = this.allItemsText;
            break
        } else {
            if (c[a] != undefined && c[a] != "") {
                var b = this.store.query(this.valueField, c[a]).items[0];
                if (b != undefined) {
                    d += (d != "" ? this.valueSeparator : "") + b.data[this.valueField];
                    e += (e != "" ? this.textSeparator : "") + b.data[this.displayField]
                }
            }
        }
    }
    this.setValue(d, e)
},updateUI:function() {
    this.selectedKeys = this.getValues();
    this.setValues(this.selectedKeys)
},onDestroy:function() {
    if (this.menu) {
        this.menu.destroy()
    }
    if (this.wrap) {
        this.wrap.remove()
    }
    Ext.form.MultiSelectDropDown.superclass.onDestroy.call(this)
},checkHandler:function(a, b) {
    this.updateUI()
},checkAllHandler:function(a, b) {
    this.updateUI()
},clearAllChecks:function() {
    if (this.showAllCheckbox) {
        this.headerCheck.setChecked(false, true)
    } else {
        for (var a = 0; a < this.checkItems.length;
             a++) {
            var b = this.checkItems[a];
            b.setChecked(false, true)
        }
    }
},populateList:function(a) {
    if (this.selectedKeys !== null) {
        if (this.showAllCheckbox && this.selectedKeys.length === 1 && this.selectedKeys[0] === this.allItemsValue) {
            this.headerCheck.setChecked(true, true)
        } else {
            this.clearAllChecks();
            for (var b = 0; b < this.selectedKeys.length; b++) {
                try {
                    var c = this.store.query(this.valueField, this.selectedKeys[b]).items[0].data[this.valueField];
                    this.menu.items.each(function(e) {
                        if (e.value === c) {
                            e.setChecked(true, true)
                        }
                    }, this)
                } catch(d) {
                }
            }
            if (this.showAllCheckbox) {
                this.headerCheck.updateMyStateFromChecks()
            }
        }
    } else {
        this.clearAllChecks()
    }
}});
Ext.reg("multiselectdropdown", Ext.form.MultiSelectDropDown);
Ext.ns("Explore.view.common");
Explore.view.common.PositiveNumberField = Ext.extend(Ext.form.NumberField, {allowNegatives:false,allowDecimals:false,allowBlank:false});
Ext.reg("explore.view.common.positivenumberfield", Explore.view.common.PositiveNumberField);
Ext.ns("Explore.view.common");
Explore.view.common.ProgressColumn = Ext.extend(Ext.grid.Column, {tpl:new Ext.XTemplate("<tpl if=\"align == 'left'\">", '<div class="ux-progress-cell-inner ux-progress-cell-inner-{align} ux-progress-cell-background">', "<div>{value}</div>", "</div>", '<div class="ux-progress-cell-inner ux-progress-cell-inner-{align} ux-progress-cell-foreground {cls}" style="width:{pct}%" ext:qtip="{qtip}">', '<div ext:qtip="{qtip}">{value}</div>', "</div>", "</tpl>", "<tpl if=\"align != 'left'\">", '<div class="ux-progress-cell-inner ux-progress-cell-inner-{align} ux-progress-cell-foreground {cls}" ext:qtip="{qtip}">', '<div ext:qtip="{qtip}">{value}</div>', "</div>", '<div class="ux-progress-cell-inner ux-progress-cell-inner-{align} ux-progress-cell-background" style="left:{pct}%">', '<div style="left:-{pct}%">{value}</div>', "</div>", "</tpl>"),constructor:function(a) {
    if (a.renderer) {
        this.baseRenderer = a.renderer;
        a = Ext.apply({}, a);
        delete a.renderer
    }
    Ext.grid.Column.call(this, a);
    this.renderer = Explore.view.common.ProgressColumn.prototype.renderer.createDelegate(this)
},getBarClass:function(a) {
    return(a > 0.98) ? "high" : (a > 0.75) ? "medium" : "low"
},getFraction:function(e, f, a, g, c, b) {
    var d = 0;
    if (a) {
        if (this.dividend) {
            d = a.get(this.dividend) / e
        } else {
            if (this.divisor) {
                d = e / a.get(this.divisor)
            }
        }
        if (d < 0) {
            d = 0
        } else {
            if (d > 1) {
                d = 1
            }
        }
    }
    return d
},getQtip:function(e, f, a, g, c, b, d) {
    return Ext.util.Format.number(d, "0.00%")
},baseRenderer:function(a) {
    return a
},renderer:function(c, h, a, b, f, d) {
    var g = this.getFraction.apply(this, arguments),e = g * 100,j;
    Array.prototype.push.call(arguments, e);
    j = this.baseRenderer.apply(this, arguments);
    if (a) {
        h.css += " x-grid3-td-progress-cell";
        return this.tpl.apply({align:this.align || "left",value:j,pct:g * 100,qtip:this.getQtip.apply(this, arguments),cls:this.getBarClass(g)})
    } else {
        return j
    }
}});
Ext.ns("Explore.view.common");
Explore.view.common.RelatedConcepts = Ext.extend(Ext.tree.TreePanel, {relatedTermsAction:null,initComponent:function() {
    var b = this;
    var f = ["relatedConceptClick"];
    b.addEvents(f);
    b.enableBubble(f);
    var a = new Ext.tree.TreeLoader({dataUrl:"dummyurl",baseAttrs:{leaf:false,checked:false}});
    var d = {title:Explore.i18n("SearchResultReportTypeRelatedConcepts"),root:{nodeType:"async",text:"",id:"relatedConceptRootNode",children:[]},loader:a,checkable:true,collapsible:false,useArrows:true,autoScroll:true,animate:true,enableDD:false,containerScroll:true,rootVisible:false};
    Ext.apply(this, Ext.apply(this.initialConfig, d));
    Explore.view.common.RelatedConcepts.superclass.initComponent.apply(this, arguments);
    b.on("click", function(g) {
        g.getUI().toggleCheck()
    });
    b.on("contextmenu", function(g, h) {
        h.stopEvent();
        if (!g.getUI().isChecked()) {
            g.getUI().toggleCheck()
        }
        b.getContextMenu().showAt(h.xy)
    }, this);
    a.on("beforeload", function(n, k, m) {
        var h = new Ext.LoadMask(b.getEl(), {msg:"Loading Related Concepts"});
        h.show();
        var l = {};
        Ext.apply(l, b.searchCriteria);
        l.searchTerms = k.text;
        log.info("[RelatedConcepts.beforeload] using terms: " + l.searchTerms);
        var g = 6;
        var j = {};
        Explore.data.IDOLDataStore.retrieveRelatedConcepts(l, j, function(o) {
            h.hide();
            b.loadChildren(k, o)
        });
        return false
    });
    b.loadChildren = function(k, g) {
        if (g) {
            for (var j = 0; j < g.length; j++) {
                var h = g[j];
                h.iconCls = "no-icon";
                if (k && k.parentNode && k.parentNode.parentNode && k.parentNode.parentNode.parentNode && k.parentNode.parentNode.parentNode.parentNode && k.parentNode.parentNode.parentNode.parentNode.parentNode) {
                    h.leaf = true
                }
                k.appendChild(h)
            }
        }
    };
    var c = Ext.getCmp("searchPanel");
    if (c) {
        var e = c.getSearchPresenter();
        if (e) {
            e.on("newSearchStarted", function(h, g) {
            });
            e.on("newSearchCompleted", function(h, g) {
                c.clearRelatedConcepts();
                e.loadRelatedConceptsByCriteria(h, g)
            });
            e.on("searchErrored", function(g) {
                c.clearRelatedConcepts()
            })
        }
    }
},getContextMenu:function() {
    if (!this._contextMenu) {
        var c = this;
        var a = this.addToTopicAction = new Ext.Action({text:Explore.i18n("AddToCreateTopic"),id:"addToTopic",handler:function() {
            c.addToCreateTopic()
        }});
        var b = this.addToLexiconAction = new Ext.Action({text:Explore.i18n("AddToLexicon"),id:"addToLexicon",handler:function() {
            c.addToLexicon()
        }});
        this._contextMenu = new Ext.menu.Menu({items:[a,b]})
    }
    return this._contextMenu
},processSearch:function() {
    var c = this.getCheckedTerms();
    var b = "(";
    var d = "{0} ";
    for (var a = 0; a < c.length; a++) {
        b += String.format(d, c[a])
    }
    b += ")";
    this.fireEvent("relatedConceptClick", [b])
},getCheckedTerms:function() {
    var b = this.getChecked();
    var e = [];
    for (var c = 0; c < b.length; c++) {
        var d = b[c];
        var a = this.getSearchTerms(d);
        e = e.concat(a)
    }
    return e
},getSearchTerms:function(b) {
    var a = [];
    var c = b;
    if (this.relatedTermsAction !== "NEW") {
        while (c != null && c.text != "") {
            a.push(c.text);
            c = c.parentNode
        }
    } else {
        a.push(c.text)
    }
    return a.reverse()
},addToCreateTopic:function() {
    var a = this.getCheckedTerms();
    var b = new Explore.view.TopicManagerDialog({terms:a});
    b.show()
},addToLexicon:function() {
    var a = this.getCheckedTerms();
    var b = new Explore.view.LexiconManagerDialog({terms:a});
    b.show()
},clearConcepts:function() {
    var a = this.getRootNode();
    while (a.childNodes.length > 0) {
        a.removeChild(a.childNodes[0])
    }
},showConcepts:function(d, c) {
    this.searchCriteria = c;
    if (d != null && d.length) {
        var a = this.getRootNode();
        for (var b = 0; b < d.length; b++) {
            var e = d[b];
            e.iconCls = "no-icon";
            a.appendChild(e)
        }
    }
}});
Ext.reg("explore.view.common.relatedconcepts", Explore.view.common.RelatedConcepts);
Ext.ns("Explore.view.common");
Explore.view.common.RelatedConceptViews = Ext.extend(Ext.Panel, {RelatedConceptLayoutIndex:0,CloudLayoutIndex:1,relatedTermsAction:null,initComponent:function() {
    var a = {layout:new Ext.layout.CardLayout({layoutOnCardChange:true}),title:Explore.i18n("SearchResultReportTypeRelatedConcepts"),activeItem:this.RelatedConceptLayoutIndex,items:[
        {xtype:"explore.view.common.relatedconcepts",itemId:"relatedConcepts",margins:"0",border:false,header:false,relatedTermsAction:this.relatedTermsAction},
        {xtype:"panel",margins:"0",border:false,header:false,bodyCssClass:"search-cloud-panel",layout:"fit",items:{xtype:"explore.view.common.cloud",itemId:"searchCloud",explore:{autofit:true}}}
    ]};
    this.initTools(a);
    Ext.apply(this, Ext.apply(this.initialConfig, a));
    Explore.view.common.RelatedConceptViews.superclass.initComponent.apply(this, arguments);
    this.toolDecorator = new Explore.view.common.DisabledToolDecorator(this, a)
},showRelatedConcepts:function() {
    this.getLayout().setActiveItem(this.RelatedConceptLayoutIndex);
    this.setTitle("Related Concepts");
    this.toolDecorator.hideTools(["collapse"]);
    this.toolDecorator.showTools(["cloud","applyFilter"])
},showCloud:function() {
    this.getLayout().setActiveItem(this.CloudLayoutIndex);
    this.setTitle("Ideas Cloud");
    this.toolDecorator.hideTools(["cloud","applyFilter"]);
    this.toolDecorator.showTools(["collapse"])
},initTools:function(a) {
    var b = this;
    a.tools = [
        {id:"collapse",qtip:Explore.i18n("ShowListView"),hidden:(b.RelatedConceptLayoutIndex === 0),handler:function(e, d, c) {
            b.showRelatedConcepts()
        }},
        {id:"cloud",qtip:Explore.i18n("ShowCloudView"),hidden:(b.RelatedConceptLayoutIndex !== 0),handler:function(e, d, c) {
            b.showCloud()
        }},
        {id:"applyFilter",qtip:Explore.i18n("Search"),hidden:(b.RelatedConceptLayoutIndex !== 0),handler:function(e, d, c) {
            b.getByItemId("relatedConcepts").processSearch()
        }}
    ]
},clearConcepts:function() {
    var a = this.getByItemId("relatedConcepts");
    a.clearConcepts()
},showConcepts:function(b, a) {
    var c = this.getByItemId("relatedConcepts");
    c.showConcepts(b, a)
},setDataItems:function(b) {
    var a = this.getByItemId("searchCloud");
    a.setDataItems(b)
},getCurrentData:function(e) {
    var c = [];
    var h = this.getLayout().activeItem.xtype;
    if (h === "explore.view.common.relatedconcepts") {
        var f = 2;

        function j(n, l, p) {
            var o = {text:n.text,weight:n.tag};
            l.push(o);
            if (e && p <= f) {
                o.children = [];
                n.expand(false, false, function() {
                    for (var q = 0; q < n.childNodes.length; q++) {
                        j(n.childNodes[q], o.children, p + 1)
                    }
                })
            } else {
                if (n.childNodes != null && n.childNodes.length > 0) {
                    for (var m = 0; m < n.childNodes.length; m++) {
                        j(n.childNodes[m], l, p)
                    }
                }
            }
        }

        var k = this.getByItemId("relatedConcepts");
        var a = k.getRootNode();
        for (var d = 0; d < a.childNodes.length; d++) {
            j(a.childNodes[d], c, 1)
        }
    } else {
        var b = this.getByItemId("searchCloud");
        var g = b.getDataItems();
        for (var d = 0; d < g.length; d++) {
            c.push({text:g[d].term,weight:g[d].weight})
        }
    }
    return c
}});
Ext.reg("explore.view.common.relatedconceptviews", Explore.view.common.RelatedConceptViews);
Ext.ns("Explore.view.common");
Explore.view.common.SelectBoxField = Ext.extend(Ext.form.ComboBox, {disableKeyFilter:true,editable:false,enableKeyEvents:true,emptyText:"--" + Explore.i18n("select_one") + "--",forceSelection:true,mode:"local",triggerAction:"all",typeAhead:true,valueField:"id",displayField:"text",initComponent:function() {
    if (!this.store) {
        var a = this.initialConfig.options;
        if (a) {
            if (a.length > 0 && Ext.isArray(a[0])) {
                this.store = new Ext.data.ArrayStore({id:0,fields:[this.valueField,this.displayField],data:a})
            } else {
                this.store = new Ext.data.JsonStore({id:this.valueField,fields:[this.valueField,this.displayField],data:a})
            }
        }
    }
    Explore.view.common.SelectBoxField.superclass.initComponent.apply(this, arguments);
    this.on("keydown", this._onKeyDown, this)
},setOptions:function(a) {
    this.getStore().loadData(a)
},_onKeyDown:function(a, d) {
    var k = d.getKey();
    var j = String.fromCharCode(k);
    if (!this.store.getCount()) {
        return
    }
    switch (k) {case Ext.EventObject.HOME:d.stopEvent();this._selectIndexSpecialKey(0, true);
        return;case Ext.EventObject.END:d.stopEvent();this._selectIndexSpecialKey(this.store.getCount() - 1, true);return;case Ext.EventObject.PAGEUP:d.stopEvent();
        this._selectIndexSpecialKey(0, true);return;case Ext.EventObject.PAGEDOWN:d.stopEvent();this._selectIndexSpecialKey(this.store.getCount() - 1, true);
        return
    }
    var c = this.valueField;
    var l = this.displayField;
    var b = this.view.getSelectedIndexes();
    var g = (b.length > 0) ? b[0] : null;
    var h = (g == null) ? 0 : ++g;
    var f = this.store.find(l, j, h, false);
    if (f == -1 && h > 0) {
        f = this.store.find(l, j, 0, false)
    }
    if (f >= 0) {
        this._selectIndex(f)
    }
},_selectIndexSpecialKey:function(a) {
    if (this.isExpanded()) {
        this.select(a)
    }
},_selectIndex:function(b) {
    var a = this.store.getAt(b);
    this.select(b);
    this.setValue(a.data[this.valueField || this.displayField]);
    this.fireEvent("select", this, a, b)
}});
Ext.reg("selectboxfield", Explore.view.common.SelectBoxField);
Ext.ns("Explore.view");
Explore.view.common.SelectBoxFilter = Ext.extend(Explore.view.common.SelectBoxField, {filterConfig:null,lazyInit:false,lazyRender:false,valueField:"FilterTag",displayField:"Name",selectOnFocus:true,value:"",includeEmptyItem:true,checkValidOnHide:true,tpl:'<tpl for="."><div class="{[ values.IsGroup ? "x-combo-list-item x-combo-group-item" : "x-combo-list-item" ]}" style="padding-left:{[ 5 + values.Level * 10]}px">{Name}</div></tpl>',initComponent:function() {
    this.store = new Ext.data.JsonStore({fields:["FilterTag","Name","IsGroup","Level"],data:[]});
    if (this.filterConfig) {
        this.setFilters(this.filterConfig)
    }
    Explore.view.common.SelectBoxFilter.superclass.initComponent.apply(this, arguments)
},setFilters:function(b) {
    this.filterConfig = b;
    var a = [];
    if (this.includeEmptyItem) {
        a.push({Name:Explore.i18n("_selectAFilter_"),FilterTag:""})
    }
    this.addFilters(a, b, 0);
    this.getStore().loadData(a)
},addFilters:function(e, f, h) {
    if (f.Groups) {
        for (var b = 0; b < f.Groups.length;
             b++) {
            var d = f.Groups[b];
            e.push({Name:d.Name,FilterTag:"--" + d.Name,Level:h,IsGroup:true});
            this.addFilters(e, d, h + 1)
        }
    }
    if (f.Items) {
        for (var a = 0;
             a < f.Items.length; a++) {
            var c = f.Items[a];
            if (c.Name === "Sentiment" && !(Explore.data.PreferenceDataStore.getShowSentimentPreference())) {
                log.info("Not showing sentiment because of preferences")
            } else {
                e.push({Name:c.Name,FilterTag:c.FilterTag,Level:h,IsGroup:false,Item:c})
            }
        }
    }
},isValid:function() {
    var a = Explore.view.common.SelectBoxFilter.superclass.isValid.call(this);
    if (!this.isVisible()) {
        if (this.checkValidOnHide) {
            return a
        } else {
            return true
        }
    }
    return a
},validateValue:function(b) {
    if (this.disabled || this.hidden) {
        return true
    }
    var a = null;
    var c = this.getValue();
    if (!this.allowBlank && (c == null || c == "")) {
        a = Explore.i18n("A valid selection is required")
    }
    if (c.indexOf("--") === 0) {
        a = Explore.i18n("Filter groups may not be selected")
    }
    if (a === null) {
        return true
    } else {
        this.markInvalid(a);
        return false
    }
}});
Ext.reg("selectboxfilter", Explore.view.common.SelectBoxFilter);
Ext.ns("Explore.view.common");
Explore.view.common.SentimentFormField = Ext.extend(Ext.ButtonGroup, {value:null,initComponent:function() {
    var b = this;
    var a = {fieldLabel:"Change Sentiment",width:"100%",defaults:{style:{marginRight:"10px"}},items:[
        {xtype:"button",cls:"btn-no-border",iconCls:"positiveIcon",margins:"0 10 0 0",sentiment:"Positive",itemId:"PositiveSentimentButton",scope:this,handler:this.changeSentiment},
        {xtype:"button",cls:"btn-no-border",iconCls:"neutralIcon",margins:"0 10 0 0",sentiment:"Neutral",itemId:"NeutralSentimentButton",scope:this,handler:this.changeSentiment},
        {xtype:"button",cls:"btn-no-border",iconCls:"negativeIcon",margins:"0 10 0 0",sentiment:"Negative",itemId:"NegativeSentimentButton",scope:this,handler:this.changeSentiment}
    ]};
    Ext.apply(this, a);
    Explore.view.common.SentimentFormField.superclass.initComponent.apply(this, arguments)
},setValue:function(e) {
    var c = this,b = c.getByItemId("PositiveSentimentButton"),d = c.getByItemId("NeutralSentimentButton"),a = c.getByItemId("NegativeSentimentButton");
    if (e) {
        b.setDisabled(false);
        a.setDisabled(false);
        d.setDisabled(false);
        if (e === "Positive") {
            b.setDisabled(true);
            c.value = e
        } else {
            if (e === "Neutral") {
                d.setDisabled(true);
                c.value = e
            } else {
                if (e === "Negative") {
                    a.setDisabled(true);
                    c.value = e
                }
            }
        }
    }
},getValue:function() {
    return this.value
},changeSentiment:function(b) {
    var a = this;
    a.setValue(b.sentiment);
    a.fireEvent("sentimentpressed", b.sentiment)
},getAutomationAction:function() {
    var c = this.rule,a = c.getActionByType("AddSentiment");
    var b = new Explore.data.model.AutomationAction({Action:Explore.model.AutomationAction.AddSentiment,EngagementItem:new Explore.data.model.EngagementItem({Sentiment:this.getValue()})});
    if (a) {
        b.Id = a.Id
    }
    return this.getValue() ? b : null
}});
Ext.reg("explore.view.common.sentimentformfield", Explore.view.common.SentimentFormField);
Ext.ns("Explore.view.common");
Explore.view.common.Spectrograph = Ext.extend(Explore.base.WidgetBase, {projectId:null,DEFAULT_SIZE:512,scaleX:1,scaleY:1,stretch:true,errorCls:"",urlPrefix:"../",_SpectrographResults:null,currentSearchId:null,currentSearchType:null,searchType:null,searchId:null,initComponent:function() {
    var a = this;
    a.projectId = Explore.presenter.ProjectsPresenter.getCurrentProjectId();
    var d = Ext.id();
    Explore.ensureExtDirect(a.initialConfig.applicationBaseURL);
    if (typeof a.initialConfig.applicationBaseURL !== "undefined") {
        a.urlPrefix = a.initialConfig.applicationBaseURL;
        if (!a.urlPrefix.match(/\/$/)) {
            a.urlPrefix += "/"
        }
    }
    var b = {layout:"card",border:false,items:[
        {xtype:"container",cls:this.errorCls,items:{xtype:"component",autoEl:{tag:"span",html:"(" + Explore.i18n("selectSavedSearch_spectrograph") + ")"}}},
        {xtype:"container",itemId:"statusPanel",border:false,items:{xtype:"panel",border:false,padding:"12 12 12 12",width:"75%",items:[
            {xtype:"label",itemId:"statuslabel",text:""},
            {xtype:"container",height:10,border:false},
            {xtype:"button",text:Explore.i18n("submitNewSpectrographJob"),handler:function() {
                a.submitSpectrographJob()
            }}
        ]}},
        {xtype:"container",itemId:"spectrographMainPanel",layout:new Explore.layout.SpectrographImageLayout({stretch:a.stretch}),listeners:{resize:function(f, g, e) {
            if (a.stretch) {
                a.scaleX = g / a.DEFAULT_SIZE;
                a.scaleY = e / a.DEFAULT_SIZE
            } else {
                a.scaleX = a.scaleY = Math.min(g, e) / a.DEFAULT_SIZE
            }
            a._setupImageMap()
        }},items:[
            {itemId:"spectrographsImage",xtype:"component",autoEl:{tag:"img",cls:"spectrographs-image",usemap:"#spectrographsImageMap" + d}},
            {itemId:"spectrographsImageMap",xtype:"component",autoEl:{tag:"map",cls:"spectrographs-image-map",name:"spectrographsImageMap" + d}}
        ]}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.common.Spectrograph.superclass.initComponent.apply(this, arguments);
    a.on("afterrender", function() {
        if (a.searchId && a.searchType) {
            var e = {searchId:a.searchId,searchType:a.searchType};
            if (typeof e.searchType === "string") {
                e.searchtype = parseInt(e.searchType, 10)
            }
            a.doSearch(e)
        }
    });
    var c = true;
    a.on("afterlayout", function() {
        if (c) {
            c = false;
            if (this.ownerCt.getItemId() === "cardContainer") {
                a.showBusy()
            }
        }
    })
},getCoords:function(j) {
    var c = this.scaleX * j.X1;
    var e = this.scaleY * (j.Y1 - j.RadiusFrom);
    var h = this.scaleX * j.X1;
    var a = this.scaleY * (j.Y1 + j.RadiusFrom);
    var f = this.scaleX * j.X2;
    var g = this.scaleY * (j.Y2 + j.RadiusTo);
    var b = this.scaleX * j.X2;
    var d = this.scaleY * (j.Y2 - j.RadiusTo);
    return String.format("{0},{1},{2},{3},{4},{5},{6},{7}", c, e, h, a, f, g, b, d)
},_setupImageMap:function() {
    log.debug("setupImageMap for Spectrogaph scale = ", this.scaleX, this.scaleY);
    if (this._SpectrographResults != null) {
        var c = this.getByItemId("spectrographsImage");
        var f = this.getByItemId("spectrographsImageMap");
        var b = [];
        var a = this._SpectrographResults.imageMap;
        for (var e = 0; e < a.length;
             e++) {
            var d = a[e];
            var g = Explore.i18n("Title") + ": " + d.Title;
            b.push(String.format('<area title="{0}" href="#" onclick="return Explore.view.SpectrographsAreaClick(this, {2}, \'{3}\');" shape="poly" alt="{0}" coords="{1}" />', g, this.getCoords(d), d.Id, this.id))
        }
    }
    if (f && f.el && f.el.dom) {
        f.el.dom.innerHTML = b.join("")
    }
},exportData:function() {
    if (this._SpectrographResults != null) {
        Explore.utils.Exporter.exportSpectrographImage(this.urlPrefix + this._SpectrographResults.imageSrc)
    } else {
        this.showError(Explore.i18n("ExportNotSupported_PleaseWaitUntilTheSpectrographHasLoaded_"))
    }
},setStatus:function(b) {
    var a = b || "";
    var c = this.getByItemId("statuslabel");
    if (c) {
        c.setText(a)
    }
},submitSpectrographJob:function() {
    if (this.currentSearchId && this.currentSearchType) {
        Explore.data.ClusterDataStore.submitSpectrographJobForSavedSearch(this.currentSearchId, this.projectId);
        this.setStatus(Explore.i18n("NewSpectrographSubmttedTryLater"))
    }
},closeBusyMessage:function() {
    this.hideStatus();
    if (Explore.view.StatusBox && Explore.view.StatusBox.close) {
        Explore.view.StatusBox.close()
    }
},doSearch:function(c) {
    var a = this;
    a.currentSearchId = c.searchId;
    a.currentSearchType = c.searchType;
    var b = a.getByItemId("spectrographsImage");
    var d = a.getByItemId("spectrographsImageMap");
    if (b.rendered && d.rendered) {
        b.el.dom.src = Ext.BLANK_IMAGE_URL;
        d.el.dom.innerHTML = ""
    }
    this._SpectrographResults = null;
    if (a.currentSearchType !== 1) {
        a.getLayout().setActiveItem(0);
        a.closeBusyMessage();
        return
    } else {
        Explore.data.SpectrographDataStore.getSpectrographResultInfo(c.searchId, a.projectId, function(e) {
            if (c.canceled) {
                log.debug("search was canceled. Ignoring results.")
            } else {
                if (e == null) {
                    a.getLayout().setActiveItem(1);
                    Explore.data.SpectrographDataStore.getSpectrographErrorInfo(c.searchId, c.searchType, a.projectId, function(f) {
                        if (f != null) {
                            a.setStatus(Explore.i18n("" + f.ID))
                        }
                    })
                } else {
                    if (e.imageMap.length == 0) {
                        a.getLayout().setActiveItem(1);
                        Explore.data.SpectrographDataStore.getSpectrographErrorInfo(c.searchId, c.searchType, a.projectId, function(f) {
                            if (f != null) {
                                a.setStatus(Explore.i18n("" + f.ID))
                            }
                        })
                    } else {
                        a.getLayout().setActiveItem(2);
                        a.doLayout();
                        a._SpectrographResults = e;
                        b.el.dom.src = a.urlPrefix + e.imageSrc;
                        a._setupImageMap()
                    }
                }
            }
            a.closeBusyMessage()
        })
    }
},getSpectrographById:function(b) {
    var a = this._SpectrographResults.imageMap;
    for (var d = 0; d < a.length;
         d++) {
        var c = a[d];
        if (c.Id === b.toString()) {
            return c
        }
    }
    return null
},areaClick:function(a) {
    log.info("spectrographs areaClick: " + a);
    var b = Explore.showSearchPanel();
    if (b) {
        var c = this.getSpectrographById(a);
        Explore.data.IDOLDataStore.getSearchCriteriaBySearchId(this.currentSearchId, function(d) {
            _Title = '"' + c.Title.replace(/, /g, '","') + '"';
            d.searchTerms = "SAVEDSEARCH::(" + d.Name + ")+AND+(" + _Title + ")";
            d.searchTermsUI = "SAVEDSEARCH::(" + d.Name + ")+AND+(" + _Title + ")";
            d.searchType = 0;
            d.projectId = Explore.presenter.ProjectsPresenter.getCurrentProjectId();
            d.timezoneOffsetMilliseconds = Explore.getLocalTimeZoneOffset();
            b.searchByCriteria(d, {bypassBusyMessage:false})
        })
    }
    return false
}});
Ext.reg("explore.view.common.spectrograph", Explore.view.common.Spectrograph);
Explore.view.SpectrographsAreaClick = function(b, a, c) {
    var d = Ext.getCmp(c);
    d.areaClick(a);
    return false
};
Ext.ns("Explore.layout");
Explore.layout.SpectrographImageLayout = Ext.extend(Ext.layout.ContainerLayout, {stretch:true,monitorResize:true,onLayout:function(d, g) {
    Explore.layout.SpectrographImageLayout.superclass.onLayout.call(this, d, g);
    if (!this.container.collapsed) {
        var f = (Ext.isIE6 && Ext.isStrict && g.dom == document.body) ? g.getViewSize() : g.getStyleSize();
        var b = d.items.itemAt(0);
        var c = d.items.itemAt(1);
        var e,a;
        if (this.stretch) {
            a = f.height;
            e = f.width
        } else {
            e = a = Math.min(f.width, f.height)
        }
        if (e > 0 && a > 0 && (e != this.lastWidth || a != this.lastHeight)) {
            log.debug("SpectrographImageLayout size", e, a);
            this.lastWidth = e;
            this.lastHeight = a;
            b.el.setSize(e, a)
        }
    }
}});
Ext.namespace("Explore.view.common");
Explore.view.common.TipIconPlugin = {init:function(a) {
    a.on("afterrender", this._onLayout, this, {single:true})
},_onLayout:function(a) {
    if (a.fieldLabelTip || a.helpText) {
        var b = a.getEl().up("div.x-form-item").query("label");
        if (window.console) {
        }
        if (b.length > 0) {
            Ext.DomHelper.append(b[0], {tag:"img",src:Ext.BLANK_IMAGE_URL,style:"display:inline;width:16px;height:16px;vertical-align:bottom;margin-left:5px","ext:qtip":a.fieldLabelTip || a.helpText,cls:"x-tool-info"})
        }
    }
}};
Ext.ns("Explore.view.common");
Explore.view.common.TristateCheck = Ext.extend(Ext.Component, {checked:false,checksToMonitor:null,initComponent:function() {
    var a = this;
    var b = {autoEl:{tag:"span",cls:this.getClassName(),html:this.boxLabel},listeners:{render:function(c) {
        c.el.on("click", function(f, d) {
            log.debug("tristate-checkbox clicked.");
            a.toggleState();
            a.fireEvent("check", a, this.checked)
        })
    }}};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.common.TristateCheck.superclass.initComponent.apply(this, arguments)
},getClassName:function() {
    var a = "tristateCheckbox";
    if (this.checked === true) {
        a += " tristateCheckbox-checked"
    } else {
        if (this.checked === false) {
            a += " tristateCheckbox-unchecked"
        }
    }
    return a
},toggleState:function() {
    if (this.checked === true) {
        this.setValue(false)
    } else {
        this.setValue(true)
    }
},updateMyStateFromChecks:function() {
    if (this.checksToMonitor != null) {
        var c = true;
        var a = true;
        for (var d = 0; d < this.checksToMonitor.length; d++) {
            var b = this.checksToMonitor[d];
            if (b.el && b.el.dom) {
                var e = b.el.dom.checked;
                c = (!e) && c;
                a = e && a
            }
        }
        if (c) {
            this.setValue(false)
        } else {
            if (a) {
                this.setValue(true)
            } else {
                this.setValue("mixed")
            }
        }
    }
},updateChecks:function(b) {
    for (var a = 0;
         a < this.checksToMonitor.length; a++) {
        var c = this.checksToMonitor[a];
        if (c.el && c.el.dom) {
            c.el.dom.checked = b;
            c.el.dom.defaultChecked = b
        }
    }
},getValue:function() {
    return this.checked
},setValue:function(b) {
    this.checked = b;
    var a = this.getClassName();
    if (this.el && this.el.dom) {
        this.el.dom.className = a
    }
    if (typeof b === "boolean") {
        this.updateChecks(b)
    }
},monitorChecks:function(c) {
    var b = this;
    this.checksToMonitor = c;
    if (c) {
        for (var d = 0;
             d < c.length; d++) {
            var a = c[d];
            a.on("check", b.updateMyStateFromChecks, this)
        }
    }
    this.updateMyStateFromChecks()
}});
Ext.reg("explore.view.common.tristatecheck", Explore.view.common.TristateCheck);
Ext.ns("Explore.view.common");
Explore.view.common.TristateCheckMenuItem = Ext.extend(Ext.menu.CheckItem, {checksToMonitor:null,itemCls:"x-menu-item x-menu-tristate-check-item",itemClsChecked:"x-menu-tristate-item-checked",itemClsUndetermined:"x-menu-tristate-item-undetermined",setChecked:function(b, a) {
    var c = a === true;
    if (this.checked !== b && (c || this.fireEvent("beforecheckchange", this, b) !== false)) {
        Ext.menu.MenuMgr.onCheckChange(this, b);
        this.checked = b;
        this.updateUI();
        this.updateChecks(this.checked);
        if (!c) {
            this.fireEvent("checkchange", this, b)
        }
    }
},updateUI:function() {
    if (this.container) {
        if (this.checked === true) {
            this.container.addClass(this.itemClsChecked);
            this.container.removeClass(this.itemClsUndetermined)
        } else {
            if (this.checked === false) {
                this.container.removeClass(this.itemClsChecked);
                this.container.removeClass(this.itemClsUndetermined)
            } else {
                this.container.removeClass(this.itemClsChecked);
                this.container.addClass(this.itemClsUndetermined)
            }
        }
    }
},updateMyStateFromChecks:function() {
    if (this.checksToMonitor != null) {
        var c = true;
        var a = true;
        for (var d = 0; d < this.checksToMonitor.length;
             d++) {
            var b = this.checksToMonitor[d];
            var e = b.checked;
            c = (!e) && c;
            a = e && a
        }
        if (c) {
            this.checked = false
        } else {
            if (a) {
                this.checked = true
            } else {
                this.checked = "mixed"
            }
        }
        this.updateUI()
    }
},updateChecks:function(b) {
    if (this.checked === true || this.checked === false) {
        for (var a = 0;
             a < this.checksToMonitor.length; a++) {
            var c = this.checksToMonitor[a];
            c.setChecked(b, true)
        }
    }
},monitorChecks:function(c) {
    var b = this;
    this.checksToMonitor = c;
    if (c) {
        for (var d = 0; d < c.length; d++) {
            var a = c[d];
            a.on("checkchange", this.updateMyStateFromChecks, this)
        }
    }
    this.updateMyStateFromChecks()
}});
Ext.reg("explore.view.common.tristatecheckmenuitem", Explore.view.common.TristateCheck);
Ext.ns("Explore.view.common");
Explore.view.common.EngagementPriorityCombo = Ext.extend(Explore.view.common.SelectBoxField, {width:165,fieldLabel:Explore.i18n("Priority"),initComponent:function() {
    var b = this;
    var a = {emptyText:"",options:[
        [Explore.model.EngagementPriority.High,Explore.i18n("High")],
        [Explore.model.EngagementPriority.Medium,Explore.i18n("Medium")],
        [Explore.model.EngagementPriority.Low,Explore.i18n("Low")]
    ]};
    Ext.apply(this.initialConfig, a);
    Explore.view.common.EngagementPriorityCombo.superclass.initComponent.apply(this, arguments);
    b.on("select", this.onPriorityChange, this)
},onPriorityChange:function(d, a, c) {
    var b = this;
    b.fireEvent("priorityselected", d, a, c)
},getAutomationAction:function() {
    var b = this.rule,c = b.getActionByType("ChangePriority");
    var a = new Explore.data.model.AutomationAction({Action:Explore.model.AutomationAction.ChangePriority,EngagementItem:new Explore.data.model.EngagementItem({Priority:this.getValue()})});
    if (c) {
        a.Id = c.Id
    }
    return this.getValue() ? a : null
}});
Ext.reg("explore.view.common.engagementprioritycombo", Explore.view.common.EngagementPriorityCombo);
Ext.ns("Explore.view.common");
Explore.view.common.EngagementStatusCombo = Ext.extend(Explore.view.common.SelectBoxField, {width:165,val:null,initComponent:function() {
    var b = this;
    var a = {fieldLabel:Explore.i18n("Status"),store:{xtype:"jsonstore",autoDestroy:true,fields:["Id","Name"],data:[]},valueField:"Id",displayField:"Name"};
    Ext.apply(this, a);
    Explore.view.common.EngagementStatusCombo.superclass.initComponent.apply(this, arguments);
    b.populateStatus();
    b.on("select", this.onStatusChange, this)
},setValue:function(a) {
    if (this.loaded) {
        Explore.view.common.EngagementStatusCombo.superclass.setValue.call(this, a)
    } else {
        this.on("loaded", function() {
            this.setValue(a)
        }, this, {single:true})
    }
},populateStatus:function() {
    var b = this,a = b.getStore();
    Explore.data.EngagementDataStore.listAll(function(c) {
        a.loadData(c || []);
        b.loaded = true;
        b.fireEvent("loaded")
    })
},onStatusChange:function(d, a, c) {
    var b = this;
    b.fireEvent("statusselected", d, a, c)
},getAutomationAction:function() {
    var c = this.rule,b = c.getActionByType("ChangeStatus");
    var a = new Explore.data.model.AutomationAction({Action:Explore.model.AutomationAction.ChangeStatus,EngagementItem:new Explore.data.model.EngagementItem({PreviousStatus:(b && b.EngagementItem && b.EngagementItem.CurrentStatus) ? b.EngagementItem.CurrentStatus : 0,CurrentStatus:this.getValue()})});
    if (b) {
        a.Id = b.Id
    }
    return this.getValue() ? a : null
}});
Ext.reg("explore.view.common.engagementstatuscombo", Explore.view.common.EngagementStatusCombo);
Explore.view.DeleteProgressBar = Ext.extend(Ext.ProgressBar, {initComponent:function() {
    var a = this;
    var c = this.initialConfig || {};
    var b = {animate:true,listeners:{update:this.completeCheck},numItems:100,text:Explore.i18n("Calculating_")};
    Ext.apply(this, Ext.apply(b, this.initialConfig));
    Explore.view.DeleteProgressBar.superclass.initComponent.apply(this, arguments);
    this.on("update", this.completeCheck)
},updateBar:function(b, a) {
    this.syncSize();
    if (!a) {
        a = (b / this.numItems) + "% Complete"
    }
    this.updateProgress(b, a)
},deletingItemUpdate:function(b) {
    var a = "Deleting " + (b + 1) + " of " + this.numItems;
    this.updateBar(b / this.numItems, a, true)
},completeCheck:function(b, a, c) {
    if (a >= 1) {
        b.fireEvent("completed")
    }
},updateNumItems:function(a) {
    this.numItems = a
}});
Ext.reg("explore.view.deleteprogressbar", Explore.view.DeleteProgressBar);
Ext.ns("Explore.view");
Explore.view.RecursiveDeleteWindow = Ext.extend(Ext.Window, {initComponent:function() {
    var a = this;
    var c = this.initialConfig || {};
    var b = {autoShow:true,resizable:false,closable:false,constrain:true,height:70,width:500,layout:"fit",modal:true,valComplete:0,stop:false,renderTo:Ext.getBody(),items:[
        {xtype:"explore.view.deleteprogressbar",itemId:"progressbar",listeners:{completed:function() {
            a.close()
        }}}
    ],fbar:[
        {xtype:"button",itemId:"cancelButton",text:Explore.i18n("Cancel"),hidden:false,handler:this.cancelButtonAction,scope:this}
    ]};
    Ext.apply(this, Ext.apply(b, this.initialConfig));
    Explore.view.RecursiveDeleteWindow.superclass.initComponent.apply(this, arguments);
    this.on("deletecancled", function() {
        a.cancelButtonAction()
    });
    if (!this.numGroup) {
        this.numGroup = this.results.length
    }
},start:function() {
    var a = this;
    a.show();
    a.updateAllProgress();
    a.deleteNext()
},callDeleteOnItem:function(e, b, g, f, c) {
    var a = this;
    var d = new Explore.view.DeleteConfirmationWindow({mytype:e,deleteFn:b,myId:g,itemName:c,callback:f,showDeletingMask:false,silentDelete:true});
    d.on("itemdeleted", function() {
        a.valComplete += 1;
        a.updateAllProgress();
        a.deleteNext()
    });
    d.on("deletecancled", function() {
        a.fireEvent("canceled");
        if (a.cancelFn) {
            a.cancelFn()
        }
        a.close()
    });
    if (c) {
        a.setBarText(e, c, false)
    }
    d.start()
},callDeleteOfGroup:function(e, c, f, b, d) {
    var a = this;
    if (d) {
        a.setBarText(e, d, true)
    }
    c(f, function(g) {
        if (b) {
            b(g)
        }
        a.valComplete += 1;
        a.updateAllProgress();
        a.deleteNext()
    }, true)
},setBarText:function(b, a, c) {
    var d;
    if (c) {
        d = Explore.i18n("Deleting") + " " + Explore.i18n(b) + " " + Explore.i18n("group_1") + ": " + a
    } else {
        d = Explore.i18n("Deleting") + " " + Explore.i18n(b) + ": " + a
    }
    this.setProgressBarText(d)
},deleteNext:function() {
    if (this.stop) {
        return
    }
    if (!this.results) {
        this.cancelButtonAction()
    } else {
        var a = this.results.pop();
        if (a) {
            if (a.leaf) {
                this.callDeleteOnItem(this.mytype, this.deleteFn, a.Id, this.callback, a.name)
            } else {
                this.callDeleteOfGroup(this.mytype, this.deleteGroupFn, a.Id, this.groupDelCallback, a.name)
            }
        } else {
            this.doneFn();
            this.close()
        }
    }
},cancelButtonAction:function() {
    this.stop = true;
    if (this.cancelFn) {
        this.cancelFn()
    }
    this.close()
},updateAllProgress:function() {
    try {
        var a = this.getByItemId("progressbar");
        a.updateNumItems(this.numGroup);
        a.deletingItemUpdate(this.valComplete)
    } catch(b) {
    }
},setProgressBarText:function(c) {
    try {
        var a = this.getByItemId("progressbar");
        a.updateText(c)
    } catch(b) {
    }
}});
Ext.reg("explore.view.recursivedeletewindow", Explore.view.RecursiveDeleteWindow);
Ext.ns("Explore.view");
Explore.view.DeleteConfirmationWindow = Ext.extend(Ext.Window, {initComponent:function() {
    var a = this;
    var c = this.initialConfig || {};
    var b = {autoShow:true,autoScroll:true,title:a.getTitle(),closable:false,constrain:true,height:400,width:700,layout:"fit",showDeletingMask:true,resizable:false,modal:true,renderTo:Ext.getBody(),items:[a.getDependencyGrid()],fbar:[
        {xtype:"button",itemId:"cancelButton",text:Explore.i18n("Cancel"),hidden:false,handler:this.cancelButtonAction,scope:this}
    ]};
    Ext.apply(this, Ext.apply(b, this.initialConfig));
    Explore.view.DeleteConfirmationWindow.superclass.initComponent.apply(this, arguments);
    a.on("show", function() {
        a.refreshGrid()
    })
},deleteButtonAction:function() {
},deleteOrignal:function() {
    var b = this;
    b.hide();
    var a = new Ext.LoadMask(Ext.getBody(), {msg:"Deleting..."});
    a.show();
    var c = function(e) {
        if (b.callback && e !== null) {
            a.hide();
            b.callback(e)
        } else {
            if (b.callback) {
                b.callback()
            }
        }
        a.hide();
        b.fireEvent("itemdeleted");
        b.close()
    };
    try {
        if (b.silentDelete) {
            this.deleteFn(this.myId, c, true)
        } else {
            this.deleteFn(this.myId, c)
        }
    } catch(d) {
        Explore.view.StatusBox.showError(Explore.i18n("ErrorWithRequest"), Explore.i18n("DeleteRequestFailingToCompleteAtThisTime"));
        b.fireEvent("deletecancled");
        b.close()
    }
},getTitle:function() {
    var a = Explore.i18n("DependencyResolution");
    if (this.itemName) {
        a = this.itemName + " - " + a
    }
    return a
},getDependencyGrid:function() {
    if (this.mytype === "Lexicon") {
        return this.getTopicGrid()
    } else {
        if (this.mytype === "Role") {
            return this.getUserGrid()
        } else {
            return this.getProjectGrid()
        }
    }
},getTopicGrid:function() {
    var a = this;
    return{xtype:"explore.view.deletetopicspanel",itemId:"deletepanel",parent:a,projName:a.itemName,mytype:this.mytype,myId:this.myId,listeners:{edittopic:function(b) {
        a.editTopic(b)
    },deletetopic:function(b) {
        a.deleteTopic(b)
    },closeall:function() {
        a.close()
    },readyfordelete:function() {
        a.deleteOrignal()
    }}}
},getProjectGrid:function() {
    var a = this;
    return{xtype:"explore.view.deleteprojectspanel",itemId:"deletepanel",parent:a,projName:a.itemName,mytype:this.mytype,myId:this.myId,listeners:{editproject:function(b) {
        a.editProject(b)
    },deleteproject:function(b) {
        a.deleteProject(b)
    },closeall:function() {
        a.close()
    },readyfordelete:function() {
        a.deleteOrignal()
    }}}
},getUserGrid:function() {
    var a = this;
    return{xtype:"explore.view.deleteuserspanel",itemId:"deletepanel",parent:a,projName:a.itemName,mytype:this.mytype,myId:this.myId,listeners:{edituser:function(b) {
        a.editUser(b)
    },deleteuser:function(b) {
        a.deleteUser(b)
    },closeall:function() {
        a.close()
    },readyfordelete:function() {
        a.deleteOrignal()
    }}}
},start:function() {
    var c = this;
    var a = new Ext.LoadMask(Ext.getBody(), {msg:"Deleting..."});
    if (c.showDeletingMask) {
        a.show()
    }
    var d = c.getByItemId("deletepanel");
    var b = d.getStore();
    var e = function(h) {
        var g = h ? h.length : 0;
        if (g === 0) {
            c.deleteOrignal()
        } else {
            c.show();
            b.loadData(h)
        }
        a.hide()
    };
    if (c.mytype) {
        try {
            if (c.mytype === "Source") {
                Explore.data.ProjectDataStore.getProjectsUsingDataSource(this.myId, e)
            } else {
                if (c.mytype === "Project") {
                    c.deleteOrignal()
                } else {
                    if (c.mytype === "Snapshot") {
                        Explore.data.ProjectDataStore.getProjectsUsingSnapshot(this.myId, e)
                    } else {
                        if (c.mytype === "Topic") {
                            Explore.data.ProjectDataStore.getProjectsUsingTopic(this.myId, e)
                        } else {
                            if (c.mytype === "User") {
                                Explore.data.ProjectDataStore.getProjectsForUser(this.myId, e)
                            } else {
                                if (c.mytype === "Lexicon") {
                                    Explore.data.TopicDataStore.getTopicsUsingLexicon(this.myId, e)
                                } else {
                                    if (c.mytype === "DataImport") {
                                        Explore.data.ProjectDataStore.getProjectsUsingDataImport(this.myId, e)
                                    } else {
                                        if (c.mytype === "Role") {
                                            Explore.data.UserDataStore.getUsersInRole(this.myId, e)
                                        } else {
                                            log.info("Type: " + c.mytype + " is not supported by DeleteConfirmationWindow. Calling callback");
                                            c.deleteOrignal()
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        } catch(f) {
            a.hide()
        }
    }
},refreshGrid:function() {
    var a = this;
    var b = a.getByItemId("deletepanel");
    b.refreshItems()
},cancelButtonAction:function() {
    this.fireEvent("deletecancled");
    this.close()
},editTopic:function(b) {
    var c = this;
    var a = new Ext.LoadMask(c.getEl(), {msg:Explore.i18n("EditTopic")});
    a.show();
    var e = b.TopicSectionId;
    var d = b.Id;
    var f = Explore.i18n("ViewTopic") + " " + String.format(Explore.i18n("RemoveTopic"), b.Name);
    var g = false;
    Explore.data.TopicDataStore.getTopic(d, function(j) {
        if (j !== null) {
            log.debug("Open topic dialog for topic: ", d, " config: ", h);
            var h = {editObject:j,readOnly:g,title:f,adminMode:false,allowLexiconEdit:false};
            var k = new Explore.view.TopicDialog(h);
            log.info("TopicPicker.saveTopic sectionId=", e, j);
            k.show(this);
            k.on("beforeclose", function() {
                a.hide()
            });
            k.on("save", function(m, l) {
                Explore.data.TopicDataStore.saveTopic(e, j, function(n) {
                    a.hide();
                    c.refreshGrid()
                })
            })
        }
    })
},deleteTopic:function(b) {
    var c = this;
    var a = new Ext.LoadMask(c.body, {msg:Explore.i18n("DeleteTopic")});
    a.show();
    Explore.data.TopicDataStore.deleteTopic(b.Id, function(d) {
        c.refreshGrid();
        a.hide()
    })
},editProject:function(b) {
    var c = this;
    var a = new Ext.LoadMask(c.body, {msg:Explore.i18n("EditProject")});
    a.show();
    Explore.data.ProjectDataStore.getProject(b.Id, function(e) {
        var d = new Explore.view.EditProjectDefinitionDialog({editObject:e,readOnly:false,mytype:c.mytype,association:c.itemName,listeners:{save:function() {
            Explore.data.ProjectDataStore.save(e, function() {
                c.refreshGrid();
                a.hide()
            })
        },beforeclose:function() {
            a.hide()
        }}});
        d.show()
    })
},deleteProject:function(b) {
    var c = this;
    var a = new Ext.LoadMask(c.body, {msg:Explore.i18n("DeleteProject")});
    a.show();
    Explore.data.ProjectDataStore.deleteProject(b.Id, function(d) {
        c.refreshGrid();
        a.hide()
    })
},editUser:function(b) {
    var c = this;
    var a = new Ext.LoadMask(c.body, {msg:Explore.i18n("EditUser")});
    a.show();
    Explore.data.UserDataStore.getUser(b.Id, function(d) {
        if (d != null) {
            var e = new Explore.view.UserDialog({editObject:d,readOnly:false,listeners:{save:function() {
                Explore.data.UserDataStore.saveUser(d, function() {
                    c.refreshGrid();
                    a.hide()
                })
            },beforeclose:function() {
                a.hide()
            }}});
            e.show(c)
        }
    })
},deleteUser:function(b) {
    var c = this;
    var a = new Ext.LoadMask(c.body, {msg:Explore.i18n("DeleteUser")});
    a.show();
    Explore.data.UserDataStore.deleteUser(b.Id, function(d) {
        c.refreshGrid();
        a.hide()
    })
}});
Ext.reg("explore.view.deleteconfirmationwindow", Explore.view.DeleteConfirmationWindow);
Ext.ns("Explore.view");
Explore.view.deleteProjectPanel = Ext.extend(Ext.Panel, {initComponent:function() {
    var a = this;
    var c = this.initialConfig || {};
    var b = {border:false,frame:false,layout:"fit",items:[
        {xtype:"panel",layout:"border",items:[a.getGrid()]}
    ]};
    Ext.apply(this, Ext.apply(b, this.initialConfig));
    Explore.view.deleteProjectPanel.superclass.initComponent.apply(this, arguments)
},getStore:function() {
    var a = this;
    if (!a.store) {
        a.store = new Ext.data.JsonStore({fields:[
            {name:"Name"}
        ]})
    }
    return a.store
},refreshItems:function() {
    var c = this;
    var a = new Ext.LoadMask(c.body, {msg:Explore.i18n("CheckingForDependencies")});
    a.show();
    var b = c.getStore();
    var d = function(f) {
        b.loadData(f);
        var e = b.getCount();
        a.hide();
        if (e === 0) {
            c.dependencyBroken()
        }
    };
    if (c.mytype) {
        a.show();
        if (c.mytype === "Source") {
            Explore.data.ProjectDataStore.getProjectsUsingDataSource(this.myId, d)
        } else {
            if (c.mytype === "Project") {
                c.dependencyBroken()
            } else {
                if (c.mytype === "Snapshot") {
                    Explore.data.ProjectDataStore.getProjectsUsingSnapshot(this.myId, d)
                } else {
                    if (c.mytype === "Topic") {
                        Explore.data.ProjectDataStore.getProjectsUsingTopic(this.myId, d)
                    } else {
                        if (c.mytype === "User") {
                            Explore.data.ProjectDataStore.getProjectsForUser(this.myId, d)
                        } else {
                            if (c.mytype === "DataImport") {
                                Explore.data.ProjectDataStore.getProjectsUsingDataImport(this.myId, d)
                            }
                        }
                    }
                }
            }
        }
    } else {
        c.closeWindow()
    }
    a.hide()
},closeWindow:function() {
    this.fireEvent("closeall")
},dependencyBroken:function() {
    this.fireEvent("readyfordelete")
},createGrid:function() {
    var c = this;
    var b = c.getStore();
    var a = [
        {id:"Name",header:"Project Name",width:60,sortable:true,dataIndex:"Name"}
    ];
    var f = new Ext.Button({itemId:"editbutton",text:Explore.i18n("Edit"),disabled:true,iconCls:"edit-icon",handler:function() {
        var h = d.getSelectionModel();
        var g = h.getSelected();
        if (g) {
            c.fireEvent("editproject", g.json)
        }
    }});
    var e = new Ext.Button({itemId:"deletebutton",disabled:true,text:Explore.i18n("Delete"),iconCls:"delete-icon",handler:function() {
        var h = d.getSelectionModel();
        var g = h.getSelected();
        if (g) {
            c.fireEvent("deleteproject", g.json)
        }
    }});
    var d = new Ext.grid.GridPanel({store:b,region:"center",itemId:"grid",loadMask:true,tbar:[f,e],columns:a,autoExpandColumn:"Name",title:c.getDescriptionPanel()});
    d.getSelectionModel().on("rowselect", function(j, h, g) {
        f.enable();
        e.enable()
    });
    d.on("rowcontextmenu", function(h, g, j) {
        j.stopEvent();
        var l = h.getSelectionModel();
        l.selectRow(g, false, false);
        var k = new Ext.menu.Menu({items:[
            {text:Explore.i18n("Edit"),handler:function() {
                var m = l.getSelected();
                c.fireEvent("editproject", m.json)
            }},
            {text:Explore.i18n("Delete"),handler:function() {
                var m = l.getSelected();
                c.fireEvent("deleteproject", m.json)
            }}
        ]});
        k.showAt(j.xy)
    });
    return d
},getGrid:function() {
    var a = this.getByItemId("grid");
    if (a === null) {
        a = this.createGrid()
    }
    return a
},getDescriptionPanel:function() {
    var a = Explore.i18n("DependencyHeader");
    a = String.format(a, this.projName, Explore.i18n(this.mytype.toLowerCase()));
    return a
}});
Ext.reg("explore.view.deleteprojectspanel", Explore.view.deleteProjectPanel);
Ext.ns("Explore.view");
Explore.view.deleteTopicsPanel = Ext.extend(Ext.Panel, {initComponent:function() {
    var a = this;
    var c = this.initialConfig || {};
    var b = {border:false,frame:false,layout:"fit",items:[
        {xtype:"panel",layout:"border",items:[a.getGrid()]}
    ]};
    Ext.apply(this, Ext.apply(b, this.initialConfig));
    Explore.view.deleteTopicsPanel.superclass.initComponent.apply(this, arguments)
},getStore:function() {
    var a = this;
    if (!a.store) {
        a.store = new Ext.data.JsonStore({fields:[
            {name:"Name"}
        ]})
    }
    return a.store
},refreshItems:function() {
    var b = this;
    var a = b.getStore();
    var c = function(e) {
        a.loadData(e);
        var d = a.getCount();
        b.getLoadMask().hide();
        if (d === 0) {
            b.dependencyBroken()
        }
    };
    if (b.mytype && b.mytype === "Lexicon") {
        b.getLoadMask().show();
        Explore.data.TopicDataStore.getTopicsUsingLexicon(this.myId, c)
    } else {
        b.closeWindow()
    }
},closeWindow:function() {
    this.fireEvent("closeall")
},dependencyBroken:function() {
    this.fireEvent("readyfordelete")
},createGrid:function() {
    var c = this;
    var b = c.getStore();
    var a = [
        {id:"Name",header:"Topic Name",width:160,sortable:true,dataIndex:"Name"}
    ];
    var f = new Ext.Button({itemId:"editButton",text:Explore.i18n("Edit"),disabled:true,iconCls:"edit-icon",handler:function() {
        var h = d.getSelectionModel();
        var g = h.getSelected();
        if (g) {
            c.fireEvent("edittopic", g.json)
        }
    }});
    var e = new Ext.Button({itemId:"DeleteButton",text:Explore.i18n("Delete"),disabled:true,iconCls:"delete-icon",handler:function() {
        var h = d.getSelectionModel();
        var g = h.getSelected();
        if (g) {
            c.fireEvent("deletetopic", g.json)
        }
    }});
    var d = new Ext.grid.GridPanel({store:b,region:"center",itemId:"grid",loadMask:true,title:c.getDescriptionPanel(),tbar:[f,e],columns:a,autoExpandColumn:"Name"});
    d.getSelectionModel().on("rowselect", function(j, h, g) {
        e.enable();
        f.enable()
    });
    d.on("rowcontextmenu", function(h, g, j) {
        j.stopEvent();
        var l = h.getSelectionModel();
        l.selectRow(g, false, false);
        var k = new Ext.menu.Menu({items:[
            {text:Explore.i18n("Edit"),handler:function() {
                var m = l.getSelected();
                c.fireEvent("edittopic", m.json)
            }},
            {text:Explore.i18n("Delete"),handler:function() {
                var m = l.getSelected();
                c.fireEvent("deletetopic", m.json)
            }}
        ]});
        k.showAt(j.xy)
    });
    return d
},getGrid:function() {
    var a = this.getByItemId("grid");
    if (a === null) {
        a = this.createGrid()
    }
    return a
},getDescriptionPanel:function() {
    var a = Explore.i18n("DependencyHeaderTopic");
    a = String.format(a, this.projName);
    return a
},getLoadMask:function() {
    if (this.parent && this.parent.getLoadMask) {
        return this.parent.getLoadMask()
    }
    if (!this.loadMask) {
        var a = this;
        a.loadMask = new Ext.LoadMask(a.body, {msg:Explore.i18n("CheckingForDependencies")})
    }
    return this.loadMask
}});
Ext.reg("explore.view.deletetopicspanel", Explore.view.deleteTopicsPanel);
Ext.ns("Explore.view");
Explore.view.DeleteUsersPanel = Ext.extend(Ext.Panel, {initComponent:function() {
    var a = this;
    var c = this.initialConfig || {};
    var b = {border:false,frame:false,layout:"fit",items:[
        {xtype:"panel",layout:"border",items:[a.getGrid()]}
    ]};
    Ext.apply(this, Ext.apply(b, this.initialConfig));
    Explore.view.DeleteUsersPanel.superclass.initComponent.apply(this, arguments)
},getStore:function() {
    var a = this;
    if (!a.store) {
        a.store = new Ext.data.JsonStore({fields:[
            {name:"FullNameLFM"}
        ]})
    }
    return a.store
},refreshItems:function() {
    var b = this;
    var a = b.getStore();
    var c = function(e) {
        a.loadData(e);
        var d = a.getCount();
        b.getLoadMask().hide();
        if (d === 0) {
            b.dependencyBroken()
        }
    };
    if (b.mytype && b.mytype === "Role") {
        b.getLoadMask().show();
        Explore.data.UserDataStore.getUsersInRole(this.myId, c)
    } else {
        b.closeWindow()
    }
},closeWindow:function() {
    this.fireEvent("closeall")
},dependencyBroken:function() {
    this.fireEvent("readyfordelete")
},createGrid:function() {
    var c = this;
    var b = c.getStore();
    var a = [
        {id:"Name",header:"Name",width:160,sortable:true,dataIndex:"FullNameLFM"}
    ];
    var f = new Ext.Button({itemId:"editButton",text:Explore.i18n("Edit"),disabled:true,iconCls:"edit-icon",handler:function() {
        var h = d.getSelectionModel();
        var g = h.getSelected();
        if (g) {
            c.fireEvent("edituser", g.json)
        }
    }});
    var e = new Ext.Button({itemId:"DeleteButton",text:Explore.i18n("Delete"),disabled:true,iconCls:"delete-icon",handler:function() {
        var h = d.getSelectionModel();
        var g = h.getSelected();
        if (g) {
            c.fireEvent("deleteuser", g.json)
        }
    }});
    var d = new Ext.grid.GridPanel({store:b,region:"center",itemId:"grid",loadMask:true,title:c.getDescriptionPanel(),tbar:[f,e],columns:a,autoExpandColumn:"Name"});
    d.getSelectionModel().on("rowselect", function(j, h, g) {
        if (g.id === 1 || g.id === currentUser.Id) {
            e.disable();
            f.disable()
        } else {
            e.enable();
            f.enable()
        }
    });
    d.on("rowcontextmenu", function(h, g, j) {
        j.stopEvent();
        var l = h.getSelectionModel();
        l.selectRow(g, false, false);
        var k = new Ext.menu.Menu({items:[
            {text:Explore.i18n("Edit"),handler:function() {
                var m = l.getSelected();
                c.fireEvent("edituser", m.json)
            }},
            {text:Explore.i18n("Delete"),handler:function() {
                var m = l.getSelected();
                c.fireEvent("deleteuser", m.json)
            }}
        ]});
        k.showAt(j.xy)
    });
    return d
},getGrid:function() {
    var a = this.getByItemId("grid");
    if (a === null) {
        a = this.createGrid()
    }
    return a
},getDescriptionPanel:function() {
    var a = Explore.i18n("DependencyHeaderUser");
    a = String.format(a, this.projName);
    return a
},getLoadMask:function() {
    if (this.parent && this.parent.getLoadMask) {
        return this.parent.getLoadMask()
    }
    if (!this.loadMask) {
        var a = this;
        a.loadMask = new Ext.LoadMask(a.body, {msg:Explore.i18n("CheckingForDependencies")})
    }
    return this.loadMask
}});
Ext.reg("explore.view.deleteuserspanel", Explore.view.DeleteUsersPanel);
Explore.view.EditProjectDefinitionDialog = Ext.extend(Explore.view.ProjectDefinitionsDialog, {initComponent:function() {
    var a = this;
    var b = {};
    Ext.apply(this, Ext.apply(b, this.initialConfig));
    Explore.view.EditProjectDefinitionDialog.superclass.initComponent.apply(this, arguments);
    if (a.association && a.mytype && a.itemDescription) {
        var c = String.format(Explore.i18n("Edit_"), a.itemDescription) + ": " + a.getObjectName();
        c += " (Remove " + a.mytype + ": " + a.association + ")";
        a.setTitle(c)
    }
}});
Explore.view.ImportProgressBar = Ext.extend(Ext.ProgressBar, {initComponent:function() {
    var a = this;
    var c = this.initialConfig || {};
    var b = {animate:true,numItems:c.numItems || 1,text:("Calculating....")};
    Ext.apply(this, Ext.apply(b, this.initialConfig));
    Explore.view.ImportProgressBar.superclass.initComponent.apply(this, arguments)
},updateNumItems:function(a) {
    this.numItems = a
},updateBar:function(c, b) {
    this.syncSize();
    if (!b) {
        b = (c / this.numItems) * 100 + "% Complete"
    }
    var a = (c / this.numItems);
    this.updateProgress(a, b, true)
}});
Ext.reg("explore.view.importprogressbar", Explore.view.ImportProgressBar);
Ext.ns("Explore.view");
Explore.view.ProgressBarPanel = Ext.extend(Ext.Panel, {initComponent:function() {
    var a = this;
    var b = {fileUpload:true,height:60,fbar:[
        {xtype:"button",itemId:"cancelButton",text:Explore.i18n("Cancel"),hidden:false,handler:function() {
            a.fireEvent("finished")
        }}
    ],items:[
        {xtype:"explore.view.importprogressbar",itemId:"progressbar"}
    ]};
    Ext.apply(this, Ext.apply(b, this.initialConfig));
    Explore.view.ProgressBarPanel.superclass.initComponent.apply(this, arguments)
},updateNumItems:function(b) {
    var a = this.getByItemId("progressbar");
    a.updateNumItems(b)
},updateBar:function(c, b) {
    var a = this.getByItemId("progressbar");
    a.updateBar(c, b)
}});
Ext.reg("explore.view.ProgressBarPanel", Explore.view.ProgressBarPanel);
Ext.ns("Explore.view");
Explore.view.ImportLexiconConflictWindow = Ext.extend(Ext.Window, {initComponent:function() {
    var a = this;
    var c = this.initialConfig || {};
    var b = {autoShow:true,resizable:false,constrain:true,height:500,width:500,layout:"fit",modal:true,valComplete:0,stop:false,renderTo:Ext.getBody(),items:[],fbar:[
        {xtype:"button",itemId:"cancelButton",text:Explore.i18n("Cancel"),hidden:false,handler:this.cancelButtonAction,scope:this}
    ]};
    Ext.apply(this, Ext.apply(b, this.initialConfig));
    Explore.view.ImportLexiconConflictWindow.superclass.initComponent.apply(this, arguments)
},cancelButtonAction:function() {
    this.close()
},addLexicon:function(f) {
    var b = this;
    var d = f.Name;
    var c = f.Name;
    var a = 0;
    var e = function(g) {
        Explore.data.LexiconDataStore.saveLexicon(g, function(h) {
            if (h.ErrorCode === 54003) {
                a++;
                g.Name = d + " copy " + a;
                e(g)
            } else {
                b.close()
            }
        }, true)
    };
    e(f)
}});
Ext.reg("explore.view.ImportLexiconConflictWindow", Explore.view.ImportLexiconConflictWindow);
Ext.ns("Explore.view");
Explore.view.ImportLexiconPanel = Ext.extend(Ext.FormPanel, {initComponent:function() {
    var a = this;
    var b = {fileUpload:true,padding:5,fbar:[
        {xtype:"button",itemId:"importButton",text:Explore.i18n("Import"),hidden:false,disabled:true,handler:function() {
            a.upload()
        }},
        {xtype:"button",itemId:"cancelButton",text:Explore.i18n("Cancel"),hidden:false,handler:function() {
            a.fireEvent("finished")
        }}
    ],items:[
        {xtype:"fileuploadfield",itemId:"uploadfield",id:"filedata",regex:new RegExp("(.|S)*(.xml)+"),emptyText:"Select a document to upload...",regexText:Explore.i18n("PleaseChooseAnXmlFile"),fieldLabel:"File",allowBlank:false,autoShow:true,width:"98%",buttonText:"Browse"}
    ]};
    Ext.apply(this, Ext.apply(b, this.initialConfig));
    Explore.view.ImportLexiconPanel.superclass.initComponent.apply(this, arguments);
    a.getByItemId("uploadfield").on("fileselected", function(d, c) {
        if (a.getByItemId("uploadfield").isValid()) {
            a.fbar.getByItemId("importButton").enable()
        } else {
            a.fbar.getByItemId("importButton").disable()
        }
    })
},start:function() {
    var a = this;
    var d = a.getByItemId("uploadfield");
    var b = d.button;
    var c = b.btnEl.dom
},upload:function() {
    var a = this;
    var b = a.getForm();
    if (b.isValid()) {
        b.submit({fileUpload:true,url:"../Handlers/ImportLexicon.ashx",waitMsg:"Importing..",success:function(c, d) {
            a.processImportingLexicons(c, d)
        },failure:function(c, d) {
            a.processFailedImports(d)
        }})
    } else {
        Explore.view.StatusBox.showWarning(Explore.i18n("error"), Explore.i18n("RequestFailed"))
    }
},processImportingLexicons:function(c, a) {
    var b = this;
    if (a && a.result && a.result.success && a.result.result) {
        b.fireEvent("importdatarecieved", a.result.result)
    } else {
        b.processFailedImports(a)
    }
},processFailedImports:function(a) {
    var c = a.result;
    if (c) {
        var e = "";
        for (var b = 0; b < c.errors.length;
             b++) {
            var d = Explore.i18n("errorMessage" + c.errors[b].Number);
            if (b != 0 && b == c.errors.length - 1) {
                e += ","
            }
            e += (d)
        }
        Explore.view.StatusBox.showWarning(Explore.i18n("error"), e)
    } else {
        Explore.view.StatusBox.showWarning(Explore.i18n("error"), Explore.i18n("RequestFailed"))
    }
}});
Ext.reg("explore.view.importlexiconpanel", Explore.view.ImportLexiconPanel);
Ext.ns("Explore.view");
Explore.view.ImportLexiconWindow = Ext.extend(Ext.Window, {initComponent:function() {
    var a = this;
    var c = this.initialConfig || {};
    var b = {autoShow:true,closable:true,constrain:true,resizable:false,height:100,width:600,title:Explore.i18n("ImportLexicon"),layout:"fit",modal:true,renderTo:Ext.getBody(),items:[a.getUploadFilePanel(),a.getProgressBar()]};
    Ext.apply(this, Ext.apply(b, this.initialConfig));
    Explore.view.ImportLexiconWindow.superclass.initComponent.apply(this, arguments);
    var d = a.getByItemId("importpanel");
    d.on("finished", function() {
        a.cancelButtonAction()
    });
    d.on("importdatarecieved", function(f) {
        var e = a.getByItemId("progressbarpanel");
        e.show();
        d.hide();
        a.setHeight(85);
        a.processAddingLexicons(f)
    });
    a.on("show", function() {
        d.start()
    })
},cancelButtonAction:function() {
    var a = this;
    a.close()
},start:function() {
    var a = this;
    a.show()
},getProgressBar:function() {
    var a = this;
    if (!this.progressBar) {
        a.progressBar = new Explore.view.ProgressBarPanel({itemId:"progressbarpanel",hidden:true});
        a.progressBar.on("finished", function() {
            a.cancelButtonAction()
        })
    }
    return this.progressBar
},getUploadFilePanel:function() {
    var a = this;
    var b = new Explore.view.ImportLexiconPanel({itemId:"importpanel"});
    return b
},processAddingLexicons:function(g) {
    var b = this;
    var a = g;
    var f = a.length;
    var e = b.getProgressBar();
    e.updateNumItems(f);
    var d = 0;
    var c = function(h) {
        var k = h.pop();
        if (k) {
            var l = Explore.i18n("Importing") + "..." + k.Name;
            e.updateBar(d, l);
            var j = new Explore.view.ImportLexiconConflictWindow();
            j.on("close", function() {
                d++;
                l = Explore.i18n("Importing") + "..." + k.Name;
                e.updateBar(d, l);
                c(h)
            });
            j.addLexicon(k)
        } else {
            b.close()
        }
    };
    c(a)
}});
Ext.reg("explore.view.importlexiconwindow", Explore.view.ImportLexiconWindow);
Ext.ns("Explore.view");
Explore.view.ImportTopicConflictWindow = Ext.extend(Ext.Window, {parentId:1,isCustom:false,initComponent:function() {
    var a = this;
    var c = this.initialConfig || {};
    var b = {autoShow:true,resizable:false,constrain:true,height:500,width:500,layout:"fit",modal:true,valComplete:0,stop:false,renderTo:Ext.getBody(),items:[],fbar:[
        {xtype:"button",itemId:"cancelButton",text:Explore.i18n("Cancel"),hidden:false,handler:this.cancelButtonAction,scope:this}
    ]};
    Ext.apply(this, Ext.apply(b, this.initialConfig));
    Explore.view.ImportTopicConflictWindow.superclass.initComponent.apply(this, arguments);
    a.addEvents("topicinsertcancel", "sectioninsertcancel")
},cancelButtonAction:function() {
    this.close()
},beginInsertTopicSection:function(a) {
    var b = this;
    b.checkForSectionConflict(a)
},checkForSectionConflict:function(a) {
    var b = this;
    b.addSection(a)
},addSection:function(a) {
    var c = this;
    var e = a.Name;
    var d = a.Name;
    var h = c.parentId;
    var g = c.isCustom;
    var b = 0;
    var f = function(j) {
        if (j && j.ErrorCode === 54003) {
            b++;
            d = e + " copy " + b;
            Explore.data.TopicDataStore.addTopicSection(h, d, g, f)
        } else {
            a.added = true;
            var n = j.Result.Id;
            var m = a.Topics;
            for (var k = 0; k < m.length;
                 k++) {
                m[k].parent = n
            }
            var l = a.Sections;
            for (var k = 0; k < l.length; k++) {
                l[k].parent = n
            }
            c.close()
        }
    };
    Explore.data.TopicDataStore.addTopicSection(h, d, g, f)
},beginInsertTopic:function(b) {
    var a = this;
    var c = a.parentId;
    a.checkForTopicConflict(b)
},checkForTopicConflict:function(b) {
    var a = this;
    a.addTopic(b)
},addTopic:function(d) {
    var b = this;
    var f = b.parentId;
    var c = d.Name;
    d.IsCustom = b.isCustom;
    var a = 0;
    var e = function(g) {
        if (g && g.ErrorCode === 54003) {
            a++;
            d.Name = c + " copy " + a;
            Explore.data.TopicDataStore.saveTopic(f, d, e)
        } else {
            d.added = true;
            b.close()
        }
    };
    Explore.data.TopicDataStore.saveTopic(f, d, e)
}});
Ext.reg("explore.view.importtopicwindow", Explore.view.ImportTopicConflictWindow);
Ext.ns("Explore.view");
Explore.view.ImportTopicPanel = Ext.extend(Ext.FormPanel, {initComponent:function() {
    var a = this;
    var b = {fileUpload:true,padding:5,fbar:[
        {xtype:"button",itemId:"importButton",text:Explore.i18n("Import"),hidden:false,disabled:true,handler:function() {
            a.upload()
        }},
        {xtype:"button",itemId:"cancelButton",text:Explore.i18n("Cancel"),hidden:false,handler:function() {
            a.fireEvent("finished")
        }}
    ],items:[
        {xtype:"fileuploadfield",itemId:"uploadfield",id:"filedata",regex:new RegExp("(.|S)*(.xml)+"),emptyText:"Select a document to upload...",regexText:Explore.i18n("PleaseChooseAnXmlFile"),fieldLabel:"File",allowBlank:false,autoShow:true,width:"98%",buttonText:"Browse"}
    ]};
    Ext.apply(this, Ext.apply(b, this.initialConfig));
    Explore.view.ImportTopicPanel.superclass.initComponent.apply(this, arguments);
    a.getByItemId("uploadfield").on("fileselected", function(d, c) {
        if (a.getByItemId("uploadfield").isValid()) {
            a.fbar.getByItemId("importButton").enable()
        } else {
            a.fbar.getByItemId("importButton").disable()
        }
    })
},close:function() {
    var a = this;
    a.fireEvent("finished")
},start:function() {
    var a = this;
    var d = a.getByItemId("uploadfield");
    var b = d.fileInput;
    var c = b.dom
},upload:function() {
    var a = this;
    var b = a.getForm();
    if (b.isValid()) {
        b.submit({fileUpload:true,url:"../Handlers/ImportTopic.ashx?topicSectionId=" + a.nodeId,waitMsg:"Importing..",success:function(c, d) {
            a.addAllTopicsAndSections(d, c)
        },failure:function(c, d) {
            a.handleFailedImport(d)
        }})
    } else {
    }
},addAllTopicsAndSections:function(a, c) {
    var b = this;
    if (a && a.result && a.result.success && a.result.result) {
        b.fireEvent("importdatarecieved", a.result.result)
    } else {
        b.handleFailedImport(a)
    }
},handleFailedImport:function(e) {
    var b = e.result;
    if (b) {
        var d = "";
        for (var a = 0; a < b.errors.length;
             a++) {
            var c = Explore.i18n("errorMessage" + b.errors[a].Number);
            if (a != 0 && a == b.errors.length - 1) {
                d += ","
            }
            d += (c)
        }
        Explore.view.StatusBox.showWarning(Explore.i18n("error"), d)
    } else {
        Explore.view.StatusBox.showWarning(Explore.i18n("error"), Explore.i18n("RequestFailed"))
    }
}});
Ext.reg("explore.view.ImportTopicPanel", Explore.view.ImportTopicPanel);
Ext.ns("Explore.view");
Explore.view.ImportTopicWindow = Ext.extend(Ext.Window, {nodeId:null,isCustom:false,initComponent:function() {
    var a = this;
    var c = this.initialConfig || {};
    var b = {autoShow:true,closable:true,constrain:true,resizable:false,height:105,width:600,title:Explore.i18n("ImportTopic"),layout:"fit",modal:true,renderTo:Ext.getBody(),items:[a.getUploadFilePanel(),a.getProgressBar()]};
    Ext.apply(this, Ext.apply(b, this.initialConfig));
    Explore.view.ImportTopicWindow.superclass.initComponent.apply(this, arguments);
    var d = a.getByItemId("importpanel");
    d.on("importdatarecieved", function(f) {
        var e = a.getByItemId("progressbarpanel");
        e.show();
        d.hide();
        a.setHeight(85);
        a.startImporting(f)
    });
    a.on("show", function() {
        d.start()
    })
},getProgressBar:function() {
    var a = this;
    if (!this.progressBar) {
        a.progressBar = new Explore.view.ProgressBarPanel({itemId:"progressbarpanel",hidden:true});
        a.progressBar.on("finished", function() {
            a.cancelButtonAction()
        })
    }
    return this.progressBar
},nodeToAddID:function() {
    var a = this;
    var b = a.nodeId || 1;
    return b
},cancelButtonAction:function() {
    var a = this;
    a.close()
},start:function() {
    var a = this;
    a.show()
},getUploadFilePanel:function() {
    var a = this;
    if (!a.uploadPanel) {
        a.uploadPanel = new Explore.view.ImportTopicPanel({itemId:"importpanel",nodeId:a.nodeToAddID()});
        a.uploadPanel.on("finished", function() {
            a.cancelButtonAction()
        })
    }
    return a.uploadPanel
},startImporting:function(b) {
    var k = this;
    if (b.length) {
        var j = function(o) {
            var m = o.parent || k.nodeId;
            var l = new Explore.view.ImportTopicConflictWindow({parentId:m,isCustom:k.isCustom});
            l.on("close", function() {
                k.close()
            });
            l.beginInsertTopic(o)
        };
        for (var c = 0; c < b.length; c++) {
            j(b[c])
        }
    } else {
        var g = k.getProgressBar();
        var f = k.getCount(b);
        var h = 0;
        g.updateNumItems(f);
        var a = function(q) {
            var l = k.getNextToAdd(b);
            if (l) {
                var p = l.parent || k.nodeId;
                var o = Explore.i18n("Importing") + "..." + l.Name;
                g.updateBar(h, o);
                var m = new Explore.view.ImportTopicConflictWindow({parentId:p,isCustom:k.isCustom});
                m.on("close", function() {
                    h++;
                    g.updateBar(h, o);
                    a()
                });
                if (l.section) {
                    m.beginInsertTopicSection(l)
                } else {
                    m.beginInsertTopic(l)
                }
            } else {
                k.close()
            }
        };
        var e = new Explore.view.ImportTopicConflictWindow({parentId:k.nodeId,isCustom:k.isCustom});
        e.on("close", function() {
            h++;
            a()
        });
        var d = Explore.i18n("Importing") + "..." + b.Name;
        g.updateBar(h, d);
        e.beginInsertTopicSection(b)
    }
},getCount:function(c) {
    var b = function(e) {
        var g = 0;
        for (var f = 0; f < e.Topics.length; f++) {
            g++
        }
        return g
    };
    var a = function(e) {
        var g = 1;
        for (var f = 0; f < e.Sections.length; f++) {
            g += a(e.Sections[f])
        }
        g += b(e);
        return g
    };
    var d = a(c) - 1;
    (d < 0) ? 0 : d;
    return d
},getNextToAdd:function(c) {
    var d = function(e) {
        for (var f = 0; f < e.Topics.length;
             f++) {
            if (!e.Topics[f].added && !e.skip) {
                var g = e.Topics[f];
                g.section = false;
                return g
            }
        }
        return null
    };
    var b = function(e) {
        for (var f = 0;
             f < e.Sections.length; f++) {
            if (!e.Sections[f].added) {
                var g = e.Sections[f];
                g.section = true;
                return g
            }
        }
        return null
    };
    var a = function(e) {
        var j = d(e);
        var g = b(e);
        if (j) {
            return j
        }
        if (g) {
            return g
        }
        for (var f = 0; f < e.Sections.length; f++) {
            var h = a(e.Sections[f]);
            if (h) {
                return h
            }
        }
        return null
    };
    return a(c)
}});
Ext.reg("explore.view.importtopicwindow", Explore.view.ImportTopicWindow);
Ext.ns("Explore.view");
Explore.view.ImportTopicPhraseWindow = Ext.extend(Ext.Window, {initComponent:function() {
    var a = this;
    var c = this.initialConfig || {};
    var b = {autoShow:true,closable:true,constrain:true,resizable:false,height:105,width:600,title:Explore.i18n("ImportTopic") + Explore.i18n("Phrase"),layout:"fit",modal:true,renderTo:Ext.getBody(),items:[a.getImportPanel()]};
    Ext.apply(this, Ext.apply(b, this.initialConfig));
    Explore.view.ImportTopicPhraseWindow.superclass.initComponent.apply(this, arguments)
},getImportPanel:function() {
    var a = this;
    if (!a.importPanel) {
        a.importPanel = new Ext.FormPanel({fileUpload:true,padding:5,fbar:[
            {xtype:"button",itemId:"importButton",text:Explore.i18n("Import"),hidden:false,disabled:true,handler:function() {
                a.upload()
            }},
            {xtype:"button",itemId:"cancelButton",text:Explore.i18n("Cancel"),hidden:false,handler:function() {
                a.close()
            }}
        ],items:[
            {xtype:"fileuploadfield",itemId:"uploadfield",id:"filedata",regex:new RegExp("(.|S)*(.csv)+"),emptyText:"Select a document to upload...",regexText:Explore.i18n("PleaseChooseACsvFile"),fieldLabel:"File",allowBlank:false,autoShow:true,width:"98%",buttonText:"Browse"}
        ]});
        a.importPanel.getByItemId("uploadfield").on("fileselected", function(c, b) {
            if (a.importPanel.getByItemId("uploadfield").isValid()) {
                a.importPanel.fbar.getByItemId("importButton").enable()
            } else {
                a.importPanel.fbar.getByItemId("importButton").disable()
            }
        })
    }
    return a.importPanel
},upload:function() {
    var a = this;
    var b = a.getImportPanel().getForm();
    if (b.isValid()) {
        b.submit({fileUpload:true,url:"../Handlers/ImportTopicPhrase.ashx",waitMsg:"Importing..",success:function(d, e) {
            var c = e.result;
            if (!c.success) {
                Explore.view.StatusBox.showError(Explore.i18n("error"), c.Message)
            } else {
                a.fireEvent("import", c.result)
            }
        },failure:function(d, h) {
            var c = h.result;
            var g = "Import Failed";
            if (c && c.errors) {
                var f = c.errors;
                g = "";
                for (var e = 0; e < f.length; e++) {
                    g += Explore.i18n("errorMessage" + f[e].Number);
                    if (e > 0 && e == f.length - 1) {
                        g += ","
                    }
                }
            }
            Explore.view.StatusBox.showError(Explore.i18n("error"), g);
            a.close()
        }})
    } else {
    }
}});
Ext.reg("explore.view.importtopicphrasewindow", Explore.view.ImportTopicPhraseWindow);
Ext.ns("Explore.view.importdata");
Explore.view.importdata.ImportDataWindow = Ext.extend(Ext.Window, {initComponent:function() {
    var d = this;
    var g = this.initialConfig || {};
    var c = d.getNorthPanel();
    var a = d.getCenterPanel();
    this.obj = g.obj || 0;
    var e = {autoShow:true,layout:"border",constrain:true,title:!d.obj ? Explore.i18n("NewDataImportSource") : Explore.i18n("EditDataImportSource"),height:460,width:800,modal:true,renderTo:Ext.getBody(),items:[c,a],fbar:[
        {xtype:"button",itemId:"previewBtn",text:Explore.i18n("PreviewResults"),hidden:d.obj ? true : false,disabled:true,handler:this.previewResultsAction,scope:this},
        {xtype:"button",itemId:"importButton",text:!d.obj ? Explore.i18n("Import") : Explore.i18n("Save"),hidden:false,handler:this.importButtonAction,scope:this},
        {xtype:"button",itemId:"cancelButton",text:Explore.i18n("Cancel"),hidden:false,handler:this.cancelButtonAction,scope:this}
    ]};
    Ext.apply(this, Ext.apply(e, this.initialConfig));
    Explore.view.importdata.ImportDataWindow.superclass.initComponent.apply(this, arguments);
    var f = d.fbar.getByItemId("previewBtn");
    var b = d.fbar.getByItemId("importButton");
    a.on("previewready", function(h) {
        f.setDisabled(!h)
    });
    d.on("sourcechange", function(j) {
        a.switchSourcePanel(j);
        var h = (j !== "radian6");
        f.setVisible(h)
    });
    c.on("clientvalidation", function(j, h) {
        if (!h) {
            b.setDisabled(true)
        } else {
            b.setDisabled(!d.isValid() || !d.isDirty())
        }
    });
    a.on("clientvalidation", function(j, h) {
        if (!h) {
            b.setDisabled(true)
        } else {
            b.setDisabled(!d.isValid() || !d.isDirty())
        }
    })
},checkSocialConnectorAvailable:function(d) {
    var b = this;
    var a = new Ext.LoadMask(b.getEl(), Explore.i18n("Checking social connector"));
    a.show();
    var c = function() {
        SourceService.IsSocialConnectorAvailable(function(e) {
            a.hide();
            if (e === null) {
                if (d) {
                    d()
                }
            } else {
                Explore.view.StatusBox.showError(Explore.i18n("Social Connector Unavailable"), Explore.i18n(e.Message))
            }
        })
    };
    ConfigurationService.GetConfigurationSettings(function(f, g) {
        if (f.SocialMediaConnectorUrl != "") {
            c()
        } else {
            Explore.showConfigMissingMessage(Explore.i18n("Social Connector Url Not Set"));
            a.hide()
        }
    })
},previewResultsAction:function() {
    var b = this;
    var a = function() {
        var e = b.getCenterPanel().getLayout().activeItem;
        var d = new Ext.LoadMask(b.getEl(), "Loading Preview");
        d.show();
        var c = function() {
            d.hide()
        };
        e.showPreview(b.getNorthPanel().getByItemId("name").getValue(), b.getNorthPanel().getByItemId("description").getValue(), c)
    };
    b.checkSocialConnectorAvailable(a)
},importButtonAction:function() {
    var b = this;
    var a = function() {
        var c = b.getNorthPanel().getByItemId("name").getValue();
        var d = b.getNorthPanel().getByItemId("description").getValue();
        b.getCenterPanel().layout.activeItem.saveDataImport(c, d, b.obj);
        b.getCenterPanel().layout.activeItem.on("savecompleted", function() {
            b.close()
        })
    };
    if (b.getCenterPanel().layout.activeItem.id !== "radian6") {
        b.checkSocialConnectorAvailable(a)
    } else {
        a()
    }
},cancelButtonAction:function() {
    var a = this;
    a.close()
},hideRadian6:function(a) {
    var b = false;
    b = Explore.data.IDOLDataStore.getRadianSixDataImportVisibility();
    return b
},getNorthPanel:function() {
    var c = this;
    if (!c.topPanel) {
        var b = '<img src="{0}"  width="16px" align="bottom" class="radio-icon"/> {1}';
        var f = "../resources/css/../images/MAS_icons/icon_facebook_16.png";
        var e = "../resources/css/../images/MAS_icons/icon_twitter_16.png";
        var a = "../resources/css/../images/MAS_icons/icon_radian6_16.png";
        var d = new Ext.form.RadioGroup({xtype:"radiogroup",itemId:"sourceradiogroup",hidden:false,fieldLabel:Explore.i18n("ImportDataFrom"),columns:3,vertical:true,width:"100%",disabled:!c.obj ? false : true,items:[
            {boxLabel:String.format(b, e, "Twitter"),name:"rb",inputValue:"twitter",checked:c.obj ? c.obj.Origin == 3 : true},
            {boxLabel:String.format(b, f, "facebook"),name:"rb",inputValue:"facebook",checked:c.obj ? c.obj.Origin == 2 : false},
            {boxLabel:String.format(b, a, "Radian6"),name:"rb",inputValue:"radian6",itemid:"r6rbutton",checked:c.obj ? c.obj.Origin == 1 : false,hidden:c.hideRadian6(c)}
        ]});
        d.on("change", function(k, h, g) {
            var j = k.getValue().inputValue;
            c.fireEvent("sourcechange", j)
        });
        c.topPanel = new Ext.form.FormPanel({region:"north",height:140,frame:false,border:false,monitorValid:true,monitorPoll:1000,padding:10,itemId:"northpanel",labelWidth:150,isValid:function() {
            return this.getByItemId("name").isValid() && this.getByItemId("description").isValid()
        },isDirty:function() {
            return this.getByItemId("name").isDirty() || this.getByItemId("description").isDirty()
        },items:[
            {xtype:"textfield",fieldLabel:Explore.i18n("DataImportName"),name:"dataimportname",itemId:"name",maxLength:50,width:"98%",allowBlank:false,value:c.obj ? c.obj.Name : ""},
            {xtype:"textarea",grow:true,name:"description",itemId:"description",maxLength:300,width:"98%",fieldLabel:Explore.i18n("Description"),value:c.obj ? c.obj.Description : ""},
            d
        ]})
    }
    return c.topPanel
},getCenterPanel:function() {
    var b = this;
    if (!b.centerPanel) {
        var a = {region:"center",frame:false,border:false,itemId:"centerpanel",obj:b.obj};
        b.centerPanel = new Explore.view.importdata.ImportSourcePanel(a)
    }
    return b.centerPanel
},isValid:function() {
    var a = this;
    var b = true;
    b &= a.getNorthPanel().isValid();
    b &= a.getCenterPanel().isValid();
    return b
},isDirty:function() {
    var b = this;
    var c = true;
    var a = true;
    if (b.obj) {
        c &= b.getNorthPanel().isDirty();
        a &= b.getCenterPanel().isDirty()
    }
    return c || a
}});
Ext.reg("explore.view.importdata.importdatawindow", Explore.view.importdata.ImportDataWindow);
Ext.ns("Explore.view.importdata");
Explore.view.importdata.ImportFacebookPanel = Ext.extend(Ext.Panel, {initComponent:function() {
    var a = this;
    var d = this.initialConfig || {};
    this.obj = this.initialConfig.obj;
    var f = a.getSearchField();
    var e = a.getImportLimitPanel();
    var h = a.getDateLimitPanel();
    var c = a.getIntervalRadioGroupPanel();
    var b = {border:false,frame:false,items:[f,h,e,c]};
    Ext.apply(this, Ext.apply(b, this.initialConfig));
    Explore.view.importdata.ImportFacebookPanel.superclass.initComponent.apply(this, arguments);
    a.addEvents("previewready");
    var g = a.getSearchField().getByItemId("searchcriteria");
    g.on("invalid", function(j, k) {
        a.fireEvent("previewready", false)
    });
    g.on("valid", function(j, k) {
        a.fireEvent("previewready", true)
    });
    a.on("show", function() {
        a.fireEvent("previewready", g.isValid())
    })
},getSearchField:function() {
    if (!this.searchFieldPanel) {
        this.searchFieldPanel = new Ext.form.FormPanel({border:false,autoHeight:true,frame:false,itemId:"Search",padding:5,labelWidth:150,items:[
            {xtype:"textfield",itemId:"searchcriteria",fieldLabel:"Search Criteria",value:this.obj ? this.obj.Criteria : "",allowBlank:false,width:"95%"}
        ]})
    }
    return this.searchFieldPanel
},displayStartDate:function(a) {
    if (a) {
        return((a.FilterByDateType == Explore.model.FilterByDateType.Between) || (a.FilterByDateType == Explore.model.FilterByDateType.After)) ? true : false
    } else {
        return false
    }
},displayEndDate:function(a) {
    if (a) {
        return((a.FilterByDateType == Explore.model.FilterByDateType.Between) || (a.FilterByDateType == Explore.model.FilterByDateType.Before)) ? true : false
    } else {
        return false
    }
},getDateLimitPanel:function() {
    if (!this.dateLimitPanel) {
        if (this.obj) {
            if (this.obj.FromDate != null) {
                this.obj.FromDate = new Date(this.obj.FromDate)
            }
            if (this.obj.ToDate != null) {
                this.obj.ToDate = new Date(this.obj.ToDate)
            }
        }
        var a = {xtype:"explore.view.common.daterangepicker",itemId:"dateRangePicker",fieldLabel:Explore.i18n("Date"),horizontalLayout:true,supportTrailingRanges:true,isFacebook:true,defaultValues:{showStartDate:this.displayStartDate(this.obj),showEndDate:this.displayEndDate(this.obj),startDate:(this.obj && this.obj.FromDate) ? this.obj.FromDate : new Date,endDate:(this.obj && this.obj.ToDate) ? this.obj.ToDate : new Date,dateType:(this.obj && this.obj.FilterByDateType != null) ? this.obj.FilterByDateType : Explore.model.FilterByDateType.Any}};
        this.dateLimitPanel = new Ext.form.FormPanel({border:false,autoHeight:true,frame:false,itemId:"datelimit",padding:5,labelWidth:150,items:[a]})
    }
    return this.dateLimitPanel
},getImportLimitPanel:function() {
    if (!this.importLimitPanel) {
        this.importLimitPanel = new Ext.form.FormPanel({border:false,frame:false,autoHeight:true,padding:5,hidden:false,labelWidth:150,items:[
            {xtype:"compositefield",itemId:"compositefield",height:25,combineErrors:false,items:[
                {xtype:"textfield",itemId:"importmaxfield",fieldLabel:Explore.i18n("ImportNoMoreThan"),value:this.obj ? this.obj.DocumentImportLimit : 1000,validator:function(b, a) {
                    if ((isNaN(b)) || (b % 100 != 0)) {
                        return Explore.i18n("DocumentLimitRequiresHundreds")
                    } else {
                        return true
                    }
                },allowBlank:false,width:60},
                {xtype:"label",width:200,text:Explore.i18n("DocumentInputHundreds")}
            ]}
        ]})
    }
    return this.importLimitPanel
},getIntervalRadioGroupPanel:function() {
    var p = this;
    if (!this.intervalRadioGroupPanel) {
        var j = new Ext.form.Radio({boxLabel:Explore.i18n("Every_1"),itemId:"every",checked:this.obj ? this.obj.Repeat : false});
        var g = new Ext.form.TextField({itemId:"importIntervalfield",value:this.obj ? this.obj.Schedule : 24,regex:new RegExp("^[0-9]+$"),width:60,disabled:this.obj ? !this.obj.Repeat : true,allowBlank:this.obj ? !this.obj.Repeat : true});
        var f = new Date().add(Date.DAY, 0);
        var e = "12:00 AM";
        if (this.obj && this.obj.StartDate) {
            var k = this.obj.StartDate;
            f = Explore.getDateFromEpoch(k / 1000);
            var m = f.getHours();
            var h = f.getMinutes();
            f.setHours(0);
            f.setMinutes(0);
            var n = false;
            if (m > 11) {
                m = m - 12;
                n = true
            }
            if (h === 0) {
                h = "00"
            }
            if (m === 0) {
                m = 12
            }
            e = m + ":" + h + " " + (n ? "PM" : "AM")
        }
        var b = new Ext.form.DateField({itemId:"dateField",format:Explore.getDateFormatByPref({ignoreTime:true}),editable:false,altFormats:Explore.getDateFormatByPref({ignoreTime:true}),value:f,width:100,disabled:false,allowBlank:this.obj ? !this.obj.Repeat : true});
        var a = new Ext.form.TimeField({itemId:"startTimeField",increment:30,width:90,margins:"0 8 0 8",allowBlank:this.obj ? !this.obj.Repeat : true,disabled:false,value:e});
        var o = {xtype:"compositefield",itemId:"compositefield",items:[j,g,{xtype:"label",width:100,text:Explore.i18n("hoursStartingOn")},b,{xtype:"label",width:10,text:Explore.i18n("at")},a]};
        var l = new Ext.form.Radio({boxLabel:Explore.i18n("Never_JustImportThisOnce"),itemId:"single",checked:this.obj ? !this.obj.Repeat : true});
        var c = new Ext.form.RadioGroup({xtype:"radiogroup",itemId:"intervalradiogroup",disabled:false,fieldLabel:Explore.i18n("RepeatDataImport"),columns:1,vertical:true,items:[l,o]});
        l.on("check", function(q, d) {
            if (d) {
                j.setValue(false);
                g.allowBlank = true;
                g.setDisabled(true);
                g.clearInvalid()
            }
        });
        j.on("check", function(q, d) {
            if (d) {
                l.setValue(false);
                g.allowBlank = false;
                g.setDisabled(false);
                g.validate()
            }
        });
        this.intervalRadioGroupPanel = new Ext.form.FormPanel({getHoursField:function() {
            return g
        },getDateField:function() {
            return b
        },getTimeField:function() {
            return a
        },border:false,frame:false,autoHeight:true,disable:true,padding:"0px 5px 5px 5px",labelWidth:150,items:[c]})
    }
    return this.intervalRadioGroupPanel
},setTimeInDate:function(d, e) {
    if (d) {
        var b = d.split(":");
        var a = parseInt(b[0]);
        var f = b[1].split(" ");
        var c = parseInt(f[0]);
        if (a === 12) {
            a = a - 12
        }
        if (f[1] === "PM") {
            a = a + 12
        }
        e.setHours(a);
        e.setMinutes(c);
        e.setTime(e.getTime())
    }
},saveDataImport:function(b, c) {
    var a = this;
    this.obj = this.getDataImport(b, c);
    Explore.data.DataImportStore.saveFacebookDataImport(this.obj, function(d) {
        var e;
        if (d) {
            e = (d.Result.Repeat) ? "scheduled" : "submitted";
            if (d.ErrorCode === 0) {
                Explore.view.StatusBox.showInfo(Explore.i18n("Facebook"), Explore.i18n("messageFacebookImportSuccessful") + " " + e + ".");
                a.fireEvent("savecompleted")
            } else {
                Explore.view.StatusBox.showWarning(Explore.i18n("messageFacebookImportFailed"), d.Message)
            }
        } else {
            Explore.view.StatusBox.showInfo(Explore.i18n("Facebook"), Explore.i18n("messageFacebookNotReachable"))
        }
    }, false)
},isValid:function() {
    var a = this;
    var b = true;
    b &= a.getIntervalRadioGroupPanel().getHoursField().isValid();
    b &= a.getSearchField().getByItemId("searchcriteria").isValid();
    b &= a.getImportLimitPanel().getByItemId("importmaxfield").isValid();
    return b
},isDateRangeLimitDirty:function() {
    var a = this;
    var b = false;
    fltrByDateType = this.getDateLimitPanel().getByItemId("dateRangePicker").getFilterByDateType();
    b |= !(this.obj.FilterByDateType == fltrByDateType);
    if (this.obj.FromDate != null) {
        if ((this.obj.FilterByDateType == Explore.model.FilterByDateType.Between) || (this.obj.FilterByDateType == Explore.model.FilterByDateType.After)) {
            b |= !(this.obj.FromDate.toDateString() == a.getDateLimitPanel().getByItemId("dateRangePicker").getStartDate().toDateString())
        }
    }
    if (this.obj.ToDate != null) {
        if ((this.obj.FilterByDateType == Explore.model.FilterByDateType.Before) || (this.obj.FilterByDateType == Explore.model.FilterByDateType.Between)) {
            b |= !(this.obj.ToDate.toDateString() == a.getDateLimitPanel().getByItemId("dateRangePicker").getEndDate().toDateString())
        }
    }
    return b
},isDirty:function() {
    var c = this;
    var d = false;
    d |= !(c.obj.Criteria === c.getSearchField().getByItemId("searchcriteria").getValue());
    d |= c.isDateRangeLimitDirty();
    var a = (c.getIntervalRadioGroupPanel().getByItemId("intervalradiogroup").getValue().getItemId() === "every");
    d |= !(c.obj.Repeat === a);
    if (a) {
        d |= !(c.obj.Schedule == c.getIntervalRadioGroupPanel().getHoursField().getValue())
    }
    d |= !(c.obj.Schedule == c.getIntervalRadioGroupPanel().getHoursField().getValue());
    d |= !(c.obj.DocumentImportLimit == c.getImportLimitPanel().getByItemId("importmaxfield").getValue());
    var e = this.getIntervalRadioGroupPanel().getTimeField().getValue();
    var b = this.getIntervalRadioGroupPanel().getDateField().getValue();
    this.setTimeInDate(e, b);
    d |= !(b.toString() == (Explore.getDateFromEpoch(this.obj.StartDate / 1000)));
    return d
},getDataImport:function(b, c) {
    var a = this;
    if (!this.obj) {
        this.obj = {}
    }
    this.obj.Name = b;
    this.obj.Description = c;
    this.obj.Origin = 3;
    this.obj.Repeat = this.getIntervalRadioGroupPanel().getByItemId("intervalradiogroup").getValue().getItemId() === "every";
    this.obj.DocumentImportLimit = this.getImportLimitPanel().getByItemId("importmaxfield").getValue();
    this.obj.FilterByDateType = this.getDateLimitPanel().getByItemId("dateRangePicker").getFilterByDateType();
    var e = new Date();
    switch (this.obj.FilterByDateType) {case Explore.model.FilterByDateType.Before:this.obj.ToDate = this.getDateLimitPanel().getByItemId("dateRangePicker").getEndDate();
        this.obj.ToDate.setHours(23);this.obj.ToDate.setMinutes(59);this.obj.ToDate.setSeconds(59);this.obj.FromDate = null;break;case Explore.model.FilterByDateType.Between:this.obj.FromDate = this.getDateLimitPanel().getByItemId("dateRangePicker").getStartDate();
        this.obj.FromDate.setHours(0);this.obj.FromDate.setMinutes(0);this.obj.ToDate = this.getDateLimitPanel().getByItemId("dateRangePicker").getEndDate();
        this.obj.ToDate.setHours(23);this.obj.ToDate.setMinutes(59);this.obj.ToDate.setSeconds(59);break;case Explore.model.FilterByDateType.After:this.obj.FromDate = this.getDateLimitPanel().getByItemId("dateRangePicker").getStartDate();
        this.obj.FromDate.setHours(0);this.obj.FromDate.setMinutes(0);this.obj.ToDate = null;break;case Explore.model.FilterByDateType.PastDay:this.obj.FromDate = Explore.getStartDateFromTimeWindow(Explore.model.TimeWindow.Past24Hours, e, null);
        this.obj.ToDate = null;break;case Explore.model.FilterByDateType.PastWeek:this.obj.FromDate = Explore.getStartDateFromTimeWindow(Explore.model.TimeWindow.PastWeek, e, null);
        this.obj.ToDate = null;break;case Explore.model.FilterByDateType.PastMonth:this.obj.FromDate = Explore.getStartDateFromTimeWindow(Explore.model.TimeWindow.PastMonth, e, null);
        this.obj.ToDate = null;break;case Explore.model.FilterByDateType.PastYear:this.obj.FromDate = Explore.getStartDateFromTimeWindow(Explore.model.TimeWindow.Past12Months, e, null);
        this.obj.ToDate = null;break;default:break
    }
    this.obj.Criteria = this.getSearchField().getByItemId("searchcriteria").getValue();
    this.obj.Schedule = this.getIntervalRadioGroupPanel().getHoursField().getValue();
    this.obj.StartDate = this.getIntervalRadioGroupPanel().getDateField().getValue();
    var d = this.getIntervalRadioGroupPanel().getTimeField().getValue();
    this.setTimeInDate(d, this.obj.StartDate);
    return this.obj
},showPreview:function(c, d, a) {
    var b = this;
    var e = new Explore.view.importdata.preview.ResultsWindow({type:"facebook"});
    SourceService.GetPreviewOfFacebookResults(this.getDataImport(c, d), function(g) {
        var f = e.getPreviewGrid().getStore();
        f.loadData(g.Result);
        e.show()
    });
    e.on("close", function() {
        a()
    })
}});
Ext.reg("explore.view.importdata.importfacebookpanel", Explore.view.importdata.ImportFacebookPanel);
Ext.ns("Explore.view.importdata");
Explore.view.importdata.ImportRadian6Panel = Ext.extend(Ext.Panel, {initComponent:function() {
    var a = this;
    var e = this.initialConfig || {};
    var d = a.getUploadField();
    var f = a.getImportLimitPanel();
    this.obj = this.initialConfig.obj;
    var c = a.getIntervalRadioGroupPanel();
    var b = {border:false,frame:false,monitorValid:true,layout:"vbox",items:[d,c]};
    Ext.apply(this, Ext.apply(b, this.initialConfig));
    Explore.view.importdata.ImportRadian6Panel.superclass.initComponent.apply(this, arguments)
},getUploadField:function() {
    if (!this.uploadField) {
        var a = this;
        this.uploadField = new Ext.form.FormPanel({fileUpload:true,border:false,autoHeight:true,frame:false,itemId:"UploadFieldForm",padding:10,labelWidth:150,listeners:{afterlayout:function() {
            if (a.isVisible()) {
                a.uploadField.getByItemId("radian6file").el.setWidth(a.getWidth() - 200)
            }
        }},items:[
            {xtype:"fileuploadfield",buttonOnly:false,name:"radian6file",itemId:"radian6file",allowBlank:false,width:"100%",fieldLabel:Explore.i18n("UploadRadian6File"),buttonText:"...",regex:/^.*\.(xml)$/,value:this.obj ? this.obj.ImportFileUNC : "",regexText:Explore.i18n("Only xml data supported"),listeners:{scope:this,fileselected:function(c, b) {
            }}}
        ]})
    }
    return this.uploadField
},getImportLimitPanel:function() {
    if (!this.importLimitPanel) {
        this.importLimitPanel = new Ext.form.FormPanel({border:false,frame:false,autoHeight:true,disable:false,padding:10,labelWidth:150,items:[
            {xtype:"compositefield",hidden:false,itemId:"compositefield",items:[
                {xtype:"textfield",itemId:"importmaxfield",fieldLabel:Explore.i18n("ImportNoMoreThan"),value:this.obj ? this.obj.DocumentImportLimit : 1000,regex:new RegExp("[0-9]+"),width:60},
                {xtype:"label",width:40,text:Explore.i18n("Documents")}
            ]}
        ]})
    }
    return this.importLimitPanel
},getIntervalRadioGroupPanel:function() {
    var p = this;
    if (!this.intervalRadioGroupPanel) {
        var j = new Ext.form.Radio({boxLabel:Explore.i18n("Every_1"),itemId:"every",checked:this.obj ? this.obj.Repeat : false});
        var g = new Ext.form.TextField({itemId:"importmaxfield",value:this.obj ? this.obj.Schedule : 24,regex:new RegExp("[0-9]+"),width:60,disabled:false,allowBlank:this.obj ? !this.obj.Repeat : true});
        var f = new Date().add(Date.DAY, 0);
        var e = "12:00 AM";
        if (this.obj && this.obj.StartDate) {
            var k = this.obj.StartDate - Explore.getLocalTimeZoneOffset();
            f = Explore.getDateFromEpoch(k / 1000);
            var m = f.getHours();
            var h = f.getMinutes();
            f.setHours(0);
            f.setMinutes(0);
            var n = false;
            if (m > 11) {
                m = m - 12;
                n = true
            }
            if (h === 0) {
                h = "00"
            }
            if (m === 0) {
                m = 12
            }
            e = m + ":" + h + " " + (n ? "PM" : "AM")
        }
        var b = new Ext.form.DateField({itemId:"dateField",format:Explore.getDateFormatByPref({ignoreTime:true}),editable:false,altFormats:Explore.getDateFormatByPref({ignoreTime:true}),value:f,width:100,disabled:false,allowBlank:this.obj ? !this.obj.Repeat : true});
        var a = new Ext.form.TimeField({itemId:"startTimeField",increment:30,width:90,margins:"0 8 0 8",allowBlank:this.obj ? !this.obj.Repeat : true,disabled:false,value:e});
        var o = {xtype:"compositefield",itemId:"compositefield",items:[j,g,{xtype:"label",width:100,text:Explore.i18n("hoursStartingOn")},b,{xtype:"label",width:10,text:Explore.i18n("at")},a]};
        var l = new Ext.form.Radio({boxLabel:Explore.i18n("Never_JustImportThisOnce"),itemId:"single",checked:this.obj ? !this.obj.Repeat : true});
        var c = new Ext.form.RadioGroup({xtype:"radiogroup",itemId:"intervalradiogroup",disabled:false,fieldLabel:Explore.i18n("RepeatDataImport"),columns:1,vertical:true,items:[l,o]});
        l.on("check", function(q, d) {
            if (d) {
                j.setValue(false);
                g.allowBlank = true;
                g.setDisabled(true);
                g.clearInvalid();
                b.allowBlank = true;
                b.setDisabled(true);
                b.clearInvalid();
                a.allowBlank = true;
                a.setDisabled(true);
                a.clearInvalid()
            }
        });
        j.on("check", function(q, d) {
            if (d) {
                l.setValue(false);
                g.allowBlank = false;
                g.setDisabled(false);
                g.validate();
                b.allowBlank = false;
                b.setDisabled(false);
                b.validate();
                a.allowBlank = false;
                a.setDisabled(false);
                a.validate()
            }
        });
        this.intervalRadioGroupPanel = new Ext.form.FormPanel({getHoursField:function() {
            return g
        },getDateField:function() {
            return b
        },getTimeField:function() {
            return a
        },border:false,frame:false,autoHeight:true,disable:true,padding:10,labelWidth:150,items:[c]})
    }
    return this.intervalRadioGroupPanel
},setTimeInDate:function(d, e) {
    if (d) {
        var b = d.split(":");
        var a = parseInt(b[0]);
        var f = b[1].split(" ");
        var c = parseInt(f[0]);
        if (a === 12) {
            a = a - 12
        }
        if (f[1] === "PM") {
            a = a + 12
        }
        e.setHours(a);
        e.setMinutes(c);
        e.setTime(e.getTime())
    }
},saveDataImport:function(b, d) {
    var a = this;
    if (!this.obj) {
        this.obj = {}
    }
    var c = this.obj.ImportFileUNC != this.getUploadField().getByItemId("radian6file").getValue();
    this.obj.Name = b;
    this.obj.Description = d;
    this.obj.ImportFileUNC = this.getUploadField().getByItemId("radian6file").getValue();
    this.obj.Repeat = this.getIntervalRadioGroupPanel().getByItemId("intervalradiogroup").getValue().getItemId() === "every";
    this.obj.Schedule = this.getIntervalRadioGroupPanel().getHoursField().getValue();
    this.obj.DocumentImportLimit = 0;
    this.obj.StartDate = this.getIntervalRadioGroupPanel().getDateField().getValue();
    this.obj.Origin = 1;
    var f = this.getIntervalRadioGroupPanel().getTimeField().getValue();
    this.setTimeInDate(f, this.obj.StartDate);
    var e = this.obj.Repeat;
    Explore.data.DataImportStore.saveDataImport(this.obj, function(g) {
        var h = a.getByItemId("UploadFieldForm");
        if (e === false) {
            if (g.ErrorCode === 0) {
                var j = g.Result;
                if (j.Id > 0) {
                    if (h.getForm().isValid() && c) {
                        h.getForm().submit({fileUpload:true,url:"../Handlers/ImportRadian6.ashx?importDefId=" + j.Id,waitMsg:"Importing..",success:function(k, m) {
                            if (!m || !m.result) {
                                Explore.view.StatusBox.showWarning("Failed", "Server failed to return a response.");
                                a.fireEvent("savecompleted");
                                return
                            }
                            var l = m.result.result;
                            Explore.view.StatusBox.showInformation("Success", m.result.msg + " <br/> Total Valid Documents: " + l.TotalValidDocuments + "<br/>Total Validation Errors: " + l.TotalValidationErrors, function() {
                                a.fireEvent("savecompleted")
                            })
                        },failure:function(m, p) {
                            var n;
                            if (!p || !p.result) {
                                Explore.view.StatusBox.showWarning("Failed", "Server failed to return a response.");
                                a.fireEvent("savecompleted");
                                return
                            }
                            var n = p.result.result;
                            m.reset();
                            var l = "Radian6 import failed";
                            for (var k = 0; k < n.Errors.length;
                                 k++) {
                                l += "<br/>" + Explore.i18n("errorMessage" + n.Errors[k])
                            }
                            Explore.view.StatusBox.showWarning("Failed", l);
                            a.fireEvent("savecompleted")
                        }})
                    } else {
                        a.fireEvent("savecompleted")
                    }
                }
            } else {
                Explore.view.StatusBox.showWarning("Failed", Explore.i18n("errorMessage" + g.ErrorCode));
                a.fireEvent("savecompleted")
            }
        } else {
            a.fireEvent("savecompleted")
        }
    }, false)
},isValid:function() {
    var a = this;
    var b = true;
    b &= a.getIntervalRadioGroupPanel().getDateField().isValid();
    b &= a.getIntervalRadioGroupPanel().getHoursField().isValid();
    b &= a.getIntervalRadioGroupPanel().getTimeField().isValid();
    b &= a.getUploadField().getByItemId("radian6file").isValid();
    return b
},isDirty:function() {
    var d = false;
    var c = this;
    d |= !(c.obj.Schedule == c.getIntervalRadioGroupPanel().getHoursField().getValue());
    var a = (c.getIntervalRadioGroupPanel().getByItemId("intervalradiogroup").getValue().getItemId() === "every");
    d |= !(c.obj.Repeat === a);
    d |= !(c.obj.DocumentImportLimit == 0);
    var e = this.getIntervalRadioGroupPanel().getTimeField().getValue();
    var b = this.getIntervalRadioGroupPanel().getDateField().getValue();
    this.setTimeInDate(e, b);
    d |= !(b.toString() == (Explore.getDateFromEpoch(this.obj.StartDate / 1000 - Explore.getLocalTimeZoneOffset() / 1000)));
    return d
}});
Ext.reg("explore.view.importdata.importradian6panel", Explore.view.importdata.ImportRadian6Panel);
Ext.ns("Explore.view.importdata");
Explore.view.importdata.ImportSourcePanel = Ext.extend(Ext.Panel, {initComponent:function() {
    var b = this;
    var d = this.initialConfig || {};
    var a = 0;
    if (this.obj) {
        if (this.obj.Origin == 3) {
            a = 0
        } else {
            if (this.obj.Origin == 2) {
                a = 1
            } else {
                if (this.obj.Origin == 1) {
                    a = 2
                }
            }
        }
    }
    var c = {autoShow:true,resizable:false,monitorValid:true,monitorPoll:1000,layout:"card",layoutOnCardChange:true,activeItem:a,items:b.getAllPanels()};
    Ext.apply(this, Ext.apply(c, this.initialConfig));
    Explore.view.importdata.ImportSourcePanel.superclass.initComponent.apply(this, arguments)
},getAllPanels:function() {
    var b = this;
    var a = {id:"facebook",xtype:"explore.view.importdata.importfacebookpanel",layout:"fit",obj:this.obj,listeners:{previewready:function(e) {
        b.fireEvent("previewready", e)
    }}};
    var d = {id:"twitter",xtype:"explore.view.importdata.importtwitterpanel",obj:this.obj,listeners:{previewready:function(e) {
        b.fireEvent("previewready", e)
    }}};
    var c = {id:"radian6",xtype:"explore.view.importdata.importradian6panel",layout:"fit",obj:this.obj};
    return[d,a,c]
},switchSourcePanel:function(c) {
    var a = this;
    var b = a.getLayout();
    b.setActiveItem(c);
    a.doLayout()
},isValid:function() {
    var a = this;
    var b = a.getLayout();
    return b.activeItem.isValid()
},isDirty:function() {
    var a = this;
    var b = a.getLayout();
    return b.activeItem.isDirty()
}});
Ext.reg("explore.view.importdata.importsourcepanel", Explore.view.importdata.ImportSourcePanel);
Ext.ns("Explore.view.importdata");
Explore.view.importdata.ImportTwitterPanel = Ext.extend(Ext.Panel, {labelWidth:150,defaults:{width:"100%",border:false,frame:false,labelWidth:150,padding:"0px 0px 0px 10px"},initComponent:function() {
    var a = this;
    var d = this.initialConfig || {};
    this.obj = this.initialConfig.obj;
    var f = a.getSearchField();
    var e = a.getImportLimitPanel();
    var h = a.getDateLimitPanel();
    var c = a.getIntervalRadioGroupPanel();
    var b = {border:false,frame:false,monitorValid:true,layout:"vbox",items:[a.getAccountSearchRadioGroup(),f,a.getTwitterAccountPanel(),h,e,c]};
    Ext.apply(this, Ext.apply(b, this.initialConfig));
    Explore.view.importdata.ImportTwitterPanel.superclass.initComponent.apply(this, arguments);
    var g = a.getSearchField().getSearchcriteria();
    g.on("invalid", function(j, k) {
        a.fireEvent("previewready", false)
    });
    g.on("valid", function(j, k) {
        a.fireEvent("previewready", true)
    });
    a.on("show", function() {
        a.fireEvent("previewready", g.isValid())
    })
},getAccountSearchRadioGroup:function() {
    if (!this._accountSearchRadioGroupPanel) {
        var a = this;
        var d = (this.obj && (this.obj.SearchType === Explore.model.DataSourceSearchType.Authorized));
        var c = new Ext.form.Radio({boxLabel:Explore.i18n("Account-based API")});
        var b = new Ext.form.Radio({boxLabel:Explore.i18n("Search-based API")});
        a.on("afterrender", function() {
            c.setValue(d);
            b.setValue(!d)
        }, this, {single:true});
        c.on("check", function(f, e) {
            b.setValue(!e);
            a.getSearchField().setVisible(!e);
            a.getTwitterAccountPanel().setVisible(e);
            a.doLayout()
        });
        b.on("check", function(f, e) {
            a.getSearchField().setVisible(e);
            a.getTwitterAccountPanel().setVisible(!e);
            c.setValue(!e);
            a.doLayout()
        });
        this._accountSearchRadioGroup = new Ext.form.RadioGroup({fieldLabel:Explore.i18n("Using"),items:[b,c]});
        this._accountSearchRadioGroupPanel = new Ext.form.FormPanel({getAccountRadio:function() {
            return c
        },getSearchRadio:function() {
            return b
        },getSearchType:function() {
            if (this.getAccountRadio().getValue()) {
                return Explore.model.DataSourceSearchType.Authorized
            } else {
                if (this.getSearchRadio().getValue()) {
                    return Explore.model.DataSourceSearchType.Public
                } else {
                    return null
                }
            }
        },items:this._accountSearchRadioGroup})
    }
    return this._accountSearchRadioGroupPanel
},getTwitterAccountPanel:function() {
    if (!this._twitterAccountPanel) {
        var a = Explore.getSocialAccountsByType(Explore.model.SocialMediaType.Twitter);
        this._twitterAccountPanel = new Ext.form.FormPanel({getCombo:function() {
            return this.getByItemId("twitterAccntsCmb")
        },items:[
            {xtype:"selectboxfield",itemId:"twitterAccntsCmb",allowBlank:false,fieldLabel:Explore.i18n("Engagement Account"),emptyText:Explore.i18n("HypNoneHyp"),width:200,value:(this.obj && this.obj.SocialMediaAccountId) ? this.obj.SocialMediaAccountId : null,options:a,valueField:"Id",displayField:"ScreenName"}
        ]})
    }
    return this._twitterAccountPanel
},getSearchField:function() {
    if (!this.searchFieldPanel) {
        var b = '<table celpadding="0" celspacing="0"><tbody><tr><th><b>Operator</b></th><th>Finds tweets...</th></tr><tr><td>twitter search</td><td>containing both "twitter" and "search". This is the default operator.</td></tr><tr><td><b>"</b>happy hour<b>"</b></td><td>containing the exact phrase "happy hour".</td></tr><tr><td>love <b>OR</b> hate</td><td>containing either "love" or "hate" (or both).</td></tr><tr><td>beer <b>-</b>root</td><td>containing "beer" but not "root".</td></tr><tr><td><b>#</b>haiku</td><td>containing the hashtag "haiku".</td></tr><tr><td><b>from:</b>alexiskold</td><td>sent from person "alexiskold".</td></tr><tr><td><b>to:</b>techcrunch</td><td>sent to person "techcrunch".</td></tr><tr><td><b>@</b>mashable</td><td>referencing person "mashable".</td></tr><tr><td><b>near:</b>NYC <b>within:</b>15mi</td><td>sent within 15 miles of "NYC".</td></tr><tr><td>flight <b>:(</b></td><td>containing "flight" and with a negative attitude.</td></tr><tr><td>traffic <b>?</b></td><td>containing "traffic" and asking a question.</td></tr><tr><td>hilarious <b>filter:links</b></td><td>containing "hilarious" and linking to URLs.</td></tr><tr><td>news <b>source:twitterfeed</b></td><td>containing "news" and entered via TwitterFeed</td></tr></tbody></table></div></div></div><div style="display: none;" class="twttr-dialog-footer clearfix"></div></div></div>';
        var d = new Ext.Window({title:Explore.i18n("Search Operators"),x:0,y:0,autoScroll:true,constrain:true,closeAction:"hide",cls:"white-bg-dialog",html:b});
        this.on("destroy", function() {
            d.close()
        });
        var a = '<a id="twitterOperatorHelp" href="#">{0}</a>';
        var c = {xtype:"displayfield",frame:false,border:false,cls:"searchHdrText",autoEl:{tag:"div"},html:String.format(a, Explore.i18n("Show Operator Tips")),listeners:{afterrender:function(f) {
            var g = Ext.get("twitterOperatorHelp");
            g.on("click", function() {
                d.show()
            }, self);
            new Ext.ToolTip({target:"twitterOperatorHelp",anchor:"top",html:Explore.i18n("Show Operator Tips")})
        }}};
        var e = new Ext.form.TextField({xtype:"textfield",fieldLabel:"Search Criteria",itemId:"searchcriteria",width:"95%",value:this.obj ? this.obj.Criteria : "",allowBlank:false});
        this.searchFieldPanel = new Ext.form.FormPanel({border:false,autoHeight:true,frame:false,getSearchcriteria:function() {
            return e
        },itemId:"Search",padding:5,labelWidth:150,items:[e,c]});
        d.on("deactivate", function() {
            Ext.WindowMgr.bringToFront(d)
        }, this, {delay:1})
    }
    return this.searchFieldPanel
},displayStartDate:function(a) {
    if (a) {
        return((a.FilterByDateType == Explore.model.FilterByDateType.Between) || (a.FilterByDateType == Explore.model.FilterByDateType.After)) ? true : false
    } else {
        return false
    }
},displayEndDate:function(a) {
    if (a) {
        return((a.FilterByDateType == Explore.model.FilterByDateType.Between) || (a.FilterByDateType == Explore.model.FilterByDateType.Before)) ? true : false
    } else {
        return false
    }
},getDateLimitPanel:function() {
    if (!this.dateLimitPanel) {
        if (this.obj) {
            if (this.obj.ToDate != null) {
                this.obj.ToDate = new Date(this.obj.ToDate)
            }
            if (this.obj.FromDate != null) {
                this.obj.FromDate = new Date(this.obj.FromDate)
            }
        }
        var a = {xtype:"explore.view.common.daterangepicker",itemId:"dateRangePicker",fieldLabel:Explore.i18n("Date"),horizontalLayout:true,isTwitter:true,supportTrailingRanges:true,defaultValues:{showStartDate:this.displayStartDate(this.obj),showEndDate:this.displayEndDate(this.obj),startDate:(this.obj && this.obj.FromDate != null) ? this.obj.FromDate : new Date,endDate:(this.obj && this.obj.ToDate != null) ? this.obj.ToDate : new Date,dateType:(this.obj && this.obj.FilterByDateType != null) ? this.obj.FilterByDateType : Explore.model.FilterByDateType.Any}};
        this.dateLimitPanel = new Ext.form.FormPanel({border:false,autoHeight:true,frame:false,itemId:"datelimit",padding:5,labelWidth:150,items:[a]})
    }
    return this.dateLimitPanel
},getImportLimitPanel:function() {
    if (!this.importLimitPanel) {
        this.importLimitPanel = new Ext.form.FormPanel({border:false,frame:false,autoHeight:true,hidden:false,padding:5,labelWidth:150,items:[
            {xtype:"compositefield",itemId:"compositefield",height:25,combineErrors:false,items:[
                {xtype:"textfield",itemId:"importmaxfield",fieldLabel:Explore.i18n("ImportNoMoreThan"),value:this.obj ? this.obj.DocumentImportLimit : 1000,validator:function(b, a) {
                    if ((isNaN(b)) || (b % 100 != 0)) {
                        return Explore.i18n("DocumentLimitRequiresHundreds")
                    } else {
                        return true
                    }
                },allowBlank:false,width:60},
                {xtype:"label",width:200,text:Explore.i18n("DocumentInputHundreds")}
            ]}
        ]})
    }
    return this.importLimitPanel
},getIntervalRadioGroupPanel:function() {
    var p = this;
    if (!this.intervalRadioGroupPanel) {
        var j = new Ext.form.Radio({boxLabel:Explore.i18n("Every_1"),itemId:"every",checked:this.obj ? this.obj.Repeat : false});
        var g = new Ext.form.TextField({itemId:"schedulefield",value:this.obj ? this.obj.Schedule : 24,regex:new RegExp("[0-9]+"),width:60,disabled:this.obj ? !this.obj.Repeat : true,allowBlank:false});
        var f = new Date().add(Date.DAY, 0);
        var e = "12:00 AM";
        if (this.obj && this.obj.StartDate) {
            var k = this.obj.StartDate;
            f = Explore.getDateFromEpoch(k / 1000);
            var m = f.getHours();
            var h = f.getMinutes();
            f.setHours(0);
            f.setMinutes(0);
            var n = false;
            if (m > 11) {
                m = m - 12;
                n = true
            }
            if (h === 0) {
                h = "00"
            }
            if (m === 0) {
                m = 12
            }
            e = m + ":" + h + " " + (n ? "PM" : "AM")
        }
        var b = new Ext.form.DateField({itemId:"dateField",format:Explore.getDateFormatByPref({ignoreTime:true}),editable:false,altFormats:Explore.getDateFormatByPref({ignoreTime:true}),value:f,width:100,disabled:false,allowBlank:this.obj ? !this.obj.Repeat : true});
        var a = new Ext.form.TimeField({itemId:"startTimeField",increment:30,width:90,margins:"0 8 0 8",allowBlank:this.obj ? !this.obj.Repeat : true,disabled:false,value:e});
        var o = {xtype:"compositefield",itemId:"compositefield",items:[j,g,{xtype:"label",width:100,text:Explore.i18n("hoursStartingOn")},b,{xtype:"label",width:10,text:Explore.i18n("at")},a]};
        var l = new Ext.form.Radio({boxLabel:Explore.i18n("Never_JustImportThisOnce"),itemId:"single",checked:this.obj ? !this.obj.Repeat : true});
        var c = new Ext.form.RadioGroup({xtype:"radiogroup",itemId:"intervalradiogroup",disabled:false,fieldLabel:Explore.i18n("RepeatDataImport"),columns:1,vertical:true,items:[l,o]});
        l.on("check", function(q, d) {
            if (d) {
                j.setValue(false);
                g.allowBlank = true;
                g.setValue("24");
                g.setDisabled(true);
                g.clearInvalid()
            }
        });
        j.on("check", function(q, d) {
            if (d) {
                l.setValue(false);
                g.allowBlank = false;
                g.setDisabled(false);
                g.validate()
            }
        });
        this.intervalRadioGroupPanel = new Ext.form.FormPanel({getHoursField:function() {
            return g
        },getDateField:function() {
            return b
        },getTimeField:function() {
            return a
        },border:false,frame:false,autoHeight:true,disable:true,padding:"0px 5px 5px 5px",labelWidth:150,items:[c]})
    }
    return this.intervalRadioGroupPanel
},setTimeInDate:function(d, e) {
    if (d) {
        var b = d.split(":");
        var a = parseInt(b[0]);
        var f = b[1].split(" ");
        var c = parseInt(f[0]);
        if (a === 12) {
            a = a - 12
        }
        if (f[1] === "PM") {
            a = a + 12
        }
        e.setHours(a);
        e.setMinutes(c);
        e.setTime(e.getTime())
    }
},saveDataImport:function(b, c) {
    var a = this;
    this.obj = this.getDataImportObject(b, c);
    Explore.data.DataImportStore.saveTwitterDataImport(this.obj, function(d) {
        var e;
        if (d) {
            e = (d.Result.Repeat) ? "scheduled" : "submitted";
            if (d.ErrorCode === 0 && d.Message === null) {
                Explore.view.StatusBox.showInfo(Explore.i18n("docTypeTWITTER"), Explore.i18n("messageTwitterImportSuccessful") + " " + e + ".");
                a.fireEvent("savecompleted")
            } else {
                Explore.view.StatusBox.showWarning(Explore.i18n("twitterImportFailed"), d.Message)
            }
        } else {
            Explore.view.StatusBox.showInfo(Explore.i18n("docTypeTWITTER"), Explore.i18n("messageTwitterNotReachable"))
        }
    })
},getDataImportObject:function(a, b) {
    if (!this.obj) {
        this.obj = {}
    }
    this.obj.Name = a;
    this.obj.Description = b;
    this.obj.Origin = 2;
    this.obj.Repeat = this.getIntervalRadioGroupPanel().getByItemId("intervalradiogroup").getValue().getItemId() === "every";
    this.obj.DocumentImportLimit = this.getImportLimitPanel().getByItemId("importmaxfield").getValue();
    this.obj.FromDate = null;
    this.obj.FilterByDateType = this.getDateLimitPanel().getByItemId("dateRangePicker").getFilterByDateType();
    this.obj.SearchType = this.getAccountSearchRadioGroup().getSearchType();
    if (this.obj.SearchType === Explore.model.DataSourceSearchType.Authorized) {
        this.obj.SocialMediaAccountId = this.getTwitterAccountPanel().getCombo().getValue()
    } else {
        if (this.obj.SearchType === Explore.model.DataSourceSearchType.Public) {
            this.obj.Criteria = this.getSearchField().getByItemId("searchcriteria").getValue()
        }
    }
    var d = new Date();
    switch (this.obj.FilterByDateType) {case Explore.model.FilterByDateType.Before:this.obj.ToDate = this.getDateLimitPanel().getByItemId("dateRangePicker").getEndDate();
        this.obj.ToDate.setHours(23);this.obj.ToDate.setMinutes(59);this.obj.ToDate.setSeconds(59);this.obj.FromDate = null;break;case Explore.model.FilterByDateType.Between:this.obj.FromDate = this.getDateLimitPanel().getByItemId("dateRangePicker").getStartDate();
        this.obj.FromDate.setHours(0);this.obj.FromDate.setMinutes(0);this.obj.ToDate = this.getDateLimitPanel().getByItemId("dateRangePicker").getEndDate();
        this.obj.ToDate.setHours(23);this.obj.ToDate.setMinutes(59);this.obj.ToDate.setSeconds(59);break;case Explore.model.FilterByDateType.After:this.obj.FromDate = this.getDateLimitPanel().getByItemId("dateRangePicker").getStartDate();
        this.obj.FromDate.setHours(0);this.obj.FromDate.setMinutes(0);this.obj.ToDate = null;break;case Explore.model.FilterByDateType.PastDay:this.obj.FromDate = Explore.getStartDateFromTimeWindow(Explore.model.TimeWindow.Past24Hours, d, null);
        this.obj.ToDate = null;break;case Explore.model.FilterByDateType.PastWeek:this.obj.FromDate = Explore.getStartDateFromTimeWindow(Explore.model.TimeWindow.PastWeek, d, null);
        this.obj.ToDate = null;break;case Explore.model.FilterByDateType.PastMonth:this.obj.FromDate = Explore.getStartDateFromTimeWindow(Explore.model.TimeWindow.PastMonth, d, null);
        this.obj.ToDate = null;break;case Explore.model.FilterByDateType.PastYear:this.obj.FromDate = Explore.getStartDateFromTimeWindow(Explore.model.TimeWindow.Past12Months, d, null);
        this.obj.ToDate = null;break;default:break
    }
    this.obj.Schedule = this.getIntervalRadioGroupPanel().getHoursField().getValue();
    this.obj.StartDate = this.getIntervalRadioGroupPanel().getDateField().getValue();
    var c = this.getIntervalRadioGroupPanel().getTimeField().getValue();
    this.setTimeInDate(c, this.obj.StartDate);
    return this.obj
},isValid:function() {
    var a = this;
    var b = true;
    b &= a.getIntervalRadioGroupPanel().getHoursField().isValid();
    if (a.getSearchField().isVisible()) {
        b &= a.getSearchField().getByItemId("searchcriteria").isValid()
    } else {
        b &= !!(a.getTwitterAccountPanel().getCombo().getValue())
    }
    return b
},isDateLimitDirty:function() {
    var a = this;
    var b = false;
    fltrByDateType = this.getDateLimitPanel().getByItemId("dateRangePicker").getFilterByDateType();
    b |= !(this.obj.FilterByDateType == fltrByDateType);
    if (fltrByDateType === Explore.model.FilterByDateType.Between) {
        if (this.obj.ToDate != null) {
            b |= !(this.obj.ToDate.toDateString() == a.getDateLimitPanel().getByItemId("dateRangePicker").getEndDate().toDateString())
        }
    }
    return b
},isDirty:function() {
    var c = this;
    var d = false;
    d |= this.isDateLimitDirty();
    var a = (c.getIntervalRadioGroupPanel().getByItemId("intervalradiogroup").getValue().getItemId() === "every");
    d |= !(c.obj.Repeat === a);
    if (a) {
        d |= !(c.obj.Schedule == c.getIntervalRadioGroupPanel().getHoursField().getValue())
    }
    d |= !(c.obj.Schedule == c.getIntervalRadioGroupPanel().getHoursField().getValue());
    d |= !(c.obj.DocumentImportLimit == c.getImportLimitPanel().getByItemId("importmaxfield").getValue());
    var e = this.getIntervalRadioGroupPanel().getTimeField().getValue();
    var b = this.getIntervalRadioGroupPanel().getDateField().getValue();
    this.setTimeInDate(e, b);
    d |= !(b.toString() == (Explore.getDateFromEpoch(this.obj.StartDate / 1000)));
    if (c.getSearchField().isVisible()) {
        d |= (c.obj.Criteria !== c.getSearchField().getByItemId("searchcriteria").getValue())
    } else {
        d |= (c.obj.SocialMediaAccountId !== c.getTwitterAccountPanel().getCombo().getValue())
    }
    return d
},showPreview:function(c, d, a) {
    var b = this;
    var e = new Explore.view.importdata.preview.ResultsWindow({type:"twitter"});
    e.on("close", function() {
        a()
    });
    SourceService.GetPreviewOfTwitterResults(this.getDataImportObject(c, d), function(g) {
        var f = e.getPreviewGrid().getStore();
        f.loadData(g.Result);
        e.show()
    })
}});
Ext.reg("explore.view.importdata.importtwitterpanel", Explore.view.importdata.ImportTwitterPanel);
Ext.ns("Explore.view.importdata.preview");
Explore.view.importdata.preview.DisplayWindow = Ext.extend(Ext.Window, {height:400,width:600,title:"",constrain:true,maximizable:true,modal:true,type:null,cls:"white-bg-dialog",results:null,startIndex:0,currentIndex:0,totalRecords:0,currentRecord:null,history:{},template:new Ext.XTemplate('<div class="search-result">', "{image}", "<h1>{title}</h1>", '<div class="search-result-hdr"><tpl if="from != \'\'">{this.strings.by} <span class="author">{from}</span> </tpl>', '(<span class="type">{type}</span> <img src="../resources/images/icons/icn_multichannel_{type}_16.png" alt="{type}" style="vertical-align: middle" />) ', "{this.strings.on} {date} {this.strings.at} {time}</div>", "<hr/>", '<div class="search-result-content"> <p>{content}</p></div>', "<br/>", '<tpl if="articleUrl"><div class="search-result-link"><a href="{articleUrl}" target="_blank">{this.strings.viewSource}</a></div></tpl>', "</div>", {strings:{sentiment:Explore.i18n("Sentiment").toUpperCase(),taggedWith:Explore.i18n("taggedWith"),by:Explore.i18n("by"),on:Explore.i18n("on"),at:Explore.i18n("at"),following:Explore.i18n("Following"),followers:Explore.i18n("Followers"),updates:Explore.i18n("Updates"),similarArticles:Explore.i18n("similarArticles"),followingArticles:Explore.i18n("followingArticles"),postType:Explore.i18n("PostType"),viewSource:Explore.i18n("viewSource")}}),initComponent:function() {
    var a = this;
    var b = {layout:"fit",items:[
        {itemId:"mainPanel",xtype:"box",cls:"search-result-window-box-autoscroll",listeners:{afterrender:function(c) {
            a.loadResults(a.startIndex)
        }}}
    ],fbar:[
        {itemId:"backButton",iconCls:"x-tbar-page-prev",tooltip:Explore.i18n("BackToTheLastItemViewed"),handler:function() {
            a.navigateBack()
        }},
        {itemId:"resultIndexLabel",xtype:"label",text:a.getResultIndexLabelText()},
        {itemId:"nextButton",iconCls:"x-tbar-page-next",tooltip:Explore.i18n("NextResult"),handler:function() {
            a.navigate(1)
        }},
        {itemId:"closeButton",text:Explore.i18n("Close"),handler:function() {
            a.close()
        }}
    ]};
    Ext.apply(this, Ext.apply(b, this.initialConfig));
    Explore.view.importdata.preview.DisplayWindow.superclass.initComponent.apply(this, arguments)
},loadResults:function(b) {
    var a = this;
    var c = a.currentIdex + b;
    var d = a.results[a.currentIndex];
    a.currentIndex += b;
    a.currentRecord = a.results[a.currentIndex];
    a.displayObject(a.currentRecord)
},displayObject:function(a) {
    this.updateUI()
},getResultIndexLabelText:function() {
    return String.format("Results {0} of {1}", this.currentIndex + 1, this.totalRecords)
},navigate:function(a) {
    this.loadResults(a)
},updateUI:function() {
    var b = this;
    var c = b.fbar;
    b.updatePanelHtml();
    var a = c.getByItemId("resultIndexLabel");
    a.setText(b.getResultIndexLabelText());
    c.getByItemId("nextButton").setDisabled(b.currentIndex + 1 === b.totalRecords);
    c.getByItemId("backButton").setDisabled(b.currentIndex === 0);
    b.setTitle(b.getTitleForCurrentResult())
},getTitleForCurrentResult:function() {
    var a = "{0}";
    return String.format(a, this.currentRecord.get("SourceTitle"))
},navigateBack:function() {
    this.navigate(-1)
},updatePanelHtml:function() {
    var l = this;
    var c = l.getByItemId("mainPanel").el;
    var o = (l.type === "facebook");
    var g = l.currentRecord;
    if (g) {
        var k = {};
        k.type = l.type;
        k.isFacebook = o;
        var e = g.get("ImageURL");
        k.image = '<img src="' + e + '" style="display:none; padding-right:10px; max-height:64px; max-width:64px; float:left;" alt="' + g.get("Author") + '" onload="Explore.showLoadedImage(this)" />';
        k.title = Explore.SearchResults.getTruncateTextWithEllipsis(g.get("SourceTitle"));
        k.from = g.get("Author");
        k.articleUrl = g.get("SourceURL");
        if (o) {
            var b = g.get("SourcDateTime");
            var h = b.lastIndexOf("+");
            if (h != -1) {
                var n = b.substring(0, h) + "Z";
                k.date = Explore.formatDateByPref(n, {ignoreTime:true});
                k.time = Explore.formatTimeByPref(n)
            }
        } else {
            var d = new Date(g.get("SourcDateTime"));
            if (d) {
                k.date = Explore.formatDateByPref(d, {ignoreTime:true});
                k.time = Explore.formatTimeByPref(d)
            }
        }
        var j = g.get("Content") || "";
        var m = j.split(new RegExp("\\n"));
        var a = "";
        for (var f = 0; f < m.length;
             f++) {
            a += String.format("<p>{0}</p>", m[f])
        }
        k.hasContent = !!(j && j !== "");
        if (k.hasContent) {
            k.content = a
        } else {
        }
        l.template.overwrite(c, k)
    } else {
    }
}});
Ext.ns("Explore.view.importdata.preview");
Explore.view.importdata.preview.ResultsGrid = Ext.extend(Ext.grid.GridPanel, {border:false,frame:false,autoScroll:true,autoExpandColumn:"title",autoExpandMax:2000,loadMask:true,initComponent:function() {
    var a = this;
    var b = {store:a.getStore(),columns:a.getColumns(),listeners:{cellcontextmenu:function(f, h, d, g) {
        f.getSelectionModel().selectRow(h, false);
        var c = a.getContextMenu();
        c.showAt(g.xy);
        g.stopPropagation();
        g.stopEvent()
    },celldblclick:function(c, g, d, f) {
        c.getSelectionModel().selectRow(g, false);
        c.openPreviewDetails()
    }}};
    Ext.apply(this, Ext.apply(b, this.initialConfig));
    Explore.view.importdata.preview.ResultsGrid.superclass.initComponent.apply(this, arguments)
},getContextMenu:function() {
    if (!this._contextMenu) {
        var a = this;
        this._contextMenu = new Ext.menu.Menu({autoShow:true,items:[
            {text:Explore.i18n("Open"),iconCls:"buttonOpen",itemId:"openBtn",handler:function() {
                a.openPreviewDetails()
            }}
        ]})
    }
    return this._contextMenu
},openPreviewDetails:function() {
    var j = this;
    var e = j.getSelectionModel();
    var d = e.getSelected();
    var g = j.getStore();
    var h = g.getTotalCount();
    var a = j.getStore().getRange(0);
    var c = 0;
    for (var b = 0; b < h; b++) {
        if (e.isSelected(b)) {
            c = b;
            break
        }
    }
    var f = new Explore.view.importdata.preview.DisplayWindow({results:a,startIndex:c,totalRecords:h,type:j.type});
    f.show()
},getColumns:function() {
    if (!this._columns) {
        var a = this;

        function b(k, d, f, h, m, l) {
            var j = f.data.SourcDateTime;
            var o;
            var g = j.lastIndexOf("+");
            if (g == -1) {
                var e = new Date(j);
                if (e) {
                    o = Explore.formatDateByPref(e, {ignoreTime:true});
                    o += " " + Explore.formatTimeByPref(e);
                    return o
                }
            } else {
                var n = j.substring(0, g) + "Z";
                o = Explore.formatDateByPref(n, {ignoreTime:true});
                o += " " + Explore.formatTimeByPref(n);
                return o
            }
        }

        function c(k, e, d, l, h, f) {
            var j = d.data.type.toLowerCase();
            var g = "";
            if (d.data.hidden === true) {
                g += '<img src="../resources/images/icons/showhide.gif" alt="Hidden" />'
            }
            g += '<img src="' + Explore.SearchResults.getIcnSmallByType(a.type) + '" alt="' + j + '" />';
            return g
        }

        this._columns = [
            {id:"type",header:"type",width:60,align:"center",renderer:c,dataIndex:"type"},
            {id:"title",header:"title",sortable:true,dataIndex:"SourceTitle"},
            {id:"date",header:"date",align:"center",renderer:b,width:160,dataIndex:"SourcDateTime"}
        ]
    }
    return this._columns
},getStore:function() {
    if (!this._store) {
        this._store = new Ext.data.JsonStore({totalProperty:"totalCount",fields:[
            {name:"SourceTitle"},
            {name:"type"},
            {name:"SourcDateTime"},
            {name:"Content"},
            {name:"Id"},
            {name:"Author"},
            {name:"SourceURL"},
            {name:"ImageURL"}
        ]})
    }
    return this._store
}});
Ext.ns("Explore.view.importdata.preview");
Explore.view.importdata.preview.ResultsWindow = Ext.extend(Ext.Window, {height:400,width:600,title:"",constrain:true,maximizable:true,modal:true,type:"",initComponent:function() {
    var a = this;
    var b = {layout:"fit",items:[a.getPreviewGrid()],fbar:[
        {itemId:"closeButton",text:Explore.i18n("Close"),handler:function() {
            a.close()
        }}
    ]};
    Ext.apply(this, Ext.apply(b, this.initialConfig));
    Explore.view.importdata.preview.ResultsWindow.superclass.initComponent.apply(this, arguments);
    a.setTitle(String.format("{0} Preview", a.type.toUpperCase()))
},getPreviewGrid:function() {
    if (!this._previewGrid) {
        this._previewGrid = new Explore.view.importdata.preview.ResultsGrid({type:this.type})
    }
    return this._previewGrid
}});
Ext.ns("Explore.view.influencer");
Explore.view.influencer.BarViewGridPanel = Ext.extend(Ext.TabPanel, {docTypes:[],savedSearch:null,initComponent:function() {
    var b = this;
    var a = {activeTab:0,border:false,bodyBorder:false,defaults:{closable:false,autoScroll:false},enableTabScroll:true,items:b.getTabs()};
    Ext.apply(this, a);
    Explore.view.influencer.BarViewGridPanel.superclass.initComponent.apply(this, arguments);
    b.on("show", function() {
        b.loadDocsBasedOnSavedSearch()
    });
    b.on("tabchange", function(h, f) {
        if (f && f.xtype === "grid") {
            var c = b.getMask(),e = b.getViewDataValue(),g = b.savedSearch.Id,j = f.type,d = f.getStore();
            if (e && g && j) {
                c.show();
                InfluenceService.GetInfluenceResultsByDocType(g, j, e, function(k) {
                    c.hide();
                    if (k && k.Result && k.Result.Data) {
                        d.loadData(k.Result.Data);
                        d.sort("InfluenceValue", "DESC")
                    } else {
                        d.loadData([])
                    }
                })
            } else {
                if (b.savedSearch && j) {
                    if (e) {
                        e = 10
                    }
                    c.show();
                    InfluenceService.GetInfluenceResultsByDocTypeWithSearchCriteria(b.savedSearch, j, e, function(k) {
                        c.hide();
                        if (k && k.Result && k.Result.Data) {
                            d.loadData(k.Result.Data);
                            d.sort("InfluenceValue", "DESC")
                        } else {
                            d.loadData([])
                        }
                    })
                }
            }
        }
    })
},getTabs:function() {
    var d = [],b = this,a = this.docTypes,g = function(k) {
        var j = '<p><img alt="micro media" src="../resources/images/icons/icn_multichannel_{1}_16.png" style="float:left;padding: 0px 3px 3px 3px;">{0}</p>';
        return String.format(j, k, k.toLowerCase())
    };
    for (var c = 0; c < a.length; c++) {
        var h = a[c];
        var e = {xtype:"grid",title:g(h),type:h,autoExpandColumn:"InfluenceValue",autoExpandMax:1500,listeners:{rowdblclick:function(m, q, o) {
            var l = b.savedSearch,p = m.type,k = m.getSelectionModel(),n = k.getSelected(),j = n.get("Id");
            b.fireEvent("authordocrowclick", l, p, j)
        }},columns:[
            {header:"Author",dataIndex:"Author",sortable:true,align:"left",width:250,type:"string"},
            {header:"Username",dataIndex:"Username",sortable:true,align:"left",width:250,type:"string"},
            new Explore.view.common.BarColumn({id:"InfluenceValue",header:"Influence Value",align:"center",width:300,sortable:true,dataIndex:"InfluenceValue"})
        ],store:new Ext.data.ArrayStore({fields:[
            {name:"InfluenceValue"},
            {name:"Author"},
            {name:"Username"},
            {name:"Id",type:"int"},
        ],data:[]})};
        d.push(e)
    }
    if (d.length === 0) {
        var f = {xtype:"panel",title:"",html:'<div class="no-report">No Data Found</div>'};
        d.push(f)
    }
    return d
},loadDocsBasedOnSavedSearch:function() {
    var b = this;
    b.removeAll();
    var a = b.getMask();
    if (b.savedSearch) {
        var c = b.savedSearch.Id;
        a.show();
        if (c) {
            InfluenceService.GetDocumentTypesWithCriteria(b.savedSearch.Id, function(d) {
                a.hide();
                b.savedSearch.loaded = true;
                b.docTypes = d || [];
                b.add(b.getTabs());
                b.getLayout().setActiveItem(0)
            })
        } else {
            InfluenceService.GetDocumentTypesWithSearchCriteria(b.savedSearch, function(d) {
                a.hide();
                b.savedSearch.loaded = true;
                b.docTypes = d || [];
                b.add(b.getTabs());
                b.getLayout().setActiveItem(0)
            })
        }
    }
},displaySavedSearch:function(b) {
    var a = this;
    a.savedSearch = b;
    if (a.isVisible()) {
        a.loadDocsBasedOnSavedSearch()
    }
}});
Ext.reg("explore.view.influencer.barviewgridpanel", Explore.view.influencer.BarViewGridPanel);
Ext.ns("Explore.view.influencer");
Explore.view.influencer.GridViewPanel = Ext.extend(Ext.TabPanel, {docTypes:[],savedSearch:null,initComponent:function() {
    var b = this;
    this.docTypes = [];
    var a = {activeTab:0,border:false,bodyBorder:false,defaults:{closable:false,autoScroll:false},enableTabScroll:true,items:b.getTabs()};
    Ext.apply(this, a);
    Explore.view.influencer.GridViewPanel.superclass.initComponent.apply(this, arguments);
    b.on("show", function() {
        b.loadDocsBasedOnSavedSearch()
    });
    b.on("tabchange", function(g, e) {
        if (e && e.createGrid) {
            var c = b.getMask(),d = b.getViewDataValue(),f = b.savedSearch.Id,h = e.type;
            if (d && f && h) {
                c.show();
                InfluenceService.GetInfluenceResultsByDocType(f, h, d, function(j) {
                    c.hide();
                    if (j && j.Result) {
                        e.createGrid(j.Result)
                    }
                })
            } else {
                if (b.savedSearch && h) {
                    if (d) {
                        d = 10
                    }
                    c.show();
                    InfluenceService.GetInfluenceResultsByDocTypeWithSearchCriteria(b.savedSearch, h, d, function(j) {
                        c.hide();
                        if (j && j.Result) {
                            e.createGrid(j.Result)
                        }
                    })
                }
            }
        }
    })
},getMask:function(b) {
    var a = new Ext.LoadMask(this.getEl() || Ext.getBody(), {msg:b || Explore.i18n("Loading...")});
    return a
},getDocTypes:function() {
    var b = Explore.data.IDOLDataStore.getDocumentTypeConfigs();
    var a = [];
    for (key in b) {
        a.push(key)
    }
    return a
},getTabs:function() {
    var d = [],b = this,a = this.docTypes,g = function(k) {
        var j = '<p><img alt="micro media" src="../resources/images/icons/icn_multichannel_{1}_16.png" style="float:left;padding: 0px 3px 3px 3px;">{0}</p>';
        return String.format(j, k, k.toLowerCase())
    };
    for (var c = 0; c < a.length; c++) {
        var h = a[c];
        var e = {xtype:"Explore.view.common.DynamicGridPanel",title:g(h),type:h,gridConfig:{type:h,listeners:{rowdblclick:function(m, q, o) {
            var l = b.savedSearch,p = m.type,k = m.getSelectionModel(),n = k.getSelected(),j = n.get("Id");
            b.fireEvent("authordocrowclick", l, p, j)
        }}}};
        d.push(e)
    }
    if (d.length === 0) {
        var f = {xtype:"panel",title:"",html:'<div class="no-report">No Data Found</div>'};
        d.push(f)
    }
    return d
},loadDocsBasedOnSavedSearch:function() {
    var b = this;
    b.removeAll();
    var a = b.getMask();
    if (b.savedSearch) {
        var c = b.savedSearch.Id;
        a.show();
        if (c) {
            InfluenceService.GetDocumentTypesWithCriteria(b.savedSearch.Id, function(d) {
                a.hide();
                b.savedSearch.loaded = true;
                b.docTypes = d || [];
                b.add(b.getTabs());
                b.getLayout().setActiveItem(0)
            })
        } else {
            InfluenceService.GetDocumentTypesWithSearchCriteria(b.savedSearch, function(d) {
                a.hide();
                b.savedSearch.loaded = true;
                b.docTypes = d || [];
                b.add(b.getTabs());
                b.getLayout().setActiveItem(0)
            })
        }
    }
},displaySavedSearch:function(b) {
    var a = this;
    a.savedSearch = b;
    if (a.isVisible()) {
        a.loadDocsBasedOnSavedSearch()
    }
}});
Ext.reg("explore.view.influencer.gridviewpanel", Explore.view.influencer.GridViewPanel);
Ext.ns("Explore.view.influencer");
Explore.view.influencer.InfluencerDetailPanel = Ext.extend(Explore.base.AdministrationDetailPanelBase, {autoScroll:true,labelWidth:200,initComponent:function() {
    var b = this;
    var a = {formItems:[
        {xtype:"panel",itemId:"rootSelectedPanel",html:'<div class="no-report">Please Select a Social Media Type</div>'},
        {xtype:"explore.view.influencer.socialmediainfluencersettingspanel",fieldLabel:"",name:"DocTypeConfiguration",listeners:{clientvalidation:function(e, c) {
            if (c) {
                var d = b.topToolbar.getByItemId("saveButton");
                d.setDisabled(!e.isDirty())
            }
        }}}
    ]};
    Ext.apply(this, a);
    Explore.view.influencer.InfluencerDetailPanel.superclass.initComponent.apply(this, arguments)
},getTitleText:function() {
    return Explore.i18n("Social Media Types Details:")
},displayObject:function(d) {
    Explore.view.influencer.InfluencerDetailPanel.superclass.displayObject.call(this, d);
    var b = this.currentObject.type === -1,c = this.getByItemId("DocTypeConfiguration"),a = this.getByItemId("rootSelectedPanel");
    c.setVisible(!b);
    a.setVisible(b)
},saveDocTypeDetails:function() {
    var b = this,c = b.getByItemId("DocTypeConfiguration"),d = c.getInfluenceCriteria(),e = b.currentObject.DocTypeConfiguration,a = b.getMask(Explore.i18n("Saving Social Media Types Information"));
    a.show();
    e.InfluenceCriteriaItems = d;
    Explore.data.InfluencerDataStore.saveDocConfiguration(e, function(f) {
        a.hide()
    })
},getButtonsConfig:function() {
    var a = this;
    var b = [
        {xtype:"button",itemId:"saveButton",iconCls:"buttonSearchSave",text:Explore.i18n("Save"),tooltip:Explore.i18n("Save Influencer"),disabled:true,hidden:!a.permissions["delete"],scope:a,handler:a.saveDocTypeDetails}
    ];
    return b
},updateButtonState:function() {
    var a = this.currentObject.type === -1;
    if (this.topToolbar.getByItemId) {
        var b = this.topToolbar.getByItemId("saveButton");
        b.setVisible(!a);
        b.setDisabled(a)
    }
}});
Ext.reg("explore.view.influencer.influencerdetailpanel", Explore.view.influencer.InfluencerDetailPanel);
Ext.ns("Explore.view.influencer");
Explore.view.influencer.InfluencerGrid = Ext.extend(Ext.grid.GridPanel, {initComponent:function() {
    var b = this;
    var a = {store:new Ext.data.JsonStore({fields:[]}),columns:[],viewConfig:{forceFit:true},loadMask:true};
    Ext.apply(this, a);
    Explore.view.influencer.InfluencerGrid.superclass.initComponent.apply(this, arguments)
}});
Ext.reg("explore.view.influencer.influencergrid", Explore.view.influencer.InfluencerGrid);
Ext.ns("Explore.view.influencer");
Explore.view.influencer.InfluencerTree = Ext.extend(Explore.base.AdministrationTreePanel, {rootVisible:true,checkable:false,initComponent:function() {
    var b = this;
    b.loadFn = function(k, j) {
        var g = b.getSelectionModel(),h = g.getSelectedNode(),f = h.attributes,e = f.tag;
        if (j) {
            j(e)
        }
    };
    var d = this.checkable ? false : undefined;
    var a = new Ext.tree.TreeNode({text:Explore.i18n("Social Media Types"),id:0,singleClickExpand:true,uiProvider:Ext.tree.TriStateNodeUI,checked:d,expanded:true,tag:{type:-1,id:0,isCustom:false}});
    var c = {itemDescription:Explore.i18n("Project"),loader:new Ext.tree.TreeLoader({preloadChildren:true,clearOnLoad:true,directFn:InfluenceService.GetDocTypesWithInfluenceCriteria,baseAttrs:{uiProvider:Ext.tree.TriStateNodeUI,checked:d,singleClickExpand:true,expanded:this.checkable}}),root:a};
    Ext.apply(this, Ext.apply(this.initialConfig, c));
    Explore.view.influencer.InfluencerTree.superclass.initComponent.apply(this, arguments);
    Explore.data.InfluencerDataStore.on("docConfigurationTypeChanged", function() {
        var e = b.getSelectionModel(),f = e.getSelectedNode();
        b.refreshAndSelectNode(null, (f && f.attributes) ? f.attributes.id : "0")
    });
    b.refresh()
},onContextMenu:function() {
    return
}});
Ext.reg("explore.view.influencer.influencetree", Explore.view.influencer.InfluencerTree);
Ext.ns("Explore.view.influencer");
Explore.view.influencer.SocialMediaInfluencerSettingsPanel = Ext.extend(Ext.form.FormPanel, {border:false,frame:false,DocTypeConfiguration:null,cls:"project-detail",labelWidth:250,monitorValid:true,monitorPoll:1000,initComponent:function() {
    var b = this;
    var a = {title:Explore.i18n("Set Weightings (1-100)")};
    Ext.apply(this, a);
    Explore.view.influencer.SocialMediaInfluencerSettingsPanel.superclass.initComponent.apply(this, arguments)
},createSliders:function() {
    var e = this.getDocSettings();
    if (e) {
        var f = e.InfluenceCriteriaItems;
        if (f) {
            var a = [];
            for (var b = 0; b < f.length;
                 b++) {
                var d = f[b];
                var c = new Explore.view.common.FillSlider({value:d.CriteriaValue,increment:1,minValue:0,maxValue:100,itemId:d.Name,influenceCriteria:d,fieldLabel:d.Name,isDirty:function() {
                    return this.getValue() !== this.influenceCriteria.CriteriaValue
                }});
                a.push(c)
            }
            this.add(a);
            this.doLayout()
        }
    }
},getValue:function() {
    var a = this.getInfluenceCriteria();
    return a
},getInfluenceCriteria:function() {
    var f = this.getDocSettings(),a = [];
    if (f) {
        var g = f.InfluenceCriteriaItems;
        if (g) {
            var b = [];
            for (var c = 0; c < g.length; c++) {
                var e = g[c],d = this.getByItemId(e.Name);
                obj = {};
                Ext.apply(obj, d.influenceCriteria);
                obj.CriteriaValue = d.getValue();
                a.push(obj)
            }
        }
    }
    return a
},setValue:function(a) {
    this.DocTypeConfiguration = a;
    this.removeAll();
    this.createSliders()
},getDocSettings:function() {
    return this.DocTypeConfiguration
},isValid:function() {
    return !!this.getDocSettings()
},isDirty:function() {
    var c = false;
    var e = (this.getDocSettings() || {}).InfluenceCriteriaItems || [];
    for (var a = 0; a < e.length; a++) {
        var d = e[a];
        var b = this.getByItemId(d.Name);
        c |= b.isDirty()
    }
    return c
}});
Ext.reg("explore.view.influencer.socialmediainfluencersettingspanel", Explore.view.influencer.SocialMediaInfluencerSettingsPanel);
Ext.ns("Explore.view.influencer");
Explore.view.influencer.ViewTabPanel = Ext.extend(Ext.Panel, {bodyBorder:false,frame:false,border:false,layout:"card",initComponent:function() {
    var b = this;
    var a = {tbar:b.getTbar(),activeItem:0,items:[
        {xtype:"explore.view.influencer.barviewgridpanel",listeners:{authordocrowclick:function(c, e, d) {
            b.performSavedSearchWithAddedFilters(c, e, d)
        }},getViewDataValue:function() {
            var d = b.getTopToolbar(),c = d.getByItemId("view-top-combo");
            return c.getValue()
        },getMask:function(c) {
            return b.getMask(c)
        },itemId:"bar-view"},
        {xtype:"explore.view.influencer.gridviewpanel",listeners:{authordocrowclick:function(c, e, d) {
            b.performSavedSearchWithAddedFilters(c, e, d)
        }},getViewDataValue:function() {
            var d = b.getTopToolbar(),c = d.getByItemId("view-top-combo");
            return c.getValue()
        },getMask:function(c) {
            return b.getMask(c)
        },itemId:"grid-view"}
    ]};
    Ext.apply(this, a);
    Explore.view.influencer.ViewTabPanel.superclass.initComponent.apply(this, arguments)
},performSavedSearchWithAddedFilters:function(a, f, e) {
    var c = Explore.showSearchPanel(),d = a.criteria || {Combine:Explore.model.ASCombineType.And,Criteria:[]},b = new Explore.data.model.SearchCriteria({criteria:d,searchTerms:a.searchTerms,documentTypes:f});
    d.Criteria.push({Combine:0,FilterTag:"FROM_USER_ID",Comparator:"EQUAL",Values:[e]});
    b.documentTypes = "Micro Media";
    b.searchTermsUI = "SAVEDSEARCH::(" + a.Name + ")";
    c.searchByCriteria(b, {replaceCurrentFilters:true})
},getMask:function(b) {
    var a = new Ext.LoadMask(this.getEl() || Ext.getBody(), {msg:b || Explore.i18n("Loading...")});
    return a
},getTbar:function() {
    if (!this._myTbar) {
        var d = this,c = function(g, h) {
            if (!h) {
                g.getEl().addClass("underline-text")
            } else {
                g.getEl().removeClass("underline-text")
            }
        },b = new Ext.Button({text:"Bar View",itemId:"bar-btn",handler:function() {
            d.getLayout().setActiveItem(0);
            c(this, true);
            c(d.getTopToolbar().getByItemId("view-btn"), false)
        }}),f = new Ext.Button({text:"Grid View",itemId:"view-btn",cls:"underline-text",handler:function() {
            d.getLayout().setActiveItem(1);
            c(this, true);
            c(d.getTopToolbar().getByItemId("bar-btn"), false)
        }}),e = {xtype:"displayfield",value:"View Data for:",padding:5},a = {xtype:"selectboxfield",itemId:"view-top-combo",width:200,value:10,options:[
            [10,Explore.i18n("Top 10")],
            [50,Explore.i18n("Top 50")],
            [100,Explore.i18n("Top 100")]
        ]};
        this._myTbar = new Ext.Toolbar({items:[b,f,"->",e,"",a]})
    }
    return this._myTbar
},displaySavedSearch:function(c) {
    var b = this,a = b.getByItemId("bar-view"),d = b.getByItemId("grid-view");
    a.displaySavedSearch(c);
    d.displaySavedSearch(c)
}});
Ext.reg("explore.view.influencer.viewtabpanel", Explore.view.influencer.ViewTabPanel);
Ext.ns("ExploreAutomation.util");
ExploreAutomation.util.AJAXInterceptor = (function() {
    return{onBeforeRequest:function(d, b) {
        if (b.isMASRequest === true && b.url.indexOf("../Handlers/MasProxy.ashx/?") == -1) {
            var a = b.url;
            if (b.params && b.method == "GET") {
                var f = Ext.urlEncode(b.params);
                var c = Ext.urlEncode({url:b.url});
                var e = undefined;
                if (b.url.indexOf("http://") == -1 && b.url.indexOf("https://") == -1) {
                    e = a + "?" + f;
                    b.url = "../Handlers/MasProxy.ashx/?" + e
                } else {
                    e = c + encodeURIComponent("&" + f);
                    b.url = "../Handlers/MasProxy.ashx/?cache?" + e
                }
            } else {
                if (!b.params && b.method == "GET") {
                    if (b.url.indexOf("http://") == -1 && b.url.indexOf("https://") == -1) {
                        b.url = "../Handlers/MasProxy.ashx/?" + a
                    } else {
                        b.url = "../Handlers/MasProxy.ashx/?cache?url=" + a
                    }
                }
            }
        } else {
            return
        }
    },restoreParams:function(c, a, b) {
        if (b.originalParams) {
            b.params = b.originalParams;
            delete b.originalParams
        }
    }}
})();
Ext.Ajax.on("beforerequest", ExploreAutomation.util.AJAXInterceptor.onBeforeRequest);
Ext.Ajax.on("requestcomplete", ExploreAutomation.util.AJAXInterceptor.restoreParams);
Ext.Ajax.on("requestexception", ExploreAutomation.util.AJAXInterceptor.restoreParams);
Ext.ns("ExploreAutomation");
ExploreAutomation.App = function(a) {
    a = a || {};
    Ext.apply(this, a);
    this.addEvents("ready");
    if (a.listeners) {
        this.on(a.listeners)
    }
};
ExploreAutomation.App = Ext.extend(ExploreAutomation.App, Ext.util.Observable, {wizard:null,silenceErrors:false,loadNumDays:true,databaseReader:new Ext.data.XmlReader({totalProperty:"databases > num_databases",idProperty:"name",record:"database",fields:[
    {name:"name",mapping:"name"},
    {name:"documents",mapping:"documents",convert:function(b, a) {
        return parseInt(b)
    }},
    {name:"internal",mapping:"internal",convert:function(b, a) {
        return b === "true"
    }}
]}),init:function() {
    this.getUserSettings();
    this.loadProperties()
},loadProperties:function() {
    Ext.Ajax.request({url:"system/settings.json",success:this.parseProperties,failure:function(a, b) {
        Ext.Msg.show({title:"ERROR",msg:Explore.i18n("MAS_Unreachable"),width:370,buttons:Ext.MessageBox.OK,icon:Ext.MessageBox.ERROR});
        ExploreAutomation.loadMask.hide()
    },scope:this,method:"GET",isMASRequest:true,disableCaching:false})
},parseProperties:function(a, b) {
    var c = Ext.decode(a.responseText);
    if (!app.silenceErrors && !c.success) {
        Ext.Msg.alert("Error", "Could not load settings.");
        return
    }
    this.properties = c.data;
    this.properties["idol.aci.url"] = this.properties["idol.aci.protocol"] + "://" + this.properties["idol.aci.host"] + ":" + this.properties["idol.aci.port"];
    this.properties["idol.dah.aci.url"] = this.properties["idol.dah.protocol"] + "://" + this.properties["idol.dah.aci.host"] + ":" + this.properties["idol.dah.aci.port"];
    this.properties["idol.dih.aci.url"] = this.properties["idol.dih.protocol"] + "://" + this.properties["idol.dih.aci.host"] + ":" + this.properties["idol.dih.aci.port"];
    this.properties["idol.dih.indexer.url"] = this.properties["idol.dih.protocol"] + "://" + this.properties["idol.dih.indexer.host"] + ":" + this.properties["idol.dih.indexer.port"];
    if (this.properties["idol.dah.aci.host"] && this.properties["idol.dah.aci.port"]) {
        this.properties["idol.aci.url"] = this.properties["idol.dah.aci.url"]
    }
    this.properties["idol.dish.url"] = this.properties["idol.dish.protocol"] + "://" + this.properties["idol.dish.host"] + ":" + this.properties["idol.dish.port"];
    this.loadResourceBundles()
},loadResourceBundles:function() {
    ExploreAutomation.util.Resources.load("system/resources.json", this.loadDatabases.createDelegate(this))
},loadDatabases:function() {
    Ext.Ajax.request({url:this.getProperty("idol.aci.url") + "/?a=getstatus",success:this.parseDatabases,failure:function(a, b) {
        this.handleError(a, b, "Could not load databases.");
        this.fireEvent("ready", this)
    },scope:this,method:"GET",isMASRequest:true,disableCaching:false})
},parseDatabases:function(a, b) {
    var f = this.databaseReader.readRecords(a.responseXML);
    var e = "";
    if (f.totalRecords > 0) {
        this.databases = [];
        for (var c = 0; c < f.totalRecords; c++) {
            var d = f.records[c];
            if (!d.data.internal && d.data.name != "") {
                if (d.data.name == "SentimentAgents" || d.data.name == "ErrorDocs") {
                    continue
                }
                this.databases.push(d.data)
            }
        }
    }
    log.info(Ext.encode(this.databases));
    if (this.loadNumDays) {
        this.getDayCount()
    } else {
        this.fireEvent("ready", this)
    }
},getDayCount:function() {
    if (this.getProperty("skip.idol.numdays") == "true") {
        this.fireEvent("ready", this);
        return
    }
    Ext.Ajax.request({url:this.getProperty("idol.aci.url") + "/?a=GetQueryTagValues",params:{Text:"*",FieldName:"autn_date",DatePeriod:"day",Template:"NoNamespace"},success:this.countDays,failure:function(a, b) {
        log.error("Couldn't get number of days in IDOL, using estimate.")
    },callback:function() {
        this.fireEvent("ready", this)
    },scope:this,method:"GET",isMASRequest:true,disableCaching:false})
},countDays:function(a, b) {
    var c = a.responseXML;
    var d = Ext.DomQuery.selectValue("autnresponse > responsedata > field > total_values", c);
    log.info("default number of days: " + app.getProperty("estimation.numdays"));
    log.info("Retrieved number of days of data in IDOL: " + d);
    app.setProperty("estimation.numdays", d)
},handleError:function(a, b, c) {
    if (!app.silenceErrors) {
        Ext.Msg.alert("Error", c || "Could not load settings.")
    }
},getProperty:function(a) {
    if (this.properties) {
        return this.properties[a]
    } else {
        return null
    }
},setProperty:function(a, b) {
    if (!this.properties) {
        this.properties = {}
    }
    this.properties[a] = b
},getDatabases:function() {
    return this.databases
},showWizard:function() {
    if (this.wizard) {
        this.wizard.show()
    } else {
        this.wizard = new ExploreAutomation.wizard.JumpstartWizard({listeners:{settingschange:this.transferWizardToSearchFormPanel},sourceName:app.getUserSettings().source ? app.getUserSettings().source.name : "",projectName:app.getUserSettings().project ? app.getUserSettings().project.name : ""});
        this.wizard.show()
    }
},icons:{"FORUM POSTS":"../Resources/images/MAS_icons/icon_forum posts_16.png",FORUMPOSTS:"../Resources/images/MAS_icons/icon_forum posts_16.png",BLOG:"../Resources/images/MAS_icons/icon_blog_16.png",BLOGS:"../Resources/images/MAS_icons/icon_blog_16.png","MICRO MEDIA":"../Resources/images/MAS_icons/icon_micro media_16.png",MICROMEDIA:"../Resources/images/MAS_icons/icon_micro media_16.png",TWITTER:"../Resources/images/MAS_icons/icon_twitter_16.png",FACEBOOK:"../Resources/images/MAS_icons/icon_facebook_16.png",LINKEDIN:"../Resources/images/MAS_icons/icon_linkedin_16.png",NEWSPAPER:"../Resources/images/MAS_icons/icon_news media_16.png",NEWSPAPERS:"../Resources/images/MAS_icons/icon_news media_16.png",PODCAST:"../Resources/images/MAS_icons/icon_podcast_16.gif",PODCASTS:"../Resources/images/MAS_icons/icon_podcast_16.gif",VIDEO:"../Resources/images/MAS_icons/icon_video_16.gif",VIDEOS:"../Resources/images/MAS_icons/icon_video_16.gif",WEBSITE:"../Resources/images/MAS_icons/icon_website_16.gif",WEBSITES:"../Resources/images/MAS_icons/icon_website_16.gif",MAGAZINE:"../Resources/images/MAS_icons/icon_magazine_16.gif",MAGAZINES:"../Resources/images/MAS_icons/icon_magazine_16.gif",TV:"../Resources/images/MAS_icons/icon_tv_16.gif",RADIO:"../Resources/images/MAS_icons/icon_radio_16.gif"},transferWizardToSearchFormPanel:function(d) {
    var a = appViewport;
    var c = a.getByItemId("searchFormPanel");
    var b = c.getForm();
    c.reset();
    c.setValues(d);
    c.doSearch.defer(10, c)
},getUserSettings:function() {
    return this.userSettings
},setUserSettings:function(a) {
    if (!a) {
        this.userSettings = {}
    } else {
        this.userSettings = a
    }
    return this.userSettings
},publicDatabases:["MicroMedia","Magazines","Videos","Newspapers","Websites","ForumPosts","Blogs","Podcasts","Radio","TV"],setParams:function(a) {
    this.params = a
},getParams:function() {
    return this.params
},contextVariableRenderer:function(a, m, c, g, l, j, d, h, o) {
    var n = c.data.contextVariables;
    h = Ext.value(h, "/");
    if (Ext.isArray(d)) {
        var e = false;
        var f = [];
        for (var b = 0; b < d.length; b++) {
            var k = n[d[b]] ? n[d[b]] : "";
            e = e || k;
            f.push(k)
        }
        a = e ? f.join(h) : ""
    } else {
        a = n[d] ? n[d] : ""
    }
    var o = o ? o : this.qtipRenderer;
    return a ? o.apply(this, [a,m,c,g,l,j]) : ""
},qtipTplWithoutDescription:new Ext.XTemplate("<h2>{val}</h2>"),qtipRenderer:function(d, a, b) {
    d = Ext.util.Format.defaultValue(d, "");
    var c = this.qtipTplWithoutDescription.apply({val:d});
    return'<div qtip="' + c + '">' + d + "</div>"
},recurringRenderer:function(d, a, b) {
    var e = b.data.contextVariables.recurring === "true";
    d = Ext.util.Format.defaultValue(d, "");
    var c = this.qtipTplWithoutDescription.apply({val:e ? "Recurring: " + d : "Scheduled Once: " + d});
    return'<div qtip="' + c + '" class="' + (e ? "recurring" : "nonrecurring") + '">' + d + "</div>"
},latestResultRenderer:function(e, a, b) {
    var d = b.data.contextVariables.success ? b.data.contextVariables.success === "true" : true;
    e = d ? "Success" : "Error";
    if (!d) {
        e += ": " + Ext.value(b.data.contextVariables["etl.exception.process.id"], "") + ": " + Ext.value(b.data.contextVariables["etl.exception.message"], "")
    }
    e = Ext.util.Format.defaultValue(e, "");
    e = Ext.util.Format.htmlEncode(e);
    var c = this.qtipTplWithoutDescription.apply({val:e});
    return'<div qtip="' + c + '" class="' + (d ? "COMPLETED" : "ERRORED") + '">' + e + "</div>"
}});
function setCookie(c, e, a, h, d, g) {
    var b = new Date();
    b.setTime(b.getTime());
    if (a) {
        a = a * 1000 * 60 * 60 * 24
    }
    var f = new Date(b.getTime() + (a));
    document.cookie = c + "=" + escape(e) + ((a) ? ";expires=" + f.toGMTString() : "") + ((h) ? ";path=" + h : "") + ((d) ? ";domain=" + d : "") + ((g) ? ";secure" : "")
}
function getCookie(a) {
    var f = document.cookie.split(";");
    var b = "";
    var d = "";
    var e = "";
    var c = false;
    for (i = 0; i < f.length; i++) {
        b = f[i].split("=");
        d = b[0].replace(/^\s+|\s+$/g, "");
        if (d == a) {
            c = true;
            if (b.length > 1) {
                e = unescape(b[1].replace(/^\s+|\s+$/g, ""))
            }
            return e;
            break
        }
        b = null;
        d = ""
    }
    if (!c) {
        return null
    }
}
(function() {
    Ext.evalObject = function(j, g) {
        if (!(Ext.isString(j))) {
            return j
        }
        var h = j.split(".");
        var j = g || window;
        for (var f = 0,e = h.length; f < e; ++f) {
            j = j[h[f]];
            if ((j === null) || (j === undefined)) {
                break
            }
        }
        return j
    };
    Ext.intercept(Ext.chart.Chart.prototype, "refresh", function() {
        return !!(this.swf && this.swf.setDataProvider)
    });
    Ext.override(Ext.form.CompositeField, {cascade:function(g, f, e) {
        return this.rendered && this.innerCt.cascade(g, f, e)
    }});
    var d = Ext.form.NumberField.prototype.getValue;
    Ext.override(Ext.form.NumberField, {getValue:function(e) {
        var f = d.apply(this, arguments);
        return(f === "") ? null : f
    }});
    Ext.applyIf(Ext.form.BasicForm.prototype, {getFields:function(e) {
        var f = Ext.type(e);
        if (!f || !((f === "regexp") || (f === "function"))) {
            throw new Error("A regexp or a function must be specified.")
        }
        if (f === "regexp") {
            var g = e;
            e = function(j) {
                var h = j.getName() || "";
                return h.match(g)
            }
        }
        return this.items.filterBy(e)
    }});
    function b(f, e) {
        e.eachKey(function(g, h) {
            if (h.isComposite) {
                b(f, h.items)
            } else {
                if (!h.disabled && (h.submitValue !== false) && !(((h.inputType === "radio") || (h.inputType === "checkbox")) && !(h.getValue()))) {
                    f.add(g, h)
                }
            }
        });
        return f
    }

    Ext.override(Ext.form.BasicForm, {getSubmittableFieldValues:function(e) {
        var f = b(new Ext.util.MixedCollection(), this.items);
        return this.getFieldValues.apply({items:f}, arguments)
    }});
    var c = {tag:"img",src:Ext.BLANK_IMAGE_URL,width:16,height:16,cls:"x-toolUR x-toolUR-about",style:"margin-bottom: 0; margin-left: 5px; padding: 0;"};
    var a = {title:"",autoWidth:true,dismissDelay:0};
    Ext.sequence(Ext.form.Field.prototype, "afterRender", function() {
        if (this.helpText) {
            var f = this.helpText;
            var g = c;
            if (this.label) {
                g = this.label.createChild(g)
            } else {
                g = null
            }
            if (g) {
                var e = Ext.apply({target:g,html:f}, a);
                new Ext.ToolTip(e)
            }
        }
    });
    if (Ext.isIE) {
        window.numFilesLoading = 0;
        window.onerror = function(j, h, f) {
            if (window.numFilesLoading <= 0) {
                log.debug("no files loading");
                return false
            }
            if (!(h.match(/\/workspaces\/deploy/))) {
                log.debug(h + " not a widget resource url");
                return false
            }
            var g = null;
            var e = Ext.select('script[src*="/workspaces/deploy/"]');
            e.each(function(l, m, k) {
                if (l.dom.src === h) {
                    g = Ext.get(l.dom);
                    return false
                } else {
                    log.debug("not this one: " + l.dom.src + " (" + l.dom.id + ")")
                }
            });
            if (g) {
                g.dom.error = {msg:j,line:f};
                return true
            } else {
                log.debug("no script element with url " + h)
            }
            return false
        }
    }
})();
Ext.ns("Autonomy");
Autonomy.IDOLPagingToolbar = Ext.extend(Ext.PagingToolbar, {cacheTotalResults:false,lazyLoadTotalResults:true,interimDisplayMsg:"Displaying {0} - {1} of Many",_cachedTotalResults:-1,beforeLoad:function(a, b) {
    if (b.params) {
        var e = b.params;
        var d = this.findKey(e, "start");
        if (d == null) {
            e.start = 0
        }
        var d = this.findKey(e, "start");
        if (this.lazyLoadTotalResults && (e[d] == 0 || e.isRefresh)) {
            this._cachedTotalResults = -1
        }
        if (e[d] != 0 && !e.isRefresh) {
            this.replaceOrUpdateProperty(e, "totalresults", true);
            this.replaceOrUpdateProperty(e, "_cachedTotalCount", a.getTotalCount())
        }
        if (this.lazyLoadTotalResults) {
            this.replaceOrUpdateProperty(e, "totalresults", false)
        }
        e[d] += 1;
        var c = this.findKey(e, "maxresults");
        c = c || "maxresults";
        e[c] = e[d] + parseInt(this.pageSize) - 1
    }
    Autonomy.IDOLPagingToolbar.superclass.beforeLoad.call(this, a, b)
},onLoad:function(b, a, c) {
    if (c.params) {
        var e = c.params;
        var d = this.findKey(e, "start");
        d = d || "start";
        e[d] -= 1;
        if (!this.lazyLoadTotalResults && e._cachedTotalCount) {
            b.totalLength = parseInt(e._cachedTotalCount)
        }
        if (this.lazyLoadTotalResults && this._cachedTotalResults) {
            b.totalLength = this._cachedTotalResults
        }
    }
    Autonomy.IDOLPagingToolbar.superclass.onLoad.call(this, b, a, c);
    if (c.params) {
        if (this.lazyLoadTotalResults && this._cachedTotalResults == -1 && (e[d] == 0 || e.isRefresh)) {
            this.retrieveTotalCount(c)
        }
    }
},doRefresh:function() {
    this.doLoad(this.cursor, true)
},doLoad:function(d, b) {
    var c = {},a = this.getParams();
    c[a.start] = d;
    c[a.limit] = this.pageSize;
    c.isRefresh = b === true;
    if (this.fireEvent("beforechange", this, c) !== false) {
        this.store.load({params:c})
    }
},updateInfo:function() {
    if (this.displayItem) {
        var a = this.store.getCount();
        var b = null;
        if (a == 0) {
            b = this.emptyMsg
        } else {
            if (this._cachedTotalResults >= 0) {
                b = String.format(this.displayMsg, this.cursor + 1, this.cursor + a, this.store.getTotalCount())
            } else {
                b = String.format(this.interimDisplayMsg, this.cursor + 1, this.cursor + a, this.store.getTotalCount())
            }
        }
        this.displayItem.setText(b)
    }
},retrieveTotalCount:function(c) {
    var b = this.store.proxy.url;
    var a = {};
    if (!c.params) {
        c.params = {}
    }
    var e = c.params;
    this.replaceOrUpdateProperty(e, "totalresults", true);
    this.replaceOrUpdateProperty(e, "print", "NoResults");
    this.replaceOrUpdateProperty(e, "maxresults", 0);
    var d = this.findKey(e, "start");
    d = d ? d : "start";
    c.params[d] += 1;
    Ext.Ajax.request({method:"GET",url:b,params:c.params,success:this.handleTotalCountSuccess,failure:this.handleTotalCountError,scope:this,timeout:parseInt(app.getProperty("ui.query.timeoutmillis")),isMASRequest:true,disableCaching:false})
},handleTotalCountSuccess:function(c, d) {
    var e = c.responseXML;
    var f = Ext.DomQuery.selectValue("autnresponse > response", e);
    if (f != "SUCCESS") {
        Ext.Msg.alert("Error", "The search query encountered an error.");
        return
    }
    var a = Ext.DomQuery.selectNumber("responsedata > totalhits", e);
    log.info("Number of Hits: " + a);
    this.store.totalLength = this._cachedTotalResults = a;
    var b = this.store.getRange(0, this.store.getCount());
    this.store.fireEvent("load", this.store, b, d)
},handleSearchError:function(a, b) {
    this.loadMask.hide();
    Ext.Msg.alert("Error", "Could not retrieve total count.")
},findKey:function(d, c) {
    var b = c.toLowerCase();
    for (var a in d) {
        if (a.toLowerCase() == b) {
            return a
        }
    }
    return null
},replaceOrUpdateProperty:function(d, a, c) {
    var b = this.findKey(d, a);
    if (b) {
        d[b] = c
    } else {
        d[a] = c
    }
}});
Ext.reg("idolpaging", Autonomy.IDOLPagingToolbar);
Ext.ns("ExploreAutomation");
Ext.MasMainWindow = Ext.extend(Ext.Window, {minHeight:600,minWidth:800,height:600,width:800,editObject:null,initComponent:function(b) {
    var a = this,c = a.editObject;
    var b = {autoShow:true,autoScroll:true,activeItem:0,title:c.Id ? String.format("Edit [{0}]", c.Name) : Explore.i18n("New Media Aggregation Service Source"),closable:true,constrain:true,itemId:"MasWizard",layout:"card",maximizable:true,modal:true,resizable:true,defaults:{editObject:c},listeners:{setjobname:this.setJobName},items:[
        {xtype:"mas.selection.panel",id:"card-0",itemId:"selectionPanel",listeners:{resize:function(d, e) {
            a.doLayout();
            this.doLayout()
        },towizard:function() {
            a.saveNameDescription(function() {
                a.fireEvent("setjobname", a.getJobName());
                a.layout.setActiveItem(1);
                a.doLayout()
            })
        },toquerybuilder:function() {
            a.saveNameDescription(function() {
                a.doLayout();
                a.layout.setActiveItem(2)
            })
        },closeall:function() {
            a.close()
        }}},
        {xtype:"mas.wizard.panel",id:"card-1",itemId:"wizardpanel",sourceName:app.userSettings.source.name,listeners:{toselectionform:function() {
            a.layout.setActiveItem(0)
        },closeall:function() {
            a.close()
        },settingschange:function(g) {
            var d = a.getByItemId("queryBuilder");
            var f = d.getByItemId("searchFormPanel");
            var e = f.getForm();
            f.reset();
            f.setValues(g);
            f.doSearch.defer(10, f);
            a.doLayout();
            a.layout.setActiveItem(2)
        }}},
        {xtype:"exploreautomation.searchpanel",id:"card-3",itemId:"queryBuilder",parent:a,listeners:{toselectionform:function() {
            a.layout.setActiveItem(0)
        },closeall:function() {
            a.close()
        }}}
    ]};
    Ext.apply(this, Ext.apply(b, this.initialConfig));
    Ext.MasMainWindow.superclass.initComponent.apply(this, arguments);
    a.on("afterrender", a.checkMASConfiguration, this, {single:true})
},checkMASConfiguration:function() {
    var c = this;
    var d = currentUser.Email;
    var a = currentUser.EnableNotifications;
    var b = new Ext.LoadMask(c.body, {msg:Explore.i18n("Sending notification")});
    b.show();
    ConfigurationService.GetConfigurationSettings(function(r, m) {
        b.hide();
        log.debug(r);
        var k = r.NotificationServerUrl;
        var q = r.MASImportAgentIP;
        var f = r.AutomationServerUrl;
        if (!(d && a && k && f && q)) {
            var l = "{0}{1}{2}{3}{4}";
            var o = d ? "" : Explore.i18n("No email address is set for the current user");
            var p = a ? "" : Explore.i18n("Notifications are not enabled for the current user");
            if (o !== "" && p !== "") {
                o += "<br>"
            }
            var n = k ? "" : Explore.i18n("Notification server url is not configured");
            if (n !== "" && (p !== "" || o !== "")) {
                n = "<br>" + n
            }
            var h = q ? "" : Explore.i18n("MAS Import Agent IP is not configured");
            if (h !== "" && (n !== "" || p !== "" || o !== "")) {
                n += "<br>"
            }
            var j = f ? "" : Explore.i18n("Media Aggregation Service URL is not configured");
            if (j !== "" && (h !== "" || n !== "" || p !== "" || o !== "")) {
                h += "<br>"
            }
            var g = String.format(l, o, p, n, h, j);
            Explore.view.StatusBox.showError(Explore.i18n("Notfication Failed"), g);
            c.close()
        }
    })
},setJobName:function(b) {
    var a = this.getByItemId("wizardpanel");
    a.fireEvent("setjobname", b)
},saveNameDescription:function(e) {
    var a = this.getJobName();
    var d = this.getJobDescription();
    var b = app.userSettings.source.groupId;
    app.userSettings.source.name = a;
    app.userSettings.source.description = d;
    if (app.userSettings.source.id) {
        app.userSettings.source.id = null
    }
    var c = new Ext.LoadMask(this.body, {msg:"Checking for unique name"});
    c.show();
    Explore.data.SourceDataStore.getDataSourcesByGroup(b, function(f) {
        var h = true;
        for (var g = 0; g < f.length; g++) {
            if (f[g].Name === a) {
                h = false
            }
        }
        c.hide();
        if (h) {
            e()
        } else {
            Ext.Msg.alert("Warning", "You must select a name that has not already been used")
        }
    })
},getJobName:function() {
    var a = this.getByItemId("selectionPanel");
    return a.getFormData().name
},getJobDescription:function() {
    var a = this.getByItemId("selectionPanel");
    return a.getFormData().description
},getFormData:function() {
    var a = this.getByItemId("selectionPanel");
    return a.getFormData()
},getLoadMask:function() {
    if (!this.loadMask) {
        var a = this;
        this.loadMask = new Ext.LoadMask(a.body, {msg:"Please wait...Saving Job"})
    }
    return this.loadMask
}});
Ext.reg("mas.main.window", Ext.MasMainWindow);
Ext.ns("ExploreAutomation.util");
ExploreAutomation.util.Resources = (function() {
    var a = "\0";
    var c = {};
    var e = {};

    function f(j, l) {
        l = l.split(".");
        var k = j;
        for (var h = 0; h < l.length; ++h) {
            k = k[l[h]];
            if (!k) {
                break
            }
        }
        return k
    }

    function d(l, h, k) {
        var j = l[h];
        ++h;
        while (c[j]) {
            log.debug("already loaded resources from " + j);
            if (k.success) {
                if (k.success.call(k.scope || window, j) === false) {
                    return
                }
            }
            if (h >= l.length) {
                if (k.complete) {
                    k.complete.call(k.scope || window)
                }
                return
            }
            j = l[h];
            ++h
        }
        var m = false;
        Ext.Ajax.request({method:"GET",url:j,isMASRequest:true,disableCaching:false,success:function(n) {
            c[j] = true;
            var o = Ext.decode(n.responseText).data;
            g(e, o);
            log.debug("loaded resources from " + j);
            if (k.success) {
                if (k.success.call(k.scope || window, j) === false) {
                    m = true
                }
            }
        },failure:function(n) {
            log.warn("unable to load resources from " + j);
            if (k.failure) {
                if (k.failure.call(k.scope || window, j) === false) {
                    m = true
                }
            }
        },callback:function(o, p, n) {
            if (m) {
                return
            }
            if (h < l.length) {
                d(l, h, k)
            } else {
                if (k.complete) {
                    k.complete.call(k.scope || window)
                }
            }
        }})
    }

    function b(j, l) {
        l = l.split(".");
        var k = j;
        for (var h = 0; h < l.length; ++h) {
            k = k[l[h]] = (k[l[h]] || {})
        }
        return k
    }

    function g(h, j) {
        Ext.iterate(j, function(k, l) {
            var m = b(h, k);
            if (Ext.isString(l)) {
                m[a] = l
            } else {
                g(m, l)
            }
        })
    }

    return{clear:function() {
        e = {};
        c = {}
    },get:function(h) {
        var j = f(e, h);
        return(j && j.hasOwnProperty(a) && j[a]) || h
    },load:function(j, h) {
        if (!(Ext.isArray(j))) {
            j = [j]
        }
        if (j.length === 0) {
            return
        }
        if (Ext.isFunction(h)) {
            h = {complete:h}
        }
        d(j, 0, h || {})
    }}
})();
Ext.ns("ExploreAutomation");
ExploreAutomation.CustomerGuidCheckBoxes = Ext.extend(Ext.form.FieldSet, {autoHeight:true,customerGuids:null,checkBoxes:{},initComponent:function() {
    var b = this;
    var a = {title:Explore.i18n("Profiles"),items:b.getCheckBoxGroup()};
    Ext.apply(this, a);
    ExploreAutomation.CustomerGuidCheckBoxes.superclass.initComponent.call(this, arguments)
},displayObject:function(c) {
    if (c) {
        var f = this.getCheckBoxGroup();
        this.customerGuids = c;
        for (var h in this.checkBoxes) {
            var b = this.checkBoxes[h];
            b.checked = false
        }
        for (var d = 0; d < c.length; d++) {
            var g = c[d],a = g.Id,j = g.FieldValue,e = this.checkBoxes[j];
            if (e) {
                e.checked = true;
                e.Id = a
            } else {
                log.warn("GUID is not in settings:" + a)
            }
        }
    }
},getCustomerGuids:function() {
    var b = app;
    if (b && b.customerProfilesGuid) {
        return b.customerProfilesGuid
    }
    return[]
},getCustomerProfiles:function() {
    var c = app || {},d = c.userSettings || {},b = d.MASCustomerProfiles || [];
    return b
},getCheckBoxGroup:function() {
    if (!this._checkBoxGroup) {
        var e = new Ext.form.Checkbox({xtype:"checkbox",boxLabel:"Select All",submitValue:false,checked:true,listeners:{check:function(m, l) {
            if (m.ignoreOneCheckEvent === true) {
                m.ignoreOneCheckEvent = false;
                return
            }
            var k = m.ownerCt.ownerCt.items.items;
            for (var h = 0; h < k.length; h++) {
                for (var g = 0; g < k[h].items.items.length; g++) {
                    k[h].items.items[g].setValue(l)
                }
            }
            m.ignoreOneCheckEvent = false
        }}});
        this.checkBoxes["Select All"] = e;
        var b = [e],a = this.getCustomerProfiles();
        for (var d = 0; d < a.length;
             d++) {
            var f = a[d],c = new Ext.form.Checkbox({boxLabel:f.Name,name:f.Guid,Id:0,itemId:f.Guid,checked:true});
            this.checkBoxes[f.Guid] = c;
            b.push(c)
        }
        this._checkBoxGroup = new Ext.form.CheckboxGroup({name:"customerguids",itemId:"customerguids",hideLabel:true,columns:2,items:b})
    }
    return this._checkBoxGroup
}});
Ext.reg("exploreautomation.customerguidcheckbox", ExploreAutomation.CustomerGuidCheckBoxes);
Ext.ns("ExploreAutomation");
ExploreAutomation.IDOLSuggestWindow = Ext.extend(Ext.Window, {cls:"idol-suggest",title:"IDOL Suggest",width:650,height:500,modal:true,animCollapse:false,autoShow:true,renderTo:Ext.getBody(),idolACIUrl:"",suggestText:"",initComponent:function() {
    var a = {layout:"fit",closeAction:"close",items:[
        {xtype:"panel",itemId:"results",layout:"column",autoScroll:true,padding:5,itemId:"results",defaults:{columnWidth:0.5,listeners:{scope:this,check:function(d, b) {
            var c = this.getFooterToolbar().get("add");
            c.setDisabled(this.getSelectedTerms().length === 0)
        }}},items:[]}
    ],buttons:[
        {itemId:"add",text:"Add",disabled:true,scope:this,handler:function(b, d) {
            var c = this.getSelectedTerms();
            this.fireEvent("suggest", c);
            this.close()
        }},
        {itemId:"cancel",text:"Cancel",scope:this,handler:this.close}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, a));
    ExploreAutomation.IDOLSuggestWindow.superclass.initComponent.apply(this, arguments);
    this.addEvents("suggest")
},afterRender:function() {
    ExploreAutomation.IDOLSuggestWindow.superclass.afterRender.apply(this, arguments);
    this.loadMask = new Ext.LoadMask(this.get("results").el, {msg:"Searching..."});
    this.loadSuggestTerms()
},loadSuggestTerms:function() {
    this.loadMask.show();
    var a = app.getProperty("idol.suggest.databasematch");
    a = a || "";
    Ext.Ajax.request({method:"GET",url:this.idolACIUrl + "/?Action=Query",isMASRequest:true,disableCaching:false,params:{Text:this.suggestText,Spellcheck:true,StoreState:true,Template:"NoNamespace",DatabaseMatch:a,Print:"NoResults"},scope:this,success:function(d, e) {
        var h = d.responseXML;
        var j = Ext.DomQuery.selectValue("autnresponse > response", h);
        if (j !== "SUCCESS") {
            this.handleError(d, Ext.apply(e, {errorMessage:"The suggest query encountered an error."}));
            return
        }
        var c = Ext.value(Ext.DomQuery.selectValue("responsedata > spellingquery", h), "");
        if (c !== "") {
            this.suggestText = c;
            this.loadSuggestTerms.defer(10, this);
            return
        }
        var b = Ext.DomQuery.selectNumber("responsedata > numhits", h);
        if (isNaN(b) || (b === 0)) {
            var f = this.get("results");
            f.add({xtype:"box",html:"No terms were found."});
            f.doLayout();
            this.loadMask.hide();
            return
        }
        var g = Ext.DomQuery.selectValue("responsedata > state", h);
        log.debug("stored state id: " + g);
        Ext.Ajax.request({method:"GET",url:this.idolACIUrl + "/?Action=TermGetBest",isMASRequest:true,disableCaching:false,params:{StateID:g,Stemming:"false",Template:"NoNamespace"},scope:this,success:function(l, t) {
            var p = l.responseXML;
            var s = Ext.DomQuery.selectValue("autnresponse > response", p);
            if (s !== "SUCCESS") {
                this.handleError(l, Ext.apply(t, {errorMessage:"The suggest query encountered an error."}));
                return
            }
            var n = this.get("results");
            var m = Ext.DomQuery.jsSelect("responsedata > term", p);
            for (var q = 0; q < m.length; ++q) {
                if (m[q].normalize) {
                    m[q].normalize()
                }
                var k = m[q].firstChild.nodeValue;
                var o = m[q].getAttribute("apcm_weight");
                var r = k + "[" + o + "]";
                log.debug("weightedTerm: " + r);
                n.add({xtype:"checkbox",inputValue:r,boxLabel:k + " (" + o + ")"})
            }
            n.doLayout();
            this.loadMask.hide()
        },failure:this.handleError})
    },failure:this.handleError})
},handleError:function(a, b) {
    this.loadMask.hide();
    Ext.Msg.alert("Error", b.errorMessage || "Query Timed Out")
},getSelectedTerms:function() {
    var b = this.findBy(function(d, c) {
        return d.isXType("checkbox", true) && d.getValue()
    });
    for (var a = 0; a < b.length; ++a) {
        b[a] = b[a].getRawValue()
    }
    return b
}});
Ext.reg("exploreautomation.idolsuggest", ExploreAutomation.IDOLSuggestWindow);
Ext.ns("ExploreAutomation");
ExploreAutomation.QueryPreview = Ext.extend(Ext.Panel, {cls:"query-preview",padding:5,title:"Query Preview",tpl:new Ext.XTemplate("Text: {text}<br/>", "Field Text: {fieldtext}<br/>", "Database Match: {databasematch}<br/>", "Any Language: {anylanguage}<br/>", "Match Language: {matchlanguage}<br/>", "Date Range: {daterange}<br/>"),tplWriteMode:"overwrite",data:{text:"",fieldtext:"",databasematch:"",anylanguage:"",matchlanguage:"",daterange:""},initComponent:function() {
    var a = {};
    Ext.apply(this, Ext.apply(this.initialConfig, a));
    ExploreAutomation.QueryPreview.superclass.initComponent.apply(this, arguments)
},onRender:function() {
    ExploreAutomation.QueryPreview.superclass.onRender.apply(this, arguments)
},updatePreview:function(a) {
    this.data = {text:a.text,fieldtext:a.fieldtext,databasematch:a.databasematch,matchlanguage:a.matchlanguage,anylanguage:a.anylanguage,daterange:(a.daterange[0] || a.daterange[1]) ? (a.daterange[0] && a.daterange[0].format("m/d/Y") || "") + " to " + (a.daterange[1] && a.daterange[1].format("m/d/Y") || "") : ""};
    this.tpl.overwrite(this.body, this.data)
}});
Ext.reg("exploreautomation.querypreview", ExploreAutomation.QueryPreview);
Ext.ns("ExploreAutomation");
ExploreAutomation.SearchFormHelper = {getBooleanFiltersFieldset:function() {
    var a = {xtype:"fieldset",title:"Boolean Filters",items:[]};
    a.items.push({xtype:"textfield",name:"boolean.all",itemId:"idol.query.allTerms",fieldLabel:"All"});
    a.items.push({xtype:"textfield",name:"boolean.exact",itemId:"idol.query.exactTerms",fieldLabel:"Exact"});
    a.items.push({xtype:"textfield",name:"boolean.any",itemId:"idol.query.anyTerms",fieldLabel:"Any"});
    a.items.push({xtype:"textfield",name:"boolean.not",itemId:"idol.query.notTerms",fieldLabel:"Not"});
    return a
},getDateFiltersFieldset:function() {
    var b = new Ext.form.DateField({itemId:"dateFrom",name:"dateFrom",emptyText:"From",format:Explore.getDateFormatByPref({ignoreTime:true}),altFormats:Explore.getDateFormatByPref({ignoreTime:true}),width:100});
    var a = new Ext.form.DateField({itemId:"dateTo",name:"dateTo",emptyText:"To",format:Explore.getDateFormatByPref({ignoreTime:true}),altFormats:Explore.getDateFormatByPref({ignoreTime:true}),width:100});
    return{xtype:"fieldset",title:"Date Filter",itemId:"dateFilter",labelWidth:1,setValue:function(d, c) {
        if (d) {
            b.setValue(Ext.isNumber(d) ? new Date(d) : d)
        }
        if (c) {
            a.setValue(Ext.isNumber(c) ? new Date(c) : c)
        }
    },items:{xtype:"compositefield",fieldLabel:"",itemId:"compositeDateField",hideLabel:true,items:[b,a]}}
},getMaxResultsFieldset:function() {
    return{xtype:"fieldset",title:"Max Results",labelWidth:1,items:{xtype:"textfield",fieldLabel:"",hideLabel:true,itemId:"maxResults",name:"maxResults",emptyText:"Max Results",width:100}}
},getCustomerGuidFieldSet:function() {
    return{xtype:"exploreautomation.customerguidcheckbox",itemId:"customerGuidFieldSet",fieldLabel:""}
},getPublicInformationSourceFiltersFieldset:function() {
    var f = app.getDatabases();
    var e = app.publicDatabases;
    var g = [
        {xtype:"checkbox",boxLabel:"Select All",itemId:"selectAllCheckbox",value:"",checked:true,listeners:{check:function(n, m) {
            if (n.ignoreOneCheckEvent === true) {
                n.ignoreOneCheckEvent = false;
                return
            }
            var l = n.ownerCt.ownerCt.items.items;
            for (var k = 0; k < l.length; k++) {
                for (var h = 0; h < l[k].items.items.length; h++) {
                    l[k].items.items[h].setValue(m)
                }
            }
            n.ignoreOneCheckEvent = false
        }}}
    ];
    if (f) {
        for (var c = 0; c < f.length; c++) {
            var a = f[c];
            if (a.name !== "Twitter") {
                var b = {xtype:"checkbox",name:"databasematch",boxLabel:(app.icons[a.name.toUpperCase()] ? '<img class="informationsource-icon" src="' + app.icons[a.name.toUpperCase()] + '" /> ' : "") + a.name + " (" + Ext.util.Format.number(a.documents, "0,000") + ")",value:a.name,itemId:a.name,checked:true,listeners:{check:function(l, k) {
                    if (!k) {
                        var h = l.ownerCt.ownerCt;
                        var j = h.getByItemId("selectAllCheckbox");
                        if (j.getValue()) {
                            j.ignoreOneCheckEvent = true;
                            j.setValue(k)
                        }
                    }
                }}};
                g.push(b)
            }
        }
    }
    var d = {name:"publicdatabasematch",itemId:"publicDatabasematchGroup",xtype:"checkboxgroup",items:g,columns:2,fieldLabel:""};
    return{xtype:"fieldset",title:"Sources",items:d,labelWidth:1}
},getLanguageFiltersFieldset:function() {
    var a = {xtype:"fieldset",title:"Language Filter",items:[],labelWidth:1};
    a.items.push({xtype:"selectboxfield",itemId:"languageFilter",name:"matchlanguage",width:200,options:[
        ["",Explore.i18n("Any Language")],
        ["English","English"],
        ["General","General"],
        ["Japanese","Japanese"],
        ["Postuguese","Postuguese"],
        ["Spanish","Spanish"],
        ["Thai","Thai"],
        ["Chinese","Chinese"],
        ["Dutch","Dutch"],
        ["Korean","Korean"],
        ["Arabic","Arabic"],
        ["French","French"],
        ["German","German"]
    ],value:""});
    return a
},computeQueryParts:function(b, l, j) {
    if (!b.isValid()) {
        Ext.Msg.alert("Error", "The search form is invalid. Please fix and resubmit.");
        return
    }
    var e = b.getSubmittableFieldValues();
    var m = e.querytext ? e.querytext : "";
    var n = "";
    if (j) {
        n = j.apply(b, [b])
    } else {
        n = e.querytext ? "(" + e.querytext + ")" : "";
        var o = this.computeBoolean(e);
        if (o !== "") {
            if (m != "*" && m != "(*)" && m != "") {
                n += " AND (" + o + ")"
            } else {
                n = "(" + o + ")"
            }
        }
    }
    var d = this.computeDatabaseMatch(e);
    var h = this.computeFieldText(b, e);
    var a = this.computeDateRange(e);
    var k = this.computeLanguageMatch(e);
    var f = this.computeGuids(e);
    var c = this.getHiddenFieldtextConditions();
    var p = this.computeFieldTextFilter(b, e);
    if (l) {
        var g = {};
        if (m) {
            g.text = m
        }
        if (h) {
            g.fieldtext = h
        }
        if (c) {
            g.hiddenfieldtext = c
        }
        if (f) {
            g.customerGuids = f
        }
        if (a && (a[0] || a[1])) {
            g.daterange = a
        }
        if (d) {
            g.databasematch = d
        }
        if (k) {
            g.matchlanguage = k;
            g.anylanguage = k === ""
        }
        if (e.pageSize) {
            g.pagesize = e.pageSize
        }
        if (e.maxResults) {
            g.maxresults = e.maxResults
        }
        if (p) {
            g.fieldTextFilter = p
        }
        if (n) {
            g.booleanQueryText = n
        }
        return g
    } else {
        return{text:m,fieldtext:h,hiddenfieldtext:c,daterange:a,databasematch:d,matchlanguage:k,anylanguage:k === "",pagesize:e.pageSize,maxresults:e.maxResults,allTerms:e["boolean.all"],anyTerms:e["boolean.any"],exactTerms:e["boolean.exact"],customerGuids:f,notTerms:e["boolean.not"],booleanQueryText:n,fieldTextFilters:p}
    }
},getHiddenFieldtextConditions:function() {
    var b = [];
    if (app.getProperty("safemode") == "true") {
        var a = app.getProperty("safemode.condition") || "(MATCH{safe,unknown}:SAFEFLAG)";
        b.push(a)
    }
    return b.join(" AND ")
},computeFieldTextFilter:function(d, l) {
    var q = [],j = {},p = l;
    for (var f in p) {
        if (f.indexOf("parametric.") === 0) {
            var h = f.split("."),c = h[h.length - 1],a = h[1],e = p[f];
            if (!j[c]) {
                j[c] = {}
            }
            j[c][a] = e
        }
    }
    for (var f in j) {
        var b = j[f],n = b.field,m = b.type,o = b.value;
        if (n && Ext.isNumber(m) && o) {
            var g = {Id:b.Id || null,Comparator:b.type,FieldName:b.field.replace("*/", ""),FieldValue:b.value};
            q.push(g)
        }
    }
    return q
},computeFieldText:function(d, l) {
    var f = [];
    var m = "";
    var o = l;
    var j = {};
    for (var g in o) {
        if (g.indexOf("parametric.") >= 0) {
            var h = g.split(".");
            var c = h[h.length - 1];
            var a = h[1];
            if (!j[c]) {
                j[c] = {}
            }
            j[c][a] = o[g]
        }
    }
    for (var g in j) {
        var b = j[g];
        var n = new Ext.XTemplate(b.type);
        var e = n.apply({val:b.value});
        f.push(e + ":" + b.field)
    }
    m = f.join(" AND ");
    return m
},computeDatabaseMatch:function(f) {
    var b = [];
    var e = f.publicdatabasematch;
    var c = f.privatedatabasematch;
    if (c) {
        for (var d = 0; d < c.length; d++) {
            e.push(c[d])
        }
    }
    if (e) {
        for (var d = 0;
             d < e.length; d++) {
            var a = e[d];
            if (a.getValue() && a.initialConfig.value != "") {
                b.push(a.initialConfig.value)
            }
        }
    }
    return b.join(",")
},computeLanguageMatch:function(a) {
    return a.matchlanguage
},computeGuids:function(f) {
    var d = f.customerguids,e = null;
    if (d) {
        e = [];
        for (var c = 0; c < d.length; c++) {
            var a = d[c],b = a.getName();
            if (a.submitValue !== false) {
                e.push({Id:a.Id,FieldValue:b})
            }
        }
    }
    return e
},computeBoolean:function(e) {
    var m = "";
    var l = e["boolean.all"];
    var f = e["boolean.exact"];
    var g = e["boolean.any"];
    var c = e["boolean.not"];
    var d = [];
    var h = "";
    if (l && l != "") {
        var j = l.split(/\s+/);
        h = "(" + j.join(" AND ") + ")"
    }
    if (h.length > 0) {
        d.push(h)
    }
    var b = "";
    if (f && f != "") {
        b = '"' + f + '"'
    }
    if (b.length > 0) {
        d.push(b)
    }
    var a = g;
    if (a && a.length > 0) {
        d.push(a)
    }
    var k = "";
    if (c && c != "") {
        k = "NOT (" + c + ")"
    }
    if (k.length > 0) {
        d.push(k)
    }
    return d.join(" AND ")
},computeDateRange:function(a) {
    return[a.dateFrom,a.dateTo]
},addDynamicField:function(e, a) {
    var f = Ext.id();
    if (e.items) {
        for (var c = 0; c < e.items.length; c++) {
            var d = e.items[c];
            if (d.name) {
                d.name += "." + f
            }
        }
    }
    if (e.name) {
        e.name += "." + f
    }
    e.id += "." + f;
    var b = Ext.create(e);
    a.add(b);
    a.doLayout();
    if (e.items) {
        for (var c = 0; c < e.items.length;
             c++) {
            var d = e.items[c];
            if (d.name) {
                d.name = d.name.replace("." + f, "")
            }
        }
    }
    e.id = e.id.replace("." + f, "");
    if (e.name) {
        e.name = e.name.replace("." + f, "")
    }
    return b
}};
Ext.ns("ExploreAutomation");
ExploreAutomation.MasMainWindowLauncher = function(a) {
    ExploreAutomation.loadMask = new Ext.LoadMask(Ext.getBody(), {msg:"Please wait..."});
    ExploreAutomation.loadMask.show();
    app = MASSingleton.getInstance();
    app.setUserSettings(a)
};
MASSingleton = function() {
    var a = null;
    return{getInstance:function() {
        if (a === null) {
            a = new ExploreAutomation.App({listeners:{ready:{fn:initializeComponents}}})
        }
        a.init();
        return a
    }}
}();
function initializeComponents() {
    var a = app,c = app.userSettings,b = c.source;
    var d = new Ext.MasMainWindow({editObject:b});
    d.show();
    ExploreAutomation.loadMask.hide()
}
Ext.ns("ExploreAutomation.wizard");
ExploreAutomation.CreateJobFormWindow = Ext.extend(Ext.Window, {opener:null,modal:true,recurring:false,title:"Save Job",width:500,height:430,autoHeight:true,masRequest:{},source:{},initComponent:function() {
    var c = this.source = app.userSettings.source || {},b = !!c.Id,d = this.jobName = (c ? c.name : "");
    var a = {autoScroll:true,title:String.format("{0} Job [{1}]", (b ? "Edit" : "Save"), d),items:this.getCreateJobForm(),fbar:[
        {itemId:"submitButton",text:Explore.i18n("Save"),handler:function() {
            if (b) {
                var e = this;
                Explore.view.StatusBox.confirm(Explore.i18n("Explore"), Explore.i18n("Editing this source will delete documents that may no longer be relevant.</br> Do you wish to continue?"), function() {
                    e.launchJob()
                })
            } else {
                this.launchJob()
            }
        },scope:this}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, a));
    ExploreAutomation.CreateJobFormWindow.superclass.initComponent.apply(this, arguments);
    this.on("afterrender", function() {
        this.displayObject(this.masRequest)
    }, this, {single:true})
},getJobOptionFieldSet:function() {
    if (!this._jobOptionFieldSet) {
        var a = new Ext.form.NumberField({name:"schedule.interval",itemId:"schedule.interval",fieldLabel:"Repeat Interval (Hours)",hidden:!this.recurring,value:this.masRequest["schedule.interval"] || 0,allowBlank:false,width:200});
        var f = new Ext.form.TextField({name:"job.name",itemId:"jobname",fieldLabel:"Job Name",allowBlank:false,width:200,emptyText:"Enter Job Name"});
        var e = new Ext.form.DateField({name:"schedule.startdate",itemId:"schedule.startdate",fieldLabel:"Start Date",allowBlank:true,hidden:!this.recurring,format:Explore.getDateFormatByPref({ignoreTime:true}),altFormats:Explore.getDateFormatByPref(true),width:200,emptyText:"Leave blank for today"});
        var c = new Ext.form.TimeField({name:"schedule.starttime",itemId:"schedule.starttime",fieldLabel:"Start Time",hidden:!this.recurring,allowBlank:true,width:200,emptyText:"Leave blank for immediately"});
        var g = new Ext.form.DateField({name:"schedule.enddate",itemId:"schedule.enddate",fieldLabel:"End Date",allowBlank:true,hidden:!this.recurring,format:Explore.getDateFormatByPref({ignoreTime:true}),altFormats:Explore.getDateFormatByPref(true),width:200,emptyText:"Leave blank for Never"});
        var d = new Ext.form.TimeField({name:"schedule.endtime",itemId:"schedule.endtime",fieldLabel:"End Time",hidden:!this.recurring,allowBlank:true,width:200,emptyText:"Leave blank for 12:00"});
        var b = new Ext.form.Checkbox({xtype:"checkbox",name:"recurring",itemId:"recurring",fieldLabel:"Recurring",listeners:{check:{scope:this,fn:function(j, h) {
            e.setVisible(h);
            c.setVisible(h);
            a.setVisible(h);
            g.setVisible(h);
            d.setVisible(h);
            if (!h) {
                a.setValue(0)
            } else {
                a.setValue((this.masRequest["schedule.interval"] || ""))
            }
        }}},checked:this.source.recurring,value:this.recurring,width:200});
        this._jobOptionFieldSet = new Ext.form.FieldSet({itemId:"jobOptionsFieldset",title:"Job Options",items:[b,a,f,e,c,g,d]})
    }
    return this._jobOptionFieldSet
},getRecieveNotificationFieldSet:function() {
    if (!this._recieveNotificationFieldSet) {
        this._recieveNotificationFieldSet = new Ext.form.FieldSet({xtype:"fieldset",title:"Receive Notifications",items:[
            {xtype:"checkbox",fieldLabel:"On Job Start",itemId:"startNotification",name:"notifications.sendStartNotification",checked:false},
            {xtype:"checkbox",fieldLabel:"On Job Complete",itemId:"completionNotification",name:"notifications.sendCompleteNotification",checked:false},
            {xtype:"checkbox",fieldLabel:"On Job Error",itemId:"errorNotification",name:"notifications.sendErrorNotification",checked:true}
        ]})
    }
    return this._recieveNotificationFieldSet
},getExportDestinationFieldSet:function() {
    if (!this._exportDestinationFieldSet) {
        this._exportDestinationFieldSet = new Ext.form.FieldSet({xtype:"fieldset",title:"Export Destination",items:[
            {xtype:"label",fieldLabel:"Target IDOL",text:app.getUserSettings().idolACIUrl},
            {xtype:"label",fieldLabel:"Source Name",text:this.jobName}
        ]})
    }
    return this._exportDestinationFieldSet
},getCreateJobForm:function() {
    if (!this._createJobForm) {
        var c = this.getJobOptionFieldSet();
        var a = this.getExportDestinationFieldSet();
        var b = this.getRecieveNotificationFieldSet();
        this._createJobForm = new Ext.form.FormPanel({itemId:"createJobFormPanel",padding:10,defaults:{labelWidth:150},items:[c,a,b]})
    }
    return this._createJobForm
},displayObject:function(f) {
    if (f) {
        this.masRequest = f;
        var b = this.getByItemId("schedule.starttime"),e = this.getByItemId("schedule.startdate"),j = this.getByItemId("schedule.endtime"),d = this.getByItemId("schedule.enddate");
        startDate = f["schedule.starttime"],endDate = f["schedule.endtime"];
        if (e && startDate) {
            e.setValue(new Date(startDate));
            b.setValue(new Date(startDate))
        }
        if (d && endDate) {
            d.setValue(new Date(endDate));
            j.setValue(new Date(endDate))
        }
        var c = this.getByItemId("startNotification"),k = this.getByItemId("completionNotification"),l = this.getByItemId("errorNotification"),g = !!f["notifications.sendCompleteNotification"],a = (f["notifications.sendErrorNotification"] === false ? false : true),h = !!f["notifications.sendStartNotification"];
        c.setValue(h);
        k.setValue(g);
        l.setValue(a)
    }
},onRender:function() {
    ExploreAutomation.CreateJobFormWindow.superclass.onRender.apply(this, arguments);
    this.loadMask = new Ext.LoadMask(this.el, {msg:"Launching Job..."});
    if (app && app.userSettings && app.userSettings.source && app.userSettings.source.name) {
        var b = app.userSettings.source.name;
        var a = this.getByItemId("jobname");
        a.setValue(b);
        a.disable();
        a.setVisible(false)
    }
},launchJob:function() {
    var a = this.getByItemId("createJobFormPanel");
    var b = a.getForm();
    if (!b.isValid()) {
        Ext.Msg.alert("Error", "Please complete the form and submit again.");
        return false;
        return
    }
    if (this.opener) {
        this.opener.createJob(b, true, this)
    }
    this.loadMask.show()
},getJobConfiguration:function() {
    var a = this.getByItemId("createJobFormPanel");
    var b = a.getForm();
    if (!b.isValid()) {
        Ext.Msg.alert("Error", "Please complete the form and submit again.");
        return false
    }
    if (this.opener) {
        this.opener.createJob(b, false, this)
    }
}});
Ext.reg("exploreautomation.createjobformwindow", ExploreAutomation.CreateJobFormWindow);
Ext.ns("ExploreAutomation");
ExploreAutomation.EstimationChart = Ext.extend(Ext.Panel, {cls:"estimation-chart",title:"Estimated Volume",numTotalResults:0,estimationType:"weekly",numberOfDays:3,adjustmentFactor:1,initComponent:function() {
    var c = parseInt(this.numTotalResults, 0);
    log.debug("Number of Days in IDOL: " + this.initialConfig.numberOfDays);
    if (isNaN(c)) {
        c = 0
    }
    var a = new Ext.data.ArrayStore({fields:["estimationType","estimationAmount"],data:this.computeChartData(c)});
    var b = {layout:"fit",items:[
        {xtype:"columnchart",itemId:"chart",extraStyle:{animationEnabled:false},store:a,xField:"estimationType",yField:"estimationAmount",seriesStyles:{size:100},yAxis:new Ext.chart.NumericAxis({labelFunction:"ExploreAutomation.EstimationChart.OMGnumberRenderer"})}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    ExploreAutomation.EstimationChart.superclass.initComponent.apply(this, arguments)
},updateChart:function(b) {
    var a = this.computeChartData(b);
    this.amount = a[0][1];
    log.info("Estimation Amount: " + this.amount);
    this.get("chart").store.loadData(a)
},computeChartData:function(b) {
    var a = 0;
    if (b > 0) {
        a = (b / this.numberOfDays) * ((this.estimationType === "monthly") ? 30 : 7) * this.adjustmentFactor
    }
    return[
        [(this.estimationType === "monthly") ? "Monthly" : "Weekly",a]
    ]
}});
Ext.reg("exploreautomation.estimationchart", ExploreAutomation.EstimationChart);
ExploreAutomation.EstimationChart.OMGnumberRenderer = function(a) {
    a = Ext.util.Format.number(a, "0,000.00");
    if (a.substring(a.length - 3) === ".00") {
        a = a.substring(0, a.length - 3)
    }
    return a
};
Ext.ns("Autonomy");
Autonomy.IDOLPagingToolbar = Ext.extend(Ext.PagingToolbar, {cacheTotalResults:false,lazyLoadTotalResults:true,interimDisplayMsg:"Displaying {0} - {1} of Many",_cachedTotalResults:-1,beforeLoad:function(a, b) {
    if (b.params) {
        var e = b.params;
        var d = this.findKey(e, "start");
        if (d == null) {
            e.start = 0
        }
        var d = this.findKey(e, "start");
        if (this.lazyLoadTotalResults && (e[d] == 0 || e.isRefresh)) {
            this._cachedTotalResults = -1
        }
        if (e[d] != 0 && !e.isRefresh) {
            this.replaceOrUpdateProperty(e, "totalresults", true);
            this.replaceOrUpdateProperty(e, "_cachedTotalCount", a.getTotalCount())
        }
        if (this.lazyLoadTotalResults) {
            this.replaceOrUpdateProperty(e, "totalresults", false)
        }
        e[d] += 1;
        var c = this.findKey(e, "maxresults");
        c = c || "maxresults";
        e[c] = e[d] + parseInt(this.pageSize) - 1
    }
    Autonomy.IDOLPagingToolbar.superclass.beforeLoad.call(this, a, b)
},onLoad:function(b, a, c) {
    if (c.params) {
        var e = c.params;
        var d = this.findKey(e, "start");
        d = d || "start";
        e[d] -= 1;
        if (!this.lazyLoadTotalResults && e._cachedTotalCount) {
            b.totalLength = parseInt(e._cachedTotalCount)
        }
        if (this.lazyLoadTotalResults && this._cachedTotalResults) {
            b.totalLength = this._cachedTotalResults
        }
    }
    Autonomy.IDOLPagingToolbar.superclass.onLoad.call(this, b, a, c);
    if (c.params) {
        if (this.lazyLoadTotalResults && this._cachedTotalResults == -1 && (e[d] == 0 || e.isRefresh)) {
            this.retrieveTotalCount(c)
        }
    }
},doRefresh:function() {
    this.doLoad(this.cursor, true)
},doLoad:function(d, b) {
    var c = {},a = this.getParams();
    c[a.start] = d;
    c[a.limit] = this.pageSize;
    c.isRefresh = b === true;
    if (this.fireEvent("beforechange", this, c) !== false) {
        this.store.load({params:c})
    }
},updateInfo:function() {
    if (this.displayItem) {
        var a = this.store.getCount();
        var b = null;
        if (a == 0) {
            b = this.emptyMsg
        } else {
            if (this._cachedTotalResults >= 0) {
                b = String.format(this.displayMsg, this.cursor + 1, this.cursor + a, this.store.getTotalCount())
            } else {
                b = String.format(this.interimDisplayMsg, this.cursor + 1, this.cursor + a, this.store.getTotalCount())
            }
        }
        this.displayItem.setText(b)
    }
},retrieveTotalCount:function(c) {
    var b = this.store.proxy.url;
    var a = {};
    if (!c.params) {
        c.params = {}
    }
    var e = c.params;
    this.replaceOrUpdateProperty(e, "totalresults", true);
    this.replaceOrUpdateProperty(e, "print", "NoResults");
    this.replaceOrUpdateProperty(e, "maxresults", 0);
    var d = this.findKey(e, "start");
    d = d ? d : "start";
    c.params[d] += 1;
    Ext.Ajax.request({method:"GET",url:b,params:c.params,success:this.handleTotalCountSuccess,failure:this.handleTotalCountError,scope:this,timeout:parseInt(app.getProperty("ui.query.timeoutmillis")),isMASRequest:true,disableCaching:false})
},handleTotalCountSuccess:function(c, d) {
    var e = c.responseXML;
    var f = Ext.DomQuery.selectValue("autnresponse > response", e);
    if (f != "SUCCESS") {
        Ext.Msg.alert("Error", "The search query encountered an error.");
        return
    }
    var a = Ext.DomQuery.selectNumber("responsedata > totalhits", e);
    log.info("Number of Hits: " + a);
    this.store.totalLength = this._cachedTotalResults = a;
    var b = this.store.getRange(0, this.store.getCount());
    this.store.fireEvent("load", this.store, b, d)
},handleSearchError:function(a, b) {
    this.loadMask.hide();
    Ext.Msg.alert("Error", "Could not retrieve total count.")
},findKey:function(d, c) {
    var b = c.toLowerCase();
    for (var a in d) {
        if (a.toLowerCase() == b) {
            return a
        }
    }
    return null
},replaceOrUpdateProperty:function(d, a, c) {
    var b = this.findKey(d, a);
    if (b) {
        d[b] = c
    } else {
        d[a] = c
    }
}});
Ext.reg("idolpaging", Autonomy.IDOLPagingToolbar);
Ext.ns("ExploreAutomation");
ExploreAutomation.QueryPreview = Ext.extend(Ext.Panel, {cls:"query-preview",padding:5,title:"Query Preview",tpl:null,fieldTextMappings:{},tplWriteMode:"overwrite",data:{text:"",fieldtext:"",databasematch:"",anylanguage:"",matchlanguage:"",daterange:""},initComponent:function() {
    var a = this;
    SourceService.GetFilterTextMappings(function(c) {
        a.fieldTextMappings = c.Result
    });
    var b = {tpl:new Ext.XTemplate("Text: {text}<br/>", "Field Text: {[this.getFieldTextFilters(values)]}<br/>", "Database Match: {databasematch}<br/>", "Any Language: {anylanguage}<br/>", "Match Language: {matchlanguage}<br/>", "Date Range: {daterange}<br/>", {processFieldFilter:function(f) {
        var d = f.Comparator,e = Explore.model.MASComparators.getName(d),h = a.fieldTextMappings[e],j = f.FieldName,g = f.FieldValue,c = "{0}{{1}}:{2}";
        if (Explore.model.MASComparators.EndsWith === d) {
            g = "*" + g
        } else {
            if (Explore.model.MASComparators.StartsWith === d) {
                g = g + "*"
            }
        }
        return String.format(c, h, g, j)
    },getFieldTextFilters:function(c) {
        var g = c.fieldTextFilters;
        if (g) {
            var f = [];
            for (var d = 0; d < g.length; d++) {
                var e = this.processFieldFilter(g[d]);
                f.push(e)
            }
            return f.join(" AND ")
        } else {
            return""
        }
    }})};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    ExploreAutomation.QueryPreview.superclass.initComponent.apply(this, arguments)
},onRender:function() {
    ExploreAutomation.QueryPreview.superclass.onRender.apply(this, arguments)
},updatePreview:function(a) {
    this.data = {text:a.booleanQueryText || a.text,fieldTextFilters:a.fieldTextFilters,databasematch:a.databasematch,matchlanguage:a.matchlanguage,anylanguage:a.anylanguage,daterange:(a.daterange[0] || a.daterange[1]) ? (a.daterange[0] && a.daterange[0].format("m/d/Y") || "") + " to " + (a.daterange[1] && a.daterange[1].format("m/d/Y") || "") : ""};
    this.tpl.overwrite(this.body, this.data)
}});
Ext.reg("exploreautomation.querypreview", ExploreAutomation.QueryPreview);
Ext.ns("ExploreAutomation");
ExploreAutomation.ResultsGrid = Ext.extend(Ext.grid.GridPanel, {qtipTplWithoutDescription:new Ext.XTemplate("<h2>{val}</h2>"),querytext:"*",fieldText:"",databaseMatch:"",pageSize:20,title:"Preview Results",dataSource:null,masRequest:{},initComponent:function() {
    var a = new Ext.data.XmlStore({proxy:new Ext.data.HttpProxy({url:app.getProperty("idol.aci.url") + "/?action=query",method:"GET",timeout:parseInt(app.getProperty("ui.query.timeoutmillis")),isMASRequest:true,disableCaching:false}),baseParams:{printfields:"DREDATE,TYPE",text:this.querytext,fieldtext:this.fieldText,databasematch:this.databaseMatch,maxresults:this.pageSize,anylanguage:"true",template:"NoNamespace",combine:"Simple",sort:"Relevance+DATE"},autoLoad:false,totalProperty:"totalhits",remoteSort:false,record:"hit",idProperty:"id",fields:[
        {name:"weight",mapping:"weight"},
        {name:"type",mapping:"DOCUMENT > TYPE"},
        {name:"title",mapping:"title"},
        {name:"dredate",mapping:"DOCUMENT > DREDATE",convert:function(e, c) {
            var h = null;
            if (!e) {
                return""
            }
            if (!this.dreDateFormats) {
                this.dreDateFormats = ["Y-m-d H:i:s O","Y-m-d H:i:s","m/d/Y H:i:s","d/m/Y H:i:s"]
            }
            for (var f = 0;
                 f < this.dreDateFormats.length && !h; f++) {
                var g = this.dreDateFormats[f];
                h = Date.parseDate(e, g)
            }
            return h
        }}
    ],listeners:{beforeload:{fn:this.tweakMaxResults,scope:this},load:{fn:this.tweakIndexBack,scope:this},exception:{fn:this.loadException,scope:this}}});
    var b = {loadMask:{msg:"Querying IDOL..."},sm:new Ext.grid.RowSelectionModel({singleSelect:true}),autoExpandColumn:"content",colModel:new Ext.grid.ColumnModel({defaults:{width:120,sortable:false,renderer:this.qtipRenderer.createDelegate(this)},columns:[
        {id:"weight",header:"Weight",width:60,dataIndex:"weight",sortable:false},
        {id:"type",header:"Type",width:50,dataIndex:"type",sortable:false,renderer:this.renderType.createDelegate(this)},
        {id:"content",header:"Title",width:160,dataIndex:"title"},
        {id:"date",header:"Date",width:160,dataIndex:"dredate",sortable:false,xtype:"datecolumn",format:"m/d/Y H:i:s T"}
    ]}),store:a,bbar:new Autonomy.IDOLPagingToolbar({cacheTotalResults:true,pageSize:this.pageSize,store:a,displayInfo:true,displayMsg:"{0}-{1} of {2}",interimDisplayMsg:"{0}-{1} of Many",emptyMsg:"No items.",listeners:{beforerender:function(g) {
        var e;
        for (e = 0; e < g.items.length; e++) {
            if (g.items.itemAt(e) && g.items.itemAt(e).iconCls == "x-tbar-loading") {
                e++;
                break
            }
        }
        var h = g.items.length - e - 1;
        var f = e;
        var d = {};
        d[e] = h;
        for (var c = 0; c < g.items.length; c++) {
            if (c < e) {
                d[c] = h + 1 + c
            } else {
                if (c > e) {
                    d[c] = c - e - 1
                }
            }
        }
        g.items.reorder(d)
    }}}),viewConfig:{emptyText:"No results to display. Please select some filters and click Search.",deferEmptyText:false},fbar:["->",this.getSaveJobAction()]};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    ExploreAutomation.ResultsGrid.superclass.initComponent.apply(this, arguments)
},onRender:function() {
    ExploreAutomation.ResultsGrid.superclass.onRender.apply(this, arguments);
    this.enableJobButtons(0)
},qtipRenderer:function(d, a, b, e) {
    d = Ext.util.Format.defaultValue(d, "");
    var c = this.qtipTplWithoutDescription.apply({val:d});
    return'<div qtip="' + c + '">' + d + "</div>"
},renderType:function(c, a, b) {
    c = c.toUpperCase();
    if (app.icons[c]) {
        return'<img src="' + app.icons[c] + '" alt="' + c + '" title="' + c + '" />'
    } else {
        log.debug("No Icon for type: " + c);
        return c
    }
},tweakMaxResults:function(a, b) {
    if (!b.params.sort) {
        b.params.sort = "Relevance+DATE";
        b.params.dir = "DESC"
    } else {
        if (b.params.sort == "weight") {
            b.params.sort = (b.params.dir == "ASC" ? "ReverseRelevance" : "Relevance")
        } else {
            if (b.params.sort == "dredate") {
                b.params.sort = (b.params.dir == "ASC" ? "Date" : "ReverseDate")
            } else {
                b.params.sort += ":" + (b.params.dir == "ASC" ? "increasing" : "decreasing")
            }
        }
    }
},tweakIndexBack:function(b, a, c) {
    if (c.params.sort.indexOf("Relevance") >= 0) {
        c.params.sort = "weight"
    } else {
        if (c.params.sort.indexOf(":") >= 0) {
            c.params.sort = c.params.sort.split(":")[0]
        }
    }
},enableJobButtons:function(c) {
    c = parseInt(c);
    var j = app.getUserSettings().idolACIUrl && app.getUserSettings().idolACIUrl != "";
    log.debug("Target IDOL ACI URL: " + app.getUserSettings().idolACIUrl);
    var b = app.getUserSettings().customerName;
    var d = null;
    if (b) {
        d = app.getProperty(b + ".max.estimated.results");
        if (d) {
            d = parseInt(d)
        }
    }
    if (!d) {
        d = parseInt(app.getProperty("max.estimated.results"))
    }
    log.info("Max Estimated Results: " + d + ", Estimated Results: " + c);
    var f = d > c && c >= 0;
    var a = true;
    var e = j && f && a;
    log.debug("Enabled: " + e);
    log.debug("Has Source: " + a);
    log.debug("Max Results OK: " + f);
    var h = this.getFooterToolbar();
    if (e) {
        this.errorMessage = ""
    } else {
        this.errorMessage = "No Target IDOL Configured";
        if (j && !a) {
            this.errorMessage = "No Source Configured"
        } else {
            if (j && !f) {
                this.errorMessage = "Maximum Estimated Results Exceeded<br/>Estimated Results: " + (c > 0 ? c : "Unknown") + "<br/>Maximum Estimated Results: " + d
            }
        }
    }
    var g = h.findByType("button")
},resetQuery:function(a) {
    this.querytext = a.booleanQueryText || a.text;
    log.info(a.text);
    log.info(this.querytext);
    this.store.setBaseParam("text", this.querytext);
    this.fieldText = a.fieldtext;
    if (a.hiddenfieldtext) {
        this.fieldText = this.fieldText ? "(" + a.hiddenfieldtext + ") AND (" + this.fieldText + ")" : a.hiddenfieldtext
    }
    this.store.setBaseParam("fieldtext", this.fieldText);
    this.databaseMatch = a.databasematch;
    this.store.setBaseParam("databasematch", this.databaseMatch);
    this.matchlanguage = a.matchlanguage;
    this.anylanguage = this.matchlanguage === "";
    this.store.setBaseParam("anylanguage", this.anylanguage);
    this.store.setBaseParam("matchlanguage", this.matchlanguage);
    if (a.daterange) {
        this.minDate = a.daterange[0] && a.daterange[0].format("d/m/Y") || "";
        this.maxDate = a.daterange[1] && a.daterange[1].format("d/m/Y") || ""
    }
    this.store.setBaseParam("mindate", this.minDate);
    this.store.setBaseParam("maxdate", this.maxDate);
    this.pageSize = a.pagesize;
    this.getBottomToolbar().pageSize = a.pagesize;
    this.store.setBaseParam("maxresults", this.pageSize);
    this.store.reload({params:{maxresults:this.pageSize,fieldtext:this.fieldText,text:this.querytext,databasematch:this.databaseMatch,anylanguage:this.anylanguage,matchlanguage:this.matchlanguage,mindate:this.minDate,maxdate:this.maxDate,start:0}})
},loadException:function(c, d, e, b, a) {
    Ext.Msg.show({title:"ERROR",msg:Explore.i18n("MAS_Unreachable"),width:370,buttons:Ext.MessageBox.OK,icon:Ext.MessageBox.ERROR})
},getSaveJobAction:function() {
    if (!this._saveJobAction) {
        this._saveJobAction = new Ext.Action({text:(this.masRequest.RequestId ? Explore.i18n("Edit Job") : Explore.i18n("Save Job")),itemId:"savejobaction",scope:this,handler:function() {
            if (this.checkError()) {
                return
            }
            var b = this.findParentByType("exploreautomation.searchpanel");
            var c = {xtype:"exploreautomation.createjobformwindow",opener:b,masRequest:this.masRequest,recurring:this.dataSource.recurring};
            var a = Ext.create(c);
            a.show()
        }})
    }
    return this._saveJobAction
},checkError:function() {
    if (this.errorMessage && this.errorMessage != "") {
        Ext.Msg.show({title:"Error",msg:"<b>Export job cannot be executed because: </b><br/>" + this.errorMessage,icon:Ext.Msg.ERROR,buttons:Ext.Msg.OK});
        return true
    }
    return false
}});
Ext.reg("exploreautomation.resultsgrid", ExploreAutomation.ResultsGrid);
Ext.ns("ExploreAutomation");
ExploreAutomation.SearchFormPanel = Ext.extend(Ext.form.FormPanel, {parametricTypeStore:new Ext.data.ArrayStore({idIndex:0,fields:["name","value"],data:[
    ["Equals",Explore.model.MASComparators.Equals],
    ["Contains",Explore.model.MASComparators.Contains],
    ["Starts With",Explore.model.MASComparators.StartsWith],
    ["Ends With",Explore.model.MASComparators.EndsWith]
]}),padding:10,cls:"search-form-panel",masRequest:{},initComponent:function() {
    var d = {autoScroll:true,title:"Search Conditions",items:[],buttonAlign:"left",fbar:["->",{itemId:"searchButton",xtype:"button",text:"Preview Results",listeners:{click:{fn:this.doSearch,scope:this}}}]};
    d.items.push(ExploreAutomation.SearchFormHelper.getPublicInformationSourceFiltersFieldset());
    d.items.push(ExploreAutomation.SearchFormHelper.getCustomerGuidFieldSet());
    d.items.push(ExploreAutomation.SearchFormHelper.getDateFiltersFieldset());
    d.items.push(ExploreAutomation.SearchFormHelper.getBooleanFiltersFieldset());
    d.items.push({xtype:"fieldset",title:"Query Text",labelWidth:75,items:[
        {itemId:"querytext",name:"querytext",xtype:"textarea",fieldLabel:"Query Text",height:33,width:"80%",value:"*",allowBlank:false}
    ]});
    var j = {itemId:"fieldFiltersFieldset",hideLabel:true,labelWidth:1,xtype:"fieldset",title:"Field Filters",items:[]};
    d.items.push(j);
    j.items.push({xtype:"button",text:"Add Field Filter",listeners:{click:{scope:this,fn:function() {
        ExploreAutomation.SearchFormHelper.addDynamicField(this.parametricFieldTemplate, this.getByItemId("fieldFiltersFieldset"))
    }}}});
    var e = app.getProperty("idol.parametricfields.csv");
    this.parametricStore = new Ext.data.ArrayStore({idIndex:0,fields:["name","value"],data:[]});
    if (e) {
        var c = e.split(",");
        var b = [];
        for (var f = 0; f < c.length; f++) {
            var h = c[f];
            h = h.trim();
            var g = h.split("/");
            var a = g[g.length - 1];
            b.push([a,h])
        }
        this.parametricStore = new Ext.data.ArrayStore({idIndex:0,fields:["name","value"],data:b})
    }
    this.parametricFieldTemplate = this.getParametricFieldTemplate();
    d.items.push(ExploreAutomation.SearchFormHelper.getLanguageFiltersFieldset());
    d.items.push({xtype:"fieldset",title:"Number of results per page",labelWidth:1,items:{xtype:"numberfield",itemId:"pageSize",name:"pageSize",value:20,width:50,allowBlank:false}});
    d.items.push(ExploreAutomation.SearchFormHelper.getMaxResultsFieldset());
    Ext.apply(this, Ext.apply(this.initialConfig, d));
    ExploreAutomation.SearchFormPanel.superclass.initComponent.apply(this, arguments)
},getParametricFieldTemplate:function(b) {
    if (!b) {
        b = {}
    }
    var a = {xtype:"compositefield",id:"parametric",fieldLabel:" ",labelSeparator:"",labelWidth:1,cls:"dynamic-form-field",items:[
        {xtype:"combo",fieldLabel:"Filter",name:"parametric.field",width:100,flex:1,valueField:"value",displayField:"name",mode:"local",triggerAction:"all",editable:true,allowBlank:false,value:b.FieldName || "",store:this.parametricStore},
        {xtype:"combo",name:"parametric.type",flex:1,valueField:"value",displayField:"name",mode:"local",triggerAction:"all",editable:true,forceSelection:true,allowBlank:false,value:Ext.isNumber(b.Comparator) ? b.Comparator : Explore.model.MASComparators.Equals,store:this.parametricTypeStore,fieldLabel:null},
        {xtype:"textfield",flex:2,name:"parametric.value",value:b.FieldValue || "",allowBlank:false,fieldLabel:null},
        {xtype:"button",text:"Remove",name:"parametric.remove",fieldLabel:null,listeners:{click:function(d, f) {
            var h = d.name.split(".")[2];
            var g = Ext.getCmp("parametric." + h);
            var c = g.findParentByType("fieldset");
            c.remove.defer(10, c, [g])
        }}},
        {xtype:"textfield",name:"parametric.Id",hidden:true,flex:1,value:b.Id || 0,fieldLabel:null}
    ]};
    return a
},onRender:function() {
    ExploreAutomation.SearchFormPanel.superclass.onRender.apply(this, arguments)
},displayObject:function(j) {
    if (j) {
        this.masRequest = j;
        for (var r in j) {
            var h = this.getByItemId(r);
            if (h && h.setValue) {
                h.setValue(j[r])
            }
        }
        var k = this.getByItemId("querytext");
        if (k && j["idol.query.text"]) {
            k.setValue(j["idol.query.text"])
        }
        var b = this.getByItemId("languageFilter");
        if (b) {
            var s = j["idol.query.matchlanguage"] || "";
            b.setValue(s)
        }
        var o = this.getByItemId("maxResults");
        if (o && j["idol.query.maxresults"]) {
            o.setValue(j["idol.query.maxresults"])
        }
        var d = this.getByItemId("dateFilter");
        d.setValue(j["idol.query.mindate"], j["idol.query.maxdate"]);
        var n = j["idol.query.databasematch"],p = this.getByItemId("publicDatabasematchGroup").items;
        if (n) {
            var c = n.split(","),e = function(u) {
                for (var t = 0;
                     t < c.length; t++) {
                    if (c[t].toLowerCase().trim() === u.itemId.toLowerCase().trim()) {
                        return true
                    }
                }
                return false
            },a = function(v) {
                for (var u = 0;
                     u < v.length; u++) {
                    var t = v[u];
                    t.checked = e(t)
                }
            };
            a(p)
        }
        var q = this.getByItemId("customerGuidFieldSet");
        guids = j["idol.query.customerGuids"];
        q.displayObject(guids);
        var l = this.getByItemId("fieldFiltersFieldset"),f = j["idol.query.fieldTextFilters"];
        for (var m = 0; f && m < f.length;
             m++) {
            var g = f[m];
            ExploreAutomation.SearchFormHelper.addDynamicField(this.getParametricFieldTemplate(g), l)
        }
    }
},computeQueryParts:function(a) {
    return ExploreAutomation.SearchFormHelper.computeQueryParts(this.getForm())
},doSearch:function() {
    var a = ExploreAutomation.SearchFormHelper.computeQueryParts(this.getForm());
    if (a) {
        this.ownerCt.doSearch(a)
    }
},reset:function() {
    var j = this.getByItemId("fieldFiltersFieldset");
    var d = j.findByType("button");
    for (var c = 0; c < d.length; c++) {
        var a = d[c].initialConfig.name;
        var b = d[c];
        if (a && a.indexOf("remove") >= 0) {
            var h = b.name.split(".")[2];
            var g = Ext.getCmp("parametric." + h);
            j.remove(g)
        }
    }
    try {
        this.getForm().reset()
    } catch(f) {
    }
},setValues:function(d) {
    var c = this.getForm();
    c.setValues(d);
    var a = d.databasematch;
    var b = c.findField("publicDatabasematchGroup");
    b.setValue([false]);
    b.items.each(function(g, f, e) {
        if (a) {
            g.setValue(a.indexOf(g.initialConfig.value) >= 0)
        }
    })
}});
Ext.reg("exploreautomation.searchformpanel", ExploreAutomation.SearchFormPanel);
Ext.ns("ExploreAutomation");
ExploreAutomation.SearchPanel = Ext.extend(Ext.Panel, {border:false,cls:"search-panel",editObject:{},initComponent:function() {
    var a = this,d = a.editObject,c = d.MasRequest || {};
    var b = {layout:"border",xtype:"panel",margins:{left:5,right:5},defaults:{masRequest:c,dataSource:d,defaults:{dataSource:d,masRequest:c}},border:false,items:[
        {region:"west",width:"40%",itemId:"searchFormPanel",xtype:"exploreautomation.searchformpanel",split:true},
        {region:"center",xtype:"panel",layout:"border",border:false,items:[
            {xtype:"container",region:"north",height:160,split:true,border:false,layout:"border",items:[
                {itemId:"estimationChart",xtype:"exploreautomation.estimationchart",region:"west",width:"33%",split:true,estimationType:app.getProperty("estimation.type"),numberOfDays:app.getProperty("estimation.numdays"),adjustmentFactor:app.getProperty("estimation.adjustment")},
                {itemId:"queryPreview",split:true,xtype:"exploreautomation.querypreview",region:"center"}
            ]},
            {region:"center",itemId:"results",xtype:"exploreautomation.resultsgrid",split:true}
        ]}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    ExploreAutomation.SearchPanel.superclass.initComponent.apply(this, arguments);
    this.displayObject(c)
},displayObject:function(b) {
    for (var a in b) {
        var c = this.getByItemId(a);
        if (c && c.setValue) {
            c.setValue(b[a])
        }
    }
    var d = this.getByItemId("searchFormPanel");
    d.displayObject(b)
},onRender:function() {
    ExploreAutomation.SearchPanel.superclass.onRender.apply(this, arguments);
    this.getByItemId("results").getStore().on("load", function(b, a, c) {
        var d = this.getByItemId("estimationChart");
        d.updateChart(b.getTotalCount());
        this.getByItemId("results").enableJobButtons(d.amount)
    }, this)
},doSearch:function(c) {
    var b = this.getByItemId("queryPreview");
    b.updatePreview(c);
    var a = this.getByItemId("results");
    a.resetQuery(c)
},createJob:function(d, a, c) {
    var b = app.userSettings.source;
    this.createJobHelper(d, a, c, b)
},createJobHelper:function(y, a, l, w) {
    var s = this.getByItemId("searchFormPanel");
    var p = s.computeQueryParts();
    if (p) {
        if (p.daterange) {
            if (p.daterange[0]) {
                p.mindate = p.daterange[0]
            } else {
                p.mindate = undefined
            }
            if (p.daterange[1]) {
                p.maxdate = p.daterange[1]
            } else {
                p.maxdate = undefined
            }
        } else {
            delete p.mindate;
            delete p.maxdate
        }
        delete p.daterange;
        delete p.pagesize;
        var g = {};
        for (var t in p) {
            g["idol.query." + t] = p[t]
        }
        p = g;
        var b = app.getUserSettings();
        log.info("User Settings: " + Ext.encode(b));
        log.info("Trying to build links");
        var h = Ext.DomHelper.createDom({tag:"a",href:b.idolACIUrl});
        var m = Ext.DomHelper.createDom({tag:"a",href:b.idolIndexUrl});
        var e = Ext.DomHelper.createDom({tag:"a",href:b.notificationACIUrl});
        if (!p["idol.query.maxresults"]) {
            p["idol.query.maxresults"] = app.getProperty("idol.query.maxresults")
        }
        p.scriptID = "async.queryexportindex.process";
        if (y) {
            var z = y.getSubmittableFieldValues();
            var n = z["schedule.starttime"];
            var c = z["schedule.startdate"];
            var d = z["schedule.endtime"];
            var v = z["schedule.enddate"];
            if (c && n) {
                var r = c.format("Y-m-d") + " " + n;
                c = Date.parseDate(r, "Y-m-d g:i A")
            }
            if (v && d) {
                var r = v.format("Y-m-d") + " " + d;
                v = Date.parseDate(r, "Y-m-d g:i A")
            }
            log.debug("StartDate: " + c);
            log.debug("schedule.starttime = " + (z["schedule.interval"] ? c : null));
            if (c && z["schedule.interval"]) {
                p["schedule.starttime"] = c
            } else {
                delete p["schedule.starttime"]
            }
            if (v && z["schedule.interval"]) {
                p["schedule.endtime"] = v
            } else {
                delete p["schedule.endtime"]
            }
            if (z["schedule.interval"]) {
                p["schedule.interval"] = z["schedule.interval"];
                w.recurring = true
            } else {
                p["schedule.interval"] = null;
                w.recurring = false
            }
            p["notifications.sendStartNotification"] = !!z["notifications.sendStartNotification"];
            p["notifications.sendCompleteNotification"] = !!z["notifications.sendCompleteNotification"];
            p["notifications.sendErrorNotification"] = !!z["notifications.sendErrorNotification"]
        }
        if (a) {
            var o = this;
            w.MasRequest = p;
            if (!p["idol.query.mindate"]) {
                delete w.MasRequest["idol.query.mindate"]
            }
            if (!p["idol.query.maxdate"]) {
                delete w.MasRequest["idol.query.maxdate"]
            }
            if (!p["schedule.interval"]) {
                delete w.MasRequest["schedule.starttime"];
                delete w.MasRequest["schedule.endtime"]
            }
            var j = function() {
                o.fireEvent("closeall");
                l.close()
            };
            Explore.data.SourceDataStore.saveDataSource(w, function(k) {
                if (k.ErrorCode) {
                    Ext.Msg.alert("Error", k.Message)
                } else {
                    if (!w.recurring) {
                        SourceService.SubmitOneTimeJob(k.Result.Id, function(q) {
                            if (q.ErrorCode) {
                                Ext.Msg.alert("Error", q.Message || "Job Saved but failed to Launch")
                            }
                            j()
                        })
                    } else {
                        j()
                    }
                }
            })
        } else {
            var f = Ext.get("download-form");
            if (!f) {
                f = Ext.getBody().createChild({tag:"form",cls:"x-hidden",id:"download-form",action:"createjobfile",target:"download-iframe",method:"POST"})
            }
            var x = Ext.query("input", f.dom);
            for (var u = 0; u < x.length; u++) {
                Ext.removeNode(x[u])
            }
            for (var t in p) {
                f.createChild({tag:"input",type:"hidden",name:t,value:Ext.util.Format.htmlEncode(p[t])})
            }
            f.dom.submit()
        }
    }
},handleLaunchJobSuccess:function(a, b, c) {
    var e = Ext.decode(a.responseText);
    if (!e.success) {
        Ext.Msg.alert("Error", "Failed to start job because: " + e.msg)
    } else {
        Ext.Msg.alert("Success", e.data.msg + "<br/>Job Token: " + e.data.guid)
    }
    if (c) {
        c.close()
    }
},handleLaunchJobError:function(a, b, c) {
    Ext.Msg.alert("Error", "Failed to start job.");
    log.error("Failed to launch job because: " + a.responseText);
    if (c) {
        c.loadMask.hide()
    }
}});
Ext.reg("exploreautomation.searchpanel", ExploreAutomation.SearchPanel);
Ext.MasSelectorForm = Ext.extend(Ext.Panel, {editObject:{},initComponent:function() {
    var b = this,f = b.editObject,e = f.Id;
    var c = {layout:"border",border:false,frame:false,items:[
        {xtype:"form",labelWidth:170,border:false,frame:false,itemId:"formpanel",region:"center",padding:"10px",items:[
            {xtype:"textfield",fieldLabel:"Name*",itemId:"name",enableKeyEvents:true,allowBlank:false,emptyText:Explore.i18n("EnterUniqueMASName"),blankText:"This field is required",regex:new RegExp("[^ ]"),regexText:"Please enter a non-blank name",width:"90%",value:f.Name || ""},
            {xtype:"textarea",fieldLabel:"Description",emptyText:Explore.i18n("EnterBriefDescriptionForMAS"),itemId:"description",width:"90%",value:f.Description || ""},
            {xtype:"radiogroup",fieldLabel:"Set up source via",columns:1,disabled:e,itemId:"radioselection",items:[
                {boxLabel:"Media Aggregation Service Wizard",name:"rb-col",inputValue:"towizard",checked:!e},
                {boxLabel:"Advanced query builder",name:"rb-col",inputValue:"toquerybuilder",checked:e}
            ]}
        ]},
        {xtype:"label",region:"south",margins:"10px",border:false,frame:false,text:Explore.i18n("CreateMASSourceNoteResultsAndLicense")}
    ],fbar:[
        {xtype:"button",itemId:"nextButton",text:"Next &rarr;",handler:this.doNextStep,scope:this,disabled:true},
        {xtype:"button",itemId:"cancelButton",text:"Cancel",handler:this.cancel,scope:this,disabled:false}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, c));
    Ext.MasSelectorForm.superclass.initComponent.apply(this, arguments);
    this.addEvents("towizard", {});
    this.addEvents("closeall");
    var d = this.getFooterToolbar().getByItemId("nextButton");
    var a = this.getByItemId("name");
    a.on("valid", function(g) {
        d.enable()
    });
    a.on("invalid", function(g) {
        d.disable()
    })
},doNextStep:function() {
    var a = this.getFormData(),b = this.editObject;
    b.Name = a.name;
    b.Description = a.description;
    this.fireEvent(a.sel, a.name, a.description)
},cancel:function() {
    this.fireEvent("closeall")
},getFormData:function() {
    var a = this.getByItemId("name").getValue();
    var b = this.getByItemId("description").getValue();
    var c = this.getByItemId("radioselection").getValue();
    return{name:a,description:b,sel:c.inputValue}
}});
Ext.reg("mas.selection.panel", Ext.MasSelectorForm);
Ext.ux.VrTabPanel = Ext.extend(Ext.Panel, {deferredRender:true,tabWidth:130,minTabWidth:30,resizeTabs:false,enableTabScroll:false,scrollIncrement:0,scrollRepeatInterval:400,scrollDuration:0.35,animScroll:true,tabPosition:"top",baseCls:"x-tab-panel x-vr-tab-panel",autoTabs:false,autoTabSelector:"div.x-tab",activeTab:undefined,tabMargin:2,plain:false,wheelIncrement:20,footerBodyWidth:false,idDelimiter:"__",itemCls:"x-tab-item",elements:"body",headerAsText:false,frame:false,hideBorders:true,initComponent:function() {
    this.frame = false;
    Ext.ux.VrTabPanel.superclass.initComponent.call(this);
    this.addEvents("beforetabchange", "tabchange", "contextmenu");
    this.setLayout(new Ext.layout.CardLayout(Ext.apply({layoutOnCardChange:this.layoutOnTabChange,deferredRender:this.deferredRender}, this.layoutConfig)));
    if (this.tabPosition == "top") {
        this.elements += ",header";
        this.stripTarget = "header"
    } else {
        this.elements += ",footer";
        this.stripTarget = "footer"
    }
    if (!this.stack) {
        this.stack = Ext.ux.VrTabPanel.AccessStack()
    }
    this.initItems()
},onRender:function(c, a) {
    Ext.ux.VrTabPanel.superclass.onRender.call(this, c, a);
    if (this.plain) {
        var f = this.tabPosition == "top" ? "header" : "footer";
        this[f].addClass("x-tab-panel-" + f + "-plain")
    }
    var b = this[this.stripTarget];
    this.stripWrap = b.createChild({cls:"x-tab-strip-wrap",cn:{tag:"ul",cls:"x-tab-strip x-tab-strip-" + this.tabPosition}});
    var e = (this.tabPosition == "bottom" ? this.stripWrap : null);
    b.createChild({cls:"x-tab-strip-spacer"}, e);
    this.strip = new Ext.Element(this.stripWrap.dom.firstChild);
    this.strip.createChild({cls:"x-clear"});
    this.body.addClass("x-tab-panel-body-" + this.tabPosition);
    if (!this.itemTpl) {
        var d = new Ext.Template('<li class="{cls}" id="{id}"><a class="x-tab-strip-close"></a>', '<a class="x-tab-right" href="#"><em class="x-tab-left">', '<span class="x-tab-strip-inner"><span class="x-tab-strip-text {iconCls}">{text}</span></span>', "</em></a></li>");
        d.disableFormats = true;
        d.compile();
        Ext.ux.VrTabPanel.prototype.itemTpl = d
    }
    this.items.each(this.initTab, this)
},afterRender:function() {
    Ext.ux.VrTabPanel.superclass.afterRender.call(this);
    if (this.autoTabs) {
        this.readTabs(false)
    }
    if (this.activeTab !== undefined) {
        var a = Ext.isObject(this.activeTab) ? this.activeTab : this.items.get(this.activeTab);
        delete this.activeTab;
        this.setActiveTab(a)
    }
},initEvents:function() {
    Ext.ux.VrTabPanel.superclass.initEvents.call(this);
    this.mon(this.strip, {scope:this,mousedown:this.onStripMouseDown,contextmenu:this.onStripContextMenu});
    if (this.enableTabScroll) {
        this.mon(this.strip, "mousewheel", this.onWheel, this)
    }
},findTargets:function(c) {
    var b = null,a = c.getTarget("li:not(.x-tab-edge)", this.strip);
    if (a) {
        b = this.getComponent(a.id.split(this.idDelimiter)[1]);
        if (b.disabled) {
            return{close:null,item:null,el:null}
        }
    }
    return{close:c.getTarget(".x-tab-strip-close", this.strip),item:b,el:a}
},onStripMouseDown:function(b) {
    if (b.button !== 0) {
        return
    }
    b.preventDefault();
    var a = this.findTargets(b);
    if (a.close) {
        if (a.item.fireEvent("beforeclose", a.item) !== false) {
            a.item.fireEvent("close", a.item);
            this.remove(a.item)
        }
        return
    }
    if (a.item && a.item != this.activeTab) {
        this.setActiveTab(a.item)
    }
},onStripContextMenu:function(b) {
    b.preventDefault();
    var a = this.findTargets(b);
    if (a.item) {
        this.fireEvent("contextmenu", this, a.item, b)
    }
},readTabs:function(d) {
    if (d === true) {
        this.items.each(function(g) {
            this.remove(g)
        }, this)
    }
    var c = this.el.query(this.autoTabSelector);
    for (var b = 0,a = c.length; b < a; b++) {
        var e = c[b],f = e.getAttribute("title");
        e.removeAttribute("title");
        this.add({title:f,contentEl:e})
    }
},initTab:function(d, b) {
    var e = this.strip.dom.childNodes[b],f = this.getTemplateArgs(d),c = e ? this.itemTpl.insertBefore(e, f) : this.itemTpl.append(this.strip, f),a = "x-tab-strip-over",g = Ext.get(c);
    g.hover(function() {
        if (!d.disabled) {
            g.addClass(a)
        }
    }, function() {
        g.removeClass(a)
    });
    if (d.tabTip) {
        g.child("span.x-tab-strip-text", true).qtip = d.tabTip
    }
    d.tabEl = c;
    g.select("a").on("click", function(h) {
        if (!h.getPageX()) {
            this.onStripMouseDown(h)
        }
    }, this, {preventDefault:true});
    d.on({scope:this,disable:this.onItemDisabled,enable:this.onItemEnabled,titlechange:this.onItemTitleChanged,iconchange:this.onItemIconChanged,beforeshow:this.onBeforeShowItem})
},getTemplateArgs:function(b) {
    var a = b.closable ? "x-tab-strip-closable" : "";
    if (b.disabled) {
        a += " x-item-disabled"
    }
    if (b.iconCls) {
        a += " x-tab-with-icon"
    }
    if (b.tabCls) {
        a += " " + b.tabCls
    }
    return{id:this.id + this.idDelimiter + b.getItemId(),text:b.title,cls:a,iconCls:b.iconCls || ""}
},onAdd:function(b) {
    Ext.ux.VrTabPanel.superclass.onAdd.call(this, b);
    if (this.rendered) {
        var a = this.items;
        this.initTab(b, a.indexOf(b));
        if (a.getCount() == 1) {
            this.syncSize()
        }
        this.delegateUpdates()
    }
},onBeforeAdd:function(b) {
    var a = b.events ? (this.items.containsKey(b.getItemId()) ? b : null) : this.items.get(b);
    if (a) {
        this.setActiveTab(b);
        return false
    }
    Ext.ux.VrTabPanel.superclass.onBeforeAdd.apply(this, arguments);
    var c = b.elements;
    b.elements = c ? c.replace(",header", "") : c;
    b.border = (b.border === true)
},onRemove:function(d) {
    var b = Ext.get(d.tabEl);
    if (b) {
        b.select("a").removeAllListeners();
        Ext.destroy(b)
    }
    Ext.ux.VrTabPanel.superclass.onRemove.call(this, d);
    this.stack.remove(d);
    delete d.tabEl;
    d.un("disable", this.onItemDisabled, this);
    d.un("enable", this.onItemEnabled, this);
    d.un("titlechange", this.onItemTitleChanged, this);
    d.un("iconchange", this.onItemIconChanged, this);
    d.un("beforeshow", this.onBeforeShowItem, this);
    if (d == this.activeTab) {
        var a = this.stack.next();
        if (a) {
            this.setActiveTab(a)
        } else {
            if (this.items.getCount() > 0) {
                this.setActiveTab(0)
            } else {
                this.setActiveTab(null)
            }
        }
    }
    if (!this.destroying) {
        this.delegateUpdates()
    }
},onBeforeShowItem:function(a) {
    if (a != this.activeTab) {
        this.setActiveTab(a);
        return false
    }
},onItemDisabled:function(b) {
    var a = this.getTabEl(b);
    if (a) {
        Ext.fly(a).addClass("x-item-disabled")
    }
    this.stack.remove(b)
},onItemEnabled:function(b) {
    var a = this.getTabEl(b);
    if (a) {
        Ext.fly(a).removeClass("x-item-disabled")
    }
},onItemTitleChanged:function(b) {
    var a = this.getTabEl(b);
    if (a) {
        Ext.fly(a).child("span.x-tab-strip-text", true).innerHTML = b.title
    }
},onItemIconChanged:function(d, a, c) {
    var b = this.getTabEl(d);
    if (b) {
        b = Ext.get(b);
        b.child("span.x-tab-strip-text").replaceClass(c, a);
        b[Ext.isEmpty(a) ? "removeClass" : "addClass"]("x-tab-with-icon")
    }
},getTabEl:function(a) {
    var b = this.getComponent(a);
    return b ? b.tabEl : null
},onResize:function() {
    this.header.applyStyles({display:"none"});
    Ext.ux.VrTabPanel.superclass.onResize.apply(this, arguments);
    this.header.applyStyles({display:"block"});
    this.delegateUpdates()
},beginUpdate:function() {
    this.suspendUpdates = true
},endUpdate:function() {
    this.suspendUpdates = false;
    this.delegateUpdates()
},hideTabStripItem:function(b) {
    b = this.getComponent(b);
    var a = this.getTabEl(b);
    if (a) {
        a.style.display = "none";
        this.delegateUpdates()
    }
    this.stack.remove(b)
},unhideTabStripItem:function(b) {
    b = this.getComponent(b);
    var a = this.getTabEl(b);
    if (a) {
        a.style.display = "";
        this.delegateUpdates()
    }
},delegateUpdates:function() {
    if (this.suspendUpdates) {
        return
    }
    if (this.resizeTabs && this.rendered) {
    }
    if (this.enableTabScroll && this.rendered) {
    }
    this.adjustBodySize()
},adjustBodySize:function() {
    var a = this.tabWidth;
    if (Ext.isNumber(a)) {
        var c = this.body,d = c.getWidth(),b = d - a;
        this.adjustBodyWidth(a);
        if (b) {
            c.setWidth(b);
            if (this.footer && this.footerBodyWidth) {
                this.footer.setWidth(b)
            }
        }
    }
},autoSizeTabs:function() {
    var g = this.items.length,b = this.tabPosition != "bottom" ? "header" : "footer",c = this[b].dom.offsetWidth,a = this[b].dom.clientWidth;
    if (!this.resizeTabs || g < 1 || !a) {
        return
    }
    var j = Math.max(Math.min(Math.floor((a - 4) / g) - this.tabMargin, this.tabWidth), this.minTabWidth);
    this.lastTabWidth = j;
    var l = this.strip.query("li:not(.x-tab-edge)");
    for (var e = 0,h = l.length; e < h; e++) {
        var k = l[e],m = Ext.fly(k).child(".x-tab-strip-inner", true),f = k.offsetWidth,d = m.offsetWidth;
        m.style.width = (j - (f - d)) + "px"
    }
},adjustBodyWidth:function(a) {
    if (this.header) {
        this.header.setWidth(a)
    }
    if (this.footer && !this.footerBodyWidth) {
        this.footer.setWidth(a)
    }
    return a
},setActiveTab:function(c) {
    c = this.getComponent(c);
    if (this.fireEvent("beforetabchange", this, c, this.activeTab) === false) {
        return
    }
    if (!this.rendered) {
        this.activeTab = c;
        return
    }
    if (this.activeTab != c) {
        if (this.activeTab) {
            var a = this.getTabEl(this.activeTab);
            if (a) {
                Ext.fly(a).removeClass("x-tab-strip-active")
            }
        }
        if (c) {
            var b = this.getTabEl(c);
            Ext.fly(b).addClass("x-tab-strip-active");
            this.activeTab = c;
            this.stack.add(c);
            this.layout.setActiveItem(c);
            if (this.scrolling) {
                this.scrollToTab(c, this.animScroll)
            }
        }
        this.fireEvent("tabchange", this, c)
    }
},getActiveTab:function() {
    return this.activeTab || null
},getItem:function(a) {
    return this.getComponent(a)
},autoScrollTabs:function() {
    this.pos = this.tabPosition == "bottom" ? this.footer : this.header;
    var g = this.items.length,d = this.pos.dom.offsetHeight,c = this.pos.dom.clientHeight,f = this.stripWrap,e = f.dom,b = e.offsetHeight,h = this.getScrollPos(),a = b + h + 10;
    if (!this.enableTabScroll || g < 1 || b < 20) {
        return
    }
    if (a <= c) {
        e.scrollTop = 0;
        f.setHeight(c);
        if (this.scrolling) {
            this.scrolling = false;
            this.pos.removeClass("x-tab-scrolling");
            this.scrollTop.hide();
            this.scrollBottom.hide();
            if (Ext.isAir || Ext.isWebKit) {
            }
        }
    } else {
        if (!this.scrolling) {
            this.pos.addClass("x-tab-scrolling");
            if (Ext.isAir || Ext.isWebKit) {
            }
        }
        c -= f.getMargins("tb");
        f.setHeight(c > 20 ? c : 20);
        if (!this.scrolling) {
            if (!this.scrollTop) {
                this.createScrollers()
            } else {
                this.scrollTop.show();
                this.scrollBottom.show()
            }
        }
        this.scrolling = true;
        if (h > (a - c)) {
            e.scrollTop = a - c
        } else {
            this.scrollToTab(this.activeTab, false)
        }
        this.updateScrollButtons()
    }
},createScrollers:function() {
    this.header.addClass("x-tab-scrolling-" + this.tabPosition);
    var c = this.tabWidth,b = this.stripWrap;
    b.setWidth(c);
    b.applyStyles({margin:"0"});
    var a = this.header.insertFirst({cls:"x-tab-scroller-top"});
    a.setWidth(c);
    a.addClassOnOver("x-tab-scroller-top-over");
    this.leftRepeater = new Ext.util.ClickRepeater(a, {interval:this.scrollRepeatInterval,handler:this.onscrollTop,scope:this});
    this.scrollTop = a;
    var d = this.stripWrap.insertSibling({cls:"x-tab-scroller-bottom"}, "after");
    d.setWidth(c);
    d.addClassOnOver("x-tab-scroller-bottom-over");
    this.rightRepeater = new Ext.util.ClickRepeater(d, {interval:this.scrollRepeatInterval,handler:this.onscrollBottom,scope:this});
    this.scrollBottom = d
},getScrollHeight:function() {
    return this.getScrollPos()
},getScrollPos:function() {
    return parseInt(this.stripWrap.dom.scrollTop, 10) || 0
},getScrollArea:function() {
    return parseInt(this.stripWrap.dom.clientHeight, 10) || 0
},getScrollAnim:function() {
    return{duration:this.scrollDuration,callback:this.updateScrollButtons,scope:this}
},getScrollIncrement:function() {
    return this.scrollIncrement || (this.resizeTabs ? this.lastTabWidth + 2 : 100)
},scrollToTab:function(e, b) {
    if (!e) {
        return
    }
    var c = this.getTabEl(e),g = this.getScrollPos(),d = this.getScrollArea(),f = Ext.fly(c).getOffsetsTo(this.stripWrap)[0] + g,a = f + c.offsetHeight;
    if (f < g) {
        this.scrollTo(f, b)
    } else {
        if (a > (g + d)) {
            this.scrollTo(a - d, b)
        }
    }
},scrollTo:function(b, a) {
    this.stripWrap.scrollTo("top", b, a ? this.getScrollAnim() : false);
    if (!a) {
        this.updateScrollButtons()
    }
},onWheel:function(f) {
    var g = f.getWheelDelta() * this.wheelIncrement * -1;
    f.stopEvent();
    var h = this.getScrollPos(),c = h + g,a = this.getScrollHeight() - this.getScrollArea();
    var b = Math.max(0, Math.min(a, c));
    if (b != h) {
        this.scrollTo(b, false)
    }
},onscrollBottom:function() {
    var a = this.getScrollHeight() - this.getScrollArea(),c = this.getScrollPos(),b = Math.min(a, c + this.getScrollIncrement());
    if (b != c) {
        this.scrollTo(b, this.animScroll)
    }
},onscrollTop:function() {
    var b = this.getScrollPos(),a = Math.max(0, b - this.getScrollIncrement());
    if (a != b) {
        this.scrollTo(a, this.animScroll)
    }
},updateScrollButtons:function() {
    var a = this.getScrollPos();
    this.scrollTop[a === 0 ? "addClass" : "removeClass"]("x-tab-scroller-left-disabled");
    this.scrollBottom[a >= (this.getScrollHeight() - this.getScrollArea()) ? "addClass" : "removeClass"]("x-tab-scroller-right-disabled")
},beforeDestroy:function() {
    Ext.destroy(this.leftRepeater, this.rightRepeater);
    this.deleteMembers("strip", "edge", "scrollTop", "scrollBottom", "stripWrap");
    this.activeTab = null;
    Ext.ux.VrTabPanel.superclass.beforeDestroy.apply(this)
}});
Ext.reg("vrtabpanel", Ext.ux.VrTabPanel);
Ext.ux.VrTabPanel.prototype.activate = Ext.ux.VrTabPanel.prototype.setActiveTab;
Ext.ux.VrTabPanel.AccessStack = function() {
    var a = [];
    return{add:function(b) {
        a.push(b);
        if (a.length > 10) {
            a.shift()
        }
    },remove:function(e) {
        var d = [];
        for (var c = 0,b = a.length; c < b; c++) {
            if (a[c] != e) {
                d.push(a[c])
            }
        }
        a = d
    },next:function() {
        return a.pop()
    }}
};
Ext.ns("ExploreAutomation.wizard");
ExploreAutomation.wizard.FiltersFormPanel = Ext.extend(Ext.form.FormPanel, {padding:10,initComponent:function() {
    var a = {autoScroll:true,items:[
        {xtype:"box",data:{},tpl:new Ext.XTemplate("<h1>Select Your Filters</h1>", "<p>Enter filters to limit the number of results. You can use multiple filters at once.</p>"),tplMode:"overwrite"},
        ExploreAutomation.SearchFormHelper.getPublicInformationSourceFiltersFieldset(),
        ExploreAutomation.SearchFormHelper.getCustomerGuidFieldSet(),
        ExploreAutomation.SearchFormHelper.getDateFiltersFieldset(),
        ExploreAutomation.SearchFormHelper.getLanguageFiltersFieldset()
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, a));
    ExploreAutomation.wizard.FiltersFormPanel.superclass.initComponent.apply(this, arguments)
},onRender:function() {
    ExploreAutomation.wizard.FiltersFormPanel.superclass.onRender.apply(this, arguments)
}});
Ext.reg("exploreautomation.wizard.filtersformpanel", ExploreAutomation.wizard.FiltersFormPanel);
Ext.ns("ExploreAutomation.wizard");
ExploreAutomation.wizard.JumpstartWizard = Ext.extend(Ext.Window, {cls:"jumpstart-wizard",title:"Autonomy Media Aggregation Wizard",closeAction:"hide",width:650,height:500,modal:true,manager:Ext.WindowMgr,animCollapse:false,autoShow:true,renderTo:Ext.getBody(),sourceName:"",initComponent:function() {
    var a = {layout:"fit",items:[
        {padding:5,xtype:"vrtabpanel",deferredRender:false,tabWidth:170,itemId:"wizard",footerBodyWidth:false,activeTab:0,listeners:{tabchange:{fn:this.onTabChange,scope:this},beforetabchange:{fn:this.onBeforeTabChange,scope:this}},items:[
            {xtype:"panel",itemId:"overview",title:"Overview",layout:"fit",height:"100%",items:[
                {xtype:"box",data:{},tpl:new Ext.XTemplate("<h1>Overview</h1>", "<h2>What is a Media Aggregation Source?</h2>", "<p>A Media Aggregation Source is a collection of terms or concepts and filter criteria that you define.  ", "A Media Aggregation Source queries the content cloud and aggregates a set of results on a scheduled basis.  ", "Think of it as likes an RSS News Feed, but against a much larger set of data (we have the worlds social media and broadcast content).  ", "Media Aggregation Sources help you  define a set of results that you want to work with on a on-going basis. ", "</p>", "<p>It helps to organize your query parameters in categories like Brand Names, ", "Competitors, Products or Industry though they may remain uncategorized.</p>"),tplMode:"overwrite"}
            ]},
            {xtype:"panel",itemId:"topicProfile",title:"Source Name",data:{sourceName:this.sourceName,projectName:this.projectName},tpl:new Ext.XTemplate("<h1>Name Your Media Aggregation Source</h1>", "<p>The name you choose for your Media Aggregation Source should uniquely describe your source, ", "which will allow you to easily locate and work with it in Autonomy Explore.</p>", '<fieldset class="x-fieldset">', "<legend>Your Media Aggregation Source</legend>", "<label><b>Source Name: </b></label> {sourceName} <br/>", "</fieldset>", "<p>Please note:  once you configure this source, results will be moved to your ", "Autonomy Explore IDOL and will count against your licensed Authorized Documents.  ", "You may need to purge data from your Autonomy Explore IDOL should you reach your document limit</p>"),tplMode:"overwrite"},
            {itemId:"brands",title:"Brands (Optional)",typeLabel:"Brand",typeLabelPlural:"Brands",xtype:"exploreautomation.wizard.keytermsformpanel",descriptionTpl:new Ext.XTemplate("<h1>Define Your Brands</h1>", "<p>Enter keywords or concepts that you wish to track about your Brand.  ", 'You can use multiple keywords or concepts by continuing to "Add" items.  ', "Add keywords or concepts that you wish to exclude from your Media Aggregation Source.  ", "This will ensure these terms do not show up in your Media Aggregation Source.</p>")},
            {itemId:"competitors",title:"Competitors (Optional)",xtype:"exploreautomation.wizard.keytermsformpanel",typeLabel:"Competitor",typeLabelPlural:"Competitors",descriptionTpl:new Ext.XTemplate("<h1>Define Your Competitors</h1>", "<p>Enter keywords or concepts that you wish to track about your Competitors.  ", 'You can use multiple keywords or concepts by continuing to "Add" items.  ', "Add keywords or concepts that you wish to exclude from your MediaAggregation Source.  ", "This will ensure these terms do not show up in your Media Aggregation Source.</p>")},
            {itemId:"industry",title:"Industry (Optional)",xtype:"exploreautomation.wizard.keytermsformpanel",typeLabel:"Industry",typeLabelPlural:"Industries",descriptionTpl:new Ext.XTemplate("<h1>Define Your Industry</h1>", "<p>Enter keywords or concepts that you wish to track about your Industry.  ", 'You can use multiple keywords or concepts by continuing to "Add" items.  ', "Add keywords or concepts that you wish to exclude from your Media Aggregation Source.  ", "This will ensure these terms do not show up in your Media Aggregation Source.</p>")},
            {itemId:"keyTerms",title:"Key Terms or Concepts",xtype:"exploreautomation.wizard.keytermsformpanel"},
            {title:"Filters",xtype:"exploreautomation.wizard.filtersformpanel",itemId:"filters",width:"100%"},
            {title:"Summary",itemId:"summary",idolACIUrl:app.getProperty("idol.aci.url"),xtype:"exploreautomation.wizard.summarypanel"}
        ]}
    ],fbar:[
        {xtype:"button",itemId:"prevButton",text:"&larr; Previous",disabled:true,handler:this.doPreviousStep,scope:this},
        {xtype:"button",itemId:"nextButton",text:"Next &rarr;",handler:this.doNextStep,scope:this},
        {xtype:"button",itemId:"imDoneButton",text:"I'm Done",handler:this.goToSummary,scope:this,disabled:true},
        {xtype:"button",itemId:"previewResultsButton",text:"Preview Results",handler:this.previewResults,scope:this,disabled:true}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, a));
    ExploreAutomation.wizard.JumpstartWizard.superclass.initComponent.apply(this, arguments);
    this.addEvents("settingschange")
},onRender:function() {
    ExploreAutomation.wizard.JumpstartWizard.superclass.onRender.apply(this, arguments)
},doPreviousStep:function() {
    var c = this.getByItemId("wizard");
    var a = c.getActiveTab();
    var b = a.previousSibling();
    if (b) {
        c.activate(b)
    }
},doNextStep:function() {
    var c = this.getByItemId("wizard");
    var a = c.getActiveTab();
    var b = a.nextSibling();
    if (b) {
        c.activate(b)
    }
},goToSummary:function() {
    var a = this.getByItemId("wizard");
    a.activate(this.getByItemId("summary"))
},previewResults:function() {
    var a = this.getFormValues();
    this.fireEvent("settingschange", a);
    this.hide()
},onBeforeTabChange:function(e, g, f) {
    if (f) {
        var c = false;
        var d = f.findByType("form");
        if (f.getXTypes().split("/").indexOf("form") >= 0) {
            d.push(f)
        }
        if (d) {
            for (var b = 0; b < d.length; b++) {
                var a = d[b];
                if (!a.getForm().isValid()) {
                    Ext.Msg.show({title:"Error",msg:"Please complete the form(s) before continuing.",animEl:this,buttons:Ext.Msg.OK});
                    this.toBack.defer(10, this);
                    c = true
                }
            }
        }
        return !c
    }
},onTabChange:function(d, f) {
    var e = this.getFooterToolbar();
    var c = e.getByItemId("nextButton");
    c.setDisabled(f.nextSibling() == null);
    var a = e.getByItemId("prevButton");
    a.setDisabled(f.previousSibling() == null);
    var b = f.getItemId();
    e.getByItemId("imDoneButton").setDisabled(!(b == "keyTerms" || b == "filters"));
    e.getByItemId("previewResultsButton").setDisabled(!(b == "summary"))
},getFormValues:function() {
    var d = this.findByType("form");
    var g = {};
    var h = "";
    for (var f = 0; f < d.length; f++) {
        var c = d[f];
        var b = c.getForm();
        var j = b.getSubmittableFieldValues();
        g = Ext.applyIf(g, j);
        var l = ExploreAutomation.SearchFormHelper.computeDatabaseMatch(j);
        if (l) {
            h = l
        }
    }
    var n = [];
    var m = [];
    for (var e in g) {
        if (e.indexOf("boolean.any") >= 0) {
            var a = g[e].indexOf('"') != 0;
            n.push((a ? '"' : "") + g[e] + (a ? '"' : ""));
            delete g[e]
        }
    }
    for (var e in g) {
        if (e.indexOf("boolean.not") >= 0) {
            var a = g[e].indexOf('"') != 0;
            m.push((a ? '"' : "") + g[e] + (a ? '"' : ""));
            delete g[e]
        }
    }
    g["boolean.any"] = n.join(" ");
    g["boolean.not"] = m.join(" ");
    g.databasematch = h.split(",");
    return g
}});
Ext.reg("exploreautomation.jumpstartwizard", ExploreAutomation.wizard.JumpstartWizard);
Ext.ns("ExploreAutomation.wizard");
ExploreAutomation.wizard.KeyTermsFormPanel = Ext.extend(Ext.form.FormPanel, {padding:10,typeLabelPlural:"terms or concepts",typeLabel:"Term or Concept",descriptionTpl:new Ext.XTemplate("<h1>Define Your Key Terms or Concepts</h1>", "<p>Enter terms or concepts that want to use to find relevant results.  ", "You can use multiple search terms or concepts by using the wizard or importing from a list.</p>", "<p>Also, add terms or concepts you wish to exclude from your results set.  ", "This will ensure you do not push unneeded results to your Autonomy Explore IDOL.</p>", "<p>Some examples of terms or concepts are brands, competitors, products or industries.</p>"),initComponent:function() {
    var a = {autoScroll:true,items:[
        {xtype:"box",data:{sourceName:this.sourceName},tpl:this.descriptionTpl,tplMode:"overwrite"},
        {itemId:"includeTermsFieldset",hideLabel:true,labelWidth:1,xtype:"fieldset",title:"Include these " + this.typeLabelPlural,items:[
            {xtype:"container",layout:"hbox",items:[
                {xtype:"button",itemId:"add",text:"Add " + this.typeLabel,margins:{top:0,right:10,bottom:0,left:0},listeners:{scope:this,click:function() {
                    var c = ExploreAutomation.SearchFormHelper.addDynamicField(this.includeFieldTemplate, this.getByItemId("includeTermsFieldset"));
                    var b = c.items.first();
                    b.focus()
                }}},
                {xtype:"button",itemId:"suggest",text:"Suggest More",disabled:true,listeners:{scope:this,click:function(d, f) {
                    var b = this.getTextFromFieldset(this.getByItemId("includeTermsFieldset"));
                    if (b.trim() === "") {
                        d.ownerCt.get("add").focus();
                        d.disable();
                        return
                    }
                    var c = new ExploreAutomation.IDOLSuggestWindow({idolACIUrl:app.getProperty("idol.aci.url"),suggestText:b,listeners:{scope:this,suggest:function(h) {
                        for (var e = 0;
                             e < h.length; ++e) {
                            var g = ExploreAutomation.SearchFormHelper.addDynamicField(this.includeFieldTemplate, this.getByItemId("includeTermsFieldset"));
                            g.items.itemAt(0).setValue(h[e])
                        }
                    }}});
                    c.show()
                }}}
            ]}
        ]},
        {itemId:"excludeTermsFieldset",hideLabel:true,labelWidth:1,xtype:"fieldset",title:"Exclude these " + this.typeLabelPlural + " from results",items:[
            {xtype:"container",layout:"hbox",items:[
                {xtype:"button",itemId:"add",text:"Add " + this.typeLabel,margins:{top:0,right:10,bottom:0,left:0},listeners:{scope:this,click:function() {
                    var c = ExploreAutomation.SearchFormHelper.addDynamicField(this.excludeFieldTemplate, this.getByItemId("excludeTermsFieldset"));
                    var b = c.items.first();
                    b.focus()
                }}},
                {xtype:"button",itemId:"suggest",text:"Suggest More",disabled:true,listeners:{scope:this,click:function(d, f) {
                    var b = this.getTextFromFieldset(this.getByItemId("excludeTermsFieldset"));
                    if (b.trim() === "") {
                        d.ownerCt.get("add").focus();
                        d.disable();
                        return
                    }
                    var c = new ExploreAutomation.IDOLSuggestWindow({idolACIUrl:app.getProperty("idol.aci.url"),suggestText:b,listeners:{scope:this,suggest:function(h) {
                        for (var e = 0;
                             e < h.length; ++e) {
                            var g = ExploreAutomation.SearchFormHelper.addDynamicField(this.excludeFieldTemplate, this.getByItemId("excludeTermsFieldset"));
                            g.items.itemAt(0).setValue(h[e])
                        }
                    }}});
                    c.show()
                }}}
            ]}
        ]}
    ]};
    this.includeFieldTemplate = {xtype:"compositefield",id:"boolean.any.composite",fieldLabel:" ",labelSeparator:"",labelWidth:1,cls:"dynamic-form-field",items:[
        {xtype:"textfield",flex:2,enableKeyEvents:true,name:"boolean.any",allowBlank:false,emptyText:"Enter " + this.typeLabel.toLowerCase(),fieldLabel:null,listeners:{scope:this,keyup:function(f, d) {
            var c = "boolean.any.";
            var g = Ext.getCmp(c + "composite." + f.name.substring(c.length));
            var b = g.findParentByType("fieldset");
            this.checkFieldsInFieldset(b)
        },specialkey:function(d, c) {
            if (c.getKey() == c.ENTER) {
                var f = ExploreAutomation.SearchFormHelper.addDynamicField(this.includeFieldTemplate, this.getByItemId("includeTermsFieldset"));
                var b = f.items.first();
                b.focus()
            }
        }}},
        {xtype:"button",text:"Remove",name:"boolean.any.remove",fieldLabel:null,listeners:{click:function(c, f) {
            var d = c.name.split(".");
            var h = d[d.length - 1];
            var g = Ext.getCmp("boolean.any.composite." + h);
            var b = g.findParentByType("fieldset");
            b.remove.defer(10, b, [g])
        }}}
    ]};
    this.excludeFieldTemplate = {xtype:"compositefield",id:"boolean.not.composite",fieldLabel:" ",labelSeparator:"",labelWidth:1,cls:"dynamic-form-field",items:[
        {xtype:"textfield",flex:2,enableKeyEvents:true,name:"boolean.not",allowBlank:false,emptyText:"Enter " + this.typeLabel.toLowerCase(),fieldLabel:null,listeners:{scope:this,keyup:function(f, d) {
            var c = "boolean.not.";
            var g = Ext.getCmp(c + "composite." + f.name.substring(c.length));
            var b = g.findParentByType("fieldset");
            this.checkFieldsInFieldset(b)
        },specialkey:function(d, c) {
            if (c.getKey() == c.ENTER) {
                var f = ExploreAutomation.SearchFormHelper.addDynamicField(this.excludeFieldTemplate, this.getByItemId("excludeTermsFieldset"));
                var b = f.items.first();
                b.focus()
            }
        }}},
        {xtype:"button",text:"Remove",name:"boolean.not.remove",fieldLabel:null,listeners:{click:function(c, f) {
            var d = c.name.split(".");
            var h = d[d.length - 1];
            var g = Ext.getCmp("boolean.not.composite." + h);
            var b = g.findParentByType("fieldset");
            b.remove.defer(10, b, [g])
        }}}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, a));
    ExploreAutomation.wizard.KeyTermsFormPanel.superclass.initComponent.apply(this, arguments)
},onRender:function() {
    ExploreAutomation.wizard.KeyTermsFormPanel.superclass.onRender.apply(this, arguments);
    var a = {scope:this,remove:this.checkFieldsInFieldset};
    this.getByItemId("includeTermsFieldset").on(a);
    this.getByItemId("excludeTermsFieldset").on(a)
},checkFieldsInFieldset:function(c) {
    var b = c.findByType("textfield");
    var d = false;
    if (b.length === 0) {
        d = false
    } else {
        if (b.length == 1) {
            d = (b[0].getValue() !== "")
        } else {
            var e = true;
            for (var a = 0; a < b.length;
                 ++a) {
                if (b[a].getValue() !== "") {
                    e = false;
                    break
                }
            }
            d = !e
        }
    }
    c.getByItemId("suggest").setDisabled(!d)
},getTextFromFieldset:function(c) {
    var b = c.findByType("textfield");
    var d = [];
    for (var a = 0; a < b.length; ++a) {
        if (b[a].getValue() !== "") {
            d.push(b[a].getValue())
        }
    }
    return d.join(" ")
}});
Ext.reg("exploreautomation.wizard.keytermsformpanel", ExploreAutomation.wizard.KeyTermsFormPanel);
Ext.ns("ExploreAutomation.wizard");
ExploreAutomation.wizard.SummaryPanel = Ext.extend(Ext.Panel, {layout:"border",width:"100%",padding:10,defaultSearchParams:{text:"*"},idolACIUrl:"",baseParams:{totalresults:"true",text:"*",print:"NoResults",template:"NoNamespace",combine:"Simple"},exportFormValues:{},initComponent:function() {
    var a = {autoScroll:true,items:[
        {region:"center",xtype:"box",data:{},tpl:new Ext.XTemplate("<h1>Summary</h1>", "<p>Based on the information you entered in the JumpStart Guide, here is an overview of your resulting source.</p>", "<p>Your estimated ", (app.getProperty("estimation.type") == "monthly" ? "monthly" : "weekly"), " volume provides an estimate of anticipated number of results in your source.  ", "Actual volume may vary based on activity generated on the social web.</p>", '<p>To increase or decrease the number of results choose the "Previous" button below.</p>'),tplMode:"overwrite"},
        {xtype:"panel",itemId:"chartContainer",layout:"fit",height:150,region:"south",title:"Estimated Volume"}
    ],searchUrl:this.idolACIUrl + "/?action=query"};
    Ext.apply(this, Ext.apply(this.initialConfig, a));
    ExploreAutomation.wizard.SummaryPanel.superclass.initComponent.apply(this, arguments);
    this.chartConfig = {height:150,region:"south",itemId:"estimationChart",xtype:"exploreautomation.estimationchart",border:false,title:"",estimationType:app.getProperty("estimation.type"),numberOfDays:app.getProperty("estimation.numdays"),adjustmentFactor:app.getProperty("estimation.adjustment")};
    this.on("activate", this.doSearch, this);
    this.on("deactivate", this.removeChart, this)
},onRender:function() {
    ExploreAutomation.wizard.SummaryPanel.superclass.onRender.apply(this, arguments);
    this.loadMask = new Ext.LoadMask(this.el, {msg:"Searching..."})
},doSearch:function() {
    var g = this.ownerCt.findByType("form");
    var e = {};
    for (var c = 0; c < g.length; c++) {
        var a = g[c];
        var d = a.getForm();
        var b = ExploreAutomation.SearchFormHelper.computeQueryParts(d, true, this.computeText);
        e = Ext.applyIf(e, b);
        if (e.text && b.text) {
            e.text = e.text + " (" + b.text + ")"
        }
    }
    e = Ext.applyIf(e, this.defaultSearchParams);
    var f = Ext.applyIf(e, this.baseParams);
    if (f.daterange) {
        f.minDate = f.daterange[0] && f.daterange[0].format("d/m/Y") || "";
        f.maxDate = f.daterange[1] && f.daterange[1].format("d/m/Y") || ""
    }
    delete f.daterange;
    this.loadMask.show();
    Ext.Ajax.request({method:"GET",url:this.searchUrl,isMASRequest:true,disableCaching:false,params:f,success:this.handleSearchSuccess,failure:this.handleSearchError,scope:this,timeout:parseInt(app.getProperty("ui.query.timeoutmillis"))})
},handleSearchSuccess:function(b, c) {
    var d = this.getByItemId("estimationChart");
    var e = b.responseXML;
    var f = Ext.DomQuery.selectValue("autnresponse > response", e);
    if (f != "SUCCESS") {
        Ext.Msg.alert("Error", "The search query encountered an error.");
        return
    }
    var a = Ext.DomQuery.selectNumber("responsedata > totalhits", e);
    this.loadMask.hide();
    log.info("Number of Hits: " + a);
    this.chartConfig.numTotalResults = a;
    this.getByItemId("chartContainer").add(Ext.create(this.chartConfig));
    this.doLayout()
},handleSearchError:function(a, b) {
    this.loadMask.hide();
    Ext.Msg.alert("Error", "Query Timed Out")
},removeChart:function() {
    var a = this.getByItemId("chartContainer").remove("estimationChart", true)
},computeText:function(d) {
    var f = d.getSubmittableFieldValues();
    var g = null;
    var c = [];
    var h = [];
    var e = [];
    for (var a in f) {
        if (a.indexOf("boolean.any") >= 0) {
            var b = f[a].indexOf('"') != 0;
            c.push((b ? '"' : "") + f[a] + (b ? '"' : ""))
        }
    }
    for (var a in f) {
        if (a.indexOf("boolean.not") >= 0) {
            var b = f[a].indexOf('"') != 0;
            h.push((b ? '"' : "") + f[a] + (b ? '"' : ""))
        }
    }
    if (c.length > 0) {
        e.push("(" + c.join(" ") + ")")
    }
    if (h.length > 0) {
        e.push("NOT (" + h.join(" ") + ")")
    }
    g = e.length > 0 ? e.join(" AND ") : null;
    return g
}});
Ext.reg("exploreautomation.wizard.summarypanel", ExploreAutomation.wizard.SummaryPanel);
Ext.MasWizardPanel = Ext.extend(Ext.Panel, {cls:"jumpstart-wizard-panel",width:650,height:550,manager:Ext.WindowMgr,animCollapse:false,autoShow:true,sourceName:"",initComponent:function() {
    var a = {layout:"fit",id:"maswizard",itemId:"wizardpanel",listeners:{setjobname:this.setJobName},items:[
        {xtype:"vrtabpanel",deferredRender:false,tabWidth:170,itemId:"wizard",footerBodyWidth:false,activeTab:0,listeners:{tabchange:{fn:this.onTabChange,scope:this},beforetabchange:{fn:this.onBeforeTabChange,scope:this}},items:[
            {xtype:"panel",itemId:"overview",title:"Overview",layout:"fit",height:"100%",items:[
                {xtype:"box",data:{},tpl:new Ext.XTemplate("<h1>Overview</h1>", "<h2>What is a Media Aggregation Source?</h2>", "<p>A Media Aggregation Source is a collection of terms or concepts and filter criteria that you define.  ", "A Media Aggregation Source queries the content cloud and aggregates a set of results on a scheduled basis.  ", "Think of it as likes an RSS News Feed, but against a much larger set of data (we have the worlds social media and broadcast content).  ", "Media Aggregation Sources help you  define a set of results that you want to work with on a on-going basis. ", "</p>", "<p>It helps to organize your query parameters in categories like Brand Names, ", "Competitors, Products or Industry though they may remain uncategorized.</p>"),tplMode:"overwrite"}
            ]},
            {xtype:"panel",itemId:"topicProfile",title:"Source Name",data:{sourceName:this.sourceName},tpl:new Ext.XTemplate("<h1>Name Your Media Aggregation Source</h1>", "<p>The name you choose for your Media Aggregation Source should uniquely describe your source, ", "which will allow you to easily locate and work with it in Autonomy Explore.</p>", '<fieldset class="x-fieldset">', "<legend>Your Media Aggregation Source</legend>", "<label><b>Source Name: </b></label> {sourceName} <br/>", "</fieldset>", "<p>Please note:  once you configure this source, results will be moved to your ", "Autonomy Explore IDOL and will count against your licensed Authorized Documents.  ", "You may need to purge data from your Autonomy Explore IDOL should you reach your document limit</p>"),tplMode:"overwrite",setJobName:function(b) {
                this.sourceName = b;
                var c = this.tpl;
                c.overwrite(this.body, {sourceName:this.sourceName})
            }},
            {itemId:"brands",title:"Brands (Optional)",typeLabel:"Brand",typeLabelPlural:"Brands",xtype:"exploreautomation.wizard.keytermsformpanel",descriptionTpl:new Ext.XTemplate("<h1>Define Your Brands</h1>", "<p>Enter keywords or concepts that you wish to track about your Brand.  ", 'You can use multiple keywords or concepts by continuing to "Add" items.  ', "Add keywords or concepts that you wish to exclude from your Media Aggregation Source.  ", "This will ensure these terms do not show up in your Media Aggregation Source.</p>")},
            {itemId:"competitors",title:"Competitors (Optional)",xtype:"exploreautomation.wizard.keytermsformpanel",typeLabel:"Competitor",typeLabelPlural:"Competitors",descriptionTpl:new Ext.XTemplate("<h1>Define Your Competitors</h1>", "<p>Enter keywords or concepts that you wish to track about your Competitors.  ", 'You can use multiple keywords or concepts by continuing to "Add" items.  ', "Add keywords or concepts that you wish to exclude from your Media Aggregation Source.  ", "This will ensure these terms do not show up in your Media Aggregation Source.</p>")},
            {itemId:"industry",title:"Industry (Optional)",xtype:"exploreautomation.wizard.keytermsformpanel",typeLabel:"Industry",typeLabelPlural:"Industries",descriptionTpl:new Ext.XTemplate("<h1>Define Your Industry</h1>", "<p>Enter keywords or concepts that you wish to track about your Industry.  ", 'You can use multiple keywords or concepts by continuing to "Add" items.  ', "Add keywords or concepts that you wish to exclude from your Media Aggregation Source.  ", "This will ensure these terms do not show up in your Media Aggregation Source.</p>")},
            {itemId:"keyTerms",title:"Key Terms or Concepts",xtype:"exploreautomation.wizard.keytermsformpanel"},
            {title:"Filters",xtype:"exploreautomation.wizard.filtersformpanel",itemId:"filters",width:"100%"},
            {title:"Summary",itemId:"summary",idolACIUrl:app.getProperty("idol.aci.url"),xtype:"exploreautomation.wizard.summarypanel"}
        ]}
    ],fbar:[
        {xtype:"button",itemId:"prevButton",text:"&larr; Previous",disabled:false,handler:this.doPreviousStep,scope:this},
        {xtype:"button",itemId:"nextButton",text:"Next &rarr;",handler:this.doNextStep,scope:this},
        {xtype:"button",itemId:"previewResultsButton",hidden:true,text:"Preview Results",handler:this.previewResults,scope:this},
        {xtype:"button",itemId:"cancelButton",text:"Cancel",handler:this.btnCancelAction,scope:this}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, a));
    Ext.MasWizardPanel.superclass.initComponent.apply(this, arguments)
},setJobName:function(a) {
    var b = this.getByItemId("topicProfile");
    b.setJobName(a)
},btnCancelAction:function() {
    this.fireEvent("closeall")
},onRender:function() {
    Ext.MasWizardPanel.superclass.onRender.apply(this, arguments)
},doPreviousStep:function() {
    var c = this.getByItemId("wizard");
    var a = c.getActiveTab();
    var b = a.previousSibling();
    if (b) {
        c.activate(b)
    } else {
        this.fireEvent("toselectionform")
    }
},doNextStep:function() {
    var c = this.getByItemId("wizard");
    var a = c.getActiveTab();
    var b = a.nextSibling();
    if (b) {
        c.activate(b)
    }
},goToSummary:function() {
    var a = this.getByItemId("wizard");
    a.activate(this.getByItemId("summary"))
},previewResults:function() {
    var a = this.getFormValues();
    this.fireEvent("settingschange", a)
},onBeforeTabChange:function(e, g, f) {
    if (f) {
        var c = false;
        var d = f.findByType("form");
        if (f.getXTypes().split("/").indexOf("form") >= 0) {
            d.push(f)
        }
        if (d) {
            for (var b = 0; b < d.length; b++) {
                var a = d[b];
                if (!a.getForm().isValid()) {
                    Ext.Msg.show({title:"Error",msg:"Please complete the form(s) before continuing.",autoShow:true,animEl:"maswizard",buttons:Ext.Msg.OK});
                    c = true
                }
            }
        }
        return !c
    }
},onTabChange:function(c, e) {
    var d = this.getFooterToolbar();
    var b = d.getByItemId("nextButton");
    var a = d.getByItemId("previewResultsButton");
    if ((e.nextSibling() == null)) {
        b.hide();
        a.show()
    } else {
        b.show();
        a.hide()
    }
},getFormValues:function() {
    var d = this.findByType("form");
    var g = {};
    var h = "";
    for (var f = 0; f < d.length; f++) {
        var c = d[f];
        var b = c.getForm();
        var j = b.getSubmittableFieldValues();
        g = Ext.applyIf(g, j);
        var l = ExploreAutomation.SearchFormHelper.computeDatabaseMatch(j);
        if (l) {
            h = l
        }
    }
    var n = [];
    var m = [];
    for (var e in g) {
        if (e.indexOf("boolean.any") >= 0) {
            var a = g[e].indexOf('"') != 0;
            n.push((a ? '"' : "") + g[e] + (a ? '"' : ""));
            delete g[e]
        }
    }
    for (var e in g) {
        if (e.indexOf("boolean.not") >= 0) {
            var a = g[e].indexOf('"') != 0;
            m.push((a ? '"' : "") + g[e] + (a ? '"' : ""));
            delete g[e]
        }
    }
    g["boolean.any"] = n.join(" ");
    g["boolean.not"] = m.join(" ");
    g.databasematch = h.split(",");
    return g
}});
Ext.reg("mas.wizard.panel", Ext.MasWizardPanel);
Ext.ns("Explore.view.project");
Explore.view.project.EditProjectBaseWindow = Ext.extend(Ext.Window, {project:null,projectId:null,height:600,width:700,constrain:true,modal:true,initComponent:function() {
    var a = this;
    var b = {items:this.getFormPanel(),fbar:this._getToolbar()};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.project.EditProjectBaseWindow.superclass.initComponent.apply(this, arguments)
},getFormPanel:function() {
    var a = this;
    if (!a._formPanel) {
        a._formPanel = new Ext.form.FormPanel({frame:false,border:false,monitorValid:true})
    }
    return a._formPanel
},_getToolbar:function() {
    var a = this;
    if (!this._toolbar) {
        this._toolbar = new Ext.Toolbar({buttonAlign:"right",items:[
            {text:Explore.i18n("Save"),itemId:"savebtn",disabled:true,handler:function() {
                a.saveProject()
            }},
            {text:Explore.i18n("Cancel"),itemId:"cancelbtn",handler:function() {
                a.close()
            }}
        ]})
    }
    return this._toolbar
},makeReadOnly:function() {
    return(this.project.Type < 0) ? true : false
},getSaveBtn:function() {
    if (!this.saveBtn) {
        this.saveBtn = this.fbar.getByItemId("savebtn")
    }
    return this.saveBtn
},saveProject:function() {
    var a = this;
    var b = function() {
        a.actionBeforeSave();
        Explore.data.ProjectDataStore.save(a.project, function(e) {
            a.actionOnSave(e);
            a.close()
        })
    };
    if (Explore.presenter.ProjectsPresenter.getCurrentProjectId() === a.project.Id) {
        var d = Explore.i18n("Edit Current Project");
        var c = Explore.i18n("Editing the currently loaded project will refresh the application. Would you like to continue?");
        Explore.view.StatusBox.confirm(d, c, b)
    } else {
        b()
    }
},actionOnSave:function(a) {
},actionBeforeSave:function() {
}});
Ext.ns("Explore.view.project");
Explore.view.project.EditProjectDocTypesWindow = Ext.extend(Explore.view.project.EditProjectBaseWindow, {initComponent:function() {
    var a = this;
    var b = {height:443,resizable:false,title:String.format("{0}: {1} - {2}", Explore.i18n("Project"), a.project.Name, Explore.i18n("Document Types"))};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.project.EditProjectDocTypesWindow.superclass.initComponent.apply(this, arguments);
    a.addDocType(a.project);
    a.loadDocTypes(a.project)
},addDocType:function() {
    var a = this;
    var c = {xtype:"checkbox",itemId:"AllDocumentTypes",boxLabel:Explore.i18n("AllFileTypes") + ":",checked:false,disabled:a.makeReadOnly(),name:"AllDocumentTypes",listeners:{check:function(e, f) {
        if (a.getByItemId("docTypeCheckGroup")) {
            if (f) {
                Ext.each(a.getByItemId("docTypeCheckGroup").items.items, function(h, g) {
                    a.getByItemId("docTypeCheckGroup").setValue(h.id, true)
                });
                a.getByItemId("docTypePanel").disable()
            } else {
                Ext.each(a.getByItemId("docTypeCheckGroup").getValue(), function(h, g) {
                    a.getByItemId("docTypeCheckGroup").setValue(h.id, false)
                });
                a.getByItemId("docTypePanel").enable()
            }
        } else {
            if (f) {
                a.getByItemId("docTypePanel").disable()
            }
        }
    }}};
    var b = {xtype:"panel",padding:"0 0 0 5",height:360,layout:"fit",name:"DocTypes",itemId:"docTypePanel"};
    var d = {layout:"anchor",border:false,frame:false,margins:"10 15 0 0",items:[c,b]};
    a.getFormPanel().add(d)
},loadDocTypes:function(b) {
    if (b) {
        var a = this.getByItemId("AllDocumentTypes");
        if (a) {
            if (b.AllDocumentTypes !== false) {
                a.setValue(true)
            } else {
                a.setValue(false)
            }
        }
        this.getAllDocTypes(b)
    }
},getAllDocTypes:function(c) {
    var a = this;
    var d = {itemId:"docTypeCheckGroup",xtype:"checkboxgroup",autoScroll:true,allowBlank:false,columns:1,items:a.getDocumentTypeOptions(c)};
    var b = a.getByItemId("docTypePanel");
    if (b) {
        b.add(d);
        b.doLayout()
    }
    a._formPanel.on("clientvalidation", function(f, e) {
        a.getSaveBtn().setDisabled(!e || !a.isDirty())
    })
},isDirty:function() {
    var c = this;
    var f = c.project;
    var e = false;
    var h = [];
    var a = c.getByItemId("docTypeCheckGroup");
    var g = this.getByItemId("AllDocumentTypes").getValue();
    e |= (g !== f.AllDocumentTypes);
    if (a) {
        var b = a.getValue();
        for (var d = 0; d < b.length; d++) {
            h.push(b[d].itemId)
        }
        e |= !(Explore.areArraysSame(h, f.DocumentTypes))
    }
    return e
},getDocumentTypeOptions:function(a) {
    var g = this;
    var j = [];
    var c = a.DocumentTypes;

    function f(l) {
        var m = false;
        if (a.AllDocumentTypes == true) {
            return true
        } else {
            if (c && c.length > 0) {
                for (var k = 0; k < c.length; k++) {
                    if (c[k] === l) {
                        return true
                    }
                }
            }
        }
        return m
    }

    var h = Explore.data.IDOLDataStore.getSupportedDocTypes();
    if (h) {
        for (var b = 0; b < h.length; b++) {
            var d = h[b];
            var e = {itemId:d.toLowerCase(),boxLabel:Explore.i18n(d),checked:f(d.toLowerCase())};
            j.push(e)
        }
    }
    return j
},actionBeforeSave:function() {
    var c = this;
    var e = this.project;
    var f = [];
    var a = c.getByItemId("docTypeCheckGroup");
    e.AllDocumentTypes = this.getByItemId("AllDocumentTypes").getValue();
    if (a) {
        var b = a.getValue();
        for (var d = 0; d < b.length; d++) {
            f.push(b[d].itemId)
        }
        e.DocumentTypes = f
    }
}});
Ext.ns("Explore.view.project");
Explore.view.project.EditProjectFiltersWindow = Ext.extend(Explore.view.project.EditProjectBaseWindow, {initComponent:function() {
    var a = this;
    var b = {height:443,resizable:false,title:String.format("{0}: {1} - {2}", Explore.i18n("Project"), a.project.Name, Explore.i18n("Filters"))};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.project.EditProjectFiltersWindow.superclass.initComponent.apply(this, arguments);
    a.getFilterForm();
    a.displayFilters(a.project)
},getFilterForm:function() {
    var a = this;
    var b = {layout:"anchor",border:false,margins:"10 15 0 0",items:[
        {xtype:"checkbox",itemId:"AllFilters",boxLabel:Explore.i18n("AllFilters"),checked:false,disabled:a.makeReadOnly(),name:"AllFilters",listeners:{check:function(d, e) {
            var c = this.getByItemId("filtersTree");
            if (e) {
                c.checkAll();
                c.disable()
            } else {
                c.clearAll();
                c.enable()
            }
        },scope:this}},
        {xtype:"treepanel",height:360,padding:"0px 0px 0px 5px",autoScroll:true,name:"Filters",itemId:"filtersTree",rootVisible:false,root:{text:"",id:"rootNode",children:[]}}
    ]};
    a.getFormPanel().add(b);
    a._formPanel.on("clientvalidation", function(d, c) {
        a.changeSaveButn()
    })
},displayFilters:function(b) {
    var a = this;
    Explore.data.ProjectDataStore.getUserDefinedFilters(function(d) {
        if (d) {
            if (d.Groups.length > 0 || d.Items.length > 0) {
                var c = a.getByItemId("filtersTree");
                a.createNodes(b, d, c.getRootNode());
                a.getByItemId("AllFilters").setValue(b.AllFilters);
                if (!(b.defaultSettings === true)) {
                    c.checkNodesByIds(b.FilterTags)
                }
            } else {
                Ext.MessageBox.show({title:Explore.i18n("appTitle"),msg:Explore.i18n("NoFiltersDefinedInTheSystem"),buttons:Ext.MessageBox.OK,icon:Ext.MessageBox.WARNING})
            }
        }
    })
},createNodes:function(j, h, a) {
    for (var e = 0; e < h.Groups.length; e++) {
        var f = h.Groups[e];
        var d = a.appendChild({nodeType:"node",uiProvider:Ext.tree.TriStateNodeUI,id:"group-" + f.Name,text:f.Name,leaf:false,checked:false,singleClickExpand:true,expanded:true});
        this.createNodes(j, f, d)
    }
    for (var b = 0; b < h.Items.length; ++b) {
        var c = h.Items[b];
        a.appendChild({nodeType:"async",uiProvider:Ext.tree.TriStateNodeUI,id:c.FilterTag,text:c.Name,tag:c.FilterTag,iconCls:"no-icon",leaf:true,checked:false})
    }
},actionOnSave:function(a) {
},actionBeforeSave:function() {
    var b = this;
    var c = b.project;
    var a = this.getByItemId("filtersTree");
    c.AllFilters = b.getByItemId("AllFilters").getValue();
    if (c.AllFilters) {
        c.FilterTags = null
    } else {
        c.FilterTags = a.getChecked("tag")
    }
},isDirty:function() {
    var b = this;
    var e = b.project;
    var a = this.getByItemId("filtersTree");
    var c = a.getChecked("tag");
    var d = false;
    d |= !(Explore.areArraysSame(b.project.FilterTags, c));
    d |= (b.getByItemId("AllFilters").getValue() !== e.AllFilters);
    d &= b.getFormPanel().form.isValid();
    return d
},changeSaveButn:function() {
    this.getSaveBtn().setDisabled(!this.isDirty())
}});
Ext.ns("Explore.view.project");
Explore.view.project.EditProjectSourcesWindow = Ext.extend(Explore.view.project.EditProjectBaseWindow, {initComponent:function() {
    var a = this;
    var b = {height:443,resizable:false,title:String.format("{0}: {1} - {2}", Explore.i18n("Project"), a.project.Name, Explore.i18n("Sources"))};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.project.EditProjectSourcesWindow.superclass.initComponent.apply(this, arguments);
    a.addSourcesForm(a.project);
    a.loadProject(a.project)
},loadProject:function(b) {
    var a = this;
    if (b) {
        if (b.AllSources === true) {
            a.getByItemId("AllSources").setValue(true)
        } else {
            a.getByItemId("AllSources").setValue(false)
        }
    }
},addSourcesForm:function(d) {
    var a = this;
    var c = {xtype:"container",itemId:"sourceContainer",items:{xtype:"checkbox",itemId:"AllSources",checked:false,disabled:a.makeReadOnly(),boxLabel:Explore.i18n("All Sources"),name:"AllSources",listeners:{check:function(f, g) {
        if (g) {
            a.getByItemId("sourcePicker").checkAll();
            a.getByItemId("sourcePicker").disable()
        } else {
            a.getByItemId("sourcePicker").enable();
            a.getByItemId("sourcePicker").clearAll()
        }
    }}}};
    var e = {itemId:"sourcePicker",hideTools:true,xtype:"explore.view.datasourcepicker",name:"*Sources",border:false,frame:false,height:360,includeSnapshots:true,checkable:true,listeners:{treeloaded:function(f) {
        if (a.getByItemId("AllSources").checked === true || d.defaultSettings === true) {
            this.checkAll()
        } else {
            this.setSelectedDataImports(d.DataImports);
            this.setSelectedSources(d.Sources);
            this.setSelectedSnapshots(d.Snapshots)
        }
    }}};
    var b = {layout:"anchor",name:"sourceForm",itemId:"sourceForm",minHeight:400,border:false,autoScroll:false,items:[c,e]};
    a.getFormPanel().add(b);
    a._formPanel.on("clientvalidation", function(g, f) {
        a.changeSaveButn()
    })
},actionOnSave:function(a) {
},actionBeforeSave:function() {
    var b = this;
    var c = b.project;
    var a = b.getByItemId("sourcePicker");
    c.DataImports = a.getSelectedDataImports();
    c.Sources = a.getSelectedSources();
    c.Snapshots = a.getSelectedSnapshots();
    c.AllSources = b.getByItemId("AllSources").getValue()
},isDirty:function() {
    var a = this;
    var g = a.project;
    var e = a.getByItemId("sourcePicker").getSelectedDataImports();
    var c = a.getByItemId("sourcePicker").getSelectedSnapshots();
    var d = a.getByItemId("sourcePicker").getSelectedSources();
    var b = e.length + c.length + d.length;
    var h = a.getByItemId("AllSources").getValue();
    var f = false;
    f |= !(Explore.areArraysSame(e, g.DataImports));
    f |= !(Explore.areArraysSame(d, g.Sources));
    f |= !(Explore.areArraysSame(c, g.Snapshots));
    f &= !((a.getByItemId("sourcePicker") == null || b == 0) && !h);
    return f
},changeSaveButn:function() {
    this.getSaveBtn().setDisabled(!this.isDirty())
}});
Ext.ns("Explore.view.project");
Explore.view.project.EditProjectTopicsWindow = Ext.extend(Explore.view.project.EditProjectBaseWindow, {initComponent:function() {
    var a = this;
    var b = {height:443,resizable:false,title:String.format("{0}: {1} - {2}", Explore.i18n("Project"), a.project.Name, Explore.i18n("Topics"))};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.project.EditProjectTopicsWindow.superclass.initComponent.apply(this, arguments);
    a.addTopicForm(a.project)
},isDirty:function() {
    var a = this;
    var c = this.project;
    var b = false;
    if (c.AllTopics !== this.getByItemId("AllTopics").getValue()) {
        b = true
    } else {
        b = !(Explore.areArraysSame(a.getByItemId("topicPicker").getSelectedTopicIds(), c.Topics))
    }
    this.getSaveBtn().setDisabled(!b);
    return b
},changeSaveButn:function() {
    this.getSaveBtn().setDisabled(!this.isDirty())
},addTopicForm:function(c) {
    var a = this;
    var b = {layout:"anchor",border:false,itemId:"topicForm",height:400,items:[
        {xtype:"container",items:[
            {xtype:"checkbox",itemId:"AllTopics",checked:false,boxLabel:Explore.i18n("All Topics"),name:"AllTopics",listeners:{check:function(d, e) {
                if (e) {
                    a.getByItemId("topicPicker").checkAll();
                    a.getByItemId("topicPicker").disable()
                } else {
                    a.getByItemId("topicPicker").enable();
                    a.getByItemId("topicPicker").clearAll()
                }
            }}}
        ]},
        {itemId:"topicPicker",xtype:"explore.view.topicpicker",name:"Topics",border:true,height:360,checkable:true,includeMyTopics:false,includeAllProjects:true,listeners:{treeloaded:function(d) {
            if (c.AllTopics) {
                a.getByItemId("AllTopics").setValue(true)
            } else {
                a.getByItemId("topicPicker").checkNodesByIds(c.Topics)
            }
        }}}
    ]};
    a.getFormPanel().add(b);
    a._formPanel.on("clientvalidation", function(e, d) {
        a.changeSaveButn()
    })
},actionOnSave:function(a) {
},actionBeforeSave:function() {
    var a = this;
    a.project.AllTopics = a.getByItemId("AllTopics").getValue();
    a.project.Topics = a.getByItemId("topicPicker").getSelectedTopicIds()
}});
Ext.ns("Explore.view.project");
Explore.view.project.EditProjectUsersWindow = Ext.extend(Explore.view.project.EditProjectBaseWindow, {initComponent:function() {
    var a = this;
    var b = {height:443,resizable:false,title:String.format("{0}: {1} - {2}", Explore.i18n("Project"), a.project.Name, Explore.i18n("Users"))};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.project.EditProjectUsersWindow.superclass.initComponent.apply(this, arguments);
    a.addUsersForm(a.project);
    a.displayUsers(a.project)
},displayUsers:function(d) {
    var b = this;

    function c(h, g, e, f) {
        return((h != null && h.indexOf(g) >= 0) || ((e === 1) && (f < 0)))
    }

    if (b.rendered) {
        var a = new Ext.LoadMask(b.body, {msg:String.format("{0}...{1}", Explore.i18n("Loading"), Explore.i18n("Users"))});
        a.show()
    }
    Explore.data.UserDataStore.getUsers(function(j) {
        if (a) {
            a.hide()
        }
        if (j) {
            if (j.length > 0) {
                var l = {itemId:"usersCheckGroup",xtype:"checkboxgroup",allowBlank:false,autoScroll:true,getUserIds:function() {
                    var n = [];
                    var o = this.getValue();
                    for (var m = 0; m < o.length; m++) {
                        var p = o[m];
                        if (p.getValue()) {
                            n.push(p.tag.userId)
                        } else {
                        }
                    }
                    return n
                },columns:1,items:[]};
                for (var h = 0; h < j.length; h++) {
                    var g = j[h].FullNameLFM;
                    var e = j[h].Id;
                    var f = j[h].RoleId;
                    if (d.defaultSettings === true) {
                        l.items.push({boxLabel:g,tag:{userId:e,userName:g},checked:true})
                    } else {
                        l.items.push({boxLabel:g,tag:{userId:e,userName:g},checked:c(d.Users, e, f, d.Type)})
                    }
                }
                var k = b.getByItemId("usersPanel");
                k.add(l);
                k.doLayout();
                if (d.AllUsers === true) {
                    b.getByItemId("AllUsers").setValue(true)
                } else {
                    b.getByItemId("AllUsers").setValue(false)
                }
            } else {
                Ext.MessageBox.show({title:Explore.i18n("appTitle"),msg:Explore.i18n("NoUsersDefinedInTheSystem"),buttons:Ext.MessageBox.OK,icon:Ext.MessageBox.WARNING})
            }
        }
    })
},addUsersForm:function() {
    var a = this;
    var b = {layout:"anchor",border:false,height:400,margins:"10 15 0 0",items:[
        {xtype:"container",itemId:"container",items:{xtype:"checkbox",itemId:"AllUsers",boxLabel:Explore.i18n("All Users"),checked:false,disabled:a.makeReadOnly(),name:"AllUsers",listeners:{check:function(c, d) {
            if (a.getByItemId("usersCheckGroup")) {
                if (d) {
                    Ext.each(a.getByItemId("usersCheckGroup").items.items, function(f, e) {
                        a.getByItemId("usersCheckGroup").setValue(f.id, true)
                    });
                    a.getByItemId("usersPanel").disable()
                } else {
                    Ext.each(a.getByItemId("usersCheckGroup").getValue(), function(f, e) {
                        a.getByItemId("usersCheckGroup").setValue(f.id, false)
                    });
                    a.getByItemId("usersPanel").enable()
                }
            } else {
                if (d) {
                    a.getByItemId("usersPanel").disable()
                }
            }
        }}}},
        {xtype:"panel",padding:"0 0 0 5",height:360,disabled:a.makeReadOnly(),layout:"fit",name:"Users",itemId:"usersPanel"}
    ]};
    a.getFormPanel().add(b);
    a._formPanel.on("clientvalidation", function(d, c) {
        a.changeSaveButn()
    })
},actionOnSave:function(a) {
},actionBeforeSave:function() {
    var b = this;
    var e = b.project;
    var d = [];
    var a = b.getByItemId("usersCheckGroup").getValue();
    for (var c = 0; c < a.length; c++) {
        d.push(a[c].tag.userId)
    }
    e.Users = d;
    e.AllUsers = b.getByItemId("AllUsers").getValue()
},isDirty:function() {
    var a = this;
    var c = a.project;
    var b = false;
    var d = a.getByItemId("usersCheckGroup");
    b |= !(d == null || d.getValue().length == 0);
    if (d) {
        b &= !(Explore.areArraysSame(a.project.Users, d.getUserIds()));
        b |= (a.getByItemId("AllUsers").getValue() !== a.project.AllUsers)
    }
    b &= a.getFormPanel().form.isValid();
    return b
},changeSaveButn:function() {
    this.getSaveBtn().setDisabled(!this.isDirty())
}});
Ext.ns("Explore.view.projectdetail");
Explore.view.projectdetail.ProjectDocTypeDetails = Ext.extend(Ext.Panel, {project:null,autoHeight:true,cls:"project-detail",collapsible:true,initComponent:function() {
    var b = this;
    var a = {title:Explore.i18n("DocumentType")};
    Ext.apply(this, a);
    Explore.view.projectdetail.ProjectDocTypeDetails.superclass.initComponent.apply(this, arguments);
    b.on("afterrender", function() {
        b.displayProject(b.project)
    })
},displayProject:function(d) {
    var a = this,c = a.body;
    a.project = d || a.project;
    d = a.project;
    var b = a.getDocTypesDetailTemplate();
    if (!d || !c) {
        return
    }
    b.overwrite(c, d);
    a.addTopicsLink(d)
},addTopicsLink:function(d) {
    var b = this,c = b.body,a = c.query("span#doctypes.link-feel")[0];
    Ext.fly(a).on("click", function() {
        b.editProjectDocTypes(d)
    })
},editProjectDocTypes:function(b) {
    var a = new Explore.view.project.EditProjectDocTypesWindow({project:b});
    a.show()
},getDocTypesDetailTemplate:function() {
    var a = this;
    if (!a._topicsDetailTemplate) {
        a._topicsDetailTemplate = new Ext4.XTemplate('<span id="doctypes" class="link-feel">{[this.getDocTypesDetails(values)]} </span>', {getDocTypesDetails:function(b) {
            var c = b.DocumentTypes ? b.DocumentTypes.length : 0;
            return String.format("{0} {1}", c, Explore.i18n("DocumentTypeS"))
        }})
    }
    return a._topicsDetailTemplate
}});
Ext.reg("explore.view.projectdetail.projectdoctypedetails", Explore.view.projectdetail.ProjectDocTypeDetails);
Ext.ns("Explore.view.projectdetail");
Explore.view.projectdetail.ProjectFilterDetail = Ext.extend(Ext.Panel, {project:null,autoHeight:true,cls:"project-detail",collapsible:true,initComponent:function() {
    var b = this;
    var a = {title:Explore.i18n("Filters")};
    Ext.apply(this, a);
    Explore.view.projectdetail.ProjectFilterDetail.superclass.initComponent.apply(this, arguments);
    b.on("afterrender", function() {
        b.displayProject(b.project)
    })
},displayProject:function(d) {
    var a = this,c = a.body;
    a.project = d || a.project;
    d = a.project;
    var b = a.getFilterDetailTemplate();
    if (!d || !c) {
        return
    }
    b.overwrite(c, d);
    a.addTopicsLink(d)
},addTopicsLink:function(d) {
    var b = this,c = b.body,a = c.query("span#filter.link-feel")[0];
    Ext.fly(a).on("click", function() {
        b.editProjectFilters(d)
    })
},editProjectFilters:function(b) {
    var a = new Explore.view.project.EditProjectFiltersWindow({project:b});
    a.show()
},getFilterDetailTemplate:function() {
    var a = this;
    if (!a._topicsDetailTemplate) {
        a._topicsDetailTemplate = new Ext4.XTemplate('<span id="filter" class="link-feel">{[this.getFilterDetails(values)]} </span>', {getFilterDetails:function(b) {
            var c = (b.FilterTags) ? b.FilterTags.length : 0;
            return String.format("{0} {1}", c, Explore.i18n("FilterSS"))
        }})
    }
    return a._topicsDetailTemplate
}});
Ext.reg("explore.view.projectdetail.projectdilterdetail", Explore.view.projectdetail.ProjectFilterDetail);
Ext.ns("Explore.view.projectdetail");
Explore.view.projectdetail.ProjectGeneralDetail = Ext.extend(Ext.Panel, {project:null,collapsible:true,autoHeight:true,cls:"project-detail",initComponent:function() {
    var b = this;
    var a = {title:Explore.i18n("General")};
    Ext.apply(this, a);
    Explore.view.projectdetail.ProjectGeneralDetail.superclass.initComponent.apply(this, arguments);
    b.on("afterrender", function() {
        b.displayProject(b.project)
    })
},getGeneralDetailTemplate:function() {
    var a = this;
    if (!a._generalDeatilTemplate) {
        a._generalDeatilTemplate = new Ext4.XTemplate('<span class="document-count">(' + Explore.i18n("Calculating") + ")</span> in ", '<span class="link-feel" id="source">{[this.getSources(values)]} </span> for ', '<span class="link-feel" id="users">{[this.getUsers(values)]} </span>', "<hr/>", "<span> {[this.getDescription(values.Description)]}</span>", {getSources:function(b) {
            var c = (b.Sources ? b.Sources.length : 0) + (b.DataImports ? b.DataImports.length : 0) + (b.Snapshots ? b.Snapshots.length : 0);
            return String.format("{0} {1}", c, Explore.i18n("SourceSS"))
        },getUsers:function(b) {
            var c = b.Users ? b.Users.length : 0;
            return String.format("{0} {1}", c, Explore.i18n("UserSS"))
        },getDescription:function(b) {
            return b || "(No Description)"
        }})
    }
    return a._generalDeatilTemplate
},displayProject:function(d) {
    var a = this,c = a.body;
    a.project = d || a.project;
    d = a.project;
    var b = a.getGeneralDetailTemplate();
    if (!d || !c) {
        return
    }
    b.overwrite(c, d);
    a.getDocCounts(d.Id);
    a.addLinks(d)
},addLinks:function(e) {
    var a = this,b = a.body,d = b.query("span#source.link-feel")[0],c = b.query("span#users.link-feel")[0];
    Ext.fly(d).on("click", function() {
        a.editProjectSources(e)
    });
    Ext.fly(c).on("click", function() {
        a.editProjectUsers(e)
    })
},editProjectSources:function(b) {
    var a = new Explore.view.project.EditProjectSourcesWindow({project:b});
    a.show()
},editProjectUsers:function(b) {
    var a = new Explore.view.project.EditProjectUsersWindow({project:b});
    a.show()
},getDocCounts:function(b) {
    var a = this,d = a.body,e = d.child("span.document-count");
    var c = {Type:"PROJECT",Id:b};
    if (a._docTooltip) {
        a._docTooltip.destroy()
    }
    DocumentCountService.GetDocCount(c, function(f) {
        if (e && f) {
            e.update(Explore.formatNumber(f.TotalCount));
            if (f.TotalCount > 0) {
                a._docTooltip = new Explore.view.common.DocCountToolTip({target:e,documentCounts:f})
            }
        } else {
            e.update(Explore.i18n("Error"))
        }
    })
}});
Ext.reg("explore.view.projectdetail.projectgeneraldetail", Explore.view.projectdetail.ProjectGeneralDetail);
Explore.view.ProjectsDetail = Ext.extend(Explore.base.AdministrationDetailPanelBase, {autoScroll:true,labelWidth:200,project:null,initComponent:function() {
    var j = this;
    var b = ["editProject"];
    j.addEvents();
    j.enableBubble(b);
    var a = {xtype:"explore.view.allprojects",itemId:"allprojects",getMask:function() {
        return j.getMask()
    },anchor:"100% 97%"};
    var d = {xtype:"explore.view.projectdetail.projectgeneraldetail",itemId:"generaldetails"};
    var c = {xtype:"explore.view.projectdetail.projecttopicdetail",itemId:"topicdetails"};
    var g = {xtype:"explore.view.projectdetail.projectdilterdetail",itemId:"filterdetails"};
    var f = {xtype:"explore.view.projectdetail.projectdoctypedetails",itemId:"doctypedetails"};
    var h = {xtype:"explore.view.projectdetail.projectuserdetails",itemId:"userdetails",width:"95%"};
    var e = {xtype:"explore.view.projectdetail.projectsourcesdetails",itemId:"sourcesdetails",width:"95%"};
    j.formItems = [a,d,e,h,c,g,f];
    Explore.view.ProjectsDetail.superclass.initComponent.apply(this, arguments)
},editProject:function(a) {
    this.fireEvent("editProject", this.project, {}, a)
},displayObject:function(d) {
    Explore.view.ProjectsDetail.superclass.displayObject.call(this, d);
    var g = (d && d.Type < 0) ? true : false,b = !d,a = this.getByItemId("allprojects"),e = this.getByItemId("generaldetails"),c = this.getByItemId("topicdetails"),k = this.getByItemId("filterdetails"),j = this.getByItemId("doctypedetails"),l = this.getByItemId("userdetails"),h = this.getByItemId("sourcesdetails"),f = this.getByItemId("auditLabel");
    f.setVisible(false);
    a.setVisible(b);
    e.setVisible(!b);
    c.setVisible(!b);
    k.setVisible(!b);
    j.setVisible(!b);
    h.setVisible(!b);
    if (!d) {
        a.refreshGrid()
    } else {
        e.displayProject(d);
        c.displayProject(d);
        k.displayProject(d);
        j.displayProject(d);
        l.displayProject(d);
        h.displayProject(d)
    }
    this.doLayout()
},updateButtonState:function() {
    var c = this.currentObject == null;
    var a = this.currentObject ? this.currentObject.Type === -1 : false;
    if (this.topToolbar.getByItemId) {
        var d = this.topToolbar.getByItemId("editButton");
        if (d) {
            d.setVisible(!a);
            d.setDisabled(c || !Explore.Security.isAuthorized("PROJECTS_UPDATE"))
        }
        var e = this.topToolbar.getByItemId("deleteButton");
        if (e) {
            e.setVisible(true);
            e.setDisabled(c || a || !Explore.Security.isAuthorized("PROJECTS_DELETE"))
        }
        var b = this.topToolbar.getByItemId("viewButton");
        if (b) {
            b.setVisible(a);
            b.setDisabled(!a)
        }
    }
}});
Ext.reg("explore.view.projectsdetail", Explore.view.ProjectsDetail);
Ext.ns("Explore.view.projectdetail");
Explore.view.projectdetail.ProjectSourcesDetails = Ext.extend(Ext.grid.GridPanel, {project:null,collapsible:true,autoHeight:true,cls:"gray-grid project-detail-grid",SourceTypeToIconUrl:{SNAPSHOT:"../resources/images/icons/search.gif",DATA_SOURCE:"../resources/images/icons/recurring.png"},OriginToIconUrl:{1:"../resources/images/MAS_icons/icon_radian6_16.png",2:"../resources/images/icons/ic_facebook.png",3:"../resources/images/icons/ic_twitter_.png"},initComponent:function() {
    var c = this;
    var f = {id:"Name",dataIndex:"Name",sortable:true,width:200,header:Explore.i18n("Name"),renderer:function(p, j, k, n, r, q) {
        var h = k.get("Name"),l = k.get("SourceType"),o = k.get("Origin");
        var m;
        if (l === "DATA_IMPORT") {
            m = c.createImageMarkUp(c.OriginToIconUrl[o])
        } else {
            m = c.createImageMarkUp(c.SourceTypeToIconUrl[l])
        }
        return String.format("{0} {1}", m, h)
    }};
    var e = {id:"Type",dataIndex:"SourceType",sortable:true,width:200,header:Explore.i18n("Source Type"),renderer:function(m, j, h, n, l, k) {
        return Explore.i18n("text" + m)
    }};
    var b = new Explore.view.DocCountColumn({header:Explore.i18n("Available Documents"),id:"totalDocumentsIndexed",width:200});
    var g = {id:"DocCount",dataIndex:"Schedule",sortable:true,width:200,header:Explore.i18n("Status"),renderer:function(o, h, l, n, q, p) {
        var j = l.get("Repeat");
        var k;
        if (!j) {
            k = c.createImageMarkUp("../resources/images/icons/ic_refresh_disabled.png");
            return String.format("{0}{1}", k, Explore.i18n("One Time"))
        } else {
            var m = l.get("Schedule");
            k = c.createImageMarkUp("../resources/images/icons/ic_refresh.png");
            return String.format("{0} refresh every {1} hours", k, m)
        }
    }};
    var d = [f,e,b,g];
    var a = {title:Explore.i18n("Sources"),store:c.getStore(),autoExpandColumn:"Name",columns:d,plugins:[b]};
    Ext.apply(this, a);
    Explore.view.projectdetail.ProjectSourcesDetails.superclass.initComponent.apply(this, arguments);
    c.on("afterrender", function() {
        c.displayProject(c.project)
    })
},createImageMarkUp:function(b) {
    var a = "<div style=\"background:url('{0}') no-repeat 0 0px; padding-left:25px; height:20px;\">";
    return String.format(a, b)
},getStore:function() {
    var a = this;
    if (!a._store) {
        a._store = new Ext.data.JsonStore({fields:["Id","Name","SourceType","TotalDocumentsIndexed","Schedule","Repeat","Origin"]})
    }
    return a._store
},displayProject:function(b) {
    var a = this;
    a.project = b || a.project;
    if (a.project) {
        var c = [];
        c = c.concat(b.SnapshotObjs || []);
        c = c.concat(b.DataImportObjs || []);
        c = c.concat(b.SourceObjs || []);
        a.getStore().loadData(c);
        this.updateTitle(c.length)
    }
},updateTitle:function(b) {
    var c = "{0} ({1})",a = this;
    this.setTitle(String.format(c, Explore.i18n("Sources"), b || 0))
},editProjectSources:function(b) {
    var a = new Explore.view.project.EditProjectSourcesWindow({project:b});
    a.show()
}});
Ext.reg("explore.view.projectdetail.projectsourcesdetails", Explore.view.projectdetail.ProjectSourcesDetails);
Ext.ns("Explore.view.projectdetail");
Explore.view.projectdetail.ProjectTopicDetail = Ext.extend(Ext.Panel, {project:null,autoHeight:true,cls:"project-detail",collapsible:true,initComponent:function() {
    var b = this;
    var a = {title:Explore.i18n("Topics")};
    Ext.apply(this, a);
    Explore.view.projectdetail.ProjectTopicDetail.superclass.initComponent.apply(this, arguments);
    b.on("afterrender", function() {
        b.displayProject(b.project)
    })
},displayProject:function(d) {
    var a = this,c = a.body;
    a.project = d || a.project;
    d = a.project;
    var b = a.getTopicsDetailTemplate();
    if (!d || !c) {
        return
    }
    b.overwrite(c, d);
    a.addTopicsLink(d)
},addTopicsLink:function(d) {
    var b = this,c = b.body,a = c.query("span#topics.link-feel")[0];
    Ext.fly(a).on("click", function() {
        b.editProjectTopics(d)
    })
},editProjectTopics:function(b) {
    var a = new Explore.view.project.EditProjectTopicsWindow({project:b});
    a.show()
},getTopicsDetailTemplate:function() {
    var a = this;
    if (!a._topicsDetailTemplate) {
        a._topicsDetailTemplate = new Ext4.XTemplate('<span id="topics" class="link-feel">{[this.getTopicsDetails(values)]} </span>', {getTopicsDetails:function(b) {
            var c = b.Topics ? b.Topics.length : 0;
            return String.format("{0} {1}", c, Explore.i18n("TopicSS"))
        }})
    }
    return a._topicsDetailTemplate
}});
Ext.reg("explore.view.projectdetail.projecttopicdetail", Explore.view.projectdetail.ProjectTopicDetail);
Ext.ns("Explore.view.projectdetail");
Explore.view.projectdetail.ProjectUserDetails = Ext.extend(Ext.grid.GridPanel, {project:null,collapsible:true,autoHeight:true,cls:"gray-grid project-detail-grid",initComponent:function() {
    var b = this;
    var a = {title:Explore.i18n("Users"),store:b.getStore(),autoExpandColumn:"UserName",columns:b.getColumns()};
    Ext.apply(this, a);
    Explore.view.projectdetail.ProjectUserDetails.superclass.initComponent.apply(this, arguments);
    b.on("afterrender", function() {
        b.displayProject(b.project)
    })
},createImageMarkUp:function(b) {
    var a = '<div style="padding:2px;float:left;"><img src="{0}" style="vertical-align: middle" /></div>';
    return String.format(a, b)
},getColumns:function() {
    var a = this;
    var c = {id:"Name",dataIndex:"FullNameFML",width:200,sortable:true,header:Explore.i18n("Name")};
    var g = {id:"Role",header:Explore.i18n("Role"),width:200,sortable:true,dataIndex:"Role.Name"};
    var e = {id:"UserName",dataIndex:"Login",width:200,sortable:true,header:Explore.i18n("User Name")};
    var b = {id:"Email",dataIndex:"Email",width:250,sortable:true,header:Explore.i18n("Email")};
    var f = {id:"Engagement",dataIndex:"SocialMediaAccounts.length",sortable:true,header:Explore.i18n("Engagement"),renderer:function(t, j, p, r, w, u) {
        var h = p.get("SocialMediaAccounts"),y = "",v = false,m = false,k = false,n = "../resources/images/icons/ic_facebook.png",l = "../resources/images/icons/ic_twitter_.png",s = "../resources/images/icons/ic_linked_in.png";
        for (var o = 0; o < h.length; o++) {
            var x = h[o],q = x.AccountType;
            switch (q) {case Explore.model.SocialMediaType.Twitter:v = true;break;
                case Explore.model.SocialMediaType.Linkedin:k = true;break;case Explore.model.SocialMediaType.Facebook:m = true;break
            }
        }
        if (m) {
            y += a.createImageMarkUp(n)
        }
        if (k) {
            y += a.createImageMarkUp(s)
        }
        if (v) {
            y += a.createImageMarkUp(l)
        }
        return y
    }};
    var d = [e,c,g,b,f];
    return d
},getStore:function() {
    var a = this;
    if (!a._store) {
        a._store = new Ext.data.JsonStore({fields:["FullNameFML","Login","Role.Name","Email","SocialMediaAccounts","SocialMediaAccounts.length"]})
    }
    return a._store
},displayProject:function(b) {
    var a = this;
    a.project = b || a.project;
    if (a.project) {
        a.getStore().loadData(b.UserObjs || []);
        this.updateTitle(b.UserObjs ? b.UserObjs.length : 0)
    }
},updateTitle:function(b) {
    var c = "{0} ({1})",a = this;
    this.setTitle(String.format(c, Explore.i18n("Users"), b || 0))
},editProjectUsers:function(b) {
    var a = new Explore.view.project.EditProjectUsersWindow({project:b});
    a.show()
}});
Ext.reg("explore.view.projectdetail.projectuserdetails", Explore.view.projectdetail.ProjectUserDetails);
Ext.ns("Explore.view.reports");
Explore.view.reports.DataIngestionReport = Ext.extend(Ext.Panel, {store:null,initComponent:function() {
    this.store = new Ext.data.GroupingStore({reader:new Ext.data.JsonReader({fields:[
        {name:"Name"},
        {name:"Date"},
        {name:"Docs"},
        {name:"Archives"},
        {name:"Size"}
    ]})});
    var a = {xtype:"container",layout:"fit",padding:30,items:{xtype:"grid",region:"center",border:true,store:this.store,view:new Ext.grid.GroupingView({}),columns:[
        {header:Explore.i18n("Name"),width:200,sortable:true,id:"Name",dataIndex:"Name"},
        {header:Explore.i18n("Date"),width:200,sortable:true,id:"Date",dataIndex:"Date"},
        {header:Explore.i18n("Docs"),width:200,sortable:true,id:"Docs",dataIndex:"Docs"},
        {header:Explore.i18n("Archives"),width:200,sortable:true,id:"Archives",dataIndex:"Archives"},
        {header:Explore.i18n("Size_GB_"),width:200,sortable:true,id:"Size",dataIndex:"Size"}
    ]}};
    Ext.apply(this, Ext.apply(this.initialConfig, a));
    Explore.view.reports.DataIngestionReport.superclass.initComponent.apply(this, arguments);
    this.loadData()
},loadData:function() {
    var a = this;
    Explore.data.SystemReportsDataStore.getDataIngestionReport(function(b) {
        a.store.loadData(b)
    })
},getRecordsForExport:function() {
    return this.store.getRange()
}});
Ext.reg("explore.view.reports.dataingestionreport", Explore.view.reports.DataIngestionReport);
Ext.ns("Explore.view.reports");
Explore.view.reports.DocumentCountReport = Ext.extend(Ext.Panel, {chartStore_4:null,chart_4:null,initComponent:function() {
    Explore.data.PreferenceDataStore.load();
    var a = {layout:{type:"vbox",pack:"start",align:"stretch"},bodyBorder:false,autoScroll:true,padding:10,items:[
        {border:false,xtype:"container",height:80,margins:"0 0 10 0",items:[
            {itemId:"docType",xtype:"component",autoEl:{tag:"div"}},
            {itemId:"total",xtype:"component",autoEl:{tag:"div"}},
            {itemId:"mostRecent",xtype:"component",autoEl:{tag:"div"}}
        ]},
        {xtype:"box",itemId:"report-chart-title",autoEl:{tag:"div",cls:"report-chart-title"}},
        {xtype:"box",itemId:"chartContainer",flex:1,margins:"10",listeners:{resize:{fn:this.setupChart,buffer:250,scope:this}}}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, a));
    Explore.view.reports.DocumentCountReport.superclass.initComponent.apply(this, arguments)
},setupChart:function() {
    if (!this.chart_4) {
        this.loadData()
    } else {
        this.chart_4.setSize(width, height)
    }
},getRecordsForExport:function() {
    return this.chartStore_4.getRange()
},loadData:function() {
    var a = this,b = a.reportType;
    if (a.chart_4) {
        a.chart_4.destroy()
    }
    Explore.data.SystemReportsDataStore.getDocumentCountReportInfo(b, function(d) {
        var h = "";
        var c = (b === "Any");
        if (c) {
            h = Explore.i18n("All_v2")
        } else {
            var f = Explore.i18n(b);
            h = '<img align="absmiddle" src="' + Ext.BLANK_IMAGE_URL + '" class="icon16 icon16-' + b.toLowerCase() + '" alt="' + f + '" />&nbsp;' + f
        }
        a.getByItemId("docType").update(Explore.i18n("DocumentType") + ": " + h);
        a.getByItemId("total").update(Explore.i18n("TotalNumberOfDocuments") + ": " + d.GraphData.ResultCount);
        var e = "-";
        if (d.GraphData.ResultCount > 0) {
            e = Explore.formatDateByPref(d.MostRecent)
        }
        a.getByItemId("mostRecent").update(Explore.i18n("MostRecentDocument") + ": " + e);
        if (d.GraphData.ResultCount > 0) {
            var g = a.getByItemId("report-chart-title");
            g.getEl().update(d.ChartTitle);
            a.chartStore_4 = new Ext4.data.ArrayStore({fields:["Date","Documents"],data:d.GraphData.GraphData});
            a.createChart(c)
        }
        a.doLayout()
    })
},createChart:function(c) {
    var d = this.getByItemId("chartContainer"),f = d.getEl(),e = f.getComputedWidth(),b = f.getComputedHeight();
    dom = f.dom;
    var a = {trackMouse:true,width:180,height:35,renderer:function(h, g) {
        this.setTitle(h.get("Documents") + " " + Explore.i18n("_documents"))
    }};
    this.chart_4 = Ext4.create("widget.chart", {store:this.chartStore_4,shadow:false,renderTo:dom,width:e,height:b,theme:"Blue:gradients",axes:[
        {type:"Numeric",minimum:0,position:"left",fields:["Documents"],title:Explore.i18n("Documents"),grid:true,labelTitle:{font:"14px sans-serif"},label:{font:"12px sans-serif"}},
        {type:"Category",position:"bottom",title:Explore.i18n("Date"),fields:["Date"],labelTitle:{font:"14px sans-serif"},label:{font:"12px sans-serif"}}
    ],series:[
        {type:c ? "line" : "column",xField:"Date",yField:"Documents",tips:a}
    ]})
}});
Ext.reg("explore.view.reports.documentcountreport", Explore.view.reports.DocumentCountReport);
Ext.ns("Explore.view.reports");
Explore.view.reports.LoginReport = Ext.extend(Ext.Panel, {store:null,initComponent:function() {
    Explore.data.PreferenceDataStore.load();
    function b(g, d, c, h, f, e) {
        return Explore.formatDateByPref(g)
    }

    this.store = new Ext.data.GroupingStore({reader:new Ext.data.JsonReader({fields:[
        {name:"DateTime"},
        {name:"Detail"},
        {name:"IP"}
    ]}),sortInfo:{field:"DateTime",direction:"DESC"}});
    var a = {xtype:"container",layout:"fit",padding:30,items:{xtype:"grid",region:"center",border:true,store:this.store,autoExpandColumn:"Detail",view:new Ext.grid.GroupingView({}),columns:[
        {header:Explore.i18n("Date"),width:200,sortable:true,id:"DateTime",dataIndex:"DateTime",renderer:b},
        {header:Explore.i18n("UserName_1"),width:200,sortable:true,id:"Detail",dataIndex:"Detail"},
        {header:Explore.i18n("IPAddress"),width:200,sortable:true,id:"IP",dataIndex:"IP"}
    ]}};
    Ext.apply(this, Ext.apply(this.initialConfig, a));
    Explore.view.reports.LoginReport.superclass.initComponent.apply(this, arguments);
    this.loadData()
},loadData:function() {
    var a = this,b = a.reportType;
    Explore.data.SystemReportsDataStore.getAuditLog(b, function(c) {
        if (!(c == null || c === undefined)) {
            a.store.loadData(c)
        }
    })
},getRecordsForExport:function() {
    return this.store.getRange()
}});
Ext.reg("explore.view.reports.loginreport", Explore.view.reports.LoginReport);
Ext.ns("Explore.view.reports");
Explore.view.reports.NotificationReport = Ext.extend(Ext.Panel, {store:null,initComponent:function() {
    var a = this;
    this.store = new Ext.data.GroupingStore({reader:new Ext.data.JsonReader({fields:[
        {name:"UserName"},
        {name:"DateTime"},
        {name:"AuditItemName"},
        {name:"Detail"}
    ]}),sortInfo:{field:"DateTime",direction:"DESC"}});
    function c(h, e, d, j, g, f) {
        return Explore.formatDateByPref(h)
    }

    var b = {xtype:"container",layout:"fit",padding:30,items:{xtype:"grid",region:"center",border:true,store:this.store,autoExpandColumn:"AuditItemName",view:new Ext.grid.GroupingView({}),columns:[
        {header:Explore.i18n("Date"),width:200,sortable:true,id:"DateTime",dataIndex:"DateTime",renderer:c},
        {header:Explore.i18n("UserName_1"),width:300,sortable:true,id:"UserName",dataIndex:"UserName"},
        {header:Explore.i18n("Rule"),width:200,sortable:true,id:"AuditItemName",dataIndex:"AuditItemName"}
    ],listeners:{rowdblclick:function(g, j, h) {
        var f = {name:"Notification Detail",detail:g.store.data.items[j].data.Detail,user:g.store.data.items[j].data.UserName,rule:g.store.data.items[j].data.AuditItemName,date:g.store.data.items[j].data.DateTime};
        var d = new Explore.view.reports.NotificationReportDetailDialog({notificationDetail:f,readOnly:true});
        d.show()
    }}}};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.reports.NotificationReport.superclass.initComponent.apply(this, arguments);
    this.loadData()
},loadData:function() {
    var a = this;
    var b = this.reportType;
    Explore.data.SystemReportsDataStore.getAuditLog(b, function(c) {
        a.store.loadData(c)
    })
},getRecordsForExport:function() {
    return this.store.getRange()
}});
Ext.reg("explore.view.reports.notificationreport", Explore.view.reports.NotificationReport);
Explore.view.reports.NotificationReportDetailDialog = Ext.extend(Ext.Window, {notificationDetail:null,readOnly:true,initComponent:function() {
    var a = {height:500,width:800,layout:"border",cls:"white-bg-dialog",title:"Notification sent to " + this.notificationDetail.user + " for " + this.notificationDetail.rule + " rule",items:[
        {xtype:"panel",layout:"fit",region:"center",autoScroll:true,id:"detail",html:this.notificationDetail.detail,cls:"search-result-window-box-autoscroll"}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, a));
    Explore.view.reports.NotificationReportDetailDialog.superclass.initComponent.apply(this, arguments)
}});
Ext.reg("explore.view.reports.notificationreportdetaildialog", Explore.view.reports.NotificationReportDetailDialog);
Ext.ns("Explore.view.reports");
Explore.view.reports.ProductionReport = Ext.extend(Ext.Panel, {store:null,initComponent:function() {
    this.store = new Ext.data.GroupingStore({reader:new Ext.data.JsonReader({fields:[
        {name:"Date"},
        {name:"User"},
        {name:"Project"},
        {name:"Type"},
        {name:"Details"},
    ]})});
    var a = {xtype:"container",layout:"fit",padding:30,items:{xtype:"grid",region:"center",border:true,store:this.store,view:new Ext.grid.GroupingView({}),columns:[
        {header:Explore.i18n("Date"),width:200,sortable:true,id:"Date",dataIndex:"Date"},
        {header:Explore.i18n("User"),width:200,sortable:true,id:"User",dataIndex:"User"},
        {header:Explore.i18n("Project"),width:200,sortable:true,id:"Project",dataIndex:"Project"},
        {header:Explore.i18n("Type"),width:200,sortable:true,id:"Type",dataIndex:"Type"},
        {header:Explore.i18n("Details"),width:200,sortable:true,id:"Details",dataIndex:"Details"}
    ]}};
    Ext.apply(this, Ext.apply(this.initialConfig, a));
    Explore.view.reports.ProductionReport.superclass.initComponent.apply(this, arguments);
    this.loadData()
},loadData:function() {
    var a = this;
    Explore.data.SystemReportsDataStore.getProductionReport(function(b) {
        a.store.loadData(b)
    })
},getRecordsForExport:function() {
    return this.store.getRange()
}});
Ext.reg("explore.view.reports.productionreport", Explore.view.reports.ProductionReport);
Ext.ns("Explore.view.reports");
Explore.view.reports.ReportApp = new function() {
    var a = null;

    function e(h, g) {
        var f = g.name;
        var k = g.description;
        if (k != null) {
            k = k.replace("\n", "<br />")
        }
        var j = {xtype:"panel",border:false,id:"header-panel",items:{xtype:"component",autoEl:{tag:"div",html:'<div id="reportHeader"><h1></h1></div><div class="system-report-title">' + f + '</div><div class="system-report-description">' + k + "</div>"}}};
        return Ext.apply(j, h)
    }

    function c(g, f) {
        var h = {xtype:"explore.view.reports." + f.xtype,itemId:"report-component",reportType:f.reportType,border:false};
        return Ext.apply(h, g)
    }

    function d(g, f) {
        var h = {xtype:"toolbar",border:false,id:"footer-panel",cls:"report-footer-panel",items:["->",{text:Explore.i18n("Export"),iconCls:"buttonExport",handler:function() {
            log.info("ReportApp Export clicked");
            var j = a.getByItemId("report-component");
            if (typeof j.getRecordsForExport == "function") {
                var k = j.getRecordsForExport();
                Explore.utils.Exporter.exportToCsv(k)
            }
        }},{text:Explore.i18n("Print"),iconCls:"buttonPrint",handler:function() {
            log.info("ReportApp Print clicked");
            window.print()
        }}]};
        return Ext.apply(h, g)
    }

    function b(g) {
        if (a === null) {
            var f = {id:"explore-reports-viewport",layout:{type:"vbox",pack:"start",align:"stretch"},items:[e({autoHeight:true}, g),c({flex:1}, g),d({autoHeight:true}, g)]};
            a = new Ext.Viewport(f)
        }
    }

    this.run = function(f) {
        if (Ext.isIE7) {
            Ext.getBody().addClass("ie7")
        }
        b(f)
    }
};
Ext.ns("Explore.view.reports");
Explore.view.reports.ReportsPanel = Ext.extend(Ext.Panel, {initComponent:function() {
    var a = {layout:"border",border:false,items:[
        {xtype:"explore.view.reports.reportstree",itemId:"tree",title:Explore.i18n("Reports"),cls:"report-tree",region:"west",split:true,width:250,minSize:150,maxSize:350},
        {xtype:"explore.view.reports.reportsdetail",itemId:"detail",title:Explore.i18n("ReportsDetails"),region:"center"}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, a));
    return Explore.view.reports.ReportsPanel.superclass.initComponent.apply(this, arguments)
},onRender:function(d, b) {
    var c = this,a = c.getByItemId("tree");
    a.on("click", function(g) {
        var f = c.getByItemId("detail");
        f.loadData(g.attributes)
    }, c);
    var e = new Ext.LoadMask(Ext.getBody(), {msg:"Loading reports..."});
    a.getLoader().on("beforeload", function() {
        e.show()
    });
    a.getLoader().on("load", function() {
        e.hide()
    });
    a.getLoader().on("loadexception", function() {
        e.hide()
    });
    return Explore.view.reports.DocumentCountReport.superclass.onRender.apply(this, arguments)
}});
Ext.reg("explore.view.reports.reportspanel", Explore.view.reports.ReportsPanel);
Explore.view.reports.ReportsTree = Ext.extend(Ext.tree.TreePanel, {initComponent:function() {
    var a = this;
    var b = {collapsible:false,useArrows:true,autoScroll:true,animate:false,enableDD:false,tools:[
        {id:"refresh",qtip:Explore.i18n("refresh"),handler:function() {
            a.refresh()
        }}
    ],containerScroll:true,rootVisible:false,root:{id:"root",text:"root",expanded:true},loader:new Ext.tree.TreeLoader({directFn:SystemReportsService.GetSystemReportsNodes,baseAttrs:{singleClickExpand:true}})};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    return Explore.view.reports.ReportsTree.superclass.initComponent.apply(this, arguments)
}});
Ext.reg("explore.view.reports.reportstree", Explore.view.reports.ReportsTree);
Explore.view.reports.ReportsDetail = Ext.extend(Ext.Panel, {runReport:function() {
    log.info("Run report: ");
    log.info(self._tagData);
    var b = this.getByItemId("reportName").getValue();
    var c = this.getByItemId("reportDescription").getValue();
    var a = "./Report.aspx?" + Ext.urlEncode({x:this._tagData.xtype,t:this._tagData.reportType,n:b,d:c});
    Explore.popupWindow(a, "", 1024, 600)
},initComponent:function() {
    var a = {layout:"form",padding:10,items:[
        {xtype:"textfield",itemId:"reportName",fieldLabel:Explore.i18n("ReportName"),emptyText:"(" + Explore.i18n("enterReportName") + ")",disabled:true,width:400,maxLength:250},
        {xtype:"textarea",itemId:"reportDescription",fieldLabel:Explore.i18n("Description"),emptyText:"(" + Explore.i18n("enterReportDescription") + ")",disabled:true,width:400,height:50,maxLength:1000},
        {xtype:"button",itemId:"runButton",text:Explore.i18n("RunReport"),height:20,width:100,disabled:true,scope:this,handler:function() {
            this.runReport()
        }}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, a));
    return Explore.view.reports.ReportsDetail.superclass.initComponent.apply(this, arguments)
},loadData:function(g) {
    var a = this;
    this._tagData = g.tag;
    log.info("ReportDetail loadData id:");
    log.info(this._tagData);
    var e = "";
    var c = false;
    if (this._tagData) {
        e = this._tagData.defaultName || "";
        c = (this._tagData.xtype !== undefined && this._tagData.xtype !== null)
    }
    this.setTitle(Explore.i18n("ReportDetails") + ": " + e);
    var d = a.getByItemId("reportName");
    var f = a.getByItemId("reportDescription");
    var b = a.getByItemId("runButton");
    d.setDisabled(!c);
    f.setDisabled(!c);
    b.setDisabled(!c);
    d.setValue(e);
    f.setValue("");
    d.focus(true, 50)
}});
Ext.reg("explore.view.reports.reportsdetail", Explore.view.reports.ReportsDetail);
Ext.ns("Explore.view.reports");
Explore.view.reports.TransactionReport = Ext.extend(Ext.Panel, {store:null,initComponent:function() {
    this.store = new Ext.data.GroupingStore({reader:new Ext.data.JsonReader({fields:[
        {name:"Timestamp"},
        {name:"User"},
        {name:"Action"}
    ]})});
    var a = {xtype:"container",layout:"fit",padding:30,items:{xtype:"grid",region:"center",border:true,store:this.store,view:new Ext.grid.GroupingView({}),columns:[
        {header:Explore.i18n("Timestamp"),width:200,sortable:true,id:"Timestamp",dataIndex:"Timestamp"},
        {header:Explore.i18n("User"),width:200,sortable:true,id:"User",dataIndex:"User"},
        {header:Explore.i18n("Action"),width:400,sortable:true,id:"Action",dataIndex:"Action"}
    ]}};
    Ext.apply(this, Ext.apply(this.initialConfig, a));
    Explore.view.reports.TransactionReport.superclass.initComponent.apply(this, arguments);
    this.loadData()
},loadData:function() {
    var a = this;
    Explore.data.SystemReportsDataStore.getTransactionReport(function(b) {
        a.store.loadData(b)
    })
},getRecordsForExport:function() {
    return this.store.getRange()
}});
Ext.reg("explore.view.reports.transactionreport", Explore.view.reports.TransactionReport);
Ext.ns("Explore.view.searchbuilder");
Explore.view.searchbuilder.SearchCriteriaGroup = Ext.extend(Ext.Panel, {isTop:false,readOnly:true,criteriaItemsChanged:false,initComponent:function() {
    var a = this;
    var c = this.isTop;
    var d = this.readOnly;
    var b = {cls:c ? "searchCriteriaGroup" : "sub-searchCriteriaGroup",padding:10,margins:c ? "0 0 0 0" : "5 5 5 5",autoScroll:c,border:false,header:false,tbar:{xtype:"toolbar",autoWidth:true,items:[
        {xtype:"box",autoEl:{tag:"span",html:c ? Explore.i18n("IncludeResultsThatHave") : Explore.i18n("with"),style:"padding-left:5px; padding-right:5px;"}},
        {itemId:"combineField",xtype:"selectboxfield",width:80,readOnly:d,options:[
            {id:Explore.model.ASCombineType.And,text:Explore.i18n("all")},
            {id:Explore.model.ASCombineType.Or,text:Explore.i18n("any")}
        ],value:Explore.model.ASCombineType.And},
        {xtype:"box",autoEl:{tag:"span",html:Explore.i18n("ofTheFollowing_"),style:"padding-left:5px"}},
        {itemId:"addSingle",xtype:"button",iconCls:"new-icon",tooltip:Explore.i18n("AddANewCriteriaBelowThisGroup"),hidden:c || d,handler:function() {
            a.fireEvent("addSingleCriteria", a)
        }},
        {itemId:"addGroup",xtype:"button",iconCls:"new-searchgroup-icon",tooltip:Explore.i18n("AddAnAny_allGroupOfCriteriaBelowThisGroup"),hidden:c || d,handler:function() {
            a.fireEvent("addCriteriaGroup", a)
        }},
        {itemId:"deleteRow",xtype:"button",iconCls:"delete-icon",tooltip:Explore.i18n("DeleteThisCriteriaGroup"),disabled:true,hidden:c || d,handler:function() {
            a.fireEvent("deleteRow", a)
        }}
    ]},items:{itemId:"criteriaContainer",xtype:"container",items:d ? undefined : [a.getSingleCriteriaComponent()]}};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.searchbuilder.SearchCriteriaGroup.superclass.initComponent.apply(this, arguments)
},addSingleCriteria:function(d) {
    var a = this;
    var c = a.getByItemId("criteriaContainer");
    var b = c.items.length - 1;
    if (d) {
        b = c.items.indexOf(d)
    }
    var e = a.getSingleCriteriaComponent();
    c.insert(b + 1, e);
    a.setDeleteButtonState();
    c.doLayout();
    a.criteriaItemsChanged = true
},addCriteriaGroup:function(d) {
    var a = this;
    var c = a.getByItemId("criteriaContainer");
    var b = c.items.length - 1;
    if (d) {
        b = c.items.indexOf(d)
    }
    var e = a.getCriteriaGroupComponent();
    c.insert(b + 1, e);
    a.setDeleteButtonState();
    c.doLayout();
    a.criteriaItemsChanged = true
},deleteRow:function(c) {
    var a = this;
    var b = a.getByItemId("criteriaContainer");
    b.remove(c);
    if (b.items.length === 0) {
        var d = a.getSingleCriteriaComponent();
        b.insert(0, d)
    }
    a.setDeleteButtonState();
    b.doLayout();
    a.criteriaItemsChanged = true
},getCriteriaGroupComponent:function() {
    var a = {xtype:"explore.view.searchbuilder.searchcriteriagroup",readOnly:this.readOnly,listeners:{addSingleCriteria:this.addSingleCriteria,addCriteriaGroup:this.addCriteriaGroup,deleteRow:this.deleteRow,scope:this}};
    return a
},getSingleCriteriaComponent:function() {
    var a = {xtype:"explore.view.searchbuilder.searchlineitem",readOnly:this.readOnly,listeners:{addSingleCriteria:this.addSingleCriteria,addCriteriaGroup:this.addCriteriaGroup,deleteRow:this.deleteRow,scope:this}};
    return a
},setDeleteButtonState:function() {
    var b = this.getByItemId("criteriaContainer");
    var a = this;
    b.items.each(function(e, c, d) {
        e.setDeleteEnabled(!a.readOnly && (d > 1));
        return true
    })
},setDeleteEnabled:function(a) {
    this.getTopToolbar().getByItemId("deleteRow").setDisabled(false)
},isDirty:function() {
    if (this.criteriaItemsChanged) {
        return true
    }
    var a = this.getTopToolbar().getByItemId("combineField").isDirty();
    this.getByItemId("criteriaContainer").items.each(function(d, c, b) {
        if (d.isDirty()) {
            a = true
        }
        return true
    });
    return a
},isValid:function() {
    var a = true;
    this.getByItemId("criteriaContainer").items.each(function(d, c, b) {
        if (!d.isValid()) {
            a = false
        }
        return true
    });
    return a
},setCriteria:function(d) {
    var a = this;
    a.originalCriteria = d;
    if (d != null) {
        var b = this.getByItemId("criteriaContainer");
        b.removeAll();
        var c = this.getTopToolbar().getByItemId("combineField");
        c.setValue(d.Combine);
        c.initValue();
        if (d.Criteria == null || d.Criteria.length == 0) {
            b.add(a.getSingleCriteriaComponent())
        } else {
            Ext.each(d.Criteria, function(h, e, f) {
                var g;
                if (h.Combine === Explore.model.ASCombineType.Single) {
                    g = b.add(a.getSingleCriteriaComponent())
                } else {
                    g = b.add(a.getCriteriaGroupComponent())
                }
                g.setCriteria(h)
            }, this)
        }
        a.setDeleteButtonState();
        if (a.initialConfig.isTop) {
            b.doLayout()
        }
    }
},getCriteria:function() {
    var a = {Combine:this.getTopToolbar().getByItemId("combineField").getValue(),Criteria:[]};
    var b = this.getByItemId("criteriaContainer");
    b.items.each(function(f, d, e) {
        var g = f.getCriteria();
        if (g.FilterTag !== "") {
            a.Criteria.push(g)
        }
        return true
    });
    return a
}});
Ext.reg("explore.view.searchbuilder.searchcriteriagroup", Explore.view.searchbuilder.SearchCriteriaGroup);
Ext.ns("Explore.view.searchbuilder");
Explore.view.searchbuilder.SearchLineItem = Ext.extend(Ext.Container, {initComponent:function() {
    var k = this;
    var b = 1;
    var j = null;
    var d = null;
    var e = 2;
    var h = null;
    var c = null;
    var g = this.initialConfig.readOnly ? true : false;
    k.filterConfig = Explore.data.IDOLDataStore.getAdvancedSearchCriteria();
    var f = null;
    k.filterSelected = function(m) {
        log.debug("filterSelected", m);
        if (f === m) {
            return
        }
        f = m;
        if (j != null) {
            k.remove(j)
        }
        if (d != null) {
            k.remove(d)
        }
        if (m && m.ComparatorGroup) {
            var l = m.ComparatorGroup.Comparators;
            if (l.length > 1) {
                j = Ext.create({xtype:"selectboxfield",itemId:"operatorSelect",store:new Ext.data.JsonStore({fields:["IDOLSpecifier","FriendlyName"],data:l}),valueField:"IDOLSpecifier",displayField:"FriendlyName",allowBlank:false,readOnly:g,width:120,value:l[0].IDOLSpecifier,listeners:{}})
            } else {
                if (l.length == 1) {
                    j = new Ext.BoxComponent({itemId:"operatorDisplay",autoEl:{tag:"div",html:l[0].FriendlyName},margins:"0 0 10 0",comparator:l[0].IDOLSpecifier})
                } else {
                    log.warn("No operators defined for filter: " + record.data.id, record.json)
                }
            }
            k.insert(b, j)
        }
        k.setupValueField(m);
        k.doLayout()
    };
    k.setupValueField = function(n) {
        log.debug("setupValueField", n);
        if (h != null) {
            k.remove(h)
        }
        if (c != null) {
            k.remove(c)
        }
        if (!n || n.FilterTag === "") {
            return
        }
        var o;
        var m;
        var l = null;
        if (n.FilterTag === "TYPE") {
            l = function(s) {
                var p = [];
                var q = Explore.data.IDOLDataStore.getSupportedDocTypes();
                for (var r = 0; r < q.length; r++) {
                    p.push({Id:q[r],Name:q[r]})
                }
                s(p)
            }
        } else {
            if (n.FilterTag === "CLASSIFICATION") {
                l = function(s) {
                    var q = Explore.data.MetaDataStore.getTags2();
                    var p = [];
                    for (var r = 0; r < q.length; r++) {
                        p.push({Id:q[r].Id,Name:q[r].TagName})
                    }
                    s(p)
                }
            } else {
                if (n.FilterTag === "OBSERVECLASSIFICATION") {
                    l = function(q) {
                        var p = Explore.data.MetaDataStore.getRecordingClassificationNames();
                        q(p)
                    }
                } else {
                    if (n.UserValues != null && n.UserValues.length > 0) {
                        l = function(r) {
                            var p = [];
                            for (var q = 0; q < n.UserValues.length; q++) {
                                p.push({Id:n.UserValues[q].Key,Name:n.UserValues[q].Value})
                            }
                            r(p)
                        }
                    }
                }
            }
        }
        if (l !== null) {
            o = {itemId:"valueField",xtype:"multiselectdropdown",store:new Ext.data.JsonStore({fields:["Id","Name"],data:[]}),valueField:"Id",displayField:"Name",allowBlank:false,width:200,readOnly:g,editable:false,listeners:{afterrender:function(p) {
                l(function(q) {
                    p.getStore().loadData(q);
                    p.initValue()
                })
            }}}
        } else {
            switch (n.Type) {case"Date":Ext.apply({dateType:Explore.model.FilterByDateType.Any,startDate:-90}, a.defaultValues);
                o = {itemId:"valueField",xtype:"datefield",format:Explore.getDateFormatByPref({ignoreTime:true}),altFormats:Explore.getDateFormatByPref({ignoreTime:true}),hidden:false,allowBlank:false,readOnly:g};
                m = {itemId:"valueField2",xtype:"datefield",format:Explore.getDateFormatByPref({ignoreTime:true}),altFormats:Explore.getDateFormatByPref({ignoreTime:true}),hideLabel:true,hidden:false,allowBlank:false,readOnly:g};
                break;case"Int":o = {itemId:"valueField",xtype:"numberfield",allowBlank:false,readOnly:g};break;case"String":default:o = {itemId:"valueField",xtype:"textfield",allowBlank:false,readOnly:g};
                break
            }
        }
        h = k.insert(e, o);
        if (m) {
            d = new Ext.BoxComponent({itemId:"betweenText",autoEl:{tag:"div",html:"and"},margins:"0 0 10 0"});
            k.insert(e, d);
            c = k.insert(e, m)
        }
    };
    var a = {layout:{type:"hbox",align:"middle"},defaults:{margins:"5 0 0 10"},listeners:{afterrender:function() {
        var l = this.getByItemId("filterSelect");
        if (l.getRawValue() !== "") {
            k.getByItemId("addSingle").setDisabled(false);
            k.getByItemId("addGroup").setDisabled(false)
        }
    }},items:[
        {itemId:"filterSelect",xtype:"selectboxfilter",allowBlank:true,readOnly:g,margins:"5 0 0 5",includeEmptyItem:true,filterConfig:Explore.data.IDOLDataStore.getAdvancedSearchCriteria(),listeners:{select:function(n, l, m) {
            if (l.IsGroup) {
                k.filterSelected(null)
            } else {
                k.filterSelected(l.json.Item)
            }
        }}},
        {itemId:"addSingle",xtype:"button",cls:"btn-no-border",iconCls:"new-icon",tooltip:Explore.i18n("AddANewCriteriaBelowThisGroup"),hidden:g,margins:"5 0 0 5",disabled:true,handler:function() {
            k.fireEvent("addSingleCriteria", k)
        }},
        {itemId:"addGroup",xtype:"button",cls:"btn-no-border",iconCls:"new-searchgroup-icon",tooltip:Explore.i18n("AddAnAny_allGroupOfCriteriaBelowThisGroup"),hidden:g,margins:"5 0 0 5",disabled:true,handler:function() {
            k.fireEvent("addCriteriaGroup", k)
        }},
        {itemId:"deleteRow",xtype:"button",cls:"btn-no-border",iconCls:"delete-icon",tooltip:Explore.i18n("DeleteThisCriteriaGroup"),hidden:g,margins:"5 0 0 5",disabled:false,handler:function() {
            k.fireEvent("deleteRow", k)
        }}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, a));
    Explore.view.searchbuilder.SearchLineItem.superclass.initComponent.apply(this, arguments)
},isDirty:function() {
    var a = false;
    this.items.each(function(d, c, b) {
        if (d.isDirty) {
            if (d.isDirty()) {
                a = true
            }
        }
        return true
    });
    return a
},isValid:function() {
    var b = true;
    var a = this;
    this.items.each(function(e, d, c) {
        if (e.isValid) {
            if (!e.isValid()) {
                b = false
            }
        }
        return true
    });
    a.enableAdd(b);
    return b
},enableAdd:function(a) {
    var b = this.getByItemId("filterSelect");
    if (b.getRawValue() === Explore.i18n("_selectAFilter_")) {
        a = false
    }
    this.getByItemId("addSingle").setDisabled(!a);
    this.getByItemId("addGroup").setDisabled(!a)
},setCriteria:function(f) {
    var j = this;
    var g = j.getByItemId("filterSelect");
    g.setValue(f.FilterTag);
    g.initValue();
    var d = Explore.utils.SearchCriteriaUtil.findFilter(this.filterConfig, f.FilterTag);
    if (d != null) {
        j.filterSelected(d);
        var b = d.ComparatorGroup.Comparators;
        var c = Explore.findMatching(b, "IDOLSpecifier", f.Comparator);
        if (c == null) {
            c = Explore.findMatching(b, "IDOLSpecifier", d.DefaultComparatorSpecifier);
            if (c == null) {
                c = Explore.findMatching(b, "IDOLSpecifier", "MATCH")
            }
        }
        j.setupValueField(d);
        var e = j.getByItemId("operatorSelect");
        if (e !== null && c != null) {
            e.setValue(c.IDOLSpecifier);
            e.initValue()
        }
        var h = j.getByItemId("valueField");
        var a = j.getByItemId("valueField2");
        if (d.Type === "Date") {
            a.setValue(Explore.getDateFromEpoch(f.Values[0]));
            h.setValue(Explore.getDateFromEpoch(f.Values[1]))
        } else {
            if (h != null) {
                if (h.setValues) {
                    h.setValues(f.Values)
                } else {
                    h.setValue(f.Values[0])
                }
                h.initValue()
            }
        }
    }
},getCriteria:function() {
    var c = this;
    var g = {Combine:Explore.model.ASCombineType.Single,FilterTag:c.getByItemId("filterSelect").getValue(),Comparator:null,Values:null};
    var f = Explore.utils.SearchCriteriaUtil.findFilter(this.filterConfig, g.FilterTag);
    if (f != null) {
        var e = c.getByItemId("operatorSelect");
        if (e !== null) {
            g.Comparator = e.getValue()
        } else {
            var a = c.getByItemId("operatorDisplay");
            if (a !== null) {
                g.Comparator = a.comparator
            }
        }
        var d = c.getByItemId("valueField");
        var h = c.getByItemId("valueField2");
        if (d !== null) {
            if (d.getValues) {
                g.Values = d.getValues()
            } else {
                if (f.Type === "Date") {
                    var b = d.getValue().clearTime().add(Date.SECOND, 86399);
                    g.Values = [Explore.getEpochFromDate(h.getValue()),Explore.getEpochFromDate(b)]
                } else {
                    g.Values = [d.getValue()]
                }
            }
        }
    }
    return g
},setDeleteEnabled:function(a) {
}});
Ext.reg("explore.view.searchbuilder.searchlineitem", Explore.view.searchbuilder.SearchLineItem);
Ext.ns("Explore.view.searchresultdetail");
Explore.view.searchresultdetail.ApplyChangesDetail = Ext.extend(Ext.FormPanel, {frame:false,border:false,title:Explore.i18n("Apply Changes To"),baseCls:"engagement-side-panel",labelWidth:85,initComponent:function() {
    var b = this;
    var d = 165;
    var a = Explore.data.PreferenceDataStore.getShowSentimentPreference();
    var c = {defaults:{height:25},items:[
        {fieldLabel:Explore.i18n("Sentiment"),xtype:"container",layout:{type:"hbox",align:"middle"},hidden:!a,items:[
            {xtype:"button",cls:"btn-no-border",iconCls:"positiveIcon",margins:"0 10 0 0",sentiment:"Positive",itemId:"PositiveSentimentButton",scope:this,handler:this.changeSentiment},
            {xtype:"button",cls:"btn-no-border",iconCls:"neutralIcon",margins:"0 10 0 0",sentiment:"Neutral",itemId:"NeutralSentimentButton",scope:this,handler:this.changeSentiment},
            {xtype:"button",cls:"btn-no-border",iconCls:"negativeIcon",margins:"0 10 0 0",sentiment:"Negative",itemId:"NegativeSentimentButton",scope:this,handler:this.changeSentiment}
        ]},
        {xtype:"selectboxfield",fieldLabel:Explore.i18n("Priority"),itemId:"prioritySelectBox",width:d,emptyText:Explore.i18n("HypNoneHyp"),options:[
            [Explore.model.EngagementPriority.None,Explore.i18n("HypNoneHyp")],
            [Explore.model.EngagementPriority.High,Explore.i18n("High")],
            [Explore.model.EngagementPriority.Medium,Explore.i18n("Medium")],
            [Explore.model.EngagementPriority.Low,Explore.i18n("Low")]
        ],listeners:{scope:this,select:this.onPriorityChange}},
        {xtype:"selectboxfield",fieldLabel:Explore.i18n("Status"),itemId:"statusSelectBox",width:d,emptyText:Explore.i18n("HypNoneHyp"),store:{xtype:"jsonstore",autoDestroy:true,fields:["Id","Name"],data:[]},valueField:"Id",displayField:"Name",listeners:{scope:this,select:this.onStatusChange}},
        {itemId:"tagsComp",xtype:"explore.view.searchresultdetail.assignitemcomponent",iconCls:"assignTagIcon",fieldLabel:Explore.i18n("Tags"),singularLabel:Explore.i18n("Tag"),pluralLabel:Explore.i18n("Tags"),listeners:{save:this.saveTags,scope:this}},
        {itemId:"classifyComp",xtype:"explore.view.searchresultdetail.assignitemcomponent",iconCls:"assignClassificationIcon",fieldLabel:Explore.i18n("Classifications"),singularLabel:Explore.i18n("Classification"),pluralLabel:Explore.i18n("Classifications"),listeners:{save:this.saveClassifications,scope:this}},
        {xtype:"container",layout:{type:"hbox",align:"middle"},fieldLabel:Explore.i18n("Notes"),items:[
            {xtype:"textfield",emptyText:Explore.i18n("Add Note"),itemId:"notesTextField",width:d - 35,enableKeyEvents:true,listeners:{keypress:function(f, g) {
                if (g.getKey() == g.RETURN || g.getKey() == g.ENTER) {
                    g.stopEvent()
                }
            },keyup:function(f, g) {
                var h = (f.getRawValue().trim() === "");
                b.getByItemId("addNoteButton").setDisabled(h);
                if (!h) {
                    if (g.getKey() == g.RETURN || g.getKey() == g.ENTER) {
                        this.onAddNote();
                        b.getByItemId("addNoteButton").setDisabled(true)
                    }
                }
            },scope:this}},
            {xtype:"button",disabled:true,text:Explore.i18n("Add"),itemId:"addNoteButton",margins:"0 0 0 5",scope:this,handler:this.onAddNote}
        ]}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, c));
    Explore.view.searchresultdetail.ApplyChangesDetail.superclass.initComponent.apply(this, arguments)
},setUIPriority:function(a) {
    this.getByItemId("prioritySelectBox").setValue((a == null) ? Explore.model.EngagementPriority.None : a)
},setRowData:function(c) {
    this.rowData = c;
    var b;
    b = Explore.SearchResults.getWorkflowItem(this.rowData.engagementWorkFlowItems, Explore.model.EngagementWorkFlowActions.AssignedSentiment);
    this.currentSentiment = (b && b.Sentiment) ? b.Sentiment : null;
    this.getByItemId("PositiveSentimentButton").setDisabled(false);
    this.getByItemId("NeutralSentimentButton").setDisabled(false);
    this.getByItemId("NegativeSentimentButton").setDisabled(false);
    if (this.currentSentiment !== null) {
        var a = this.getByItemId(this.currentSentiment + "SentimentButton");
        if (a) {
            a.setDisabled(true)
        }
    }
    b = Explore.SearchResults.getWorkflowItem(this.rowData.engagementWorkFlowItems, Explore.model.EngagementWorkFlowActions.ChangePriority);
    this.currentPriority = (b && b.Priority) ? b.Priority : null;
    this.setUIPriority(this.currentPriority);
    b = Explore.SearchResults.getWorkflowItem(this.rowData.engagementWorkFlowItems, Explore.model.EngagementWorkFlowActions.ChangeStatus);
    this.currentStatus = (b && b.CurrentStatus) ? b.CurrentStatus : null;
    this.currentStatusName = (b && b.CurrentStatusName) ? b.CurrentStatusName : null;
    this.populateStatus();
    this.populateTags();
    this.populateClassifications()
},populateStatus:function() {
    var a = this,b = a.getByItemId("statusSelectBox");
    if (this.loadedStatus) {
        this.setStatus()
    } else {
        Explore.data.EngagementDataStore.listAll(function(c) {
            log.debug("Loading status");
            if (c != null) {
                b.store.loadData(c);
                a.loadedStatus = true;
                a.setStatus()
            }
        })
    }
},setPriority:function() {
    var b = this,a = b.currentPriority,c = b.getByItemId("prioritySelectBox");
    if (a !== null && a > 0) {
        c.setValue(a)
    } else {
        c.setValue(Explore.i18n("HypNoneHyp"))
    }
},setStatus:function() {
    var b = this,a = b.currentStatus,c = b.getByItemId("statusSelectBox");
    if (a !== null && a > 0) {
        c.setValue(a)
    } else {
        c.setValue(Explore.i18n("HypNoneHyp"))
    }
},populateTags:function() {
    log.debug("Loading tags");
    var a = this.getByItemId("tagsComp");
    var b = Explore.SearchResults.getWorkflowItem(this.rowData.engagementWorkFlowItems, Explore.model.EngagementWorkFlowActions.AssignedTags);
    this.currentTags = (b && b.Tags) ? b.Tags : null;
    this.currentTagNames = (b && b.TagNames) ? b.TagNames : null;
    a.assignConfig = {types:[
        {key:"TAGS",text:Explore.i18n("Tags"),selections:this.currentTags,idProperty:"Id",gridConfig:{store:{xtype:"jsonstore",proxy:new Ext.data.MemoryProxy(Explore.data.MetaDataStore.getTags2()),autoLoad:true,fields:[
            {name:"Id",type:"int"},
            {name:"TagName"}
        ]},columns:[
            {dataIndex:"TagName",header:Explore.i18n("Name")}
        ]}}
    ]};
    a.updateTextField(this.currentTags, this.currentTagNames)
},populateClassifications:function() {
    var b = this.getByItemId("classifyComp");
    var a = Explore.SearchResults.getWorkflowItem(this.rowData.engagementWorkFlowItems, Explore.model.EngagementWorkFlowActions.AssignedClassification);
    this.currentClassifications = (a && a.Classifications) ? a.Classifications : null;
    this.currentClassificationNames = (a && a.ClassificationNames) ? a.ClassificationNames : null;
    b.assignConfig = {types:[
        {key:"CLASSIFICATIONS",text:Explore.i18n("Classifications"),selections:this.currentClassifications,idProperty:"Id",gridConfig:{store:{xtype:"jsonstore",proxy:new Ext.data.MemoryProxy(Explore.data.MetaDataStore.getRecordingClassificationNames()),autoLoad:true,fields:[
            {name:"Id",type:"int"},
            {name:"Name"}
        ]},columns:[
            {dataIndex:"Name",header:Explore.i18n("Name")}
        ]}}
    ]};
    b.updateTextField(this.currentClassifications, this.currentClassificationNames)
},changeSentiment:function(a) {
    var c = this.rowData.id,d = this.rowData.type,b = a.sentiment;
    if (this.currentSentiment !== b) {
        Explore.data.EngagementDataStore.assignSentiment(c, d, b, function() {
        })
    }
},onPriorityChange:function(c, a, b) {
    var e = this.rowData.id,d = (c.getValue() == Explore.model.EngagementPriority.None) ? null : c.getValue();
    if (d !== this.currentPriority) {
        Explore.data.EngagementDataStore.assignPriority(e, d, function() {
        })
    } else {
        this.setPriority()
    }
},onStatusChange:function(c, a, b) {
    var e = this.rowData.id,d = (c.getValue() == 0) ? null : c.getValue();
    if (d !== this.currentStatus) {
        Explore.data.EngagementDataStore.changeStatus(e, d, this.currentStatus, function() {
        })
    } else {
        this.setStatus()
    }
},saveTags:function(c, a) {
    var d = this.rowData.id,e = this.rowData.type,b = a.TAGS;
    Explore.data.EngagementDataStore.assignTags(d, e, b, function() {
    })
},saveClassifications:function(c, a) {
    var d = this.rowData.id,e = this.rowData.type,b = a.CLASSIFICATIONS;
    Explore.data.EngagementDataStore.assignClassification(d, e, b, function() {
    })
},onAddNote:function() {
    var c = this.rowData.id;
    var b = this.getByItemId("notesTextField");
    var a = b.getValue().trim();
    if (a === "") {
        Explore.view.StatusBox.showWarning(Explore.i18n("Note required"), Explore.i18n("Provide note text to add a note."))
    } else {
        Explore.data.EngagementDataStore.addNotes(c, a, function() {
            b.setValue("")
        })
    }
}});
Ext.reg("explore.view.searchresultdetail.applychangesdetail", Explore.view.searchresultdetail.ApplyChangesDetail);
Ext.ns("Explore.view.searchresultdetail");
Explore.view.searchresultdetail.AssignDetail = Ext.extend(Ext.FormPanel, {frame:false,border:false,title:Explore.i18n("Assign To"),baseCls:"engagement-side-panel",labelWidth:85,initComponent:function() {
    var a = this;
    var c = 165;
    var b = {defaults:{height:25},items:[
        {itemId:"projectsComp",xtype:"explore.view.searchresultdetail.assignitemcomponent",fieldLabel:Explore.i18n("Projects"),singularLabel:Explore.i18n("Project"),pluralLabel:Explore.i18n("Projects"),listeners:{save:this.saveAssignments,scope:this}},
        {itemId:"usersComp",xtype:"explore.view.searchresultdetail.assignitemcomponent",fieldLabel:Explore.i18n("Users"),singularLabel:Explore.i18n("User"),pluralLabel:Explore.i18n("Users"),listeners:{save:this.saveAssignments,scope:this}}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.searchresultdetail.AssignDetail.superclass.initComponent.apply(this, arguments)
},setRowData:function(a) {
    this.rowData = a;
    this.updateUI()
},updateUI:function() {
    var c = Explore.SearchResults.getWorkflowItem(this.rowData.engagementWorkFlowItems, Explore.model.EngagementWorkFlowActions.AssignedProjects);
    if (c == null) {
        this.assignedProjects = null;
        this.assignedProjectNames = null
    } else {
        this.assignedProjects = c.Projects;
        this.assignedProjectNames = c.ProjectNames
    }
    var b = this.getByItemId("projectsComp");
    b.updateTextField(this.assignedProjects, this.assignedProjectNames);
    b.assignConfig = this.getAssignConfig("PROJECTS");
    var d = Explore.SearchResults.getWorkflowItem(this.rowData.engagementWorkFlowItems, Explore.model.EngagementWorkFlowActions.AssignedUsers);
    if (d == null) {
        this.assignedUsers = null;
        this.assignedUserNames = null
    } else {
        this.assignedUsers = d.Users;
        this.assignedUserNames = d.UserNames
    }
    var a = this.getByItemId("usersComp");
    a.updateTextField(this.assignedUsers, this.assignedUserNames);
    a.assignConfig = this.getAssignConfig("USERS")
},getAssignConfig:function(c) {
    var a = new Explore.view.DocCountColumn({header:Explore.i18n("Number of Documents"),sortable:false,id:"Documents",dataIndex:"Documents"});
    var b = {selectedType:c,types:[
        {key:"PROJECTS",text:Explore.i18n("Projects"),selections:this.assignedProjects,idProperty:"Id",gridConfig:{plugins:[a],store:{xtype:"directstore",directFn:ProjectService.ListMyProjects,autoLoad:true,fields:[
            {name:"Id",type:"int"},
            {name:"Name"},
            {name:"Description"}
        ]},columns:[
            {dataIndex:"Name",header:Explore.i18n("Name")},
            {dataIndex:"Description",header:Explore.i18n("Description")},
            a
        ]}},
        {key:"USERS",text:Explore.i18n("Users"),selections:this.assignedUsers,idProperty:"Id",gridConfig:{store:{xtype:"directstore",directFn:UserService.GetUsers,autoLoad:true,fields:[
            {name:"Id",type:"int"},
            {name:"FullNameFML"},
            {name:"Login"},
            {name:"Email"}
        ]},columns:[
            {dataIndex:"FullNameFML",header:Explore.i18n("Name")},
            {dataIndex:"Login",header:Explore.i18n("Username")},
            {dataIndex:"Email",header:Explore.i18n("Email")}
        ]}}
    ]};
    return b
},saveAssignments:function(d, a) {
    var c,f,e;
    var h = this.rowData.id;
    var b = a.PROJECTS;
    var g = a.USERS;
    if (b != null) {
        Explore.data.EngagementDataStore.assignToProjects(h, b)
    }
    if (g != null) {
        Explore.data.EngagementDataStore.assignToUsers(h, g)
    }
}});
Ext.reg("explore.view.searchresultdetail.assigndetail", Explore.view.searchresultdetail.AssignDetail);
Ext.ns("Explore.view.searchresultdetail");
Explore.view.searchresultdetail.AssignItemComponent = Ext.extend(Ext.Container, {fieldWidth:165,asssignedIds:null,assignedNames:null,singularLabel:"",pluralLabel:"",assignConfig:null,iconCls:"addressBookIcon",initComponent:function() {
    var a = this;
    var b = {layout:{type:"hbox",align:"middle"},items:[
        {xtype:"button",cls:"btn-no-border",iconCls:this.iconCls,margins:"0 5 0 0",scope:this,handler:this.showAssignDialog},
        {xtype:"textfield",itemId:"myTextField",readOnly:true,value:Explore.i18n("NoneSelected"),flex:1}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.searchresultdetail.AssignItemComponent.superclass.initComponent.apply(this, arguments)
},updateTextField:function(d, e) {
    this.assignedIds = d;
    this.assignedNames = e;
    var a = this.getByItemId("myTextField");
    if (a.mytooltip) {
        a.mytooltip.destroy()
    }
    if (d === undefined || d === null || d.length === 0) {
        a.setValue("")
    } else {
        var c = d.length;
        if (c === 1) {
            a.setValue(c + " " + this.singularLabel)
        } else {
            a.setValue(c + " " + this.pluralLabel)
        }
        if (e) {
            var b = function() {
                a.mytooltip = new Ext.ToolTip({target:a.getEl(),anchor:"top",html:e.join("<br/>").replace(/ /g, "&nbsp;")})
            };
            if (a.getEl()) {
                b()
            } else {
                this.on("afterlayout", b, this, {single:true})
            }
        }
    }
},showAssignDialog:function() {
    var a = new Explore.view.AssignDialog({assignConfig:this.assignConfig});
    a.on("save", this.saveAssignments, this);
    a.show()
},saveAssignments:function(b, a, c) {
    this.fireEvent("save", this, a, c)
},getValue:function() {
    var a = {ids:this.assignedIds || [],names:this.assignedNames || []};
    return a
},setValue:function(a) {
    if (a) {
        this.updateTextField(a.ids, a.names)
    }
}});
Ext.reg("explore.view.searchresultdetail.assignitemcomponent", Explore.view.searchresultdetail.AssignItemComponent);
Ext.ns("Explore.view.searchresultdetail");
Explore.view.searchresultdetail.EngagementResponsePanel = Ext.extend(Ext.Panel, {border:false,frame:false,rowData:null,initComponent:function() {
    var b = this;
    var a = {html:""};
    Ext.apply(this, a);
    Explore.view.searchresultdetail.EngagementResponsePanel.superclass.initComponent.apply(this, arguments)
},loadResponses:function(g) {
    var a = this,e = a.getResponseTemplate(),d = a.getEl();
    if (!g && !a.rowData) {
        return
    }
    a.rowData = g || a.rowData;
    var f = a.rowData.engagementResponses;
    if (f && f.length > 0) {
        var b = [];
        for (var c = f.length - 1; c >= 0; c--) {
            b.push(f[c])
        }
        if (d) {
            e.overwrite(a.body, b)
        } else {
            a.on("afterrender", function() {
                e.overwrite(a.getEl(), b)
            }, this, {single:true})
        }
    } else {
        a.update("")
    }
},getResponseTemplate:function() {
    var a = this;
    if (!a._responseTemplate) {
        var b = new Ext.XTemplate('<div class="search-result">', "<h1>{Response}</h1>", '<div class="search-result-hdr">', '(<span class="type">{[this.getType()]}</span> {[this.getTwitterIcon()]}) ', "{[this.postedBy(values)]}", "{[this.getPostTime(values)]} ", "{[this.getSource(values)]}", '<div class="search-result-clear"></div>', '<div class="search-result-body">{Response}</div>', "</div>", "</div>", {postedBy:function(d) {
            var c = d.RespondedByUser,e = c.FullNameFML;
            return String.format('Posted by <span class="type">{0}</span> ', e)
        },getHeader:function(c) {
            return Explore.SearchResults.getTitleForRecord(c)
        },getType:function() {
            return a.rowData.type
        },getPostTime:function(e) {
            var d = Explore.i18n("on"),c = Explore.i18n("at"),h = Explore.formatTimeByPref(e.ResponseDate),f = Explore.formatDateByPref(e.ResponseDate, {ignoreTime:true}),g = "{0} {1} {2} {3}";
            return String.format(g, d, f, c, h)
        },getTwitterIcon:function(c) {
            return'<img style="vertical-align: middle" alt="Micro Media" src="../resources/images/icons/icn_multichannel_Micro Media_16.png">'
        },getSource:function(c) {
            var d = "";
            if (c.ResponseUrl) {
                d = String.format('<span class="search-result-link"><a href="{0}" target="_blank">{1}</a></span>', c.ResponseUrl, Explore.i18n("viewSource"))
            }
            return d
        }});
        a._responseTemplate = new Ext.XTemplate('<div class="top-bottom-border">', '<div class ="indent">', '<div class ="engagement-responses">', '<tpl for=".">', "{[this.processResponse(values)]}", '<tpl if="xindex!==xcount"><hr/></tpl>', "</tpl>", "</div>", "</div>", "</div>", {processResponse:function(c) {
            return b.apply(c)
        }})
    }
    return a._responseTemplate
}});
Ext.reg("explore.view.searchresultdetail.engagementresponsepanel", Explore.view.searchresultdetail.EngagementResponsePanel);
Ext.ns("Explore.view.searchresultdetail");
Explore.view.searchresultdetail.MultiChannelEventHistory = Ext.extend(Ext.Panel, {frame:false,border:false,title:"test",cls:"engagement",collapsible:true,collapsed:true,hideCollapseTool:true,rowData:null,wrapperClass:"search-result-hyperlinking-body",defaultToolLink:"mostrecent",limit:0,recentLimit:5,initComponent:function() {
    var a = this;
    var b = {title:Explore.i18n("MultiChannel Event History")};
    this.toolTemplate = a.getToolTemplate();
    this.tools = [
        {id:"mostrecent",text:"Most Recent",link:true,handler:function(e, d, c) {
            a.setActiveTool("mostrecent");
            a.limit = a.recentLimit;
            a.loadEventHistory(a.rowData)
        }},
        {id:"seperator",text:"|",seperator:true},
        {id:"viewall",text:"View All",link:true,handler:function(e, d, c) {
            a.limit = -1;
            a.setActiveTool("viewall");
            a.loadEventHistory(a.rowData)
        }},
        {id:"toggle",handler:function(e, d, c) {
            c.toggleCollapse()
        }}
    ];
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.searchresultdetail.MultiChannelEventHistory.superclass.initComponent.apply(this, arguments);
    a.addListeners()
},addListeners:function() {
    var a = this;
    a.on("afterrender", function() {
        a.setActiveTool(a.defaultToolLink);
        a.loadEventHistory(a.rowData)
    })
},setActiveTool:function(d) {
    var a = this;
    var b = a.getTool(d);
    if (b) {
        for (toolId in a.tools) {
            var c = a.getTool(toolId);
            if (c && c.removeClass) {
                c.removeClass("active")
            }
        }
        b.addClass("active")
    }
},getToolTemplate:function() {
    var b = this;
    if (!b._toolTemplate) {
        var c = new Ext.XTemplate('<div class="x-tool x-tool-{id}">&#160;</div>');
        var a = new Ext.XTemplate('<div class="text-tool">{[this.getText(values)]}&#160;</div>', {getText:function(d) {
            if (d && d.text) {
                return d.text
            } else {
                if (d) {
                    return d.id
                } else {
                    return"link"
                }
            }
        }});
        b._toolTemplate = new Ext.XTemplate("{[this.getToolTemplate(values)]}", {getToolTemplate:function(d) {
            var f = d.link,e = d.seperator;
            if (f) {
                return a.apply(d)
            } else {
                if (e) {
                    return String.format('<div class="text-tool dont-link">{0}&#160;</div>', d.text)
                } else {
                    return c.apply(d)
                }
            }
        }})
    }
    return b._toolTemplate
},loadEventHistory:function(g) {
    var b = this;
    if (g || b.rowData) {
        b.rowData = g || b.rowData
    } else {
        return
    }
    var b = this,f = b.rowData.engagementWorkFlowItems || [],e = b.getAllEventHistoryTemplate();
    var d = [];
    var a = 0;
    if (b.limit >= 0) {
        a = f.length - b.limit;
        if (a < 0) {
            a = 0
        }
    }
    for (var c = f.length - 1; c >= a; c--) {
        d.push(f[c])
    }
    if (b.body) {
        e.overwrite(b.body, d)
    } else {
        b.on("afterrender", function() {
            e.overwrite(b.body, d)
        }, this, {single:true})
    }
},getSingleEventHistoryTemplate:function() {
    var a = this;
    if (!a._singleEventTemplate) {
        a._singleEventTemplate = new Ext4.XTemplate('<tpl if="this.isMostRecentEvent()">', "<div style=\"background:url('{[this.getIcon(values)]}') no-repeat; padding-left:25px; min-height:16px\">", "<span >{[this.getActionDetails(values)]}</span>", "</tpl>", '<tpl if="!this.isMostRecentEvent()">', "<div style=\"background:url('{[this.getIcon(values)]}') no-repeat 0 3px; padding-left:25px; \">", "<span >{[this.getActionDetails(values)]}</span>", "</tpl>", '<tpl if="this.isMostRecentEvent()">', "&nbsp", "</tpl>", '<tpl if="!this.isMostRecentEvent(values)">', "<br>", "</tpl>", "<span>{[this.getActionDateTime(values)]}</span>", "</div>", {isMostRecentEvent:function() {
            if (a.itemId === "mostrecentmultichanneleventhistory") {
                return true
            } else {
                return false
            }
        },getActionDetails:function(b) {
            var c = this.getAction(b);
            switch (c) {case Explore.model.EngagementWorkFlowActions.AddNotes:return this.getActionDetailsAddNotes(b);
                case Explore.model.EngagementWorkFlowActions.AssignedProjects:return this.getActionDetailsAssignedProjects(b);case Explore.model.EngagementWorkFlowActions.AssignedUsers:return this.getActionDetailsAssignedUsers(b);
                case Explore.model.EngagementWorkFlowActions.ChangePriority:return this.getActionDetailsChangePriority(b);case Explore.model.EngagementWorkFlowActions.ChangeStatus:return this.getActionDetailsChangeStatus(b);
                case Explore.model.EngagementWorkFlowActions.AssignedTags:return this.getActionDetailsAssignedTags(b);case Explore.model.EngagementWorkFlowActions.AssignedClassification:return this.getActionDetailsAssignedClassifications(b);
                case Explore.model.EngagementWorkFlowActions.AssignedSentiment:return this.getActionDetailsAssignedSentiment(b);case Explore.model.EngagementWorkFlowActions.Responded:return this.getActionDetailsResponded(b)
            }
        },getActionDetailsAssignedSentiment:function(b) {
            var d = Explore.i18n("assigned sentiment:"),c = b.Sentiment;
            return String.format("{0} {1} {2}", b.LastModifiedByName, d, c)
        },getActionDetailsAssignedTags:function(b) {
            var d = Explore.i18n("assigned tags:"),c = b.TagNames || [],e = c.join(", ");
            return String.format("{0} {1} {2}", b.LastModifiedByName, d, e)
        },getActionDetailsAssignedClassifications:function(b) {
            var e = Explore.i18n("assigned classifications:"),d = b.ClassificationNames || [],c = d.join(", ");
            return String.format("{0} {1} {2}", b.LastModifiedByName, e, c)
        },getActionDetailsChangeStatus:function(d) {
            var e = Explore.i18n("changed status"),c = (d.CurrentStatusName || Explore.i18n("None")),b = (d.PreviousStatusName || Explore.i18n("None"));
            return String.format("{0} {1} from {2} to {3}", d.LastModifiedByName, e, b, c)
        },getActionDetailsChangePriority:function(b) {
            var c = Explore.i18n("changed priority:");
            priority = Explore.model.EngagementPriority.getName(b.Priority);
            return String.format("{0} {1} {2}", b.LastModifiedByName, c, priority)
        },getActionDetailsAssignedUsers:function(b) {
            var d = Explore.i18n("assigned to users:");
            var c = "";
            if (b.UserNames != null) {
                c = b.UserNames.join(", ")
            }
            return String.format("{0} {1} {2}", b.LastModifiedByName, d, c)
        },getActionDetailsAssignedProjects:function(c) {
            var b = Explore.i18n("assigned to projects:");
            var d = "";
            if (c.ProjectNames != null) {
                d = c.ProjectNames.join(", ")
            }
            return String.format("{0} {1} {2}", c.LastModifiedByName, b, d)
        },getActionDetailsAddNotes:function(b) {
            var c = Explore.i18n("added note:");
            return String.format("{0} {1} {2}", b.LastModifiedByName, c, b.Notes)
        },getActionDetailsResponded:function(b) {
            var c = Explore.i18n("responded.");
            return String.format("{0} {1}", b.LastModifiedByName, c)
        },getAction:function(b) {
            var c = b.Actions[0];
            return c
        },getActionName:function(b) {
            return Explore.model.EngagementWorkFlowActions.getName(this.getAction(b))
        },getActionDateTime:function(b) {
            var c = Explore.formatDateByPref(b.LastModifiedOn, {ignoreTime:true}),d = Explore.formatTimeByPref(b.LastModifiedOn);
            return String.format("{0} {1} {2}", c, Explore.i18n("at"), d)
        },getIcon:function(b) {
            var d = this.getAction(b);
            switch (d) {case Explore.model.EngagementWorkFlowActions.AddNotes:return"../resources/images/icons/ic_note.png";
                case Explore.model.EngagementWorkFlowActions.AssignedProjects:if (b.ProjectNames != null && b.ProjectNames.length > 1) {
                    return"../resources/images/icons/ic_multiple_users.png"
                } else {
                    return"../resources/images/icons/ic_user.png"
                }case Explore.model.EngagementWorkFlowActions.AssignedUsers:if (b.UserNames != null && b.UserNames.length > 1) {
                return"../resources/images/icons/ic_multiple_users.png"
            } else {
                return"../resources/images/icons/ic_user.png"
            }case Explore.model.EngagementWorkFlowActions.ChangePriority:switch (b.Priority) {case Explore.model.EngagementPriority.None:return"../resources/images/icons/ic_priority_none.png";
                case Explore.model.EngagementPriority.Low:return"../resources/images/icons/ic_priority_low.png";case Explore.model.EngagementPriority.Medium:return"../resources/images/icons/ic_priority_medium.png";
                case Explore.model.EngagementPriority.High:return"../resources/images/icons/ic_priority_high.png";default:return Ext.BLANK_IMAGE_URL
            }case Explore.model.EngagementWorkFlowActions.ChangeStatus:return"../resources/images/icons/ic_assign_status.png";case Explore.model.EngagementWorkFlowActions.AssignedTags:return"../resources/images/icons/ic_tag.png";
                case Explore.model.EngagementWorkFlowActions.AssignedClassification:return"../resources/images/icons/ic_assign_classification.png";
                case Explore.model.EngagementWorkFlowActions.AssignedSentiment:var c = b.Sentiment ? b.Sentiment.toUpperCase() : "";switch (c) {case"POSITIVE":return"../resources/images/icons/ic_strong_positive.png";
                    case"NEUTRAL":return"../resources/images/icons/ic_neutral.png";case"NEGATIVE":return"../resources/images/icons/ic_strong_negative.png";
                    default:return Ext.BLANK_IMAGE_URL
                }
            }
            return"../resources/images/icons/icn_multichannel_Micro Media_16.png"
        }})
    }
    return a._singleEventTemplate
},getAllEventHistoryTemplate:function() {
    if (!this._eventHistoryTemplate) {
        var c = this;
        var b = this.getSingleEventHistoryTemplate();
        var a = new Ext4.XTemplate();
        var d = new Ext4.XTemplate('<div class="empty-message">{[this.getEmptyMessage()]}</div>', {getEmptyMessage:function() {
            return Explore.i18n("No Event History")
        }});
        this._eventHistoryTemplate = new Ext4.XTemplate('<tpl if="length==0">', "<div>", "</tpl>", '<tpl if="length!=0">', '<div class="' + c.wrapperClass + '">', "</tpl>", '<tpl if="length==0">', "{[this.getEmptyTemplate()]}", "</tpl>", '<tpl for=".">', '<div class="hyperlink-result">', "{[this.renderEvent(values)]}", "</div>", "</tpl>", "</div>", {renderEvent:function(e) {
            return b.apply(e)
        },getEmptyTemplate:function() {
            if (c.itemId === "mostrecentmultichanneleventhistory") {
                return a.apply({})
            } else {
                return d.apply({})
            }
        },getSourceLink:function(e) {
            if (!e || !e.sourceUrl) {
                return""
            }
            var f = '<span class="search-result-link"><a target="_blank" href="{0}">Click here to view source</a></span>';
            return String.format(f, e.sourceUrl)
        }})
    }
    return this._eventHistoryTemplate
}});
Ext.reg("explore.view.searchresultdetail.multichanneleventhistory", Explore.view.searchresultdetail.MultiChannelEventHistory);
Ext.ns("Explore.view.searchresultdetail");
Explore.view.searchresultdetail.RelatedDocumentsComponent = Ext.extend(Ext.Panel, {border:false,frame:false,rowData:null,docTypesForRelatedItems:[],collapsible:true,collapsed:true,hideCollapseTool:true,cls:"engagement",defaultToolLink:"choosedocumenttypes",wrapperClass:"search-result-hyperlinking-body",initComponent:function() {
    var a = this;
    var b = {title:Explore.i18n("similarArticles"),html:String.format('<div class="search-result-hyperlinking-body" style="display:none"></div>')};
    this.toolTemplate = a.getToolTemplate();
    this.tools = [
        {id:"choosedocumenttypes",text:"Choose Document Types",link:true,handler:function(e, d, c) {
            a.performSearchBasedOnDocTypes()
        }},
        {id:"toggle",handler:function(e, d, c) {
            c.toggleCollapse()
        }}
    ];
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.searchresultdetail.RelatedDocumentsComponent.superclass.initComponent.apply(this, arguments);
    a.addListeners();
    a.on("afterrender", function() {
        a.setActiveTool("choosedocumenttypes");
        a.getRelatedDocuments(a.rowData)
    })
},setActiveTool:function(d) {
    var b = this;
    var a = b.getTool(d);
    if (a) {
        for (toolId in b.tools) {
            var c = b.getTool(toolId);
            if (c && c.removeClass) {
                c.removeClass("active-blue")
            }
        }
        a.addClass("active-blue")
    }
},addListeners:function() {
    var a = this;
    a.on("afterrender", function() {
        a.setActiveTool(a.defaultToolLink)
    })
},getToolTemplate:function() {
    var b = this;
    if (!b._toolTemplate) {
        var c = new Ext.XTemplate('<div class="x-tool x-tool-{id}">&#160;</div>');
        var a = new Ext.XTemplate('<div class="text-tool">{[this.getText(values)]}&#160;</div>', {getText:function(d) {
            if (d && d.text) {
                return d.text
            } else {
                if (d) {
                    return d.id
                } else {
                    return"link"
                }
            }
        }});
        b._toolTemplate = new Ext.XTemplate("{[this.getToolTemplate(values)]}", {getToolTemplate:function(d) {
            var f = d.link,e = d.seperator;
            if (f) {
                return a.apply(d)
            } else {
                if (e) {
                    return String.format('<div class="text-tool dont-link">{0}&#160;</div>', d.text)
                } else {
                    return c.apply(d)
                }
            }
        }})
    }
    return b._toolTemplate
},getRelatedDocuments:function(e) {
    if (!e && !this.rowData) {
        return
    } else {
        if (e && !this.getEl()) {
            this.rowData = e;
            return
        }
    }
    this.rowData = e || this.rowData;
    var b = this,d = b.getEl(),a = new Ext.LoadMask(b.body, {msg:"Loading..." + Explore.i18n("similarArticles")});
    docIds = [e.id];
    a.show();
    var c = 3;
    Explore.data.IDOLDataStore.getRelatedDocuments(docIds, null, c, function(g) {
        if (e.id !== b.rowData.id) {
            return
        }
        a.hide();
        b.expand(true);
        if (g.rows.length > 0) {
            var l = d.query(".search-result-hyperlinking-body")[0];
            if (!l) {
                return
            }
            l.style.display = "";
            var k = g.rows.source;
            var j = this.hlTemplate = new Ext.XTemplate('<tpl for="rows"><div class="hyperlink-result">', '<img src="../resources/images/icons/icn_multichannel_{type}_16.png" alt="{type}" style="vertical-align: middle" />&nbsp;', '<a class="title" href="#">{[Explore.SearchResults.getTitleForRecord(values)]}</a>', "<br />&nbsp;{[Explore.SearchResults.getRelativeTime(values)]}</div></tpl>");
            j.overwrite(l, g);
            var f = d.query("a.title");
            for (var h = 0; h < f.length; h++) {
                b.addHyperlinkHandler(f[h], g.rows, h)
            }
            b.fireEvent("doneretrievingdocuments")
        }
    })
},performSearchBasedOnDocTypes:function() {
    var a = this;
    var b = new Explore.view.SearchOnSimilarArticlesDialog({itemId:"_doctypes",title:Explore.i18n("ChooseDocumentTypes"),editObject:a.docTypesForRelatedItems});
    b.on("save", function(c, d) {
        a.docTypesForRelatedItems = d;
        var e = new Ext.LoadMask(a.getEl(), {msg:"Loading..."});
        e.show();
        b.hide();
        a.applySearchBasedOnDocType(a.docTypesForRelatedItems);
        e.hide()
    });
    b.show()
},applySearchBasedOnDocType:function(c) {
    var b = this,e = b.getEl(),a = new Ext.LoadMask(e, {msg:"Loading..."});
    docIds = [b.rowData.id];
    a.show();
    var d = 3;
    Explore.data.IDOLDataStore.getRelatedDocuments(docIds, c, d, function(h) {
        if (h.rows.length > 0) {
            var l = e.query(".search-result-hyperlinking-body")[0];
            if (!l) {
                return
            }
            l.style.display = "";
            var k = h.rows.source;
            this.hlTemplate.overwrite(l, h);
            var f = e.query("a.title");
            for (var j = 0;
                 j < f.length; j++) {
                b.addHyperlinkHandler(f[j], h.rows, j)
            }
        } else {
            var g = e.query(".search-result-hyperlinking-body")[0];
            g.innerHTML = "No Similar Document(s) Found"
        }
    })
},addHyperlinkHandler:function(c, d, b) {
    var a = this;
    Ext.fly(c).on("click", function(f) {
        a.fireEvent("relateddocumentclicked", c, d, b);
        return false
    })
}});
Ext.reg("explore.view.searchresultdetail", Explore.view.searchresultdetail.RelatedDocumentsComponent);
Ext.ns("Explore.view.searchresultdetail");
Explore.view.searchresultdetail.TwitterPanel = Ext.extend(Ext.Panel, {frame:false,border:false,rowData:null,initComponent:function() {
    var a = this;
    var b = {items:[a.getContentPanel(),a.getResponsePanel()],fbar:[
        {xtype:"button",text:Explore.i18n("Respond"),itemId:"respondBtn",handler:function() {
            a.showResponsePanel(true)
        }}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.searchresultdetail.TwitterPanel.superclass.initComponent.apply(this, arguments);
    this.addListeners()
},addListeners:function() {
    var a = this;
    a.getContentPanel().on("afterrender", function() {
        a.processTwitterContent(a.rowData)
    })
},showResponsePanel:function(b) {
    var c = this;
    var a = c.getResponsePanel(),e = c.fbar.getByItemId("respondBtn");
    a.setVisible(b);
    e.setVisible(!b);
    if (b) {
        var d = c.getRespondToUser(c.rowData);
        c.enableTwitterButtons();
        c._responseTextArea.setDisabled(false);
        c._responseTextArea.setRawValue(d);
        a.getByItemId("replyBtn").toggle(true);
        a.getByItemId("directMsgBtn").toggle(false);
        a.getByItemId("retweetBtn").toggle(false);
        a.getByItemId("postBtn").setDisabled(true)
    }
},getRespondToUser:function(a) {
    var b = "";
    if (a && a.fields && a.fields.username) {
        b = "@" + a.fields.username + " "
    }
    return b
},getContentPanel:function() {
    var a = this;
    if (!a._contentPanel) {
        a._contentPanel = new Ext.Panel({itemId:"contentPanel",xtype:"panel",border:false,frame:false,html:"Loading content...."})
    }
    return a._contentPanel
},getResponsePanel:function() {
    var a = this;
    if (!a._responsePanel) {
        var b = a._responseTextArea = new Ext.form.TextArea({height:60,fieldLabel:Explore.i18n("Response"),itemId:"responseTextField",allowBlank:false,width:"95%",enableKeyEvents:true,listeners:{keypress:function(c, d) {
            if (d.getKey() == d.RETURN || d.getKey() == d.ENTER) {
                d.stopEvent()
            }
        },keyup:function(f, g) {
            var d = a.getByItemId("engagementResponsePanel");
            var j = d.getByItemId("postBtn");
            var c = d.getByItemId("accountsComboBox").getValue().toString();
            var h = (f.getRawValue().trim() === "") || (c.trim() === "");
            j.setDisabled(h);
            if (!h) {
                if (g.getKey() == g.RETURN || g.getKey() == g.ENTER) {
                    a.postResponse()
                }
            }
        },scope:this}});
        a._responsePanel = new Ext.form.FormPanel({padding:10,cls:"engagement",hidden:true,itemId:"engagementResponsePanel",border:false,frame:false,labelWidth:100,title:Explore.i18n("Response"),buttonAlign:"left",fbar:[
            {xtype:"button",itemId:"replyBtn",handler:this.replyTweet,tooltip:Explore.i18n("Reply"),iconCls:"twitterReplyBtn",enableToggle:true,pressed:true,scope:this},
            {xtype:"button",itemId:"directMsgBtn",handler:this.directMsgTweet,tooltip:Explore.i18n("DirectMessage"),iconCls:"twitterDirectMsgBtn",disabled:true,enableToggle:true,pressed:false,scope:this},
            {xtype:"button",itemId:"retweetBtn",handler:this.reTweet,disabled:true,tooltip:Explore.i18n("Retweet"),iconCls:"twitterRetweetBtn",enableToggle:true,pressed:false,scope:this},
            "->",
            {xtype:"button",text:Explore.i18n("Post"),itemId:"postBtn",handler:this.postResponse,disabled:true,scope:this},
            {xtype:"button",text:Explore.i18n("Cancel"),itemId:"cancelBtn",handler:function() {
                a.showResponsePanel(false)
            }}
        ],items:[a.getAccountsComboBox(),b]})
    }
    return a._responsePanel
},HasInfoForReply:function() {
    var a = this;
    var b = false;
    if (a.rowData && a.rowData.fields && a.rowData.fields.username) {
        b = true
    }
    return b
},HasInfoForRetweet:function() {
    var a = this;
    var b = false;
    if (a.rowData && a.rowData.id && a.rowData.fields && a.rowData.fields.title) {
        b = true
    }
    return b
},HasInfoForDirectMsg:function() {
    var a = this;
    var b = false;
    if (a.rowData && a.rowData.fields && a.rowData.fields.userid) {
        b = true
    }
    return b
},getAccountsComboBox:function() {
    if (!this._comboBox) {
        var a = this;
        var b = Explore.getDefaultSocialAccByType(Explore.model.SocialMediaType.Twitter);
        this._comboBox = new Explore.view.common.SelectBoxField({allowBlank:false,fieldLabel:Explore.i18n("CurrentTwitterAccount"),forceSelection:true,itemId:"accountsComboBox",triggerAction:"all",mode:"local",width:160,value:(b && b.AccountId) ? b.AccountId : "",editable:false,listeners:{select:function(e, c, d) {
            a.setDefaultAccount(Explore.model.SocialMediaType.Twitter, c.get("accountId"))
        }},store:a.getComboStore(),displayField:"userName",valueField:"accountId"})
    }
    return this._comboBox
},getComboStore:function() {
    if (!this._comboStore) {
        var a = this;
        this._comboStore = new Ext.data.ArrayStore({id:0,fields:["userName","accountId"],data:a.setStoreData()})
    }
    return this._comboStore
},setStoreData:function() {
    var b = Explore.getSocialAccountsByType(Explore.model.SocialMediaType.Twitter);
    var d = new Array();
    if (b && b.length > 0) {
        for (var a = 0; a < b.length; a++) {
            var c = new Array();
            c.push("@" + b[a].ScreenName, b[a].AccountId);
            d.push(c)
        }
    }
    return d
},setDefaultAccount:function(b, c) {
    var a = this;
    SourceService.SetDefaultSocialMediaAccount(b, c, function(d) {
        if (d) {
            if (!d.Message) {
                currentUser = d.Result
            } else {
                Explore.view.StatusBox.showWarning(Explore.i18n("appTitle"), d.Message)
            }
        } else {
        }
    })
},enableTwitterButtons:function() {
    var b = this;
    var a = b.getByItemId("engagementResponsePanel");
    if (b.HasInfoForRetweet()) {
        var c = a.getByItemId("retweetBtn");
        c.setDisabled(false)
    }
    if (b.HasInfoForDirectMsg()) {
        var d = a.getByItemId("directMsgBtn");
        if (b.rowData.fields.userid) {
            SourceService.IsReceiverAFollower(b.rowData.fields.userid, function(e) {
                if (e) {
                    if (!e.Message) {
                        d.setTooltip(Explore.i18n("DirectMessage"));
                        d.setDisabled(false)
                    } else {
                        d.setTooltip(Explore.i18n("DirectMsgWarning"));
                        d.setDisabled(true)
                    }
                }
            })
        } else {
            d.setDisabled(true)
        }
    }
},replyTweet:function(d) {
    var b = this;
    var a = b.getByItemId("engagementResponsePanel");
    a.getByItemId("replyBtn").toggle(true);
    a.getByItemId("directMsgBtn").toggle(false);
    a.getByItemId("retweetBtn").toggle(false);
    var c = b.getRespondToUser(b.rowData);
    b._responseTextArea.setRawValue(c);
    b._responseTextArea.setDisabled(false);
    var e = a.getByItemId("postBtn");
    e.setDisabled(true)
},directMsgTweet:function(c) {
    var b = this;
    var a = b.getByItemId("engagementResponsePanel");
    a.getByItemId("replyBtn").toggle(false);
    a.getByItemId("directMsgBtn").toggle(true);
    a.getByItemId("retweetBtn").toggle(false);
    b._responseTextArea.setDisabled(false);
    b._responseTextArea.setRawValue("");
    var d = a.getByItemId("postBtn");
    d.setDisabled(true)
},reTweet:function(c) {
    var b = this;
    var a = b.getByItemId("engagementResponsePanel");
    a.getByItemId("replyBtn").toggle(false);
    a.getByItemId("directMsgBtn").toggle(false);
    a.getByItemId("retweetBtn").toggle(true);
    if (b.HasInfoForRetweet()) {
        b._responseTextArea.setRawValue(b.rowData.fields.title);
        b._responseTextArea.setDisabled(true);
        var d = a.getByItemId("postBtn");
        d.setDisabled(false)
    }
},getTwitterAction:function() {
    var b = this;
    var e = Explore.model.TwitterAction.UpdateReplyStatus;
    var a = b.getByItemId("engagementResponsePanel");
    var f = a.getByItemId("replyBtn");
    var c = a.getByItemId("retweetBtn");
    var d = a.getByItemId("directMsgBtn");
    if (f.pressed) {
        e = Explore.model.TwitterAction.UpdateReplyStatus
    } else {
        if (c.pressed) {
            e = Explore.model.TwitterAction.Retweet
        } else {
            if (d.pressed) {
                e = Explore.model.TwitterAction.DirectMsg
            }
        }
    }
    return e
},postResponse:function() {
    var j = this;
    var c = this.rowData.id;
    var h = this.getByItemId("responseTextField");
    var d = this.getByItemId("accountsComboBox");
    if (h.isValid() && d.isValid()) {
        var a = this.getResponsePanel().getEl();
        a.mask(Explore.i18n("Posting response..."));
        var e = "";
        var f = "";
        var g = h.getValue();
        var b = j.getTwitterAction();
        if (j.HasInfoForDirectMsg()) {
            e = j.rowData.fields.userid
        }
        if (b === Explore.model.TwitterAction.Retweet && j.HasInfoForRetweet()) {
            f = j.rowData.id
        }
        Explore.data.EngagementDataStore.respondToTweet(c, g, f, e, b, function(k) {
            a.unmask();
            if (k.ErrorCode !== 0) {
                Explore.view.StatusBox.showError(Explore.i18n("appTitle"), k.Message)
            } else {
                h.setValue("");
                j.showResponsePanel(false)
            }
        })
    }
},processTwitterContent:function(c) {
    if (!c && !this.rowData) {
        return
    } else {
        if (c && !this.getEl()) {
            this.rowData = c;
            return
        }
    }
    var a = this;
    el = a.getContentPanel().getEl(),a.rowData = c || a.rowData,template = a.getTwitterTemplate();
    template.overwrite(el, c);
    var b = el.query(".author");
    if (b.length > 0) {
        b = Ext.fly(b[0]);
        b.on("click", function() {
            var d = a.rowData.fields || {},e = d.userid;
            if (e) {
                a.showUserDetailDialogue(e)
            }
        })
    }
},showUserDetailDialogue:function(a) {
    var b = new Explore.view.twitter.TwitterUserWindow({userId:a});
    b.show()
},getTwitterTemplate:function() {
    var a = this;
    if (!a._twitterTemplate) {
        var b = new Ext.XTemplate('<div class="search-result-details">', '<tpl for="."><span><b>{Name}:</b> {Value}</span><br /></tpl>', "</div>");
        a._twitterTemplate = new Ext.XTemplate('<div class="search-result">', "{[this.getProfileImage(values)]}", "<h1>{[this.getHeaderTitle(values)]}</h1>", '<span class="sentiment">{[this.getSentiment(values)]}</span>', '<div class="search-result-hdr">', "{[this.getFrom(values)]}", '(<span class="type">{type}</span> <img src="../resources/images/icons/icn_multichannel_{type}_16.png" alt="{type}" style="vertical-align: middle" />) ', "{[this.getPostDate(values)]} ", "{[this.getArticleSource(values)]}", "</div>", '<div class="search-result-clear"></div>', "{[this.getFollowers(values)]}", "{[this.getDetailsFields(values)]}", '<div class="search-result-body">{[this.getBodyHtml(values)]}<br/></div>', '<div class="document-priority">Priority: <span class="document-meta-data-values">{[this.getPriority(values)]}</span></div>', '<div class="document-status">Status: <span class="document-meta-data-values">{[this.getStatus(values)]}</span></div>', '<div class="document-tags">Tag: <span class="document-meta-data-values">{[this.getTags(values)]}</span></div>', '<div class="document-classification">Classification: <span class="document-meta-data-values">{[this.getClassification(values)]}</span></div>', "</div>", {getBodyHtml:function(c) {
            var d = "";
            fields = c.fields,hilightOptions = Explore.data.PreferenceDataStore.getSelectedHighlightingOption(),bodyFields = Explore.SearchResults.getBodyFieldsByType(c.type);
            for (var e = 0; e < bodyFields.length; e++) {
                var f = fields[bodyFields[e]];
                if (f === null || f === undefined) {
                    f = ""
                }
                f = f.replace(/\n/g, "<br />");
                if (hilightOptions === "HighlightTermsOnly" || hilightOptions === "HilighTermAndMatchTerms") {
                    f = f.replace(/<explore_highlight>(.*?)<\/explore_highlight>/g, "<span class='highlight'>$1</span>")
                }
                f = Explore.SearchResults.createLinks(f);
                d += (f + "<br />")
            }
            return d
        },getDetailsFields:function(d) {
            var j = Explore.data.IDOLDataStore.getDocumentTypeConfigs(),c = d.fields,h = [];
            if (j != null && j.DetailFields != null) {
                for (var f = 0; f < j.DetailFields.length; f++) {
                    var e = j.DetailFields[f];
                    var g = {Name:e.Name,Value:c[e.Tag]};
                    if (g.Name !== null && g.Value !== undefined && g.Value !== null) {
                        h.push(g)
                    }
                }
            }
            return b.apply(h)
        },getFollowers:function(d) {
            var c = d.fields,e = (c.followers && c.following && c.updates),g = c.followers || "N/A",f = c.following || "N/A",h = c.updates || "N/A";
            if (e) {
                return String.format('<div class="search-result-followers"><span><b>{0}</b> {1}</span><span><b>{2}</b> {3}</span><span><b>{4}</b> {5}</span></div><br/>', f, Explore.i18n("Following"), g, Explore.i18n("Followers"), h, Explore.i18n("Updates"))
            } else {
                return""
            }
        },getArticleSource:function(d) {
            var c = d.fields,e = c.articleUrl;
            if (e) {
                return String.format('<span class="search-result-link"><a href="{0}" target="_blank"> {1}</a></span>', e, Explore.i18n("viewSource"))
            } else {
                return""
            }
        },getPostDate:function(c) {
            var d = Explore.formatDateByPref(c.date, {ignoreTime:true}),e = Explore.formatTimeByPref(c.date);
            return String.format("{0} {1} {2} {3}", Explore.i18n("on"), d, Explore.i18n("at"), e)
        },getHeaderTitle:function(c) {
            return Explore.SearchResults.getTitleForRecord(c)
        },getFrom:function(d) {
            var c = d.fields,e = c.author || c.teamMember || c.from || c.MAPISENDERNAME || "";
            if (e) {
                return String.format('{0} <span class="author">{1}</span>', Explore.i18n("by"), e)
            } else {
                return""
            }
        },getProfileImage:function(d) {
            var c = d.fields;
            if (c && c.profileimage) {
                return'<img src="' + c.profileimage + '"style="display:none; padding-right:10px; max-height:64px; max-width:64px; float:left;" alt="' + c.author + '" onload="Explore.showLoadedImage(this)" />'
            } else {
                return""
            }
        },getSentiment:function(d) {
            var c = Explore.data.PreferenceDataStore.getShowSentimentPreference();
            var g = Explore.SearchResults.getWorkflowItem(d.engagementWorkFlowItems, Explore.model.EngagementWorkFlowActions.AssignedSentiment);
            var f = (g !== null) ? g.Sentiment : d.fields.sentiment;
            if (c) {
                if (f) {
                    var e = '<img style="vertical-align: middle" alt="{0}" src="{1}">',h = "";
                    f = f.toUpperCase();
                    if (f === "POSITIVE") {
                        h = "../resources/images/icons/ic_strong_positive.png"
                    } else {
                        if (f === "NEUTRAL") {
                            h = "../resources/images/icons/ic_neutral.png"
                        } else {
                            if (f === "NEGATIVE") {
                                h = "../resources/images/icons/ic_strong_negative.png"
                            }
                        }
                    }
                    return String.format(e, f, h)
                } else {
                    return""
                }
            } else {
                return""
            }
        },getClassification:function(c) {
            var d = Explore.SearchResults.getWorkflowItem(c.engagementWorkFlowItems, Explore.model.EngagementWorkFlowActions.AssignedClassification);
            return(d && d.ClassificationNames) ? d.ClassificationNames.join(", ") : ""
        },getPriority:function(c) {
            var d = Explore.SearchResults.getWorkflowItem(c.engagementWorkFlowItems, Explore.model.EngagementWorkFlowActions.ChangePriority);
            return(d && d.Priority) ? Explore.model.EngagementPriority.getName(d.Priority) : ""
        },getStatus:function(c) {
            var d = Explore.SearchResults.getWorkflowItem(c.engagementWorkFlowItems, Explore.model.EngagementWorkFlowActions.ChangeStatus);
            return(d && d.CurrentStatusName) ? d.CurrentStatusName : ""
        },getTags:function(c) {
            var d = Explore.SearchResults.getWorkflowItem(c.engagementWorkFlowItems, Explore.model.EngagementWorkFlowActions.AssignedTags);
            return(d && d.TagNames) ? d.TagNames.join(", ") : (c.tag || "")
        }})
    }
    return a._twitterTemplate
}});
Ext.reg("explore.view.searchresultdetail.twitterPanel", Explore.view.searchresultdetail.TwitterPanel);
Ext.ns("Explore.view.searchresultdetail");
Explore.view.searchresultdetail.TwitterDetailResultPanel = Ext.extend(Ext.Panel, {rowData:null,frame:false,border:false,padding:10,autoScroll:true,initComponent:function() {
    var a = this;
    this.contentPanel = new Explore.view.searchresultdetail.TwitterPanel({itemId:"contentPanel"});
    this.relatedDocumentsPanel = new Explore.view.searchresultdetail.RelatedDocumentsComponent({itemId:"relatedDocumentsPanel",listeners:{relateddocumentclicked:function(d, e, c) {
        a.fireEvent("relateddocumentclicked", d, e, c)
    },doneretrievingdocuments:function() {
        a.fireEvent("doneretrievingdocuments")
    }}});
    this.applyChangesDetail = new Explore.view.searchresultdetail.ApplyChangesDetail({cls:"engagement-border-bottom"});
    this.assignDetail = new Explore.view.searchresultdetail.AssignDetail({cls:"engagement-border-bottom"});
    this.multichanneleventhistory = new Explore.view.searchresultdetail.MultiChannelEventHistory({itemId:"multichanneleventhistory",limit:5,recentLimit:5,collapsed:false});
    this.mostrecentmultichanneleventhistory = new Explore.view.searchresultdetail.MultiChannelEventHistory({itemId:"mostrecentmultichanneleventhistory",wrapperClass:"blue-background",header:false,limit:1,collapsed:false});
    this.responsePanel = new Explore.view.searchresultdetail.EngagementResponsePanel({});
    var b = {layout:"border",defaults:{autoScroll:true},items:[
        {region:"west",width:320,baseCls:"engagement-side-panel-top",title:Explore.i18n("Engagement"),toolTarget:"body",collapsible:true,stateful:true,stateId:"twitter-engagement-panel",items:[this.applyChangesDetail,this.assignDetail,this.relatedDocumentsPanel]},
        {region:"center",padding:7,items:[this.mostrecentmultichanneleventhistory,this.contentPanel,this.responsePanel,this.multichanneleventhistory]}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.searchresultdetail.TwitterDetailResultPanel.superclass.initComponent.apply(this, arguments);
    this.mon(Explore.data.EngagementDataStore, "engagementWorkflowModified", function(c, d) {
        if (a.rowData != null && (c === a.rowData.id)) {
            if (a.rowData.engagementWorkFlowItems == null) {
                a.rowData.engagementWorkFlowItems = []
            }
            a.rowData.engagementWorkFlowItems.push(d);
            a.displayDetails(false)
        }
    }, this);
    this.mon(Explore.data.EngagementDataStore, "engagementResponseModified", function(c, d, e) {
        if (a.rowData != null && (c === a.rowData.id)) {
            if (a.rowData.engagementResponses == null) {
                a.rowData.engagementResponses = []
            }
            a.rowData.engagementResponses.push(d);
            a.responsePanel.loadResponses(this.rowData)
        }
    }, this)
},reloadData:function() {
    var b = this;
    if (typeof(this.getDocumentBodyFn) === "function") {
        var a = new Ext.LoadMask(b.body, {msg:Explore.i18n("loadingDocument")});
        a.show();
        this.getDocumentBodyFn(b.rowData.id, function(c) {
            a.hide();
            if (c && c.rows && c.rows.length > 0) {
                b.rowData.engagementWorkFlowItems = c.rows[0].engagementWorkFlowItems;
                b.rowData.engagementResponses = c.rows[0].engagementResponses;
                b.rowData.fields = c.rows[0].fields;
                b.rowData.hasLoadedDetails = true
            }
            b.displayDetails(true)
        })
    }
},displayDetails:function(a) {
    this.contentPanel.processTwitterContent(this.rowData);
    this.applyChangesDetail.setRowData(this.rowData);
    this.assignDetail.setRowData(this.rowData);
    this.multichanneleventhistory.loadEventHistory(this.rowData);
    this.mostrecentmultichanneleventhistory.loadEventHistory(this.rowData);
    if (a) {
        this.contentPanel.showResponsePanel(false);
        this.relatedDocumentsPanel.getRelatedDocuments(this.rowData);
        this.responsePanel.loadResponses(this.rowData)
    }
},processTwitterContent:function(b) {
    var a = this;
    if (!b && !a.rowData) {
        return
    }
    a.rowData = b || a.rowData;
    this.reloadData()
}});
Ext.reg("explore.view.searchresultdetail.twitterdetailresultpanel", Explore.view.searchresultdetail.TwitterDetailResultPanel);
Ext.ns("Explore.view.searchresultdetail.assignitems");
Explore.view.searchresultdetail.assignitems.Classification = Ext.extend(Explore.view.searchresultdetail.AssignItemComponent, {initComponent:function() {
    var b = this;
    var c = this.tagType = {key:"CLASSIFICATIONS",text:Explore.i18n("Classifications"),selections:this.currentClassifications,idProperty:"Id",gridConfig:{store:{xtype:"jsonstore",proxy:new Ext.data.MemoryProxy(Explore.data.MetaDataStore.getRecordingClassificationNames()),autoLoad:true,fields:[
        {name:"Id",type:"int"},
        {name:"Name"}
    ]},columns:[
        {dataIndex:"Name",header:Explore.i18n("Name")}
    ]}};
    var a = {iconCls:"assignClassificationIcon",fieldLabel:Explore.i18n("Add Classifications"),singularLabel:Explore.i18n("Classification"),pluralLabel:Explore.i18n("Classifications"),assignConfig:{types:[c]}};
    Ext.apply(this, a);
    Explore.view.searchresultdetail.assignitems.Classification.superclass.initComponent.apply(this, arguments);
    b.on("save", this.saveClassifications, this)
},updateTextField:function(a, b) {
    Explore.view.searchresultdetail.assignitems.Classification.superclass.updateTextField.call(this, a, b);
    this.tagType.selections = a
},saveClassifications:function(h, k, e) {
    var f = [],j = [],a = e.CLASSIFICATIONS;
    if (a) {
        for (var g = 0; g < a.length;
             g++) {
            var c = a[g],d = c.Id,b = c.Name;
            f.push(d);
            j.push(b)
        }
        this.setValue({ids:f,names:j})
    }
}});
Ext.reg("explore.view.searchresultdetail.assignitems.classification", Explore.view.searchresultdetail.assignitems.Classification);
Ext.ns("Explore.view.searchresultdetail.assignitems");
Explore.view.searchresultdetail.assignitems.Project = Ext.extend(Explore.view.searchresultdetail.AssignItemComponent, {initComponent:function() {
    var c = this;
    var b = new Explore.view.DocCountColumn({header:Explore.i18n("Number of Documents"),sortable:false,id:"Documents",dataIndex:"Documents"});
    var d = this.projectType = {key:"PROJECTS",text:Explore.i18n("Projects"),selections:this.assignedProjects,idProperty:"Id",gridConfig:{plugins:[b],store:{xtype:"directstore",directFn:ProjectService.ListMyProjects,autoLoad:true,fields:[
        {name:"Id",type:"int"},
        {name:"Name"},
        {name:"Description"}
    ]},columns:[
        {dataIndex:"Name",header:Explore.i18n("Name")},
        {dataIndex:"Description",header:Explore.i18n("Description")},
        b
    ]}};
    var a = {fieldLabel:Explore.i18n("Projects"),singularLabel:Explore.i18n("Project"),pluralLabel:Explore.i18n("Projects"),assignConfig:{selectedType:"PROJECTS",types:[d]}};
    Ext.apply(this, a);
    Explore.view.searchresultdetail.assignitems.Project.superclass.initComponent.apply(this, arguments);
    c.on("save", this.saveProject, this)
},updateTextField:function(a, b) {
    Explore.view.searchresultdetail.assignitems.Users.superclass.updateTextField.call(this, a, b);
    this.projectType.selections = a
},saveProject:function(e, a, g) {
    var b = this,c = a.PROJECTS,h = g.PROJECTS;
    if (c != null) {
        var f = [];
        for (var d = 0;
             d < h.length; d++) {
            f.push(h[d].Name)
        }
        this.updateTextField(c, f)
    }
}});
Ext.reg("explore.view.searchresultdetail.assignitems.project", Explore.view.searchresultdetail.assignitems.Project);
Ext.ns("Explore.view.searchresultdetail.assignitems");
Explore.view.searchresultdetail.assignitems.Tags = Ext.extend(Explore.view.searchresultdetail.AssignItemComponent, {initComponent:function() {
    var b = this;
    var c = this.tagType = {key:"TAGS",text:Explore.i18n("Tags"),selections:this.currentTags,idProperty:"Id",gridConfig:{store:{xtype:"jsonstore",proxy:new Ext.data.MemoryProxy(Explore.data.MetaDataStore.getTags2()),autoLoad:true,fields:[
        {name:"Id",type:"int"},
        {name:"TagName"}
    ]},columns:[
        {dataIndex:"TagName",header:Explore.i18n("Name")}
    ]}};
    var a = {iconCls:"assignTagIcon",fieldLabel:Explore.i18n("Add Tags"),singularLabel:Explore.i18n("Tag"),pluralLabel:Explore.i18n("Tags"),assignConfig:{types:[c]}};
    Ext.apply(this, a);
    Explore.view.searchresultdetail.assignitems.Tags.superclass.initComponent.apply(this, arguments);
    b.on("save", this.saveTags, this)
},updateTextField:function(a, b) {
    Explore.view.searchresultdetail.assignitems.Users.superclass.updateTextField.call(this, a, b);
    this.tagType.selections = a
},saveTags:function(f, k, c) {
    var j = [];
    var h = [];
    var e = c.TAGS;
    if (e) {
        for (var d = 0; d < e.length; d++) {
            var g = e[d],a = g.TagName,b = g.Id;
            j.push(b);
            h.push(a)
        }
        this.setValue({ids:j,names:h})
    }
}});
Ext.reg("explore.view.searchresultdetail.assignitems.tags", Explore.view.searchresultdetail.assignitems.Tags);
Ext.ns("Explore.view.searchresultdetail.assignitems");
Explore.view.searchresultdetail.assignitems.Users = Ext.extend(Explore.view.searchresultdetail.AssignItemComponent, {initComponent:function() {
    var b = this;
    var c = this.userType = {key:"USERS",text:Explore.i18n("Users"),selections:this.assignedUsers,idProperty:"Id",gridConfig:{store:{xtype:"directstore",directFn:UserService.GetUsers,autoLoad:true,fields:[
        {name:"Id",type:"int"},
        {name:"FullNameFML"},
        {name:"Login"},
        {name:"Email"}
    ]},columns:[
        {dataIndex:"FullNameFML",header:Explore.i18n("Name")},
        {dataIndex:"Login",header:Explore.i18n("Username")},
        {dataIndex:"Email",header:Explore.i18n("Email")}
    ]}};
    var a = {name:"Users",itemId:"usersComp",xtype:"explore.view.searchresultdetail.assignitemcomponent",fieldLabel:Explore.i18n("Users"),singularLabel:Explore.i18n("User"),pluralLabel:Explore.i18n("Users"),assignConfig:{selectedType:"USERS",types:[c]}};
    Ext.apply(this, a);
    Explore.view.searchresultdetail.assignitems.Users.superclass.initComponent.apply(this, arguments);
    b.on("save", this.saveUsers, this)
},updateTextField:function(a, b) {
    Explore.view.searchresultdetail.assignitems.Users.superclass.updateTextField.call(this, a, b);
    this.userType.selections = a
},saveUsers:function(e, a, f) {
    var c = this,h = a.USERS,b = f.USERS;
    if (h != null) {
        var g = [];
        for (var d = 0; d < b.length;
             d++) {
            g.push(b[d].FullNameFML)
        }
        this.updateTextField(h, g)
    }
}});
Ext.reg("explore.view.searchresultdetail.assignitems.Users", Explore.view.searchresultdetail.assignitems.Users);
Ext.ns("Explore.view.twitter");
Explore.view.twitter.MostRecentTweetsPanel = Ext.extend(Ext.Panel, {userData:null,initComponent:function() {
    var b = this;
    var c = this._tweetDataView = new Ext.DataView({store:b.getStore(),tpl:b.getTweetTemplate(),emptyText:"No Tweets to display"});
    var a = {tbar:[
        {text:Explore.i18n("Most Recent Posts"),iconCls:"refresh-icon",handler:function() {
            b.fireEvent("refreshTweets")
        }}
    ],items:[c]};
    Ext.apply(this, a);
    Explore.view.twitter.MostRecentTweetsPanel.superclass.initComponent.apply(this, arguments)
},getMask:function(a) {
    return new Ext.LoadMask(this.getEl(), {msg:a || "Loading..."})
},displayUser:function(a) {
    var c = this;
    var b = c.getStore();
    c.userData = a || {};
    b.loadData(c.userData.Tweets || [])
},getUserImageUrl:function() {
    var a = "";
    if (this.userData && this.userData.ProfileImageUrl) {
        a = this.userData.ProfileImageUrl
    }
    return a
},getUserHandle:function() {
    var a = "";
    if (this.userData && this.userData.UserName) {
        a = this.userData.UserName
    }
    return a
},getTweetTemplate:function() {
    var a = this;
    if (!a._tweetTemplate) {
        a._tweetTemplate = new Ext.XTemplate('<tpl for=".">', '<div class="twitter-tweet-container"<tpl if="xindex!==xcount">style="border-bottom:solid;border-width:1px; border-color: #8298A7"</tpl>>', '<div style="{[this.getProfileImage()]}">', '<div class="twitter-profile-handle">{[this.getUserHandle()]}</div>', '<div class ="tweet-detail">{Text}</div>', "</div>", "</div>", "</tpl>", {getUserHandle:function() {
            return"@" + a.getUserHandle()
        },getProfileImage:function() {
            var b = "background:url('{0}') no-repeat; padding-left:64px; background-size: 50px; 50px;min-height:65px;";
            return String.format(b, a.getUserImageUrl())
        }})
    }
    return a._tweetTemplate
},getStore:function() {
    var a = this;
    if (!a._twitterStore) {
        a._twitterStore = new Ext.data.JsonStore({fields:["Text","TweetDate","TweetId"]})
    }
    return a._twitterStore
}});
Ext.reg("explore.view.twitter.mostrecenttweetspanel", Explore.view.twitter.MostRecentTweetsPanel);
Ext.ns("Explore.view.twitter");
Explore.view.twitter.TwitterUserProfilePanel = Ext.extend(Ext.Panel, {userData:null,border:false,frame:false,padding:5,cls:"engagement",initComponent:function() {
    var b = this;
    var a = {items:[b.getHeaderPanel(),b.getFormPanel()]};
    Ext.apply(this, a);
    Explore.view.twitter.TwitterUserProfilePanel.superclass.initComponent.apply(this, arguments);
    b.on("afterrender", function() {
        b.displayUser(b.userData)
    })
},getMask:function(a) {
    return new Ext.LoadMask(this.getEl(), {msg:a || "Loading..."})
},getHeaderPanel:function() {
    var a = this;
    if (!a._headerPanel) {
        a._headerPanel = new Ext.Component()
    }
    return a._headerPanel
},getFollowAction:function() {
    var a = this;
    if (!a._followAction) {
        a._followAction = new Ext.Action({width:"95%"})
    }
    return a._followAction
},followUser:function() {
    var c = this,a = c.userData,d = a.UserId,b = c.getMask("sending follow request");
    b.show();
    SourceService.FollowTwitterUser(d + "", function(e) {
        b.hide();
        c.fireEvent("refreshtweets")
    })
},unFollowUser:function() {
    var c = this,a = c.userData,d = a.UserId,b = c.getMask("sending unfollow request");
    b.show();
    SourceService.UnFollowTwitterUser(d + "", function(e) {
        b.hide();
        c.fireEvent("refreshtweets")
    })
},getFormPanel:function() {
    var n = this;
    var b = null;
    if (!n._formPanel) {
        var j = new Ext.form.DisplayField({fieldLabel:Explore.i18n("Followers")}),d = new Ext.form.DisplayField({fieldLabel:Explore.i18n("Following")}),h = new Ext.form.DisplayField({fieldLabel:Explore.i18n("Tweets")}),l = new Ext.form.DisplayField({fieldLabel:Explore.i18n("Favorites")}),m = new Ext.form.DisplayField({fieldLabel:Explore.i18n("Joined")}),k = new Ext.form.DisplayField({fieldLabel:Explore.i18n("Timezone")}),a = new Ext.form.DisplayField({fieldLabel:Explore.i18n("Protected")}),g = new Ext.form.DisplayField({fieldLabel:Explore.i18n("Web"),style:"word-wrap:break-word;"}),c = new Ext.form.DisplayField({fieldLabel:Explore.i18n("Twitter"),style:"word-wrap:break-word;"}),e = new Ext.Button(n.getFollowAction()),f = new Ext.Button({itemId:"updateProfileBtn",text:Explore.i18n("Update Profile"),style:"padding: 5px 0px 0px 0px;",disabled:false,width:"95%",handler:function() {
            if (n.userData) {
                mask = n.getMask("Updating Profile...");
                mask.show();
                IDOLService.UpdateTwitterProfile(n.userData.UserId, n.userData.Followers, n.userData.Following, n.userData.NumTweets, function() {
                    mask.hide()
                })
            }
        }});
        n._formPanel = new Ext.form.FormPanel({labelWidth:90,autoScroll:true,border:false,frame:false,items:[j,d,h,l,m,a,g,c,e,f],displayUser:function(p) {
            j.setValue(p.Followers);
            d.setValue(p.Following);
            h.setValue(p.NumTweets);
            k.setValue(p.TimeZone);
            l.setValue(p.Favorites);
            m.setValue(Explore.formatDateByPref(p.CreatedDate));
            a.setValue(!p.PublicProfile);
            g.setValue(String.format('<a href="{0}" target="_blank">{0}</a>', p.WebSite || ""));
            c.setValue(String.format('<a href="{0}" target="_blank">{0}</a>', p.UserName ? ("http://twitter.com/@" + p.UserName) : ""));
            var r = p.UserId,q = n.getFollowAction(),o = n.getMask("checking if user is being followed");
            o.show();
            SourceService.IsTwitterUserAFriend(r, function(s) {
                o.hide();
                var t = s.Result;
                q.setText(t ? Explore.i18n("UnFollow") : Explore.i18n("Follow"));
                q.setHandler(t ? n.unFollowUser : n.followUser, n)
            })
        }})
    }
    return n._formPanel
},getHeaderTemplate:function() {
    var a = this;
    if (!a._headerTemplate) {
        a._headerTemplate = new Ext4.XTemplate('<div style="min-height:64px;">', "{[this.getProfileImage(values)]}", '<div class="twitter-profile-title">{FullName}</div>', '<div class="twitter-profile-handle">(@{UserName})</div>', "</div>", "<div>{ProfileDescription}</div>", "<br/>", {getProfileImage:function(b) {
            return'<img src="' + b.ProfileImageUrl + '"style="display:none; padding-right:10px; max-height:64px; max-width:64px; float:left;" alt="' + fields.author + '" onload="Explore.showLoadedImage(this)" />'
        }})
    }
    return a._headerTemplate
},displayUser:function(b) {
    var c = this,d = c.getEl();
    c.userData = b || c.userData;
    if (c.userData && d) {
        var f = c.getHeaderPanel(),e = f.getEl(),a = c.getFormPanel();
        template = c.getHeaderTemplate();
        a.displayUser(b);
        template.overwrite(e, c.userData)
    }
}});
Ext.reg("explore.view.twitter.twitteruserprofilepanel", Explore.view.twitter.TwitterUserProfilePanel);
Ext.ns("Explore.view.twitter");
Explore.view.twitter.TwitterUserWindow = Ext.extend(Ext.Window, {height:510,width:630,modal:true,userId:null,userData:null,numTweets:5,resizable:true,autoScroll:true,cls:"white-bg-dialog",initComponent:function() {
    var b = this;
    var d = this._userprofilepanel = new Explore.view.twitter.TwitterUserProfilePanel({itemId:"userprofilepanel",columnWidth:0.4,listeners:{refreshtweets:function() {
        b.getUserData(b.userId)
    }},getMask:function(e) {
        return b.getMask(e)
    },width:300});
    var c = this._mostrecenttwitterpanel = new Explore.view.twitter.MostRecentTweetsPanel({itemId:"mostrecenttwitterpanel",columnWidth:0.6,getMask:function(e) {
        return b.getMask(e)
    },listeners:{refreshtweets:function() {
        b.getUserData(b.userId)
    }}});
    var a = {layout:"column",items:[d,c],fbar:[
        {text:Explore.i18n("Close"),handler:function() {
            b.close()
        }}
    ]};
    Ext.apply(this, a);
    Explore.view.twitter.TwitterUserWindow.superclass.initComponent.apply(this, arguments);
    b.on("afterrender", function() {
        b.getUserData(b.userId)
    }, b, {single:true})
},getMask:function(a) {
    return new Ext.LoadMask(this.getEl(), {msg:a || "Loading..."})
},getUserData:function(c) {
    var b = this;
    if (!c) {
        return
    }
    var a = b.getMask();
    a.show();
    Explore.data.SourceDataStore.getTwitterUser(c, b.numTweets, function(e) {
        a.hide();
        if (e.ErrorCode === 0) {
            var d = e.Result;
            if (d) {
                b.userData = d;
                b.updateTitle();
                b.getByItemId("mostrecenttwitterpanel").displayUser(b.userData);
                b.getByItemId("userprofilepanel").displayUser(b.userData);
                b.doLayout()
            }
        } else {
            Explore.view.StatusBox.showError(Explore.i18n("Error"), e.Message, function() {
                b.close()
            })
        }
    })
},updateTitle:function() {
    var d = "{0}: {1}(@{2})",a = this.userData || {},c = a.UserName,b = a.FullName;
    if (this.userData) {
        this.setTitle(String.format(d, Explore.i18n("Twitter Profile"), b, c))
    } else {
        this.setTitle(Explore.i18n("Twitter Profile"))
    }
}});
Ext.ns("Explore.view.widgets");
Explore.view.widgets.BreakingClustersWidget = Ext.extend(Explore.base.WidgetBase, {searchId:null,projectId:null,isExplore:false,currentData:null,getReportFailedMessage:function() {
    return Explore.i18n("NoBreakingTopics")
},initComponent:function() {
    var c = this;
    c.projectId = Explore.presenter.ProjectsPresenter.getCurrentProjectId();
    if (!this.isExplore) {
        c.searchId = parseInt(c.searchId, 10);
        Explore.ensureExtDirect(d.applicationBaseURL)
    }
    var e = {xtype:"selectboxfield",itemId:"endDate",fieldLabel:Explore.i18n("EndDate"),width:130,mode:"local",store:new Ext.data.JsonStore({fields:["EndDate","EndDateVal","StartDates"],data:[]}),valueField:"EndDateVal",displayField:"EndDate",listeners:{select:function(j, g, h) {
        setStartDates(g.data.StartDates)
    }}};
    var b = {xtype:"selectboxfield",itemId:"startDate",fieldLabel:Explore.i18n("StartDate"),width:130,mode:"local",store:new Ext.data.JsonStore({fields:["Date","Value"],data:[]}),valueField:"Value",displayField:"Date",listeners:{afterrender:function(g) {
        c.loadClusterList()
    },select:function(j, g, h) {
        c.bindClusters()
    }}};
    var a = {xtype:"treepanel",itemId:"tree",hideLabel:true,anchor:"100% -50",border:false,bodyBorder:false,root:{nodeType:"async",text:"",id:"rootNode",children:[]},collapsible:false,useArrows:true,autoScroll:true,animate:true,enableDD:false,containerScroll:true,rootVisible:false,listeners:{dblclick:function(j, l) {
        if (c.isExplore) {
            var n = j.attributes.tag;
            var g = j.parentNode.childNodes;
            var k = [];
            var m = 0;
            for (var h = 0; h < g.length; h++) {
                k.push(g[h].attributes.tag);
                if (g[h].attributes.tag === n) {
                    m = h
                }
            }
            Explore.SearchResults.openResultsById(c.searchId, c.projectId, k, m)
        }
    }}};
    var d = {layout:{type:"form",trackLabels:true},border:false,padding:"10",bodyStyle:"background-color: white",items:[e,b,c.getNoReportDiv(),a]};
    Ext.apply(this, Ext.apply(this.initialConfig, d));
    Explore.view.widgets.BreakingClustersWidget.superclass.initComponent.apply(this, arguments);
    var f = true;
    this.on("afterlayout", function() {
        if (f) {
            f = false;
            c.showBusy()
        }
    })
},bindClusters:function() {
    var b = this;
    var c = b.getByItemId("startDate").getValue();
    var a = b.getByItemId("endDate").getValue();
    Explore.data.ClusterDataStore.getBreakingClusterResults(b.searchId, b.projectId, c, a, function(e) {
        var d = b.getByItemId("tree");
        var f = d.getRootNode();
        f.removeAll();
        b.currentData = e;
        if (e != null) {
            b.getNoReportDiv().setVisible(false);
            for (var g = 0; g < e.length;
                 g++) {
                f.appendChild(e[g])
            }
        } else {
            log.error("getBreakingClusterResults returned null");
            b.getNoReportDiv().setVisible(true)
        }
        b.hideStatus()
    })
},setStartDates:function(c) {
    var b = this;
    var a = b.getByItemId("startDate");
    a.getStore().loadData(c);
    if (c.length > 0) {
        a.setVisible(true);
        a.setValue(c[0].Value);
        b.bindClusters()
    } else {
        log.warn("BreakingClustersWidget: no start dates");
        a.setVisible(false);
        b.hideStatus()
    }
},loadClusterList:function() {
    var a = this;
    Explore.data.ClusterDataStore.getBreakingClusterList(a.searchId, a.projectId, function(d) {
        var c = a.getByItemId("endDate");
        var b = a.getByItemId("startDate");
        if (d != null) {
            c.getStore().loadData(d);
            if (d.length > 0) {
                c.setValue(d[0].EndDateVal);
                a.setStartDates(d[0].StartDates);
                c.setVisible(true);
                b.setVisible(true)
            } else {
                log.warn("BreakingClustersWidget: 0 dates returned");
                a.hideStatus();
                c.setVisible(false);
                b.setVisible(false);
                a.getNoReportDiv().setVisible(true)
            }
        } else {
            log.error("BreakingClustersWidget: getBreakingClusterList returned null");
            a.hideStatus();
            c.setVisible(false);
            b.setVisible(false);
            a.getNoReportDiv().setVisible(true)
        }
    })
},exportData:function() {
    if (this.currentData != null) {
        Explore.utils.Exporter.exportHotBreakingClusters(this.currentData, "BreakingTopics")
    } else {
        Explore.view.StatusBox.showWarning(Explore.i18n("ExportNotSupported"), Explore.i18n("ExportNotSupported_NoDataHasLoaded_"))
    }
}});
Ext.reg("explore.view.widgets.breakingclusterswidget", Explore.view.widgets.BreakingClustersWidget);
Explore.view.widgets.DocumentCountsByFilter = Ext.extend(Explore.base.WidgetBase, {chart_4:null,chartStore_4:null,reportData:null,reportSettings:null,lastRefreshed:null,numHideLabel:10,initComponent:function() {
    var b = this;
    var a = {layout:"fit",border:false,bodyStyle:"background: white;",items:[
        {xtype:"box",itemId:"chartContainer",listeners:{resize:{fn:this.setupChart,buffer:250,scope:this}}},
        b.getNoReportDiv()
    ]};
    Ext.apply(this, a);
    Explore.view.widgets.DocumentCountsByFilter.superclass.initComponent.apply(this, arguments);
    b.on("afterlayout", function() {
        b.refreshWidget()
    }, b, {single:true})
},refreshWidget:function() {
    var b = this;
    var c = b.cloud,a = new Explore.data.model.ReportSettings({filterByDateType:c.TimeWindow,EndDate:c.ToDate,StartDate:c.FromDate});
    b.showBusy();
    b.lastRefreshed = new Date();
    IDOLService.GetDocumentCountsFromSavedSearch(c, a, function(d) {
        b.hideStatus();
        b.reportData = d;
        b.reportSettings = a;
        if (b.reportData.GraphData.length === 0) {
            b.getNoReportDiv().show();
            b.getByItemId("chartContainer").hide()
        } else {
            b.setupChart(b.getByItemId("chartContainer"))
        }
    })
},getReportFailedMessage:function() {
    return Explore.i18n("No Document Filters Found")
},setupChart:function(c) {
    var d = this,f = c.getEl(),e = f.getComputedWidth(),b = f.getComputedHeight();
    dom = f.dom;
    if (!d.reportData || !f) {
        return
    }
    f.on("contextmenu", function(g) {
        d.fireEvent("disableContextMenu", g)
    }, d);
    if (!this.chart_4) {
        if (this.reportData.Fields != null) {
            this.chartStore_4 = new Ext4.data.ArrayStore({fields:this.reportData.Fields,data:this.reportData.GraphData})
        }
        var a = {trackMouse:true,width:180,height:35,renderer:function(j, h) {
            var g = 0;
            d.chartStore_4.each(function(k) {
                g += k.get("count")
            });
            this.update(j.get("displayText") + ": " + Math.round(j.get("count") / g * 100) + "%")
        }};
        if (this.chartType === "barChart") {
            this.chart_4 = Ext4.create("widget.chart", {store:this.chartStore_4,shadow:false,renderTo:dom,width:e,height:b,theme:"Blue:gradients",legend:{position:"right"},axes:[
                {type:"Numeric",minimum:0,position:"left",fields:["count"],title:Explore.i18n("NumberOfDocuments"),labelTitle:{font:"13px Arial"},label:{font:"11px Arial"}},
                {type:"Category",position:"bottom",fields:["displayText"],title:this.getCategoryFriendlyName(this.reportSettings.Category),labelTitle:{font:"13px Arial"},label:{font:"11px Arial",rotate:{degrees:-45}}}
            ],series:[
                {type:"column",xField:"displayText",yField:"count",title:Explore.i18n("NumberOfDocuments"),labelTitle:{font:"13px Arial"},tips:a,listeners:{itemmouseup:this.onChartItemMouseUp,scope:this}}
            ]})
        } else {
            this.chart_4 = Ext4.create("widget.chart", {store:this.chartStore_4,shadow:false,renderTo:dom,width:e,height:b,insetPadding:20,theme:"Base:gradients",legend:{position:"right"},series:[
                {type:"pie",field:"count",donut:false,tips:a,showInLegend:true,highlight:{segment:{margin:20}},label:{field:"displayText",hidden:(this.reportData.GraphData.length > this.numHideLabel),display:"outside",contrast:false,font:"11px Arial"},listeners:{itemmouseup:this.onChartItemMouseUp,scope:this}}
            ]})
        }
    } else {
        this.chart_4.setSize(e, b)
    }
},onChartItemMouseUp:function(m, j) {
    var n = this,d = n.reportData,g = d.EndDate,c = d.StartDate,h = m.storeItem,b = h.get("val"),l = h.get("friendlyName"),f = n.cloud,a = f.SearchName,k = "SAVEDSEARCH::(" + a + ")";
    options = {replaceCurrentFilters:true},searchCriteria = new Explore.data.model.SearchCriteria({searchTerms:k,searchTermsUI:k,description:k,filterByDateType:Explore.model.FilterByDateType.Between,startDate:c,endDate:g,Combine:Explore.model.ASCombineType.And,Criteria:[]}),filterValues = [b],searchPresenter = Explore.showSearchPanel(),newFilter = {Combine:Explore.model.ASCombineType.Single,friendlyName:l,FilterTag:f.Category,type:f.Category,Values:filterValues};
    Explore.utils.SearchCriteriaUtil.addSearchFilter(searchCriteria, newFilter);
    searchPresenter.searchByCriteria(searchCriteria, options)
}});
Ext.ns("Explore.view.widgets");
Explore.view.widgets.DocumentCountsWidget = Ext.extend(Explore.base.WidgetBase, {chartType:"pieChart",searchCriteria:null,reportSettings:null,reportData:null,chart_4:null,chartStore_4:null,initComponent:function() {
    if (this.reportData.Fields != null) {
        this.chartStore_4 = new Ext4.data.ArrayStore({fields:this.reportData.Fields,data:this.reportData.GraphData})
    }
    this.extraParams = [
        {showInFooter:true,xtype:"selectboxfield",options:[
            {id:"pieChart",text:Explore.i18n("PieChart")},
            {id:"barChart",text:Explore.i18n("BarChart")}
        ],value:this.chartType,listeners:{select:function(d, b, c) {
            this.chartType = d.getValue();
            if (this.chart_4) {
                this.chart_4.destroy();
                this.chart_4 = null
            }
            this.setupChart(this.getByItemId("chartContainer"))
        },scope:this}}
    ];
    var a = {layout:"fit",border:false,cls:"Explore.view.widgets.DocumentCountsWidget",items:[
        {xtype:"box",itemId:"chartContainer",listeners:{resize:{fn:this.setupChart,buffer:250,scope:this}}}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, a));
    return Explore.view.widgets.DocumentCountsWidget.superclass.initComponent.apply(this, arguments)
},refreshWidget:function() {
    var b = this;
    var a = false;
    this.showBusy(Explore.i18n("RunningReport") + ": " + b.reportSettings.name, function() {
        a = true
    });
    var c = {};
    Explore.data.IDOLDataStore.getReportOnCriteria(b.searchCriteria, c, b.reportSettings, function(d) {
        if (!a) {
            if (d == null) {
                b.hideStatus();
                b.showError(Explore.i18n("error"), Explore.i18n("errorReportFailed"))
            } else {
                if (d.ErrorInfo != null) {
                    b.hideStatus();
                    b.showError(Explore.i18n("error"), Explore.i18n("errorReportFailed") + "<br />" + d.ErrorInfo.Message)
                } else {
                    reportData = b.reportData = d;
                    b.chartStore_4 = new Ext4.data.ArrayStore({fields:reportData.Fields,data:reportData.GraphData});
                    b.chart_4.bindStore(b.chartStore_4);
                    b.hideStatus()
                }
            }
        }
    })
},setupChart:function(c) {
    var d = this,f = c.getEl(),e = f.getComputedWidth(),b = f.getComputedHeight();
    dom = f.dom;
    f.on("contextmenu", function(g) {
        d.fireEvent("disableContextMenu", g)
    }, d);
    if (!this.chart_4) {
        var a = {trackMouse:true,width:180,height:35,renderer:function(j, h) {
            var g = 0;
            d.chartStore_4.each(function(k) {
                g += k.get("count")
            });
            this.update(j.get("displayText") + ": " + Math.round(j.get("count") / g * 100) + "%")
        }};
        if (this.chartType === "barChart") {
            this.chart_4 = Ext4.create("widget.chart", {store:this.chartStore_4,shadow:false,renderTo:dom,width:e,height:b,theme:"Blue:gradients",legend:{position:"right"},axes:[
                {type:"Numeric",minimum:0,position:"left",fields:["count"],title:Explore.i18n("NumberOfDocuments"),labelTitle:{font:"13px Arial"},label:{font:"11px Arial"}},
                {type:"Category",position:"bottom",fields:["displayText"],title:this.getCategoryFriendlyName(this.reportSettings.Category),labelTitle:{font:"13px Arial"},label:{font:"11px Arial",rotate:{degrees:-45}}}
            ],series:[
                {type:"column",xField:"displayText",yField:"count",title:Explore.i18n("NumberOfDocuments"),labelTitle:{font:"13px Arial"},tips:a,listeners:{itemmouseup:this.onChartItemMouseUp,scope:this}}
            ]})
        } else {
            this.chart_4 = Ext4.create("widget.chart", {store:this.chartStore_4,shadow:false,renderTo:dom,width:e,height:b,insetPadding:20,theme:"Base:gradients",legend:{position:"right"},series:[
                {type:"pie",field:"count",donut:false,tips:a,showInLegend:true,highlight:{segment:{margin:20}},label:{field:"displayText",display:"outside",contrast:false,font:"11px Arial"},listeners:{itemmouseup:this.onChartItemMouseUp,scope:this}}
            ]})
        }
    } else {
        this.chart_4.setSize(e, b)
    }
},onChartItemMouseUp:function(k, h) {
    if (h.button == 0) {
        var l = this,d = k.series,g = Ext4.Array.indexOf(d.items, k),f = this.chartStore_4.getAt(g),a = this.reportSettings,m = {item:k,pos:h.getXY()},j = Ext4.clone(this.searchCriteria);
        var c = [];
        c.push(f.get("val"));
        Explore.utils.SearchCriteriaUtil.addSearchFilter(j, {Combine:Explore.model.ASCombineType.Single,FilterTag:a.Category,Values:c});
        j.filterByDateType = a.filterByDateType;
        j.startDate = a.startDate;
        j.endDate = a.endDate;
        var b = f.get("displayText");
        j.description = b;
        l.fireEvent("chartItemClick", m, j)
    }
}});
Ext.reg("explore.view.widgets.documentcountswidget", Explore.view.widgets.DocumentCountsWidget);
Ext.ns("Explore.view.widgets");
Explore.view.widgets.HighLowComparisonWidget = Ext.extend(Explore.base.WidgetBase, {searchCriteria:null,reportSettings:null,reportData:null,chart_4:null,chartStore_4:null,initComponent:function() {
    if (this.reportData.Fields !== null) {
        this.chartStore_4 = new Ext4.data.ArrayStore({fields:this.reportData.Fields,data:this.reportData.GraphData})
    }
    if (!this.reportSettings.DocCountView) {
        this.reportSettings.DocCountView = "byCount"
    }
    this.extraParams = [
        {showInFooter:true,xtype:"selectboxfield",options:[
            {id:"byCount",text:Explore.i18n("ShowRawValues")},
            {id:"byOffset",text:Explore.i18n("ShowOffsetFromAverage")}
        ],value:this.reportSettings.DocCountView,listeners:{select:function(d, b, c) {
            this.reportSettings.DocCountView = d.getValue();
            if (this.chart_4) {
                this.chart_4.destroy();
                this.chart_4 = null
            }
            this.setupChart(this.getByItemId("chartContainer"))
        },scope:this}}
    ];
    var a = {layout:"fit",border:false,cls:"Explore.view.widgets.DocumentCountsWidget",items:[
        {xtype:"box",itemId:"chartContainer",listeners:{resize:{fn:this.setupChart,buffer:250,scope:this}}}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, a));
    Explore.view.widgets.HighLowComparisonWidget.superclass.initComponent.apply(this, arguments)
},useOffset:function() {
    return(this.reportSettings.DocCountView === "byOffset")
},refreshWidget:function() {
    var c = this,b = this.reportSettings,a = false,d = {};
    c.showBusy(Explore.i18n("RunningReport") + ": " + b.name, function() {
        a = true
    });
    Explore.data.IDOLDataStore.getReportOnCriteria(this.searchCriteria, d, b, function(e) {
        if (!a) {
            if (e == null) {
                c.hideStatus();
                c.showError(Explore.i18n("error"), Explore.i18n("errorReportFailed"))
            } else {
                if (e.ErrorInfo != null) {
                    c.hideStatus();
                    c.showError(Explore.i18n("error"), Explore.i18n("errorReportFailed") + "<br />" + e.ErrorInfo.Message)
                } else {
                    this.reportData = e;
                    this.chartStore_4 = new Ext.data.ArrayStore({fields:this.reportData.Fields,data:this.reportData.GraphData});
                    this.chart_4.bindStore(this.chartStore_4);
                    c.hideStatus()
                }
            }
        }
    })
},setupChart:function(c) {
    var d = this,f = c.getEl(),e = f.getComputedWidth(),b = f.getComputedHeight();
    dom = f.dom,useOffset = this.useOffset(),yField = useOffset ? "Offset" : this.reportSettings.Series;
    f.on("contextmenu", function(j) {
        d.fireEvent("disableContextMenu", j)
    }, d);
    if (!this.chart_4) {
        var a = {trackMouse:true,width:350,height:50,renderer:function(m, l) {
            var o = m.get("Category") + "<br />";
            var j = d.reportSettings.Series;
            var k = m.get(j);
            var n = m.get("Offset");
            if (j === "_ATTR_DURATION") {
                o += Explore.i18n("Averag_Duration") + ": " + k + " " + Explore.i18n("Seconds_1") + "<br />";
                o += Explore.i18n("OffsetFromTotalAverage") + ": " + n + " " + Explore.i18n("Seconds_1")
            } else {
                if (j === "_ATTR_NUM_HOLDS") {
                    o += Explore.i18n("Average_Holds") + ": " + k + "<br />";
                    o += Explore.i18n("OffsetFromTotalAverage") + ": " + n
                } else {
                    if (j === "_ATTR_SILENCE") {
                        o += Explore.i18n("Average_Silence") + ": " + k + " " + Explore.i18n("Seconds_1") + "<br />";
                        o += Explore.i18n("OffsetFromTotalAverage") + ": " + n + " " + Explore.i18n("Seconds_1")
                    } else {
                        if (j === "NumCalls") {
                            o += Explore.i18n("TotalNumberOfCalls") + ": " + k + "<br />";
                            o += Explore.i18n("OffsetFromTotalAverage") + ": " + n
                        }
                    }
                }
            }
            this.update(o)
        }};
        var h,g;
        if (this.reportSettings.Category === "_ATTR_AGENT_NAME") {
            h = Explore.i18n("AgentName")
        } else {
            if (this.reportSettings.Category === "GROUPS/GROUP") {
                h = Explore.i18n("Group")
            }
        }
        if (this.reportSettings.Series === "_ATTR_DURATION") {
            if (useOffset) {
                g = Explore.i18n("OffsetFromAverageDuration")
            } else {
                g = Explore.i18n("Averag_Duration")
            }
        } else {
            if (this.reportSettings.Series === "_ATTR_NUM_HOLDS") {
                if (useOffset) {
                    g = Explore.i18n("OffsetFromAverageNumberOfHolds")
                } else {
                    g = Explore.i18n("Average_Holds")
                }
            } else {
                if (this.reportSettings.Series === "_ATTR_SILENCE") {
                    if (useOffset) {
                        g = Explore.i18n("OffsetFromAverageSilence")
                    } else {
                        g = Explore.i18n("Average_Silence")
                    }
                } else {
                    if (this.reportSettings.Series === "NumCalls") {
                        if (useOffset) {
                            g = Explore.i18n("OffsetFromAverageNumberOfCalls")
                        } else {
                            g = Explore.i18n("Total_Number_Calls")
                        }
                    }
                }
            }
        }
        this.chart_4 = Ext4.create("widget.chart", {store:this.chartStore_4,shadow:false,renderTo:dom,width:e,height:b,theme:"Blue:gradients",axes:[
            {type:"Numeric",minimum:useOffset ? undefined : 0,position:"left",fields:[yField],title:g,grid:true,labelTitle:{font:"13px Arial"},label:{font:"11px Arial"}},
            {type:"Category",position:"bottom",fields:["Category"],title:h,labelTitle:{font:"13px Arial"},label:{font:"11px Arial",rotate:{degrees:-45}}}
        ],series:[
            {type:"column",xField:"Category",yField:yField,tips:a,listeners:{itemmouseup:this.onChartItemMouseUp,scope:this}}
        ]})
    } else {
        this.chart_4.setSize(e, b)
    }
},onChartItemMouseUp:function(h, f) {
    if (f.button == 0) {
        var j = this,b = h.series,d = Ext4.Array.indexOf(b.items, h),c = this.chartStore_4.getAt(d),a = this.reportSettings,k = {item:h,pos:f.getXY()},g = Ext4.clone(this.searchCriteria);
        if (this.reportSettings.filterByDateType !== Explore.model.FilterByDateType.Any) {
            g.filterByDateType = a.filterByDateType;
            g.startDate = a.startDate;
            g.endDate = a.endDate
        }
        Explore.utils.SearchCriteriaUtil.addSearchFilter(g, {Combine:Explore.model.ASCombineType.Single,FilterTag:this.reportSettings.Category,Values:[c.get("CategoryRawValue")]});
        g.description = (g.description || "") + " " + c.get("Category");
        j.fireEvent("chartItemClick", k, g)
    }
}});
Ext.reg("explore.view.widgets.highlowcomparisonwidget", Explore.view.widgets.HighLowComparisonWidget);
Ext.ns("Explore.view.widgets");
Explore.view.widgets.HomeTopicsWidget = Ext.extend(Explore.base.WidgetBase, {projectId:null,Id:null,Position:null,Name:null,ViewType:null,DisplayCount:null,Basis:null,TimeWindow:null,FromDate:null,ToDate:null,currentResults:null,isExplore:false,reportSuccessful:function() {
    return true
},dataStore_4:null,dataStore:null,activeCloud:null,numHideLabel:10,initComponent:function() {
    var a = this;
    var b = {layout:"fit",bodyStyle:"background-color: white",activeCloud:{Id:a.Id,Position:a.Position,Name:a.Name,ViewType:a.ViewType,DisplayCount:a.DisplayCount,Basis:a.Basis,TimeWindow:a.TimeWindow,FromDate:a.FromDate,ToDate:a.ToDate},items:[]};
    a.initStores();
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.widgets.HomeTopicsWidget.superclass.initComponent.apply(this, arguments);
    a.dataLoader();
    var c = true;
    a.on("afterlayout", function() {
        if (c) {
            c = false;
            a.showBusy()
        }
    })
},initStores:function() {
    this.dataStore = new Ext.data.JsonStore({fields:[
        {name:"TopicName",type:"string"},
        {name:"Total",type:"float"},
        {name:"Target",type:"float"},
        {name:"Variance",type:"float"},
        {name:"StandardDeviation",type:"float"},
        {name:"TargetVariance",type:"float"},
        {name:"TargetStandardDeviation",type:"float"},
        {name:"Average",type:"float"},
        {name:"WasRun",type:"bool"},
        {name:"DisplayName",type:"string"}
    ]});
    this.dataStore_4 = new Ext4.data.JsonStore({fields:[
        {name:"TopicName",type:"string"},
        {name:"Total",type:"float"},
        {name:"Target",type:"float"},
        {name:"Variance",type:"float"},
        {name:"StandardDeviation",type:"float"},
        {name:"TargetVariance",type:"float"},
        {name:"TargetStandardDeviation",type:"float"},
        {name:"Average",type:"float"},
        {name:"WasRun",type:"bool"},
        {name:"DisplayName",type:"string"}
    ]})
},exportData:function() {
    if (this.activeCloud.ViewType === Explore.model.CloudViewType.TrendComparision) {
        this.widget.exportData()
    } else {
        Explore.utils.Exporter.exportToCsv(this.currentResults.TopicSearchResults, null, ["TopicName","Total","Target","Variance","StandardDeviation","TargetVariance","TargetStandardDeviation","Average","WasRun"])
    }
},dataLoader:function() {
    var a = this;
    Explore.data.IDOLDataStore.getCloudTopicResults(a.activeCloud.Id, a.activeCloud.TimeWindow, a.projectId, function(d) {
        var c = null,g;
        a.currentResults = d;
        if (!d || !d.TopicSearchResults) {
            log.error("Could not retrieve cloud topics for cloud: " + a.activeCloud.Position)
        } else {
            a.calculateTopicResultsStatistics(d.TopicSearchResults, d.TotalResults);
            if (a.activeCloud.ViewType === Explore.model.CloudViewType.CloudView) {
                c = new Explore.view.common.Cloud({region:"center",autofit:true,listeners:{cloudItemClick:function(h) {
                    a.onTopicSearch(h.data)
                },cloudItemContextMenu:function(h, j) {
                    a.fireEvent("contextMenu", h.data, j)
                }}});
                c.setDataItems(a.createCloudDataItems(d.TopicSearchResults));
                a.fireEvent("showUncalcultedLabel", c.showUncalcultedLabel)
            } else {
                if (a.activeCloud.ViewType === Explore.model.CloudViewType.ListView) {
                    g = Ext4.clone(d.TopicSearchResults);
                    a.dataStore.loadData(g);
                    c = a.createListView()
                } else {
                    if (a.activeCloud.ViewType === Explore.model.CloudViewType.PieChart) {
                        g = Ext4.clone(d.TopicSearchResults);
                        a.dataStore_4.loadData(g);
                        c = a.createPieChartView(d.TopicSearchResults)
                    } else {
                        if (a.activeCloud.ViewType === Explore.model.CloudViewType.RootCauseView) {
                            a.calculateUnmatchedResultsStatistics(d, null);
                            c = a.createRootCauseView()
                        } else {
                            if (a.activeCloud.ViewType === Explore.model.CloudViewType.TrendComparision) {
                                var b = "M-d-Y";
                                var f = a.activeCloud.TimeWindow;
                                if (f === Explore.model.TimeWindow.PastHour || f === Explore.model.TimeWindow.Past24Hours || f === Explore.model.TimeWindow.Past5Minutes || f === Explore.model.TimeWindow.PastWeek) {
                                    b = "M-d-Y g:i a"
                                } else {
                                    if (f === Explore.model.TimeWindow.Between) {
                                        var e = Explore.determineTimeInterval(a.activeCloud.FromDate, a.activeCloud.ToDate, a.getTimeInterval());
                                        durationName = Explore.i18n(Explore.model.Duration.getName(e).toLowerCase());
                                        if (durationName === "hour" || durationName === "sixhours") {
                                            b = "M-d-Y g:i a"
                                        }
                                    }
                                }
                                c = new Explore.view.widgets.TrendingComparisionWidget({dateFormat:b,topicResults:d,activeCloud:a.activeCloud})
                            }
                        }
                    }
                }
            }
        }
        a.widget = c;
        if (c != null) {
            a.add(c);
            a.doLayout()
        }
        a.hideStatus();
        a.fireEvent("dataLoaded", a)
    })
},onTopicSearch:function(b) {
    var c = this;
    if (b) {
        var d = Explore.showSearchPanel();
        if (b.ResultCounts && b.ResultCounts.length > 0) {
            var g = b.ResultCounts[0];
            var f = Explore.getLocalTimeZoneOffset();
            var a = new Date(Explore.parseSerializedDate(g.StartDate).getTime());
            var e = new Date(Explore.parseSerializedDate(g.EndDate).getTime());
            d.searchByCloudTopic(b.TopicId, b.TopicName, a, e)
        } else {
            if (c.activeCloud) {
                var e = new Date();
                var a = Explore.getStartDateFromTimeWindow(c.activeCloud.TimeWindow, e, c.activeCloud.FromDate);
                e = (c.activeCloud.TimeWindow == Explore.model.TimeWindow.Between) ? c.activeCloud.ToDate : new Date();
                d.searchByCloudTopic(b.TopicId, b.TopicName, a, e)
            } else {
                d.searchByTopic(b.TopicId, b.TopicName)
            }
        }
    }
},getTimeInterval:function() {
    var a = {byHour:3,bySixHours:8,byDay:46,byWeek:367,byYear:1085};
    return a
},calculateTopicResultsStatistics:function(d, m) {
    var f,e;
    if (d) {
        for (f = 0; f < d.length; f++) {
            var g = d[f];
            g.Total = 0;
            g.TotalSum = 0;
            g.Average = 0;
            g.Variance = 0;
            g.TargetVariance = 0;
            g.StandardDeviation = 0;
            g.TargetStandardDeviation = 0;
            g.ResultsPercentage = 0;
            if (g.ResultCounts && g.ResultCounts.length > 0) {
                var h = g.ResultCounts;
                g.Total = h[0].Count;
                for (e = 0; e < h.length; e++) {
                    g.TotalSum += h[e].Count
                }
                if (g.TotalSum > 0) {
                    var b = g.TotalSum / h.length;
                    g.Average = this.roundToDecimalPlace(b, 2);
                    var l = 0;
                    var c = 0;
                    for (e = 0; e < h.length; e++) {
                        var k = h[e].Count;
                        l += Math.pow((k - b), 2);
                        c += Math.pow((k - g.Target), 2)
                    }
                    var a = l / (h.length - 1);
                    var o = c / (h.length - 1);
                    g.Variance = this.roundToDecimalPlace(a, 2);
                    g.StandardDeviation = this.roundToDecimalPlace(Math.sqrt(a), 2);
                    g.TargetVariance = this.roundToDecimalPlace(o, 2);
                    g.TargetStandardDeviation = this.roundToDecimalPlace(Math.sqrt(o), 2);
                    if (m && m > 0 && g.Total && g.Total > 0) {
                        var n = (g.Total / m) * 100;
                        g.ResultsPercentage = this.roundToDecimalPlace(n, 2)
                    }
                }
                this.calculateTopicResultsStatistics(g.AssociatedSearchResults, g.ResultCounts[0].Count)
            }
        }
    }
},calculateUnmatchedResultsStatistics:function(d, a) {
    var c = this;
    var b = 0;
    var e = 0;
    if (d) {
        if (d.TotalUnmatchedResults && d.TotalUnmatchedResults > 0 && d.TotalResults && d.TotalResults > 0) {
            b = d.TotalUnmatchedResults;
            e = (d.TotalUnmatchedResults / d.TotalResults) * 100
        }
        d.TotalUnmatchedResults = b;
        d.TotalUnmatchedResultsPercentage = c.roundToDecimalPlace(e, 2);
        if (d.TopicSearchResults) {
            for (i = 0; i < d.TopicSearchResults.length; i++) {
                c.calculateUnmatchedResultsStatistics(null, d.TopicSearchResults[i])
            }
        }
    }
    if (a) {
        if (a.TotalUnmatchedResults && a.TotalUnmatchedResults > 0 && a.ResultCounts && a.ResultCounts.length > 0 && a.ResultCounts[0] && a.ResultCounts[0].Count > 0) {
            b = a.TotalUnmatchedResults;
            e = (a.TotalUnmatchedResults / a.ResultCounts[0].Count) * 100
        }
        a.TotalUnmatchedResults = b;
        a.TotalUnmatchedResultsPercentage = c.roundToDecimalPlace(e, 2)
    }
},roundToDecimalPlace:function(b, a) {
    var c = Math.pow(10, a);
    var d = Math.round(b * c) / c;
    return d
},getBasisNumber:function(a) {
    var b = this;
    switch (b.activeCloud.Basis) {case 0:return(a.ResultCounts && a.ResultCounts.length > 0) ? a.ResultCounts[0].Count : 0;case 1:return a.Variance;
        case 2:return a.TargetVariance;default:return -1
    }
},createCloudDataItems:function(d) {
    var h = this;
    var g = [];
    for (var c = 0; c < d.length;
         c++) {
        var f = d[c];
        var b = f.WasRun;
        var a = f.TopicName;
        var e = h.getBasisNumber(f);
        var k = f.Total;
        var j;
        if (b === true) {
            j = String.format("{0} ({1} {2})", a, k, Explore.i18n("results"))
        } else {
            j = Explore.i18n("cloudTopicNotResultsNotRunYet")
        }
        g.push({data:f,term:a,weight:e,tooltip:j})
    }
    return g
},createListView:function() {
    var h = this;
    var a = {header:Explore.i18n("Variance"),width:60,sortable:true,hidden:true,dataIndex:"Variance",renderer:Explore.formatNumber};
    var d = {header:Explore.i18n("Variance"),width:60,sortable:true,hidden:false,dataIndex:"StandardDeviation",renderer:Explore.formatNumber};
    var j = {header:Explore.i18n("TargetVariance"),width:60,sortable:true,hidden:true,dataIndex:"TargetVariance",renderer:Explore.formatNumber};
    var f = {header:Explore.i18n("TargetStandardDeviation"),width:60,sortable:true,hidden:true,dataIndex:"TargetStandardDeviation",renderer:Explore.formatNumber};
    var c = {header:Explore.i18n("Average"),width:60,sortable:true,hidden:true,dataIndex:"Average",renderer:Explore.formatNumber};
    var g = {header:Explore.i18n("Total"),width:50,sortable:true,dataIndex:"Total",renderer:Explore.formatNumber};
    var e = {header:Explore.i18n("TargetWeek"),width:82,sortable:true,dataIndex:"Target",renderer:Explore.formatNumber};
    var b = {header:Explore.i18n("Topic"),id:"cloud-grid-topic",width:145,sortable:true,dataIndex:"TopicName",renderer:function(o, l, k, q, n, m) {
        var p = o;
        if (!k.get("WasRun")) {
            p += "*";
            h.fireEvent("showUncalcultedLabel", true)
        }
        return p
    }};
    return new Ext.grid.GridPanel({border:false,store:h.dataStore,autoExpandColumn:"cloud-grid-topic",listeners:{rowclick:function(m, o, n) {
        var k = m.getStore().getAt(o);
        var l = k.json;
        h.onTopicSearch(l)
    },rowcontextmenu:function(m, o, n) {
        var k = m.getStore().getAt(o);
        var l = k.json;
        h.fireEvent("contextMenu", l, n)
    }},columns:[a,d,j,f,c,g,e,b]})
},createRootCauseView:function() {
    var a = new Ext.BoxComponent({layout:"fit",itemId:"treeContainer",listeners:{resize:{fn:this.setupRootCauseTree,buffer:250,scope:this}}});
    return a
},setupRootCauseTree:function() {
    var b = this;
    var e = b.getByItemId("treeContainer");
    var d = e.getEl();
    var c = d.getComputedWidth();
    var a = d.getComputedHeight();
    var f = d.dom;
    if (this.columnTree) {
        this.columnTree.setSize(c, a)
    } else {
        var g = Ext4.clone(b.currentResults);
        var b = this;
        this.columnTree = Ext4.create("Ext.tree.Panel", {renderTo:f,border:false,autoScroll:true,useArrows:true,cls:"root-cause-analysis",rootVisible:false,width:c,height:a,enableColumnMove:false,enableColumnHide:false,store:{fields:[
            {name:"TopicName",type:"string"},
            {name:"TotalResultsPercentage",type:"string"},
            {name:"Total",type:"float"},
            {name:"Target",type:"float"},
            {name:"Variance",type:"float"},
            {name:"WasRun",type:"bool"}
        ],root:{text:"",expanded:true,children:b.createRootCauseNodes(g, g.TopicSearchResults)}},columns:[
            {xtype:"treecolumn",header:Explore.i18n("Topic"),flex:1,menuDisabled:true,dataIndex:"TopicName"},
            {header:Explore.i18n("TotalResultsPercentage"),width:120,menuDisabled:true,tdCls:"grid-cell-inner-normal",dataIndex:"TotalResultsPercentage"},
            {header:Explore.i18n("Matches"),width:75,dataIndex:"Total",menuDisabled:true,tdCls:"grid-cell-inner-normal",renderer:Explore.formatNumber},
            {header:Explore.i18n("Target"),width:75,dataIndex:"Target",menuDisabled:true,tdCls:"grid-cell-inner-normal",renderer:Explore.formatNumber},
            {header:Explore.i18n("Variance"),width:75,dataIndex:"Variance",menuDisabled:true,tdCls:"grid-cell-inner-normal",renderer:Explore.formatNumber}
        ]})
    }
},createRootCauseNodes:function(a, h) {
    var d = [],c = this;
    if (a && h && h.length > 0) {
        for (var f = 0; f < h.length; ++f) {
            if (!h[f].WasRun) {
                h[f].TopicName += "*";
                c.fireEvent("showUncalcultedLabel", true)
            }
            d[f] = {TopicName:h[f].TopicName,TotalResultsPercentage:h[f].ResultsPercentage + Explore.i18n("percentSign"),Matches:h[f].Total,Target:h[f].Target,Variance:h[f].TargetVariance,iconCls:"no-icon",children:this.createRootCauseNodes(h[f], h[f].AssociatedSearchResults)}
        }
        var g = [];
        if (a.TopUnmatchedHits) {
            for (var f = 0; f < a.TopUnmatchedHits; ++f) {
                var e = a.TopUnmatchedHits[f];
                g.push({TopicName:e.Key,Matches:e.Value,uiProvider:"col"})
            }
        }
        var b = {TopicName:Explore.i18n("UnmatchedDocuments"),TotalResultsPercentage:a.TotalUnmatchedResultsPercentage + Explore.i18n("percentSign"),Matches:a.TotalUnmatchedResults,leaf:g.length === 0,iconCls:"no-icon",children:g};
        d.push(b)
    }
    return d
},createPieChartView:function(c) {
    var a = this;
    switch (a.activeCloud.Basis) {case 0:a.field = "Total";break;case 1:a.field = "Variance";
        break;case 2:a.field = "TargetVariance";break
    }
    a.dataStore_4.sort(a.field, "DESC");
    var b = new Ext.BoxComponent({layout:"fit",itemId:"chartContainer",listeners:{resize:{fn:a.setupChart,buffer:250,scope:this}},items:[a.getNoReportDiv()]});
    return b
},setupChart:function() {
    var c = this;
    var g = c.getByItemId("chartContainer");
    var f = g.getEl();
    var e = f.getComputedWidth();
    var b = f.getComputedHeight();
    var h = f.dom;
    if (c.pieChart) {
        c.pieChart.setSize(e, b)
    } else {
        var a = {trackMouse:true,width:250,height:30,renderer:function(m, l) {
            var k = m.get("WasRun");
            var j = m.get("TopicName");
            var o = m.get(c.field);
            if (!k) {
                o += "*";
                c.fireEvent("showUncalcultedLabel", true)
            }
            var n = String.format("Topic({0}) - {1}", j, o);
            this.update(n)
        }};
        var d = [
            {type:"pie",field:c.field,donut:false,showInLegend:true,tips:a,highlight:{segment:{margin:20}},label:{field:"DisplayName",display:"outside",hidden:(c.dataStore_4.getCount() > c.numHideLabel),contrast:false,font:"13px Arial"},listeners:{itemmouseup:{fn:function(j, k) {
                c.onTopicSearch(j.storeItem.data)
            },scope:c}}}
        ];
        c.pieChart = Ext4.create("widget.chart", {store:c.dataStore_4,shadow:false,legend:{position:"right"},renderTo:h,width:e,height:b,insetPadding:20,theme:"Base:gradients",series:d})
    }
}});
Ext.reg("explore.view.widgets.hometopicswidget", Explore.view.widgets.HomeTopicsWidget);
Ext.ns("Explore.view.widgets");
Explore.view.widgets.HotClustersWidget = Ext.extend(Explore.base.WidgetBase, {searchId:null,projectId:null,isExplore:false,currentData:null,initComponent:function() {
    var a = this;
    a.projectId = Explore.presenter.ProjectsPresenter.getCurrentProjectId();
    if (!this.isExplore) {
        a.searchId = parseInt(a.searchId, 10);
        Explore.ensureExtDirect(b.applicationBaseURL)
    }
    function c(e, f) {
        return Explore.formatDateByPref(new Date(e), {ignoreTime:true})
    }

    var b = {layout:{type:"form",trackLabels:true},border:false,padding:"10",bodyStyle:"background-color: white",items:[
        {xtype:"selectboxfield",itemId:"startDate",fieldLabel:Explore.i18n("StartDate"),width:130,mode:"local",store:new Ext.data.JsonStore({fields:[
            {name:"Date",convert:c},
            {name:"Value",mapping:"Value"}
        ],data:[]}),valueField:"Value",displayField:"Date",listeners:{afterrender:function(e) {
            a.loadClusterList()
        },select:function(g, e, f) {
            a.bindClusters()
        }}},
        {itemId:"no-cluster-data",xtype:"component",autoEl:{tag:"div",html:Explore.i18n("NoClusterData"),style:"padding: 10px 0 5px 0;"},hideLabel:true,hidden:true},
        {xtype:"treepanel",itemId:"tree",hideLabel:true,anchor:"100% -25",border:false,bodyBorder:false,root:{nodeType:"async",text:"",id:"rootNode",children:[]},collapsible:false,useArrows:true,autoScroll:true,animate:true,enableDD:false,containerScroll:true,rootVisible:false,listeners:{dblclick:function(h, k) {
            if (a.isExplore) {
                var m = h.attributes.tag;
                var f = h.parentNode.childNodes;
                var j = [];
                var l = 0;
                for (var g = 0; g < f.length; g++) {
                    j.push(f[g].attributes.tag);
                    if (f[g].attributes.tag === m) {
                        l = g
                    }
                }
                Explore.SearchResults.openResultsById(a.searchId, a.projectId, j, l)
            }
        }}}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.widgets.HotClustersWidget.superclass.initComponent.apply(this, arguments);
    var d = true;
    this.on("afterlayout", function() {
        if (d) {
            d = false;
            a.showBusy()
        }
    })
},bindClusters:function() {
    var a = this;
    var b = a.getByItemId("startDate").getValue();
    Explore.data.ClusterDataStore.getHotClusterResults(a.searchId, a.projectId, b, function(d) {
        var c = a.getByItemId("tree");
        var e = c.getRootNode();
        e.removeAll();
        a.currentData = d;
        if (d != null) {
            a.getByItemId("no-cluster-data").setVisible(false);
            for (var f = 0;
                 f < d.length; f++) {
                e.appendChild(d[f])
            }
        } else {
            log.error("HotClustersWidget: getHotClusterResults returned null");
            a.getByItemId("no-cluster-data").setVisible(true)
        }
        a.hideStatus()
    })
},setStartDates:function(c) {
    var b = this;
    var a = b.getByItemId("startDate");
    a.getStore().loadData(c);
    if (c.length > 0) {
        a.setVisible(true);
        a.setValue(c[0].Value);
        b.bindClusters()
    } else {
        log.warn("HotClustersWidget: 0 dates returned");
        a.setVisible(false);
        b.getByItemId("no-cluster-data").setVisible(true);
        b.getByItemId("no-cluster-data").getEl().update(Explore.i18n("NoHotTopics"));
        b.hideStatus()
    }
},loadClusterList:function() {
    var a = this;
    Explore.data.ClusterDataStore.getHotClusterList(a.searchId, a.projectId, function(c) {
        if (c != null) {
            a.setStartDates(c)
        } else {
            log.error("HotClustersWidget: getHotClusterList returned null");
            var b = a.getByItemId("startDate");
            b.setVisible(false);
            a.getByItemId("no-cluster-data").setVisible(true);
            a.getByItemId("no-cluster-data").getEl().update(Explore.i18n("NoHotTopics"));
            a.hideStatus()
        }
    })
},exportData:function() {
    if (this.currentData != null) {
        Explore.utils.Exporter.exportHotBreakingClusters(this.currentData, "HotTopics")
    } else {
        Explore.view.StatusBox.showWarning(Explore.i18n("ExportNotSupported"), Explore.i18n("ExportNotSupported_NoDataHasLoaded_"))
    }
}});
Ext.reg("explore.view.widgets.hotclusterswidget", Explore.view.widgets.HotClustersWidget);
Ext.ns("Explore.view.widgets");
Explore.view.widgets.MapWidget = Ext.extend(Explore.base.WidgetBase, {searchCriteria:null,reportSettings:null,reportData:null,initComponent:function() {
    var a = this;
    this.extraParams = [
        {showInFooter:true,xtype:"selectboxfield",options:[
            {id:"State",text:Explore.i18n("ByState")},
            {id:"Country",text:Explore.i18n("ByCountry")}
        ],value:a.reportSettings.Category,listeners:{select:function(e, c, d) {
            a.reportSettings.Category = e.getValue();
            a.refreshWidget()
        }}}
    ];
    var b = {layout:"fit",border:false,cls:"map-widget",items:[this.getMap()]};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.widgets.MapWidget.superclass.initComponent.apply(this, arguments)
},refreshWidget:function() {
    var b = this;
    var a = false;
    var c = {};
    b.showBusy(Explore.i18n("RunningReport") + ": " + this.reportSettings.name, function() {
        a = true
    });
    Explore.data.IDOLDataStore.getReportOnCriteria(this.searchCriteria, c, this.reportSettings, function(d) {
        if (!a) {
            if (d == null) {
                b.hideStatus();
                b.showError(Explore.i18n("error"), Explore.i18n("errorReportFailed"))
            } else {
                if (d.ErrorInfo != null) {
                    b.hideStatus();
                    b.showError(Explore.i18n("error"), Explore.i18n("errorReportFailed") + "<br />" + d.ErrorInfo.Message)
                } else {
                    reportData = b.reportData = d;
                    var e = b.getByItemId("chart");
                    b.remove(e);
                    b.add(b.getMap());
                    b.doLayout();
                    b.hideStatus()
                }
            }
        }
    })
},getMap:function() {
    var a = {};
    this.chartStore = new Ext.data.ArrayStore({fields:this.reportData.Fields,data:this.reportData.GraphData});
    this.chartStore.each(function(d) {
        a[d.get("val")] = {color:d.get("color"),label:d.get("label")};
        return true
    }, this);
    var c = "us";
    if (this.reportSettings.Category === "Country") {
        c = "world"
    }
    var b = {xtype:"explore.view.common.map",itemId:"map",columnWidth:0.4,title:"",border:"",ratio:0.7,chart:{mapType:c,detail:a}};
    return b
}});
Ext.reg("explore.view.widgets.mapwidget", Explore.view.widgets.MapWidget);
Ext.ns("explore.view.widgets");
Explore.view.widgets.RelatedConceptsWidget = Ext.extend(Explore.base.WidgetBase, {termCount:10,searchCriteria:null,reportSettings:null,initComponent:function() {
    var a = {layout:"fit",border:false,padding:"10 0 0 0",items:[
        {xtype:"explore.view.common.relatedconceptviews",itemId:"relatedConceptsViews",autoScroll:true,split:true,border:true}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, a));
    Explore.view.widgets.RelatedConceptsWidget.superclass.initComponent.apply(this, arguments);
    this.on("afterrender", this.loadRelatedConcepts, this)
},loadRelatedConcepts:function() {
    var b = this;
    var a = 20;
    var c = {};
    Explore.data.IDOLDataStore.retrieveRelatedConcepts(this.searchCriteria, c, function(f) {
        var h = [];
        var e = 6;
        if (f) {
            for (var g = 0; g < f.length && g < e; g++) {
                h.push(f[g])
            }
        }
        var j = b.convertNodesToCloudItems(f);
        var d = b.getByItemId("relatedConceptsViews");
        d.showConcepts(h, b.searchCriteria);
        d.setDataItems(j)
    })
},convertNodesToCloudItems:function(b) {
    var a = [];
    if (b) {
        for (var e = 0; e < b.length;
             e++) {
            var f = b[e];
            var d = this.trimQuotes(f.text);
            var c = f.tag;
            var g = String.format("{0} ({1} {2})", d, c, Explore.i18n("results"));
            a.push({data:f,term:d,weight:c,tooltip:g})
        }
    }
    return a
},trimQuotes:function(b) {
    var a = b;
    if (a) {
        a = a.replace(/^"|"$/g, "")
    }
    return a
},getCurrentData:function(a) {
    return this.getByItemId("relatedConceptsViews").getCurrentData(a)
},exportData:function() {
    var a = this.getCurrentData(false);
    var b = {text:Explore.i18n("Concept")};
    var c = ["text"];
    Explore.utils.Exporter.exportToCsv(a, b, c)
}});
Ext.reg("explore.view.widgets.relatedconceptswidget", Explore.view.widgets.RelatedConceptsWidget);
Ext.ns("Explore.view.widgets");
Explore.view.widgets.RelativeDocCountsByTypeWidget = Ext.extend(Explore.base.WidgetBase, {chartType:"stackedBarChart",searchCriteria:null,reportSettings:null,reportData:null,chart_4:null,chartStore_4:null,initComponent:function() {
    if (this.reportData.Fields != null) {
        this.chartStore_4 = new Ext4.data.ArrayStore({fields:this.reportData.Fields,data:this.reportData.GraphData})
    }
    var a = {layout:"fit",border:false,cls:"Explore.view.widgets.DocumentCountsWidget",items:[
        {xtype:"box",itemId:"chartContainer",listeners:{resize:{fn:this.setupChart,buffer:250,scope:this}}}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, a));
    Explore.view.widgets.RelativeDocCountsByTypeWidget.superclass.initComponent.apply(this, arguments)
},setupChart:function(c) {
    var d = this,g = c.getEl(),f = g.getComputedWidth(),b = g.getComputedHeight();
    dom = g.dom;
    g.on("contextmenu", function(j) {
        d.fireEvent("disableContextMenu", j)
    }, d);
    if (!this.chart_4) {
        var a = {autoHeight:true,autoWidth:true,trackMouse:true,renderer:function(k, j) {
            if (j.value[1]) {
                this.update(j.value[1] + " ")
            }
        }};
        var h = [
            {type:"Numeric",minimum:0,position:"bottom",fields:["count","total"],grid:true,title:Explore.i18n("NumberOfDocuments"),labelTitle:{font:"13px Arial"},label:{font:"11px Arial"},roundToDecimal:false},
            {type:"Category",position:"left",fields:["displayText"],title:this.getCategoryFriendlyName(this.reportSettings.Category),labelTitle:{font:"13px Arial"},label:{font:"11px Arial",rotate:{degrees:-45}}}
        ];
        var e = [
            {type:"bar",axis:"bottom",xField:"displayText",groupGutter:1,yField:["count","total"],title:[Explore.i18n("RelativeDocCountsSearch"),Explore.i18n("RelativeDocCountsTotal")],labelTitle:{font:"13px Arial"},tips:a,listeners:{itemmouseup:this.onChartItemMouseUp,scope:this},highlight:true}
        ];
        this.chart_4 = Ext4.create("widget.chart", {store:this.chartStore_4,shadow:false,renderTo:dom,width:f,height:b,legend:{position:"bottom"},axes:h,series:e})
    } else {
        this.chart_4.setSize(f, b)
    }
},onChartItemMouseUp:function(k, f) {
    if (f.button == 0) {
        var m = {item:k,pos:f.getXY()};
        var l = this,d = k.value[1],a = k.storeItem.data.total,h = false,g = k.storeItem.data.val;
        var j = Ext4.clone(l.searchCriteria);
        j.filterByDateType = l.reportSettings.filterByDateType;
        j.startDate = l.reportSettings.startDate;
        j.endDate = l.reportSettings.endDate;
        j.documentTypes = g;
        if (d === a) {
            j.searchTerms = "*";
            j.searchTermsUI = "*";
            h = true
        }
        var c = !h ? Explore.i18n("RelativeDocCountsSearch") : Explore.i18n("RelativeDocCountsTotal"),b = "{0}({1}) -{2}";
        j.description = String.format(b, g, d, c);
        l.fireEvent("chartItemClick", m, j)
    }
}});
Ext.reg("explore.view.widgets.relativedocumentcountstypewidget", Explore.view.widgets.RelativeDocCountsByTypeWidget);
Ext.ns("Explore.view.widgets");
Explore.view.widgets.RootCauseSummaryWidget = Ext.extend(Explore.base.WidgetBase, {searchCriteria:null,reportSettings:null,reportData:null,chartStore_4:null,projectId:null,initComponent:function() {
    var a = this;
    if (a.reportData != null && a.reportData.Fields != null) {
        a.chartStore_4 = new Ext4.data.ArrayStore({fields:a.reportData.Fields,data:a.reportData.GraphData})
    }
    var b = {layout:"fit",border:false,cls:"Explore.view.widgets.RootCauseSummaryWidget",items:[
        {xtype:"box",itemId:"chartContainer",listeners:{resize:{fn:a.setupChart,buffer:50,scope:a}}}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.widgets.RootCauseSummaryWidget.superclass.initComponent.apply(this, arguments)
},setupChart:function() {
    var l = this;
    var e = l.getByItemId("chartContainer");
    var b = e.getEl();
    var a = b.getComputedWidth();
    var k = b.getComputedHeight();
    var c = b.dom;
    if (!l.chart_4) {
        var j = {type:"Category",position:"bottom",fields:["TopicCategory"],title:Explore.i18n("Topic") + " / " + l.getCategoryFriendlyName(l.reportSettings.Category),label:{font:"11px Arial",rotate:{degrees:-45}}};
        var h = {type:"Numeric",title:Explore.i18n("NumberOfDocuments"),minimum:0,fields:["Documents"],position:"left"};
        var g = [j,h];
        var f = {trackMouse:true,width:250,height:35,renderer:function(q, p) {
            var n = q.get("Topic");
            var r = q.get("TopicCategory");
            var m = q.get("Category");
            var o = q.get("Documents");
            var s = String.format(Explore.i18n("Topic__0_nDocuments__1_"), r, o);
            this.update(s)
        }};
        var d = [
            {title:"Series",type:"Column",yField:"Documents",xField:"TopicCategory",tips:f}
        ];
        l.chart_4 = Ext4.create("widget.chart", {store:l.chartStore_4,shadow:false,renderTo:c,width:a,height:k,insetPadding:20,theme:"Blue:gradients",axes:g,series:d,listeners:{itemmouseup:l.onChartItemClick,scope:l}})
    } else {
        l.chart_4.setSize(a, k)
    }
},onChartItemClick:function(a) {
},refreshWidget:function() {
    var b = this;
    var a = false;
    Explore.data.IDOLDataStore.getReportOnCriteria(b.searchCriteria, b.reportSettings, b.projectId, function(c) {
        if (!a) {
            var d = b.getByItemId("chart");
            var e = d.chartStyle.xAxis;
            b.reportData = c;
            e.maximum = b.reportData.ResultCount;
            b.chartStore_4 = new Ext4.data.ArrayStore({fields:b.reportData.Fields,data:b.reportData.GraphData});
            d.bindStore(b.chartStore_4)
        }
    })
}});
Ext.reg("explore.view.widgets.rootcausesummarywidget", Explore.view.widgets.RootCauseSummaryWidget);
Ext.ns("Explore.view.widgets");
Explore.view.widgets.SavedSearchSentimentWidget = Ext.extend(Explore.base.WidgetBase, {searchId:null,name:null,projectId:null,TimeWindow:null,StartDate:null,EndDate:null,isExplore:false,dateFormat:"M-d-Y",initComponent:function() {
    var a = this;
    a.init();
    var b = {layout:"fit",border:false,items:[]};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.widgets.SavedSearchSentimentWidget.superclass.initComponent.apply(this, arguments);
    var c = true;
    a.on("afterlayout", function() {
        if (c) {
            c = false;
            a.showBusy()
        }
    })
},exportData:function() {
    if (this.innerWidget != null) {
        this.innerWidget.exportData()
    } else {
        Explore.view.StatusBox.showWarning(Explore.i18n("ExportNotSupported"), Explore.i18n("ExportNotSupported_PleaseWaitUntilTheChartHasLoaded_"))
    }
},init:function() {
    var a = this;
    if (!a.isExplore) {
        a.searchId = parseInt(a.searchId, 10);
        a.projectId = parseInt(a.projectId, 10);
        a.TimeWindow = parseInt(a.TimeWindow, 10);
        a.StartDate = parseInt(a.StartDate, 10);
        a.EndDate = parseInt(a.EndDate, 10);
        Explore.ensureExtDirect(config.applicationBaseURL)
    }
    Explore.data.IDOLDataStore.getSearchCriteriaBySearchId(a.searchId, function(b) {
        a.processSearchCriteria(b, a)
    })
},processSearchCriteria:function(c, b) {
    var a = b || this;
    a.searchCriteria = c || a.searchCriteria;
    if (a.searchCriteria != null) {
        a.searchCriteria.projectId = a.projectId;
        a.searchCriteria.timezoneOffsetMilliseconds = Explore.getLocalTimeZoneOffset();
        a.reportSettings = {name:name,reportType:Explore.model.SearchResultReportType.SentimentsByDate};
        a.reportSettings.filterByDateType = Explore.model.FilterByDateType.Between;
        a.reportSettings.endDate = new Date();
        if (a.TimeWindow == Explore.model.TimeWindow.Between) {
            a.reportSettings.startDate = a.StartDate;
            a.reportSettings.endDate = a.EndDate
        } else {
            a.reportSettings.startDate = Explore.getStartDateFromTimeWindow(a.TimeWindow, a.reportSettings.endDate, null)
        }
        Explore.data.IDOLDataStore.getReportOnCriteria(a.searchCriteria, {}, a.reportSettings, function(d) {
            a.processReportOnCriteria(d, a)
        })
    }
},processReportOnCriteria:function(b, c) {
    var a = c || this;
    if (b == null) {
        a.showError(Explore.i18n("error"), Explore.i18n("errorReportFailed"))
    } else {
        if (b.ErrorInfo != null) {
            a.showError(Explore.i18n("error"), Explore.i18n("errorReportFailed") + "<br />" + b.ErrorInfo.Message)
        } else {
            b.GraphData = Explore.convertGraphDataEpochsData(b.GraphData);
            a.addWidget(b, a)
        }
    }
},addWidget:function(b, c) {
    var a = c || this;
    a.innerWidget = new Explore.view.widgets.SentimentsByDateWidget({border:false,searchCriteria:a.searchCriteria,reportSettings:a.reportSettings,reportData:b,dateFormat:a.dateFormat,listeners:{chartItemClick:function(e, f) {
        var d = Explore.showSearchPanel();
        d.searchByCriteria(f, {replaceCurrentFilters:true})
    }}});
    a.add(a.innerWidget);
    a.doLayout();
    a.hideStatus()
}});
Ext.reg("explore.view.widgets.savedsearchsentimentwidget", Explore.view.widgets.SavedSearchSentimentWidget);
Ext.ns("Explore.view.widgets");
Explore.view.widgets.SentimentsByDateWidget = Ext.extend(Explore.base.WidgetBase, {chartType:"byCount",searchCriteria:null,reportSettings:null,reportData:null,chart_4:null,chartStore_4:null,dateFormat:"M-d-Y",getReportFailedMessage:function() {
    return Explore.i18n("NoSentimentData")
},reportSuccessful:function() {
    return(this.chartStore_4.data.length > 1)
},initComponent:function() {
    var b = this;
    this.addRealDateField(this.reportData);
    this.chartStore_4 = new Ext4.data.ArrayStore({fields:this.reportData.Fields,data:this.reportData.GraphData});
    this.extraParams = [
        {showInFooter:true,xtype:"selectboxfield",options:[
            {id:"byCount",text:Explore.i18n("ShowByCount")},
            {id:"byPercentage",text:Explore.i18n("ShowByCountPercentage")}
        ],value:this.chartType,listeners:{select:function(f, d, e) {
            this.chartType = f.getValue();
            this.reportSettings.DocCountView = f.getValue();
            this.chart_4 ? this.refreshWidget() : null
        },scope:this}}
    ];
    var a = {xtype:"box",itemId:"chartContainer",listeners:{resize:{fn:this.setupChart,buffer:250,scope:this}}};
    var c = {layout:"fit",border:false,bodyStyle:"background-color: white",cls:"Explore.view.widgets.SentimentsByDateWidget",items:[a,b.getNoReportDiv()]};
    Ext.apply(this, Ext.apply(this.initialConfig, c));
    return Explore.view.widgets.SentimentsByDateWidget.superclass.initComponent.apply(this, arguments)
},addRealDateField:function(a) {
    if (a.Fields != null) {
        a.Fields.push("RealDate");
        for (var b = 0; b < a.GraphData.length; b++) {
            var c = a.GraphData[b][0];
            var e = null;
            if (c > 0) {
                e = Explore.getDateFromEpoch(c, true)
            } else {
                e = new Date(0)
            }
            a.GraphData[b].push(e)
        }
    }
},refreshWidget:function() {
    var b = this;
    var a = false;
    this.showBusy(Explore.i18n("RunningReport") + ": " + b.reportSettings.name, function() {
        a = true
    });
    var c = {};
    Explore.data.IDOLDataStore.getReportOnCriteria(b.searchCriteria, c, b.reportSettings, function(d) {
        if (!a) {
            if (d === null) {
                b.hideStatus();
                b.showError(Explore.i18n("error"), Explore.i18n("errorReportFailed"))
            } else {
                if (d.ErrorInfo != null) {
                    b.hideStatus();
                    b.showError(Explore.i18n("error"), Explore.i18n("errorReportFailed") + "<br />" + d.ErrorInfo.Message)
                } else {
                    d.GraphData = Explore.convertGraphDataEpochsData(d.GraphData);
                    reportData = b.reportData = d;
                    b.addRealDateField(reportData);
                    if (b.chartStore_4) {
                        b.chartStore_4 = null
                    }
                    b.chartStore_4 = new Ext4.data.ArrayStore({fields:reportData.Fields,data:reportData.GraphData});
                    b.chart_4.bindStore(b.chartStore_4);
                    b.hideStatus()
                }
            }
        }
    })
},setupChart:function(d) {
    var e = this,g = d.getEl(),f = g.getComputedWidth(),c = g.getComputedHeight();
    dom = g.dom;
    g.on("contextmenu", function(j) {
        e.fireEvent("disableContextMenu", j)
    }, e);
    var b = e.getByItemId("chartContainer");
    var h = e.getNoReportDiv();
    if (!e.reportSuccessful()) {
        b.hide();
        h.setVisible(true);
        return
    } else {
        h.hide()
    }
    if (!this.chart_4) {
        var a = {trackMouse:true,renderer:function(n, m) {
            var l = n.data[m.series.yField],k = Explore.i18n("Documents"),j = n.data.startDate.format(e.dateFormat),o = n.data.endDate.format(e.dateFormat);
            this.update(String.format(Explore.i18n("trendingTooltip"), l, j, o))
        }};
        this.chart_4 = Ext4.create("widget.chart", {store:this.chartStore_4,renderTo:dom,shadow:false,width:f,height:c,legend:{position:"right"},axes:[
            {type:"Numeric",position:"left",fields:["Positive","Neutral","Negative"],labelTitle:{font:"13px Arial"},label:{font:"11px Arial",renderer:Ext4.util.Format.numberRenderer("0,0")},title:Explore.i18n("Documents"),minimum:0},
            {type:"Time",position:"bottom",fields:"RealDate",hideOverlappingLabels:true,minorTickSteps:1,majorTickSteps:5,dateFormat:this.dateFormat,groupBy:"year,month,day,hour",label:{font:"11px Arial"}}
        ],series:[
            {type:"line",axis:"left",xField:"RealDate",yField:"Positive",tips:a,listeners:{itemmouseup:this.onChartItemMouseUp,scope:this}},
            {type:"line",axis:"left",xField:"RealDate",yField:"Neutral",tips:a,listeners:{itemmouseup:this.onChartItemMouseUp,scope:this}},
            {type:"line",axis:"left",xField:"RealDate",yField:"Negative",tips:a,listeners:{itemmouseup:this.onChartItemMouseUp,scope:this}}
        ]})
    } else {
        this.chart_4.setSize(f, c)
    }
},onChartItemMouseUp:function(g, h) {
    if (h.button == 0) {
        var b = this,d = g.series,c = Ext4.Array.indexOf(d.items, g),a = this.chartStore_4.getAt(c);
        reportSettings = this.reportSettings,options = {item:g,pos:h.getXY()},criteria = Ext4.clone(this.searchCriteria);
        var f = null;
        switch (d.seriesIdx) {case 0:f = "Positive";
            criteria.description = Explore.i18n("PositiveSentiment");break;case 1:f = "Neutral";criteria.description = Explore.i18n("NeutralSentiment");
            break;case 2:f = "Negative";criteria.description = Explore.i18n("NegativeSentiment");break
        }
        criteria.filterByDateType = Explore.model.FilterByDateType.Between;
        criteria.startDate = a.get("startDate");
        criteria.endDate = a.get("endDate");
        criteria.description += " " + Explore.formatDateByPref(criteria.startDate, {ignoreTime:true}) + " " + Explore.i18n("to_v2") + " " + Explore.formatDateByPref(criteria.endDate, {ignoreTime:true});
        Explore.utils.SearchCriteriaUtil.addSearchFilter(criteria, {Combine:Explore.model.ASCombineType.Single,FilterTag:"SENTIMENT",Values:[f]});
        b.fireEvent("chartItemClick", options, criteria)
    }
}});
Ext.reg("explore.view.widgets.sentimentsbydatewidget", Explore.view.widgets.SentimentsByDateWidget);
Ext.ns("Explore.view.widgets");
Explore.view.widgets.ShareOfVoiceWidget = Ext.extend(Explore.base.WidgetBase, {searchCriteria:null,reportSettings:null,reportData:null,initComponent:function() {
    var a = this;
    if (!a.reportSettings.DocCountView) {
        a.reportSettings.DocCountView = "byCount"
    }
    if (a.reportData != null && a.reportData.Fields != null) {
        a.chartStore = new Ext.data.ArrayStore({fields:a.reportData.Fields,data:a.reportData.GraphData})
    }
    var b = {extraParams:[
        {showInFooter:true,xtype:"selectboxfield",options:[
            {id:"byCount",text:Explore.i18n("ShowByCount")},
            {id:"byPercentage",text:Explore.i18n("ShowByCountPercentage")}
        ],value:this.initialConfig.reportSettings.DocCountView,listeners:{select:function(e, c, d) {
            a.reportSettings.DocCountView = e.getValue();
            a.refreshWidget()
        }}}
    ],layout:"fit",border:false,cls:"Explore.view.widgets.ShareOfVoiceWidget",items:[
        {xtype:"box",itemId:"chartContainer",listeners:{resize:{fn:a.drawCorrectChart,buffer:50,scope:a}}}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.widgets.ShareOfVoiceWidget.superclass.initComponent.apply(this, arguments)
},drawChartByCount:function() {
    var j = this;
    var e = j.getByItemId("chartContainer");
    e.items = [];
    var b = e.getEl();
    b.on("contextmenu", function(k) {
        j.fireEvent("disableContextMenu", k)
    }, j);
    var a = b.getComputedWidth();
    var h = b.getComputedHeight();
    var c = b.dom;
    var g = {trackMouse:true,width:200,height:28,renderer:function(l, k) {
        this.update(l.get("Term") + " - " + l.get("Documents") + " documents")
    }};
    var d = [
        {type:"bar",axis:"bottom",highlight:true,tips:g,xField:"Term",yField:["Documents"],listeners:{itemmouseup:j.onChartItemClick,scope:j}}
    ];
    var f = [
        {type:"Numeric",position:"bottom",fields:["Documents"],title:Explore.i18n("Documents"),grid:true,minimum:0},
        {type:"Category",position:"left",fields:["Term"],title:Explore.i18n("Terms")}
    ];
    j.chart_4 = Ext4.create("widget.chart", {store:new Ext4.data.ArrayStore({fields:j.reportData.Fields,data:j.reportData.GraphData}),shadow:false,renderTo:c,width:a,height:h,insetPadding:20,theme:"Base:gradients",axes:f,series:d})
},onChartItemClick:function(f, d) {
    if (d.button == 0) {
        var a = this;
        var b = {item:f,pos:d.getXY()};
        var g = Ext4.clone(a.searchCriteria);
        var c = f.value[0];
        g.searchTerms = c;
        g.searchTermsUI = c;
        g.description = c;
        g.filterByDateType = a.reportSettings.filterByDateType;
        g.startDate = a.reportSettings.startDate;
        g.endDate = a.reportSettings.endDate;
        g.stateMatchId = a.reportData.StateMatchId;
        a.fireEvent("chartItemClick", b, g)
    }
},getShareOfVoiceType:function() {
    return this.reportSettings.DocCountView
},refreshWidget:function() {
    var b = this;
    var a = false;
    b.showBusy(Explore.i18n("RunningReport") + ": " + b.reportSettings.name, function() {
        a = true
    });
    var c = {};
    Explore.data.IDOLDataStore.getReportOnCriteria(b.searchCriteria, c, b.reportSettings, function(d) {
        if (!a) {
            b.hideStatus();
            if (d) {
                if (d.ErrorInfo != null) {
                    if (d.GraphData.length != 0) {
                        b.drawCorrectChart()
                    } else {
                        Explore.view.StatusBox.close();
                        Explore.view.StatusBox.showError(Explore.i18n("error"), Explore.i18n("errorReportFailed") + "<br />" + d.ErrorInfo.Message)
                    }
                } else {
                    b.drawCorrectChart()
                }
            } else {
                Explore.view.StatusBox.close();
                Explore.view.StatusBox.showError(Explore.i18n("error"), Explore.i18n("errorReportFailed"))
            }
        }
    })
},drawCorrectChart:function() {
    var a = this;
    if (a.chart_4) {
        a.chart_4.destroy()
    }
    if (a.getShareOfVoiceType() === "byPercentage") {
        a.drawChartByPercentage()
    } else {
        a.drawChartByCount()
    }
},drawChartByPercentage:function() {
    var o = this;
    var j = o.getByItemId("chartContainer");
    j.items = [];
    var d = j.getEl();
    d.on("contextmenu", function(p) {
        o.fireEvent("disableContextMenu", p)
    }, o);
    var c = d.getComputedWidth();
    var n = d.getComputedHeight();
    var e = d.dom;
    var h = o.reportData.GraphData;
    var b = o.reportData.ResultCount;
    var k = o.reportData.Fields;
    k.push("Percentage");
    for (var g = 0;
         g < h.length; g++) {
        h[g][2] = h[g][1] / b * 100
    }
    var a = new Ext4.data.ArrayStore({fields:k,data:h});
    var m = {trackMouse:true,width:200,height:40,renderer:function(s, r) {
        var q = s.get("Term");
        var p = Ext4.Number.toFixed(s.get("Percentage"), 2);
        this.update(q + " - " + p + " % of documents")
    }};
    var f = [
        {type:"bar",axis:"bottom",highlight:true,tips:m,xField:"Term",yField:["Percentage"],listeners:{itemmouseup:{fn:o.onChartItemClick,scope:o}}}
    ];
    var l = [
        {type:"Numeric",position:"bottom",fields:["Documents"],title:Explore.i18n("Documents") + " %",grid:true,minimum:0,maximum:100},
        {type:"Category",position:"left",fields:["Term"],title:Explore.i18n("Terms")}
    ];
    o.chart_4 = Ext4.create("widget.chart", {store:a,shadow:false,renderTo:e,width:c,height:n,insetPadding:20,theme:"Blue:gradients",axes:l,series:f})
}});
Ext.reg("explore.view.widgets.shareofvoicewidget", Explore.view.widgets.ShareOfVoiceWidget);
Ext.ns("Explore.view.widgets");
Explore.view.widgets.StatisticalSummaryWidget = Ext.extend(Ext.Panel, {searchCriteria:null,reportSettings:null,reportData:null,border:false,cls:"Explore.view.widgets.StatisticalSummaryWidget",margin:15,initComponent:function() {
    if (this.reportData && this.reportData.GraphData && this.reportData.GraphData.length === 1 && this.reportData.GraphData[0].length == 4) {
        var c = this.reportData.GraphData[0];
        var e = c[0];
        var a = c[1].toString();
        var b = c[2].toString();
        var d = c[3].toString();
        this.html = '<div class="body"><P class="StatisticalSummaryText">' + Explore.i18n("Average") + " " + e + ": " + d + "</br>" + Explore.i18n("Minimum") + " " + e + ": " + a + "</br>" + Explore.i18n("Maximum") + " " + e + ": " + b + "</P></div>"
    }
    Explore.view.widgets.StatisticalSummaryWidget.superclass.initComponent.apply(this, arguments)
}});
Ext.reg("explore.view.widgets.statisticalsummarywidget", Explore.view.widgets.StatisticalSummaryWidget);
Ext.ns("Explore.view.widgets");
Explore.view.widgets.TopTermsWidget = Ext.extend(Explore.base.WidgetBase, {termCount:10,reportData:null,termsHistory:null,breadCrumbToolbar:null,grid:null,initComponent:function() {
    this.termsHistory = [this.searchCriteria.searchTermsUI || this.searchCriteria.searchTerms];
    this.breadCrumbToolbar = new Ext.Container({autoEl:{tag:"div",cls:"top-terms-breadcrumbs"}});
    this.grid = new Ext.grid.GridPanel({border:false,store:new Ext.data.JsonStore({fields:[
        {name:"Weight",type:"float"},
        {name:"DocOccurrences"},
        {name:"TotalOccurrences"},
        {name:"Term"}
    ]}),autoExpandColumn:"term",tbar:this.breadCrumbToolbar,listeners:{rowclick:function(d, h, g) {
        var b = d.getStore().getAt(h);
        var f = b.json;
        var c = f.Term;
        this.termsHistory.push(c);
        this.searchTerm(c)
    },scope:this},columns:[
        {header:Explore.i18n("Term"),id:"term",width:200,sortable:true,dataIndex:"Term"},
        {header:Explore.i18n("Weight"),width:80,sortable:true,dataIndex:"Weight"},
        {header:Explore.i18n("Matches"),width:80,sortable:true,dataIndex:"DocOccurrences"},
        {header:Explore.i18n("Occurrences"),width:80,sortable:true,dataIndex:"TotalOccurrences"}
    ]});
    var a = {layout:"fit",border:false,items:this.grid};
    Ext.apply(this, Ext.apply(this.initialConfig, a));
    Explore.view.widgets.TopTermsWidget.superclass.initComponent.apply(this, arguments);
    this.on("afterrender", function() {
        this.analyzeCriteria(this.searchCriteria)
    }, this)
},analyzeCriteria:function(b) {
    var a = this;
    var c = false;
    a.showBusy(Explore.i18n("RunningReportForTopSearchTerms"), function() {
        c = true
    });
    Explore.data.IDOLDataStore.getBestTerms(b, this.termCount, function(d) {
        if (!c) {
            a.reportData = d;
            a.grid.getStore().loadData(d);
            a.setupHeader();
            a.hideStatus();
            a.doLayout()
        }
    })
},searchTerm:function(a) {
    var b = Ext.apply({}, {searchTerms:a,searchTermsUI:a}, this.searchCriteria);
    this.analyzeCriteria(b)
},addTermToToolbar:function(c, b) {
    var a = this;
    if (c > 0) {
        this.breadCrumbToolbar.add({xtype:"component",autoEl:{tag:"span",html:" &gt; "}})
    }
    var d = this.breadCrumbToolbar.add({xtype:"component",autoEl:{tag:"a",html:Ext.util.Format.ellipsis(b, 40)},listeners:{afterrender:function(e) {
        e.getEl().on("click", function() {
            a.termsHistory.splice(c + 1, a.termsHistory.length - (c + 1));
            if (c === 0) {
                a.analyzeCriteria(a.searchCriteria)
            } else {
                a.searchTerm(b)
            }
        })
    }}})
},setupHeader:function() {
    this.breadCrumbToolbar.removeAll(true);
    for (var a = 0; a < this.termsHistory.length; a++) {
        this.addTermToToolbar(a, this.termsHistory[a])
    }
},getRecords:function() {
    return this.grid.getStore().getRange()
},getGrid:function() {
    return this.grid
},getReportData:function() {
    return this.reportData
},exportData:function() {
    var a = this.getGrid();
    Explore.utils.Exporter.exportGridToCsv(a)
}});
Ext.reg("explore.view.widgets.toptermswidget", Explore.view.widgets.TopTermsWidget);
Ext.ns("Explore.view.widgets");
Explore.view.widgets.TrendByIDOLFieldWidget = Ext.extend(Explore.base.WidgetBase, {chartType:"line",searchCriteria:null,reportSettings:null,reportData:null,chart_4:null,chartStore_4:null,initComponent:function() {
    if (this.reportData.Fields != null) {
        this.addRealDateField(this.reportData);
        this.chartStore_4 = new Ext4.data.ArrayStore({fields:this.reportData.Fields,data:this.reportData.GraphData})
    }
    if (!this.reportSettings.view) {
        this.reportSettings.view = "line"
    }
    var a = {layout:"fit",border:false,cls:"Explore.view.widgets.TrendByIDOLFieldWidget",items:[
        {xtype:"box",itemId:"chartContainer",listeners:{resize:{fn:this.setupChart,buffer:250,scope:this}}}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, a));
    return Explore.view.widgets.TrendByIDOLFieldWidget.superclass.initComponent.apply(this, arguments)
},addRealDateField:function(a) {
    if (a.Fields != null) {
        a.Fields.push("RealDate");
        for (var c = 0; c < a.GraphData.length; c++) {
            var b = a.GraphData[c][0];
            var e = new Date(b);
            a.GraphData[c].push(e)
        }
    }
},refreshWidget:function() {
    if (this.chart_4) {
        this.chart_4.destroy();
        this.chart_4 = null;
        this.setupChart(this.getByItemId("chartContainer"))
    }
},setupChart:function(c) {
    var d = this,f = c.getEl(),e = f.getComputedWidth(),b = f.getComputedHeight();
    var g = f.dom;
    f.on("contextmenu", function(h) {
        d.fireEvent("disableContextMenu", h)
    }, d);
    if (!this.chart_4) {
        var a = {trackMouse:true,width:75,height:55,renderer:function(j, h) {
            if (h.series.yField === "maxValue") {
                this.update("Max value<br />" + j.data.RealDate.format("Y-m-d") + "<br />" + j.data.maxValue)
            } else {
                if (h.series.yField === "avgValue") {
                    this.update("Avg value<br />" + j.data.RealDate.format("Y-m-d") + "<br />" + j.data.maxValue)
                } else {
                    if (h.series.yField === "minValue") {
                        this.update("Min value<br />" + j.data.RealDate.format("Y-m-d") + "<br />" + j.data.maxValue)
                    }
                }
            }
        }};
        this.chart_4 = Ext4.create("widget.chart", {store:this.chartStore_4,renderTo:g,shadow:false,width:e,height:b,legend:{position:"bottom"},axes:[
            {type:"Numeric",position:"left",fields:["maxValue","avgValue","minValue"],labelTitle:{font:"13px Arial"},label:{font:"11px Arial",renderer:Ext4.util.Format.numberRenderer("0,0")},title:Explore.i18n("Value"),grid:true,minimum:0},
            {type:"Time",position:"bottom",dateFormat:"M-d-Y",fields:"RealDate",label:{font:"11px Arial"}}
        ],series:[
            {type:this.useLineChart() ? "line" : "column",axis:"left",xField:"RealDate",yField:"maxValue",title:Explore.i18n("MaxValue"),tips:a,listeners:{itemmouseup:this.onChartItemMouseUp,scope:this}},
            {type:this.useLineChart() ? "line" : "column",axis:"left",xField:"RealDate",yField:"avgValue",title:Explore.i18n("AvgValue"),tips:a,listeners:{itemmouseup:this.onChartItemMouseUp,scope:this}},
            {type:this.useLineChart() ? "line" : "column",axis:"left",xField:"RealDate",yField:"minValue",title:Explore.i18n("MinValue"),tips:a,listeners:{itemmouseup:this.onChartItemMouseUp,scope:this}}
        ]})
    } else {
        this.chart_4.setSize(e, b)
    }
},useLineChart:function() {
    return(this.reportSettings.view === "line")
},onChartItemMouseUp:function(h, f) {
    if (f.button == 0) {
        var j = this,b = h.series,d = Ext4.Array.indexOf(b.items, h),c = this.chartStore_4.getAt(d),a = this.reportSettings,k = {item:h,pos:f.getXY()},g = Ext4.clone(this.searchCriteria);
        g.filterByDateType = Explore.model.FilterByDateType.Between;
        g.startDate = c.get("startDate");
        g.endDate = c.get("endDate");
        g.description = Explore.formatDateByPref(g.startDate) + " " + Explore.i18n("to_v2") + " " + Explore.formatDateByPref(g.endDate);
        j.fireEvent("chartItemClick", k, g)
    }
}});
Ext.reg("explore.view.widgets.trendbyidolfieldwidget", Explore.view.widgets.TrendByIDOLFieldWidget);
Explore.view.widgets.TrendingComparisionWidget = Ext.extend(Explore.base.WidgetBase, {activeCloud:null,startDate:null,endDate:null,chartStore_4:null,series:null,fields:null,topicResults:[],dateFormat:"M-d-Y",initComponent:function() {
    var a = this;
    var b = {layout:"fit",border:false,padding:"10",bodyStyle:"background-color: white",items:[
        {xtype:"box",itemId:"chartContainer",listeners:{resize:{fn:this.setupChart,buffer:250,scope:this}}}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.widgets.TrendingComparisionWidget.superclass.initComponent.apply(this, arguments);
    this.getData()
},getData:function() {
    var b = this;
    var a = b.getByItemId("chartContainer");
    Explore.data.IDOLDataStore.getTopicTrendsForCloud(b.activeCloud.Id, function(f) {
        var e = f.GraphData;
        for (var c = 0; c < e.length; c++) {
            var d = e[c];
            d[0] = new Date(d[0]);
            d[1] = new Date(d[1])
        }
        b.setSeries(f);
        b.setFields(f);
        b.reportData = f;
        b.chartStore_4 = Ext4.create("Ext.data.ArrayStore", {fields:f.Fields,data:f.GraphData});
        b.setupChart(a)
    })
},setSeries:function(f) {
    var b = this;
    this.series = [];
    var e = f.Fields;
    for (var d = 2; d < e.length; d++) {
        var a = {trackMouse:true,renderer:function(l, k) {
            var j = k.series.yField,h = l.get(j),g = l.get("startDate").format(b.dateFormat),m = l.get("endDate").format(b.dateFormat);
            var n = "{0} - {1} documents from {2} to {3}";
            this.update(String.format(n, j, h, g, m))
        }};
        var c = {tips:a,type:"line",axis:"left",xField:"startDate",yField:e[d],listeners:{itemmouseup:this.onChartItemMouseUp,scope:this}};
        this.series.push(c)
    }
},setFields:function(c) {
    this.fields = [];
    var b = c.Fields;
    for (var a = 2; a < b.length; a++) {
        this.fields.push(b[a])
    }
},setupChart:function(b) {
    if (!this.chartStore_4) {
        return
    }
    var c = this,e = b.getEl(),d = e.getComputedWidth(),a = e.getComputedHeight();
    var f = e.dom;
    e.on("contextmenu", function(g) {
        c.fireEvent("disableContextMenu", g)
    }, c);
    if (!this.chart_4) {
        this.chart_4 = Ext4.create("widget.chart", {store:this.chartStore_4,renderTo:f,shadow:false,width:d,height:a,legend:{position:"bottom"},axes:[
            {type:"Numeric",position:"left",fields:this.fields,label:{renderer:Ext.util.Format.numberRenderer("0,0")},grid:true,minimum:0},
            {type:"Time",position:"bottom",hideOverlappingLabels:true,dateFormat:this.dateFormat,groupBy:"year,month,day,hour",fields:["startDate"],minorTickSteps:1,majorTickSteps:5,label:{font:"11px Arial"}}
        ],series:this.series})
    } else {
        this.chart_4.setSize(d, a)
    }
},getTopicIdByName:function(c) {
    var d = this.topicResults.TopicSearchResults;
    for (var b = 0; b < d.length;
         b++) {
        var a = d[b];
        if (c === a.TopicName) {
            return a.TopicId
        }
    }
    return null
},onChartItemMouseUp:function(g, j) {
    var f = g.series.yField;
    var a = g.storeItem.get("startDate");
    var h = g.storeItem.get("endDate");
    var d = Explore.model.FilterByDateType.Between;
    var c = this.getTopicIdByName(f);
    var b = Explore.showSearchPanel();
    b.searchByCloudTopic(c, f, a, h)
}});
Ext.ns("Explore.view.widgets");
Explore.view.widgets.TrendWidget = Ext.extend(Explore.base.WidgetBase, {chartType:"line",searchCriteria:null,reportSettings:null,reportData:null,chart_4:null,chartStore_4:null,dateFormat:"M-d-Y",initComponent:function() {
    if (this.reportData.Fields != null) {
        this.addRealDateField(this.reportData);
        this.chartStore_4 = new Ext4.data.ArrayStore({fields:this.reportData.Fields,data:this.reportData.GraphData})
    }
    if (!this.reportSettings.view) {
        this.reportSettings.view = "line"
    }
    this.extraParams = [
        {showInFooter:true,xtype:"selectboxfield",options:[
            {id:"line",text:Explore.i18n("ViewAsLineChart")},
            {id:"barchart",text:Explore.i18n("ViewAsBarChart")}
        ],value:this.chartType,listeners:{select:function(d, b, c) {
            this.reportSettings.view = d.getValue();
            this.refreshWidget()
        },scope:this}}
    ];
    var a = {layout:"fit",border:false,cls:"Explore.view.widgets.TrendWidget",items:[
        {xtype:"box",itemId:"chartContainer",listeners:{resize:{fn:this.setupChart,buffer:250,scope:this}}}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, a));
    return Explore.view.widgets.TrendWidget.superclass.initComponent.apply(this, arguments)
},addRealDateField:function(a) {
    if (a.Fields != null) {
        a.Fields.push("RealDate");
        for (var b = 0; b < a.GraphData.length; b++) {
            var c = a.GraphData[b][0];
            var e = null;
            if (c && c > 0) {
                e = Explore.getDateFromEpoch(c, true)
            } else {
                e = Explore.getDateFromEpoch(0, true)
            }
            a.GraphData[b].push(e)
        }
    }
},refreshWidget:function() {
    if (this.chart_4) {
        this.chart_4.destroy();
        this.chart_4 = null;
        this.setupChart(this.getByItemId("chartContainer"))
    }
},setupChart:function(c) {
    var d = this,f = c.getEl(),e = f.getComputedWidth(),b = f.getComputedHeight();
    var g = f.dom;
    f.on("contextmenu", function(h) {
        d.fireEvent("disableContextMenu", h)
    }, d);
    if (!this.chart_4) {
        var a = {trackMouse:true,renderer:function(m, l) {
            var k = m.data.Documents,j = Explore.i18n("Documents"),h = m.data.startDate.format(d.dateFormat),n = m.data.endDate.format(d.dateFormat);
            this.update(String.format(Explore.i18n("trendingTooltip"), k, h, n))
        }};
        this.chart_4 = Ext4.create("widget.chart", {store:this.chartStore_4,renderTo:g,shadow:false,width:e,height:b,legend:{position:"bottom"},axes:[
            {type:"Numeric",position:"left",fields:"Documents",labelTitle:{font:"13px Arial"},label:{font:"11px Arial",renderer:Ext4.util.Format.numberRenderer("0,0")},title:Explore.i18n("Documents"),grid:true,minimum:0},
            {type:"Time",position:"bottom",fields:"RealDate",dateFormat:this.dateFormat,hideOverlappingLabels:true,groupBy:"year,month,day,hour",minorTickSteps:1,majorTickSteps:5,label:{font:"11px Arial"}}
        ],series:[
            {type:this.useLineChart() ? "line" : "column",axis:"left",xField:"RealDate",yField:"Documents",tips:a,listeners:{itemmouseup:this.onChartItemMouseUp,scope:this}}
        ]})
    } else {
        this.chart_4.setSize(e, b)
    }
},useLineChart:function() {
    return(this.reportSettings.view === "line")
},onChartItemMouseUp:function(h, f) {
    if (f.button == 0) {
        var g = {};
        Ext.apply(g, this.searchCriteria);
        var j = this,b = h.series,d = Ext4.Array.indexOf(b.items, h),c = this.chartStore_4.getAt(d),a = this.reportSettings,k = {item:h,pos:f.getXY()};
        g.filterByDateType = Explore.model.FilterByDateType.Between;
        g.startDate = c.get("startDate");
        g.endDate = c.get("endDate");
        g.description = Explore.formatDateByPref(g.startDate) + " " + Explore.i18n("to_v2") + " " + Explore.formatDateByPref(g.endDate);
        j.fireEvent("chartItemClick", k, g)
    }
}});
Ext.reg("explore.view.widgets.trendwidget", Explore.view.widgets.TrendWidget);
Ext.ns("Explore.view.widgets");
Explore.view.widgets.WidgetDialog = Ext.extend(Ext.Window, {searchCriteria:null,reportSettings:null,reportData:null,_hideSearchReportCount:false,grid:null,criteria:null,reportFavorite:null,lastDir:null,initComponent:function() {
    var a = this;
    this.grid = new Explore.view.ConciseSearchGrid({showGridMask:true,itemId:"grid",tools:[
        {id:"close",handler:function(f, e, d) {
            a.grid.hide();
            a.doLayout()
        }}
    ],hidden:true,gridType:Explore.model.GridType.Compact,hideFooter:false,pageSize:50,usePaging:true,disableRefineResults:true,flex:1,listeners:{scope:this,gridContextOpen:this.openRowResults,rowDoubleClick:this.openRowResults,storeBeforeLoad:function(n, o) {
        if (this.criteria) {
            var e = (o && o.params && o.params.dir && o.params.dir === "ASC" && a.lastDir !== "ASC") ? Explore.model.SortDirection.Ascending : Explore.model.SortDirection.Descending;
            a.lastDir = (e === Explore.model.SortDirection.Ascending) ? "ASC" : "DESC";
            var j = Explore.model.SortProperty.Weight;
            if (o && o.params && o.params.sort) {
                var h = o.params.sort;
                if (h === "type") {
                    j = Explore.model.SortProperty.MediaType
                } else {
                    if (h === "source") {
                        j = Explore.model.SortProperty.MediaType
                    } else {
                        if (h === "date") {
                            j = Explore.model.SortProperty.DateTime
                        }
                    }
                }
            }
            var f = n.lastOptions.params || {page:0,start:0,limit:50};
            var d = f.start;
            var g = f.limit;
            var l = (d / g) || 0;
            var m = {PageNumber:(l + 1),PageSize:50,SortDirection:e,SortProperty:j};
            var k = {BypassDocCounts:l === 1 ? false : true};
            a.page = l;
            Explore.data.IDOLDataStore.getAdvancedSearchResults(this.criteria, m, k, function(p) {
                p.results = n.reader.jsonData.results;
                var q = n.reader.readRecords(p);
                n.loadRecords(q, o, true)
            })
        }
    }}});
    var c = this.getChartConfig();
    var b = {width:700,height:500,modal:true,minimizable:true,maximizable:true,shadow:false,constrain:true,title:this.getCustomTitle(),layout:"fit",cls:"white-bg-dialog",padding:5,items:{xtype:"container",layout:{type:"vbox",align:"stretch"},items:[
        {xtype:"explore.view.widgets.widgetheader",autoHeight:true,hideSearchReportCount:this._hideSearchReportCount,searchCriteria:this.searchCriteria,reportSettings:this.reportSettings,reportData:this.reportData},
        c,
        this.grid
    ]},buttonAlign:"left",fbar:[
        {text:Explore.i18n("Back"),hidden:(this.reportFavorite != null) ? this.reportFavorite : false,handler:function() {
            log.info("SearchReportDialog back clicked");
            a.fireEvent("backButton")
        }},
        "->",
        {text:Explore.i18n("SaveFavorite"),hidden:(this.reportFavorite != null) ? this.reportFavorite : false,handler:function() {
            var e = new Explore.data.model.ReportSettings(a.reportSettings);
            var f = new Explore.data.model.SearchCriteria(a.searchCriteria);
            var d = function(h) {
                e.name = h;
                var g = new Ext.LoadMask(a.body, {msg:Explore.i18n("SavingFavorite")});
                g.show();
                Explore.data.FavoriteReportDataStore.createReportFavorite(e, f, function(j) {
                    g.hide()
                })
            };
            Explore.view.StatusBox.prompt("Save Favorite", "Please enter the name in which you would like to save this report under", e.name, d)
        }},
        {text:Explore.i18n("Export"),disabled:!Explore.Security.isAuthorized("SEARCH_WIDGET_EXPORT"),handler:function() {
            log.info("SearchReportDialog Export clicked");
            var e,f;
            var d = a.getByItemId("widget");
            if (d.exportData) {
                d.exportData()
            } else {
                Explore.view.StatusBox.showWarning(Explore.i18n("ExportNotSupported"), Explore.i18n("ExportNotSupported"))
            }
        }},
        {text:Explore.i18n("Print"),disabled:!Explore.Security.isAuthorized("SEARCH_WIDGET_PRINT"),handler:function() {
            log.info("SearchReportDialog Print clicked");
            var g = a.body;
            var f = a.el;
            var d = f.prev();
            var e = [];
            while (d != null) {
                if (d.getStyle("display") != "none") {
                    e.push(d);
                    d.setStyle("display", "none")
                }
                d = d.prev()
            }
            g.addClass("white-background");
            window.setTimeout(function() {
                window.print();
                g.removeClass("white-background");
                for (var h = 0; h < e.length; h++) {
                    e[h].setStyle("display", "block")
                }
            }, 100)
        }},
        {text:Explore.i18n("Publish"),handler:function() {
            log.info("SearchReportDialog Publish clicked");
            Explore.data.WidgetDataStore.publishWidget(a.searchCriteria, a.reportSettings, true, function(d) {
                if (d.ErrorCode === 0) {
                    Explore.view.StatusBox.showInfo(Explore.i18n("SuccessfullyPublishedWidget"), Explore.i18n("SuccessfullyPublishedWidget") + " " + a.reportSettings.name)
                } else {
                    Explore.view.StatusBox.showWarning(Explore.i18n("ErrorPublishingWidget"), Explore.i18n("ThereWasAnErrorPublishingTheWidget") + d.Message)
                }
            })
        },scope:this,hidden:!Explore.demoMode}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, b));
    Explore.view.widgets.WidgetDialog.superclass.initComponent.apply(this, arguments);
    this.on("minimize", this.minimize, this)
},getCustomTitle:function() {
    var k = this;
    var e = k.reportData;
    var a = k.reportSettings;
    var d = e.StartDate;
    var g = e.EndDate;
    var j = {ignoreTime:true};
    var c = Explore.formatDateByPref(d, j);
    var f = Explore.formatDateByPref(g, j) || Ext.util.Format.date(new Date(), Explore.getDateFormatByPref({ignoreTime:true}));
    var l = e.ResultCount;
    var b = a.name;
    var h = "{0} - [{1} - {2}] ({3} results)";
    return String.format(h, b, c, f, l)
},openRowResults:function(e) {
    var a = this;
    var d = this.grid.getSelectedRows();
    if (d.length > 0) {
        var c = this.grid.getAllRows();
        var b = this.grid.getIndexOfRow(d[0]);
        this.pagingInfo = {PageNumber:1,PageSize:50,TotalCount:this.reportData.ResultCount,SortDirection:Explore.model.SortDirection.Descending,SortProperty:Explore.model.SortProperty.Weight};
        Explore.SearchResults.openSearchResults(d, c, b, this.pagingInfo, this.searchCriteria, false, function(g, f) {
            a.searchResultById(g, f)
        })
    }
},searchResultById:function(c, b) {
    this.searchCriteria.targetDocuments = [c];
    var a = {BypassDocCounts:false};
    this.searchCriteria.printOptions = Explore.model.PrintOptions.PrintAll;
    Explore.data.IDOLDataStore.getAdvancedSearchResults(this.searchCriteria, this.pagingInfo, a, function(d) {
        if (d) {
            log.info("retrieveSearchResults returned:" + d.results);
            if (b) {
                b(d)
            }
        } else {
            log.error("No search results were returned in call to retrieveSearchResults");
            if (b) {
                b(d)
            }
        }
    })
},showResults:function(e) {
    var b = this;
    b.criteria = e;
    var d = {PageNumber:1,PageSize:50,SortDirection:Explore.model.SortDirection.Descending,SortProperty:Explore.model.SortProperty.Weight};
    var c = {BypassDocCounts:false};
    var a = new Ext.LoadMask(b.getEl(), Explore.i18n("Loading..."));
    a.show();
    Explore.data.IDOLDataStore.getAdvancedSearchResults(e, d, c, function(f) {
        a.hide();
        b.grid.showData(f);
        b.grid.show();
        b.doLayout();
        var g = e.searchTermsUI,k = e.description,j = "{0}",h = String.format(j, k);
        b.grid.setTitle(h)
    })
},showDrillDownReport:function(c, a) {
    var b = Ext.apply({}, this.reportSettings);
    b.reportType = a;
    b.DocCountView = null;
    b.Category = null;
    b.Series = null;
    b.name = Explore.i18n("SearchResultReportType" + Explore.model.SearchResultReportType.getName(a)) + " for " + c.description;
    b.filterByDateType = c.filterByDateType;
    b.startDate = c.startDate;
    b.endDate = c.endDate;
    this.fireEvent("onDrillDownReport", c, b)
},showMenu:function(c, h) {
    var j = this;
    var b = [
        {text:Explore.i18n("ShowDetailResults"),handler:function() {
            j.showResults(h)
        }},
        {xtype:"menuseparator"}
    ];
    var a = [];
    var g = Explore.Globalization.globalizeAndSortArray(Explore.data.IDOLDataStore.getActiveSearchResultReportTypeValues(), "name", "SearchResultReportType");
    for (var e = 0; e < g.length; e++) {
        b.push({text:g[e].name,tag:g[e].value,handler:function(k) {
            j.showDrillDownReport(h, k.tag)
        }})
    }
    var d = new Ext.menu.Menu({items:b});
    var f = c.pos;
    if (!f) {
        f = c.component.getPosition();
        f[0] += c.x;
        f[1] += c.y
    }
    d.showAt(f)
},getChartConfig:function() {
    log.debug("getChartConfig");
    var b = this;
    var a = this.reportSettings.reportType;
    var c = {itemId:"widget",flex:1,searchCriteria:this.searchCriteria,reportSettings:this.reportSettings,reportData:this.reportData,durationName:this.durationName,dateFormat:this.dateFormat,projectId:Explore.presenter.ProjectsPresenter.getCurrentProjectId(),listeners:{chartItemClick:function(d, e) {
        log.debug("chart itemclick", d, e);
        b.showMenu(d, e)
    },disableContextMenu:function(d) {
        d.stopEvent()
    },afterrender:function(e) {
        var f = 2;
        if (e.extraParams && e.extraParams.length > 0) {
            for (var d = 0;
                 d < e.extraParams.length; d++) {
                if (e.extraParams[d].showInFooter === true) {
                    b.fbar.insert(f++, e.extraParams[d])
                }
            }
        }
    }}};
    if (a === Explore.model.SearchResultReportType.DocumentCounts) {
        c.xtype = "explore.view.widgets.documentcountswidget"
    } else {
        if (a === Explore.model.SearchResultReportType.Trend) {
            c.xtype = "explore.view.widgets.trendwidget"
        } else {
            if (a === Explore.model.SearchResultReportType.CountsByTerms || a === Explore.model.SearchResultReportType.ShareOfVoice) {
                c.xtype = "explore.view.widgets.shareofvoicewidget"
            } else {
                if (a === Explore.model.SearchResultReportType.SentimentsByDate) {
                    c.xtype = "explore.view.widgets.sentimentsbydatewidget"
                } else {
                    if (a === Explore.model.SearchResultReportType.Map) {
                        c.xtype = "explore.view.widgets.mapwidget"
                    } else {
                        if (a === Explore.model.SearchResultReportType.Terms) {
                            c.xtype = "explore.view.widgets.toptermswidget";
                            this._hideSearchReportCount = true
                        } else {
                            if (a === Explore.model.SearchResultReportType.RelatedConcepts) {
                                c.xtype = "explore.view.widgets.relatedconceptswidget";
                                this._hideSearchReportCount = true
                            } else {
                                if (a === Explore.model.SearchResultReportType.HighLowComparison) {
                                    c.xtype = "explore.view.widgets.highlowcomparisonwidget";
                                    this._hideSearchReportCount = true
                                } else {
                                    if (a === Explore.model.SearchResultReportType.RootCauseSummary) {
                                        c.xtype = "explore.view.widgets.rootcausesummarywidget";
                                        this._hideSearchReportCount = true
                                    } else {
                                        if (a === Explore.model.SearchResultReportType.StatisticalSummary) {
                                            c.xtype = "explore.view.widgets.statisticalsummarywidget";
                                            this._hideSearchReportCount = true
                                        } else {
                                            if (a === Explore.model.SearchResultReportType.RelativeDocCountsByType) {
                                                c.xtype = "explore.view.widgets.relativedocumentcountstypewidget";
                                                this._hideSearchReportCount = true
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    }
    log.info("Widget xtype= " + c.xtype);
    return c
},minimize:function() {
    this.minimized = true;
    this.hide()
}});
Ext.reg("explore.view.widgets.widgetdialog", Explore.view.widgets.WidgetDialog);
Ext.ns("Explore.view.widgets");
Explore.view.widgets.WidgetHeader = Ext.extend(Ext.Container, {reportSettings:null,searchCriteria:null,reportData:null,hideSearchReportCount:false,initComponent:function() {
    var d = this;
    var f = {cls:"report-title",autoEl:{tag:"div",html:this.reportSettings.name},hidden:this.reportSettings.name == null || this.reportSettings.name == ""};
    var c = {cls:"report-terms",autoEl:{tag:"div",html:this.getSearchTerms()}};
    var g = {cls:"report-date",autoEl:{tag:"div",html:this.formatDateRange(d)}};
    var a = {cls:"report-description",autoEl:{tag:"div",html:this.reportSettings.description},hidden:this.reportSettings.description == null || this.reportSettings.description == ""};
    var b = {cls:"report-count",autoEl:{tag:"div",html:String.format(Explore.i18n("_Results"), this.reportData.ResultCount)},hidden:this.hideSearchReportCount};
    var e = {defaults:{xtype:"component"},hidden:true,items:[f,c,g,a,b]};
    Ext.apply(this, Ext.apply(this.initialConfig, e));
    Explore.view.widgets.WidgetHeader.superclass.initComponent.apply(this, arguments)
},formatDateRange:function(f) {
    var e = f || this;
    var b;
    var g;
    if (this.reportSettings.filterByDateType === Explore.model.FilterByDateType.Any) {
        b = e.reportData.StartDate;
        g = e.reportData.EndDate
    } else {
        b = e.reportData.StartDate;
        g = e.reportData.EndDate
    }
    var a = {ignoreTime:true};
    var h = Explore.formatDateByPref(b, a);
    var c = Explore.formatDateByPref(g, a);
    var d = (h !== c) ? h + " " + Explore.i18n("to_v2") + " " + c : h;
    return d
},getSearchTerms:function() {
    var a = this.searchCriteria.searchTermsUI || this.searchCriteria.searchTerms;
    return a.replace(/\+/g, " ")
}});
Ext.reg("explore.view.widgets.widgetheader", Explore.view.widgets.WidgetHeader);
Ext.ns("Explore.view.widgets");
Explore.view.widgets.WidgetSettingsDialog = Ext.extend(Ext.Window, {width:520,autoHeight:true,maxHeight:500,modal:true,title:Explore.i18n("RunReport"),cls:"white-bg-dialog",initComponent:function() {
    var b = this;
    var d = ["runReport","save"];
    b.addEvents(d);
    var a = new Explore.view.widgets.WidgetSettingsFormPanel({monitorValid:true,isExplore:true,isFavoriteEdit:b.saveSettings,listeners:{clientvalidation:function(f, e) {
        this.getByItemId("runReportButton").setDisabled(!e);
        this.getByItemId("saveReportButton").setDisabled(!e)
    },scope:this}});
    var c = {layout:"fit",items:a,buttons:[
        {text:Explore.i18n("RunReport"),hidden:b.saveSettings,itemId:"runReportButton",handler:function() {
            var e = a.getForm().getFieldValues();
            b.fireEvent("runReport", e);
            b.close()
        }},
        {text:Explore.i18n("OK"),hidden:!b.saveSettings,itemId:"saveReportButton",handler:function() {
            var e = a.getForm().getFieldValues();
            b.fireEvent("save", e);
            b.close()
        }},
        {text:Explore.i18n("textCancel"),handler:function() {
            b.fireEvent("cancel");
            b.close()
        }}
    ]};
    Ext.apply(this, Ext.apply(this.initialConfig, c));
    Explore.view.widgets.WidgetSettingsDialog.superclass.initComponent.apply(this, arguments);
    this.on("beforeRender", function() {
        b.title = (b.saveSettings) ? Explore.i18n("SaveSettings") : Explore.i18n("RunReport")
    });
    this.on("afterrender", function() {
        a.getForm().setValues(b.reportSettings)
    })
}});
Ext.reg("explore.view.widgets.widgetsettingsdialog", Explore.view.widgets.WidgetSettingsDialog);
Ext.ns("Explore.view.widgets");
Explore.view.widgets.WidgetSettingsFormPanel = Ext.extend(Ext.form.FormPanel, {isExplore:false,bodyBorder:false,border:false,autoHeight:true,initComponent:function() {
    var m = this;
    var a = {xtype:"textfield",name:"name",itemId:"name",fieldLabel:Explore.i18n("ReportName"),allowBlank:false,width:350,userChangedText:false,hideLabel:!m.isExplore,hidden:!m.isExplore};
    var k = {xtype:"textfield",name:"description",fieldLabel:Explore.i18n("Description"),width:350,hideLabel:!m.isExplore,hidden:!m.isExplore};
    var h = {xtype:"selectboxfield",name:"reportType",itemId:"reportType",fieldLabel:Explore.i18n("Type"),width:350,mode:"local",hideLabel:!m.isExplore,hidden:!m.isExplore,store:new Ext.data.JsonStore({fields:["value","name"],data:Explore.Globalization.globalizeAndSortArray(Explore.data.IDOLDataStore.getActiveSearchResultReportTypeValues(), "name", "SearchResultReportType")}),valueField:"value",displayField:"name",listeners:{select:function(p, n, o) {
        var q = n.data.value;
        m.reportTypeChanged(q);
        m.setNameValueBasedOnType(m)
    }}};
    var b = {xtype:"selectboxfilter",name:"Category",itemId:"Category",checkValidOnHide:false,fieldLabel:Explore.i18n("Category"),allowBlank:false,width:150,forceSelection:true,disabled:true};
    var g = {xtype:"selectboxfield",name:"Series",itemId:"Series",fieldLabel:Explore.i18n("Series"),width:150,mode:"local",store:new Ext.data.JsonStore({fields:["value","name"],data:[
        {value:"_ATTR_DURATION",name:Explore.i18n("Averag_Duration")},
        {value:"_ATTR_NUM_HOLDS",name:Explore.i18n("Average_Holds")},
        {value:"_ATTR_SILENCE",name:Explore.i18n("Average_Silence")},
        {value:"NumCalls",name:Explore.i18n("Total_Number_Calls")}
    ]}),valueField:"value",displayField:"name",value:"_ATTR_DURATION"};
    var f = {xtype:"field",name:"terms",itemId:"terms",fieldLabel:Explore.i18n("Terms"),width:350};
    var d = {xtype:"explore.view.topicpicker",itemId:"topicPicker",fieldLabel:Explore.i18n("Topics"),width:350,height:230,checkable:true,listeners:{treeloaded:function(n) {
        if (m.reportSettings) {
            n.checkNodesByNames(m.reportSettings.topics)
        }
    },afterrender:function(n) {
        if (m.reportSettings) {
            n.checkNodesByNames(m.reportSettings.topics)
        }
    }}};
    var j = {xtype:"spinnerfield",name:"LimitResults",itemId:"LimitResults",fieldLabel:Explore.i18n("LimitResults"),width:50,minValue:1,maxValue:20};
    var e = {itemId:"dateRangePicker",fieldLabel:Explore.i18n("Date"),xtype:"explore.view.common.daterangepicker",supportTrailingRanges:true};
    var c = {padding:15,layoutConfig:{trackLabels:true},items:[a,k,h,b,g,f,d,j,e]};
    Ext.apply(this, Ext.apply(this.initialConfig, c));
    Explore.view.widgets.WidgetSettingsFormPanel.superclass.initComponent.apply(this, arguments);
    var l = m.getByItemId("name");
    l.on("focus", function() {
        var n = l.getRawValue();
        if (!l.userChangedText) {
            l.on("blur", function() {
                if (!l.userChangedText) {
                    if (n !== l.getRawValue()) {
                        l.userChangedText = true;
                        m.reportSettings.userChangedText = true
                    }
                }
            }, m, {single:true})
        }
    })
},getCategories:function(a, c) {
    var b = null;
    if (a === Explore.model.SearchResultReportType.HighLowComparison) {
        b = {Items:[
            {FilterTag:"_ATTR_AGENT_NAME",Name:Explore.i18n("AgentName")},
            {FilterTag:"GROUPS/GROUP",Name:Explore.i18n("Group")}
        ]};
        c(b)
    } else {
        if (a === Explore.model.SearchResultReportType.Map) {
            b = {Items:[
                {FilterTag:"State",Name:Explore.i18n("ByState")},
                {FilterTag:"Country",Name:Explore.i18n("ByCountry")}
            ]};
            c(b)
        } else {
            if (a === Explore.model.SearchResultReportType.RootCauseSummary || a === Explore.model.SearchResultReportType.DocumentCounts) {
                b = Explore.data.IDOLDataStore.getParametricFilters();
                c(b)
            } else {
                if (a === Explore.model.SearchResultReportType.StatisticalSummary) {
                    Explore.data.IDOLDataStore.getNumericStatsFilters(function(d) {
                        c(d)
                    })
                } else {
                    if (a === Explore.model.SearchResultReportType.Trend) {
                        c(null)
                    } else {
                        if (a === Explore.model.SearchResultReportType.RelativeDocCountsByType) {
                            c(null)
                        } else {
                            c(null)
                        }
                    }
                }
            }
        }
    }
},setupCategories:function(b) {
    var c = this;
    var a = c.getByItemId("Category");
    if (a !== null) {
        a.getStore().removeAll();
        a.disable();
        this.getCategories(b, function(d) {
            if (d == null || d.length == 0) {
                a.setVisible(false)
            } else {
                a.setVisible(true);
                a.setFilters(d);
                a.setValue("")
            }
            a.enable()
        })
    }
},reportTypeChanged:function(a) {
    var b = this;
    var e = b.getByItemId("terms");
    var d = b.getByItemId("topicPicker");
    var c = b.getByItemId("LimitResults");
    if (a === Explore.model.SearchResultReportType.ShareOfVoice) {
        e.setVisible(true);
        d.setVisible(true);
        c.setVisible(false)
    } else {
        if (a === Explore.model.SearchResultReportType.RootCauseSummary) {
            e.setVisible(false);
            d.setVisible(true);
            c.setVisible(true)
        } else {
            if (a === Explore.model.SearchResultReportType.DocumentCounts) {
                e.setVisible(false);
                d.setVisible(false);
                c.setVisible(true)
            } else {
                e.setVisible(false);
                d.setVisible(false);
                c.setVisible(false)
            }
        }
    }
    b.setupCategories(a);
    b.getByItemId("Series").setVisible(a === Explore.model.SearchResultReportType.HighLowComparison)
},createForm:function() {
    var a = Ext.applyIf({listeners:{}}, this.initialConfig);
    a.parentPanel = this;
    return new Explore.view.widgets.WidgetSettingsBasicForm(null, a)
},setNameValueBasedOnType:function(f) {
    var d = f || this;
    var e = d.getByItemId("name");
    if (!e.userChangedText && !d.reportSettings.userChangedText) {
        var b = d.getByItemId("reportType");
        var c = b.getRawValue();
        var h = d.reportSettings.searchTerms;
        var a = "[{0}] - {1}";
        var g = (d.isFavoriteEdit) ? d.reportSettings.name : String.format(a, c, h);
        e.setValue(g)
    }
}});
Ext.reg("explore.view.widgets.widgetsettingsformpanel", Explore.view.widgets.WidgetSettingsFormPanel);
Explore.view.widgets.WidgetSettingsBasicForm = Ext.extend(Ext.form.BasicForm, {parentPanel:null,getFieldValues:function(a) {
    var b = Explore.view.widgets.WidgetSettingsBasicForm.superclass.getFieldValues.call(this, a);
    b.topics = this.parentPanel.getByItemId("topicPicker").getSelectedTopicNames();
    this.parentPanel.getByItemId("dateRangePicker").populateObject(b);
    b = Ext.apply({}, b, this.parentPanel.reportSettings);
    for (var c in b) {
        if (c.indexOf("ext-comp") == 0) {
            delete b[c]
        } else {
            if (b[c] === null) {
                delete b[c]
            }
        }
    }
    if (!this.isExplore) {
        b.topics = b.topics.join("|");
        b.startDate = Explore.serializeDate(b.startDate);
        b.endDate = Explore.serializeDate(b.endDate)
    }
    if (!this.parentPanel.getByItemId("Category").isVisible()) {
        delete b.Category
    }
    if (!this.parentPanel.getByItemId("Series").isVisible()) {
        delete b.Series
    }
    this.parentPanel.reportSettings = b;
    log.debug("WidgetSettingsFormPanel.getFieldValues ", b);
    return b
},setValues:function(a) {
    var b = this.parentPanel;
    if (!this.isExplore) {
        if (typeof a.topics === "string") {
            a.topics = a.topics.split("|")
        }
        if (typeof a.reportType === "string") {
            a.reportType = parseInt(a.reportType, 10)
        }
        if (typeof a.filterByDateType === "string") {
            a.filterByDateType = parseInt(a.filterByDateType, 10)
        }
        if (typeof a.searchType === "string") {
            a.searchType = parseInt(a.searchType, 10)
        }
        a.startDate = Explore.parseSerializedDate(a.startDate);
        a.endDate = Explore.parseSerializedDate(a.endDate)
    }
    b.getByItemId("topicPicker").checkNodesByNames(a.topics);
    b.getByItemId("dateRangePicker").populateUI(a);
    b.reportTypeChanged(a.reportType);
    log.debug("WidgetSettingsFormPanel.setValues ", a);
    Explore.view.widgets.WidgetSettingsBasicForm.superclass.setValues.call(this, a);
    b.reportSettings = a;
    b.setNameValueBasedOnType(b)
}});
Ext.ns("Explore.view.widgets");
Explore.view.widgets.WorkspacesWidgetPanel = Ext.extend(Explore.base.WidgetBase, {hideSearchReportCount:false,reportSettings:null,searchCriteria:null,reportData:null,initComponent:function() {
    Explore.ensureExtDirect(this.initialConfig.applicationBaseURL);
    this.reportSettings = this.getReportSettings(a);
    this.searchCriteria = this.getSearchCriteria(a);
    var a = {layout:{type:"vbox",align:"stretch"},border:false};
    Ext.apply(this, Ext.apply(this.initialConfig, a));
    Explore.view.widgets.WorkspacesWidgetPanel.superclass.initComponent.apply(this, arguments);
    this.on("render", this.refreshWidget, this)
},getDate:function(b) {
    var a = Explore.parseSerializedDate(b);
    if (a != null && a.getFullYear && a.getFullYear() <= 1970) {
        a = null
    }
    return a
},getReportSettings:function(b) {
    var a = {reportType:parseInt(b.reportType, 10),filterByDateType:parseInt(b.filterByDateType, 10),startDate:this.getDate(b.startDate),endDate:this.getDate(b.endDate),LimitResults:parseInt(b.LimitResults, 10),terms:b.terms,topics:b.topics.split("|"),DocCountView:b.DocCountView,Category:b.Category,Series:b.Series};
    return a
},getSearchCriteria:function(b) {
    var a = {searchTerms:b.searchTerms,documentTypes:b.documentTypes,language:b.language,filterByDateType:parseInt(b.filterByDateType, 10),startDate:this.getDate(b.startDate),endDate:this.getDate(b.endDate),stateMatchId:b.stateMatchId,criteria:Ext.decode(b.criteria),projectId:parseInt(b.projectId, 10),timezoneOffsetMilliseconds:Explore.getLocalTimeZoneOffset()};
    return a
},handleSettingsChange:function(a) {
    log.debug("Settings Change: ", a);
    this.reportSettings = getReportSettings(a);
    this.searchCriteria = getSearchCriteria(config);
    this.refreshWidget()
},refreshWidget:function() {
    var b = this;
    this.removeAll();
    var a = false;
    var d = this.reportName || this.searchTerms;
    this.showBusy(Explore.i18n("RunningReport") + ": " + d, function() {
        a = true
    });
    var c = {};
    Explore.data.IDOLDataStore.getReportOnCriteria(searchCriteria, c, reportSettings, function(e) {
        if (e == null) {
            b.showError(Explore.i18n("error"), Explore.i18n("errorReportFailed"))
        } else {
            if (e.ErrorInfo != null) {
                b.showError(Explore.i18n("error"), Explore.i18n("errorReportFailed") + "<br />" + e.ErrorInfo.Message)
            } else {
                reportData = e;
                var f = b.getChartConfig();
                var g = {xtype:"explore.view.widgets.widgetheader",autoHeight:true,hideSearchReportCount:this.hideSearchReportCount,searchCriteria:searchCriteria,reportSettings:reportSettings,reportData:reportData};
                b.add([g,f]);
                b.doLayout();
                b.hideStatus()
            }
        }
    })
},getChartConfig:function() {
    log.debug("getChartConfig");
    var a = this.reportSettings.reportType;
    var b = {itemId:"widget",flex:1,searchCriteria:searchCriteria,reportSettings:reportSettings,reportData:reportData,projectId:parseInt(config.projectId, 10)};
    if (a === Explore.model.SearchResultReportType.DocumentCounts) {
        b.xtype = "explore.view.widgets.documentcountswidget"
    } else {
        if (a === Explore.model.SearchResultReportType.Trend) {
            b.xtype = "explore.view.widgets.trendwidget"
        } else {
            if (a === Explore.model.SearchResultReportType.CountsByTerms || a === Explore.model.SearchResultReportType.ShareOfVoice) {
                b.xtype = "explore.view.widgets.shareofvoicewidget"
            } else {
                if (a === Explore.model.SearchResultReportType.SentimentsByDate) {
                    b.xtype = "explore.view.widgets.sentimentsbydatewidget"
                } else {
                    if (a === Explore.model.SearchResultReportType.Map) {
                        b.xtype = "explore.view.widgets.mapwidget"
                    } else {
                        if (a === Explore.model.SearchResultReportType.Terms) {
                            b.xtype = "explore.view.widgets.toptermswidget";
                            this.hideSearchReportCount = true
                        } else {
                            if (a === Explore.model.SearchResultReportType.RelatedConcepts) {
                                b.xtype = "explore.view.widgets.relatedconceptswidget";
                                this.hideSearchReportCount = true
                            } else {
                                if (a === Explore.model.SearchResultReportType.HighLowComparison) {
                                    b.xtype = "explore.view.widgets.highlowcomparisonwidget"
                                } else {
                                    if (a === Explore.model.SearchResultReportType.RootCauseSummary) {
                                        b.xtype = "explore.view.widgets.rootcausesummarywidget";
                                        this.hideSearchReportCount = true
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    }
    return b
},onRender:function() {
    Explore.view.widgets.WorkspacesWidgetPanel.superclass.onRender.apply(this, arguments);
    this.on("settingschange", this.handleSettingsChange)
}});
Ext4.override(Ext4.chart.Chart, {onMouseUp:function(d) {
    var c = this,a = c.getEventXY(d),b;
    if (c.mask) {
        c.mixins.mask.onMouseUp.call(c, d)
    }
    c.series.each(function(e) {
        if (Ext4.draw.Draw.withinBox(a[0], a[1], e.bbox)) {
            if (e.getItemForPoint) {
                b = e.getItemForPoint(a[0], a[1]);
                if (b) {
                    e.fireEvent("itemmouseup", b, d)
                }
            }
        }
    }, c)
}});
Ext.override(Ext.layout.BorderLayout, {onLayout:function(f, H) {
    var g,A,E,l,v = f.items.items,B = v.length;
    if (!this.rendered) {
        g = [];
        for (A = 0; A < B; A++) {
            E = v[A];
            l = E.region;
            if (E.collapsed) {
                g.push(E)
            }
            E.collapsed = false;
            if (!E.rendered) {
                E.render(H, A);
                E.getPositionEl().addClass("x-border-panel")
            }
            this[l] = l != "center" && E.split ? new Ext.layout.BorderLayout.SplitRegion(this, E.initialConfig, l) : new Ext.layout.BorderLayout.Region(this, E.initialConfig, l);
            this[l].render(H, E)
        }
        this.rendered = true
    }
    var u = this.getLayoutTargetSize();
    if (u.width < 20 || u.height < 20) {
        if (g) {
            this.restoreCollapsed = g
        }
        return
    } else {
        if (this.restoreCollapsed) {
            g = this.restoreCollapsed;
            delete this.restoreCollapsed
        }
    }
    var r = u.width,C = u.height,q = r,z = C,o = 0,p = 0,x = this.north,t = this.south,k = this.west,D = this.east,E = this.center,G,y,d,F;
    if (!E && Ext.layout.BorderLayout.WARN !== false) {
        throw"No center region defined in BorderLayout " + f.id
    }
    if (x && x.isVisible()) {
        G = x.getSize();
        y = x.getMargins();
        G.width = r - (y.left + y.right);
        G.x = y.left;
        G.y = y.top;
        o = G.height + G.y + y.bottom;
        z -= o;
        x.applyLayout(G);
        this.addCollapsedTitle(x, false)
    }
    if (t && t.isVisible()) {
        G = t.getSize();
        y = t.getMargins();
        G.width = r - (y.left + y.right);
        G.x = y.left;
        F = (G.height + y.top + y.bottom);
        G.y = C - F + y.top;
        z -= F;
        t.applyLayout(G);
        this.addCollapsedTitle(t, false)
    }
    if (k && k.isVisible()) {
        G = k.getSize();
        y = k.getMargins();
        G.height = z - (y.top + y.bottom);
        G.x = y.left;
        G.y = o + y.top;
        d = (G.width + y.left + y.right);
        p += d;
        q -= d;
        k.applyLayout(G);
        this.addCollapsedTitle(k, true)
    }
    if (D && D.isVisible()) {
        G = D.getSize();
        y = D.getMargins();
        G.height = z - (y.top + y.bottom);
        d = (G.width + y.left + y.right);
        G.x = r - d + y.left;
        G.y = o + y.top;
        q -= d;
        D.applyLayout(G);
        this.addCollapsedTitle(D, true)
    }
    if (E) {
        y = E.getMargins();
        var j = {x:p + y.left,y:o + y.top,width:q - (y.left + y.right),height:z - (y.top + y.bottom)};
        E.applyLayout(j)
    }
    if (g) {
        for (A = 0,B = g.length; A < B; A++) {
            g[A].collapse(false)
        }
    }
    if (Ext.isIE && Ext.isStrict) {
        H.repaint()
    }
    if (A = H.getStyle("overflow") && A != "hidden" && !this.adjustmentPass) {
        var a = this.getLayoutTargetSize();
        if (a.width != u.width || a.height != u.height) {
            this.adjustmentPass = true;
            this.onLayout(f, H)
        }
    }
    delete this.adjustmentPass
},addCollapsedTitle:function(e, b) {
    if (typeof e.collapsedEl != "undefined" && e.collapseTitleAdded !== true) {
        e.collapseTitleAdded = true;
        var d = e.collapsedEl;
        var a,c;
        if (b) {
            a = new Ext.Template('<div style="white-space:nowrap;writing-mode:tb-rl;-moz-transform:rotate(90deg);-webkit-transform:rotate(90deg);transform:rotate(90deg);">{txt}</div>');
            c = a.append(d, {txt:e.title}, true)
        } else {
            a = new Ext.Template('<div style="float: left;">{txt}</div>');
            c = a.append(d, {txt:e.title}, true)
        }
        c.addClass("x-panel-header-text-collapsed");
        if (e.collapsedTitleStyle) {
            c.applyStyles(e.collapsedTitleStyle)
        }
    }
}});
Ext.override(Ext.dd.DragTracker, {onMouseMove:function(f, d) {
    var b = Ext.isIE && (/msie 9/.test(navigator.userAgent.toLowerCase())) && document.documentMode != 6;
    if (this.active && Ext.isIE && !b && !f.browserEvent.button) {
        f.preventDefault();
        this.onMouseUp(f);
        return
    }
    f.preventDefault();
    var c = f.getXY(),a = this.startXY;
    this.lastXY = c;
    if (!this.active) {
        if (Math.abs(a[0] - c[0]) > this.tolerance || Math.abs(a[1] - c[1]) > this.tolerance) {
            this.triggerStart(f)
        } else {
            return
        }
    }
    this.fireEvent("mousemove", this, f);
    this.onDrag(f);
    this.fireEvent("drag", this, f)
}});
Ext.useShims = true;
Ext.override(Ext.Container, {getByItemId:function(g) {
    var d = this;
    if (!d.itemIdCache) {
        d.itemIdCache = {}
    }
    var b = d.itemIdCache[g] || null;
    if (!b) {
        function e(j) {
            if (j.itemId === g) {
                b = j;
                return false
            }
        }

        d.cascade(e);
        if (!b) {
            var c = ["topToolbar","bottomToolbar","fbar","menu"];
            for (var f = 0,a = c.length; f < a; f++) {
                var h = c[f];
                if (d[h] && d[h].cascade) {
                    d[h].cascade(e);
                    if (b != null) {
                        break
                    }
                }
            }
        }
        if (b) {
            d.itemIdCache[g] = b;
            b.on("beforedestroy", function() {
                d.itemIdCache[g] = null
            })
        }
    }
    return b
}});
Ext.util.JSON.encodeDate = function(a) {
    return a.format('"Y-m-d\\TH:i:s O"')
};
Ext.apply(Ext.form.VTypes, {range:function() {
    var a = /\d{1,5}-\d{1,6}/;
    return function(b) {
        return a.test(b)
    }
}(),rangeMask:/[\d-]/,rangeText:"The format must be min-max. e.g. 0-100",searchTerms:function() {
    var a = /::.+::/;
    return function(b) {
        return !a.test(b)
    }
}(),searchTermsText:"Only one expression using :: syntax is allowed",usersyntaxName:function() {
    var a = /[:()]/;
    return function(b) {
        return !a.test(b)
    }
}(),usersyntaxNameText:"The name must not have any of the following characters: : ( )",url:function() {
    var a = /^(https?):\/\/([\-\w\.]{2,})(:[0-9]+)?(\/[%\-\w]+)*\/?$/i;
    return function(b) {
        return a.test(b)
    }
}(),urlText:'This field should be a URL in the format "http://servername:9100" or "http://servername/path"',windowsusername:function(a) {
    var b = /^[^\\]+\\[^\/\\\[\]:;|=,+*?<>]+$/i;
    return function(c) {
        return b.test(c)
    }
}(),windowsusernameText:"This field should be a windows domain and username in the format domain\\username"});
Ext.namespace("Autonomy.ux.form");
Autonomy.ux.form.FirstInvalidField = {init:function(a) {
    a.getFirstInvalidField = this.getFirstInvalidField;
    a.on("afterrender", this._afterRender, this, {single:true})
},getFirstInvalidField:function() {
    var e = this.getForm();
    var c = e.el.dom.elements;
    for (var b = 0,a = c.length; b < a; b++) {
        var d = c[b];
        var f = e.findField(d.id);
        if (f && !f.isValid()) {
            return f
        }
    }
},_afterRender:function(a) {
    var d = null;
    if (a.focusFieldOnRender) {
        d = a.getForm().findField(a.focusFieldOnRender)
    }
    if (!d) {
        var f = a.getForm();
        for (var c = 0,b = f.items.getCount();
             c < b; c++) {
            var e = f.items.get(c);
            if (e.xtype && e.xtype != "hidden") {
                d = e;
                break
            }
        }
    }
    if (d) {
        this._initForm.defer(100, a, [d])
    }
},_initForm:function(a) {
    this.getForm().clearInvalid();
    a.focus()
}};
Ext.override(Ext.FlashComponent, {onRender:function() {
    Ext.FlashComponent.superclass.onRender.apply(this, arguments);
    var d = Ext.apply({allowScriptAccess:"always",bgcolor:this.backgroundColor,wmode:this.wmode}, this.flashParams),c = Ext.apply({allowedDomain:document.location.hostname,YUISwfId:this.getId(),YUIBridgeCallback:"Ext.FlashEventProxy.onEvent"}, this.flashVars);
    var b = this;
    var a = function(e) {
        if (!e.success) {
            b.el.addClass("get-flash");
            b.el.update('<a href="http://get.adobe.com/flashplayer/"><img src="http://www.adobe.com/images/shared/download_buttons/get_flash_player.gif" alt="Get Adobe Flash Player" style="border: none; width:112px; height:33px;" /></a>')
        }
    };
    new swfobject.embedSWF(this.url, this.id, this.swfWidth, this.swfHeight, this.flashVersion, this.expressInstall ? Ext.FlashComponent.EXPRESS_INSTALL_URL : undefined, c, d, null, a);
    this.swf = Ext.getDom(this.id);
    this.el = Ext.get(this.swf)
}});
Ext.override(Ext.ux.form.MultiSelect, {setValue:function(a) {
    if (this.rendered) {
        var b;
        var d = [];
        this.view.clearSelections();
        this.hiddenField.dom.value = "";
        if (!a || (a == "")) {
            return
        }
        if (!Ext.isArray(a)) {
            a = a.split(this.delimiter)
        }
        for (var c = 0; c < a.length; c++) {
            b = this.view.store.indexOf(this.view.store.query(this.valueField, new RegExp("^" + a[c] + "$", "i")).itemAt(0));
            d.push(b)
        }
        this.view.select(d);
        this.hiddenField.dom.value = this.getValue();
        this.validate()
    } else {
        this.value = a
    }
}});
Ext.override(Ext.Panel, {stateEvents:["collapse","expand","resize"],saveDimensionState:false,getState:function() {
    var a;
    if (this.collapsed) {
        a = a || {};
        a.collapsed = true
    }
    if (this.saveDimensionState && !this.collapsed && this.isVisible()) {
        a = a || {};
        a.height = this.getFrameHeight() + this.getInnerHeight();
        a.width = this.getFrameWidth() + this.getInnerWidth()
    }
    return a
}});
Ext.override(Ext.TabPanel, {stateEvents:["collapse","expand","resize","tabchange"],getState:function() {
    var a = Ext.TabPanel.superclass.getState.apply(this, arguments) || {};
    a.activeTab = this.items.indexOf(this.getActiveTab());
    return a
}});
Ext.override(Ext.tree.TreeNodeUI, {grayedValue:null,setReadOnly:function(a) {
    this.readOnly = a
},onDisableChange:function(a, b) {
    this.disabled = b;
    this[b ? "addClass" : "removeClass"]("x-tree-node-disabled")
},initEvents:function() {
    this.node.on("move", this.onMove, this);
    if (this.node.disabled) {
        this.disabled = true;
        this.addClass("x-tree-node-disabled")
    }
    if (this.node.hidden) {
        this.hide()
    }
    var b = this.node.getOwnerTree();
    var a = b.enableDD || b.enableDrag || b.enableDrop;
    if (a && (!this.node.isRoot || b.rootVisible)) {
        Ext.dd.Registry.register(this.elNode, {node:this.node,handles:this.getDDHandles(),isHandle:false})
    }
},onDblClick:function(a) {
    a.preventDefault();
    if (this.disabled) {
        return
    }
    if (!this.animating && this.node.isExpandable() && !a.getTarget(".x-tree-checkbox", 1)) {
        this.node.toggle()
    }
    this.fireEvent("dblclick", this.node, a)
},onCheckChange:function() {
    var a = this.isChecked();
    if (a !== this.node.attributes.checked) {
        this.node.attributes.checked = a;
        this.node.getOwnerTree().setDirty(true);
        this.fireEvent("checkchange", this.node, a)
    }
},toggleCheck:function(b) {
    var a = this.checkbox;
    if (!a) {
        return false
    }
    var c = this.isChecked();
    if (c === b) {
        return
    }
    if (b === undefined) {
        b = c === false
    }
    if (b === true) {
        Ext.fly(a).replaceClass("x-tree-node-grayed", "x-tree-node-checked")
    } else {
        if (b !== false) {
            Ext.fly(a).replaceClass("x-tree-node-checked", "x-tree-node-grayed")
        } else {
            Ext.fly(a).removeClass(["x-tree-node-checked","x-tree-node-grayed"])
        }
    }
    this.onCheckChange();
    return b
},onCheckboxClick:function() {
    if (!this.disabled && !this.readOnly) {
        this.toggleCheck()
    }
},onCheckboxOver:function() {
    if (!this.disabled && !this.readOnly) {
        this.addClass("x-tree-checkbox-over")
    }
},onCheckboxOut:function() {
    if (!this.disabled && !this.readOnly) {
        this.removeClass("x-tree-checkbox-over")
    }
},onCheckboxDown:function() {
    if (!this.disabled && !this.readOnly) {
        this.addClass("x-tree-checkbox-down")
    }
},onCheckboxUp:function() {
    if (!this.disabled && !this.readOnly) {
        this.removeClass("x-tree-checkbox-down")
    }
},renderElements:function(e, k, j, l) {
    this.indentMarkup = e.parentNode ? e.parentNode.ui.getChildIndent() : "";
    var f = k.checked !== undefined;
    var c = k.href ? k.href : Ext.isGecko ? "" : "#";
    var d = ['<li class="x-tree-node"><div ext:tree-node-id="',e.id,'" class="x-tree-node-el x-tree-node-leaf x-unselectable ',k.cls,'" unselectable="on">','<span class="x-tree-node-indent">',this.indentMarkup,"</span>",'<img src="',this.emptyIcon,'" class="x-tree-ec-icon x-tree-elbow" />',f ? ('<img src="' + this.emptyIcon + '" class="x-tree-checkbox' + (k.checked === true ? " x-tree-node-checked" : (k.checked !== false ? " x-tree-node-grayed" : "")) + '" />') : "",'<img src="',k.icon || this.emptyIcon,'" class="x-tree-node-icon',(k.icon ? " x-tree-node-inline-icon" : ""),(k.iconCls ? " " + k.iconCls : ""),'" unselectable="on" />','<a hidefocus="on" class="x-tree-node-anchor" href="',c,'" tabIndex="1" ',k.hrefTarget ? ' target="' + k.hrefTarget + '"' : "",'><span unselectable="on">',e.text,"</span></a></div>",'<ul class="x-tree-node-ct" style="display:none;"></ul>',"</li>"].join("");
    var b;
    if (l !== true && e.nextSibling && (b = e.nextSibling.ui.getEl())) {
        this.wrap = Ext.DomHelper.insertHtml("beforeBegin", b, d)
    } else {
        this.wrap = Ext.DomHelper.insertHtml("beforeEnd", j, d)
    }
    this.elNode = this.wrap.childNodes[0];
    this.ctNode = this.wrap.childNodes[1];
    var h = this.elNode.childNodes;
    this.indentNode = h[0];
    this.ecNode = h[1];
    var g = 2;
    if (f) {
        this.checkbox = h[g++]
    }
    this.iconNode = h[g++];
    this.anchor = h[g];
    this.textNode = h[g].firstChild
},isChecked:function() {
    return this.checkbox ? (Ext.fly(this.checkbox).hasClass("x-tree-node-checked") ? true : Ext.fly(this.checkbox).hasClass("x-tree-node-grayed") ? this.grayedValue : false) : false
},getChecked:function() {
    return this.node.attributes.checked
}});
Ext.override(Ext.tree.TreeEventModel, {initEvents:function() {
    var a = this.tree.getTreeEl();
    a.on("click", this.delegateClick, this);
    if (this.tree.trackMouseOver !== false) {
        a.on("mouseover", this.delegateOver, this);
        a.on("mouseout", this.delegateOut, this)
    }
    a.on("mousedown", this.delegateDown, this);
    a.on("mouseup", this.delegateUp, this);
    a.on("dblclick", this.delegateDblClick, this);
    a.on("contextmenu", this.delegateContextMenu, this)
},delegateOver:function(b, a) {
    if (!this.beforeEvent(b)) {
        return
    }
    if (this.lastEcOver) {
        this.onIconOut(b, this.lastEcOver);
        delete this.lastEcOver
    }
    if (this.lastCbOver) {
        this.onCheckboxOut(b, this.lastCbOver);
        delete this.lastCbOver
    }
    if (b.getTarget(".x-tree-ec-icon", 1)) {
        this.lastEcOver = this.getNode(b);
        this.onIconOver(b, this.lastEcOver)
    } else {
        if (b.getTarget(".x-tree-checkbox", 1)) {
            this.lastCbOver = this.getNode(b);
            this.onCheckboxOver(b, this.lastCbOver)
        }
    }
    if (this.getNodeTarget(b)) {
        this.onNodeOver(b, this.getNode(b))
    }
},delegateOut:function(b, a) {
    if (!this.beforeEvent(b)) {
        return
    }
    var c;
    if (b.getTarget(".x-tree-ec-icon", 1)) {
        c = this.getNode(b);
        this.onIconOut(b, c);
        if (c == this.lastEcOver) {
            delete this.lastEcOver
        }
    } else {
        if (b.getTarget(".x-tree-checkbox", 1)) {
            c = this.getNode(b);
            this.onCheckboxOut(b, c);
            if (c == this.lastCbOver) {
                delete this.lastCbOver
            }
        }
    }
    a = this.getNodeTarget(b);
    if (a && !b.within(a, true)) {
        this.onNodeOut(b, this.getNode(b))
    }
},delegateDown:function(b, a) {
    if (!this.beforeEvent(b)) {
        return
    }
    if (b.getTarget(".x-tree-checkbox", 1)) {
        this.onCheckboxDown(b, this.getNode(b))
    }
},delegateUp:function(b, a) {
    if (b.getTarget(".x-tree-checkbox", 1)) {
        if (!this.disabled) {
            this.onCheckboxUp(b, this.getNode(b))
        }
    }
},delegateClick:function(b, a) {
    if (!this.beforeEvent(b)) {
        return
    }
    if (b.getTarget(".x-tree-checkbox", 1)) {
        this.onCheckboxClick(b, this.getNode(b))
    } else {
        if (b.getTarget(".x-tree-ec-icon", 1)) {
            this.onIconClick(b, this.getNode(b))
        } else {
            if (this.getNodeTarget(b)) {
                this.onNodeClick(b, this.getNode(b))
            }
        }
    }
},onCheckboxClick:function(b, a) {
    a.ui.onCheckboxClick()
},onCheckboxOver:function(b, a) {
    a.ui.onCheckboxOver()
},onCheckboxOut:function(b, a) {
    a.ui.onCheckboxOut()
},onCheckboxDown:function(b, a) {
    a.ui.onCheckboxDown()
},onCheckboxUp:function(b, a) {
    a.ui.onCheckboxUp()
}});
Ext.override(Ext.tree.TreePanel, {isDirtyFlag:false,getChecked:function(b, c) {
    c = c || this.root;
    var d = [];
    var e = function() {
        if (this.ui.getChecked()) {
            d.push(!b ? this : (b == "id" ? this.id : this.attributes[b]))
        }
    };
    c.cascade(e);
    return d
},refresh:function(e, g) {
    var c = this;
    var a = c.getLoader();
    if (Ext.isString(e)) {
        e = c.getNodeById(e)
    }
    if (a) {
        if ((e) && (e.attributes)) {
            e.attributes.children = null
        } else {
            e = c.root
        }
        var d = [];
        e.cascade(function(h) {
            if (h.isExpanded()) {
                d.push(h.id)
            }
        });
        var b = this.getChecked("id", e);

        function f() {
            for (var h = 0;
                 h < d.length; h++) {
                var j = c.getNodeById(d[h]);
                if (j) {
                    j.expand(false, false)
                }
            }
            if (b.length > 0) {
                c.checkNodesByIds(b)
            }
            if (g) {
                g()
            }
        }

        a.load(e, f);
        this.setDirty(false)
    }
},refreshAndSelectNode:function(c, b) {
    var a = this;
    a.refresh(c, function() {
        var d = a.getNodeById(b);
        if (d) {
            d.ensureVisible();
            d.select()
        }
    })
},setDirty:function(a) {
    this.isDirtyFlag = a
},isDirty:function() {
    return this.isDirtyFlag
},clearAll:function() {
    var a = function() {
        if (this.attributes.checked) {
            this.getUI().toggleCheck(false)
        }
    };
    this.root.cascade(a)
},checkAll:function() {
    var a = function() {
        if (!this.attributes.checked) {
            this.getUI().toggleCheck(true)
        }
    };
    this.root.cascade(a)
},checkNodeById:function(c, a) {
    var b = this.getNodeById(c);
    if (b) {
        b.getUI().toggleCheck(a)
    }
},checkNodesByIds:function(b) {
    if (b) {
        for (var a = 0;
             a < b.length; a++) {
            this.checkNodeById(b[a], true)
        }
    }
},findNodeByText:function(d, c) {
    if (!c) {
        return this.findNodeByText(d, this.getRootNode().childNodes)
    } else {
        for (var a = 0; a < c.length; a++) {
            var e = c[a];
            if (e.text === d) {
                return e
            } else {
                if (e.childNodes.length > 0) {
                    var b = this.findNodeByText(d, e.childNodes);
                    if (b != null) {
                        return b
                    }
                }
            }
        }
        return null
    }
},checkNodesByNames:function(b) {
    if (b) {
        for (var a = 0; a < b.length; a++) {
            var c = this.findNodeByText(b[a]);
            if (c != null) {
                c.getUI().toggleCheck(true)
            } else {
                log.warn("Topic node not found: " + b[a])
            }
        }
    }
},setReadOnly:function(b) {
    var a = function() {
        this.getUI().setReadOnly(b)
    };
    this.root.cascade(a)
}});
Ext.tree.TriStateNodeUI = Ext.extend(Ext.tree.TreeNodeUI, {onCheckChange:function() {
    Ext.tree.TriStateNodeUI.superclass.onCheckChange.apply(this, arguments);
    var a = this.node;
    while ((a = a.parentNode) && a.getUI().updateParent && a.getUI().checkbox && !a.getUI().isUpdating) {
        a.getUI().updateParent()
    }
},toggleCheck:function() {
    var a = Ext.tree.TriStateNodeUI.superclass.toggleCheck.apply(this, arguments);
    this.updateChild(a);
    return a
},renderElements:function(e, c, d, b) {
    Ext.tree.TriStateNodeUI.superclass.renderElements.apply(this, arguments);
    this.updateChild(this.node.attributes.checked)
},updateParent:function() {
    var a;
    this.node.eachChild(function(b) {
        if (a === undefined) {
            a = b.attributes.checked
        } else {
            if (a !== b.attributes.checked) {
                a = this.grayedValue;
                return false
            }
        }
    }, this);
    this.toggleCheck(a)
},updateChild:function(a) {
    if (typeof a == "boolean") {
        this.isUpdating = true;
        this.node.eachChild(function(b) {
            b.getUI().toggleCheck(a)
        }, this);
        delete this.isUpdating
    }
}});
Ext.tree.AsynchTriStateNodeUI = Ext.extend(Ext.tree.TriStateNodeUI, {updateChild:function(a) {
    if (this.checkbox) {
        if (a === true) {
            Ext.fly(this.ctNode).replaceClass("x-tree-branch-unchecked", "x-tree-branch-checked")
        } else {
            if (a === false) {
                Ext.fly(this.ctNode).replaceClass("x-tree-branch-checked", "x-tree-branch-unchecked")
            } else {
                Ext.fly(this.ctNode).removeClass(["x-tree-branch-checked","x-tree-branch-unchecked"])
            }
        }
    }
},getChecked:function() {
    var a = this.node.parentNode ? this.node.parentNode.ui.getChecked() : this.grayedValue;
    return typeof a == "boolean" ? a : Ext.tree.TriStateNodeUI.superclass.getChecked.call(this)
}});
Ext.override(Ext.tree.TreeLoader, {createNode:function(attr) {
    if (this.baseAttrs) {
        Ext.applyIf(attr, this.baseAttrs)
    }
    if (this.applyLoader !== false && !attr.loader) {
        attr.loader = this
    }
    if (typeof attr.uiProvider == "string") {
        attr.uiProvider = this.uiProviders[attr.uiProvider] || eval(attr.uiProvider)
    }
    if (attr.nodeType) {
        return new Ext.tree.TreePanel.nodeTypes[attr.nodeType](attr)
    } else {
        return(attr.leaf || (attr.children != null && attr.children.length === 0)) ? new Ext.tree.TreeNode(attr) : new Ext.tree.AsyncTreeNode(attr)
    }
}});
Ext.override(Ext.Window, {stateEvents:["resize"],getState:function() {
    var a = {};
    var b = this.getPosition();
    if (this.isVisible()) {
        if (!this.collapsed) {
            a.height = this.getHeight();
            a.width = this.getWidth()
        }
        a.x = b[0];
        a.y = b[1]
    }
    return a
}});